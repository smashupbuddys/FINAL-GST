var bJ=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ret=bJ((Eet,Pw)=>{function SJ(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function CJ(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var N5={exports:{}},rb={},M5={exports:{}},At={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A0=Symbol.for("react.element"),EJ=Symbol.for("react.portal"),TJ=Symbol.for("react.fragment"),_J=Symbol.for("react.strict_mode"),RJ=Symbol.for("react.profiler"),AJ=Symbol.for("react.provider"),OJ=Symbol.for("react.context"),kJ=Symbol.for("react.forward_ref"),IJ=Symbol.for("react.suspense"),NJ=Symbol.for("react.memo"),MJ=Symbol.for("react.lazy"),TD=Symbol.iterator;function PJ(t){return t===null||typeof t!="object"?null:(t=TD&&t[TD]||t["@@iterator"],typeof t=="function"?t:null)}var P5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D5=Object.assign,L5={};function kf(t,e,r){this.props=t,this.context=e,this.refs=L5,this.updater=r||P5}kf.prototype.isReactComponent={};kf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};kf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function F5(){}F5.prototype=kf.prototype;function Ak(t,e,r){this.props=t,this.context=e,this.refs=L5,this.updater=r||P5}var Ok=Ak.prototype=new F5;Ok.constructor=Ak;D5(Ok,kf.prototype);Ok.isPureReactComponent=!0;var _D=Array.isArray,$5=Object.prototype.hasOwnProperty,kk={current:null},H5={key:!0,ref:!0,__self:!0,__source:!0};function j5(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)$5.call(e,n)&&!H5.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:A0,type:t,key:s,ref:o,props:i,_owner:kk.current}}function DJ(t,e){return{$$typeof:A0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ik(t){return typeof t=="object"&&t!==null&&t.$$typeof===A0}function LJ(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var RD=/\/+/g;function NC(t,e){return typeof t=="object"&&t!==null&&t.key!=null?LJ(""+t.key):e.toString(36)}function sw(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case A0:case EJ:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+NC(o,0):n,_D(i)?(r="",t!=null&&(r=t.replace(RD,"$&/")+"/"),sw(i,e,r,"",function(c){return c})):i!=null&&(Ik(i)&&(i=DJ(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(RD,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",_D(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+NC(s,a);o+=sw(s,e,r,l,i)}else if(l=PJ(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+NC(s,a++),o+=sw(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Sv(t,e,r){if(t==null)return t;var n=[],i=0;return sw(t,n,"","",function(s){return e.call(r,s,i++)}),n}function FJ(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ei={current:null},ow={transition:null},$J={ReactCurrentDispatcher:Ei,ReactCurrentBatchConfig:ow,ReactCurrentOwner:kk};function B5(){throw Error("act(...) is not supported in production builds of React.")}At.Children={map:Sv,forEach:function(t,e,r){Sv(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Sv(t,function(){e++}),e},toArray:function(t){return Sv(t,function(e){return e})||[]},only:function(t){if(!Ik(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};At.Component=kf;At.Fragment=TJ;At.Profiler=RJ;At.PureComponent=Ak;At.StrictMode=_J;At.Suspense=IJ;At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$J;At.act=B5;At.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=D5({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=kk.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)$5.call(e,l)&&!H5.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:A0,type:t.type,key:i,ref:s,props:n,_owner:o}};At.createContext=function(t){return t={$$typeof:OJ,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:AJ,_context:t},t.Consumer=t};At.createElement=j5;At.createFactory=function(t){var e=j5.bind(null,t);return e.type=t,e};At.createRef=function(){return{current:null}};At.forwardRef=function(t){return{$$typeof:kJ,render:t}};At.isValidElement=Ik;At.lazy=function(t){return{$$typeof:MJ,_payload:{_status:-1,_result:t},_init:FJ}};At.memo=function(t,e){return{$$typeof:NJ,type:t,compare:e===void 0?null:e}};At.startTransition=function(t){var e=ow.transition;ow.transition={};try{t()}finally{ow.transition=e}};At.unstable_act=B5;At.useCallback=function(t,e){return Ei.current.useCallback(t,e)};At.useContext=function(t){return Ei.current.useContext(t)};At.useDebugValue=function(){};At.useDeferredValue=function(t){return Ei.current.useDeferredValue(t)};At.useEffect=function(t,e){return Ei.current.useEffect(t,e)};At.useId=function(){return Ei.current.useId()};At.useImperativeHandle=function(t,e,r){return Ei.current.useImperativeHandle(t,e,r)};At.useInsertionEffect=function(t,e){return Ei.current.useInsertionEffect(t,e)};At.useLayoutEffect=function(t,e){return Ei.current.useLayoutEffect(t,e)};At.useMemo=function(t,e){return Ei.current.useMemo(t,e)};At.useReducer=function(t,e,r){return Ei.current.useReducer(t,e,r)};At.useRef=function(t){return Ei.current.useRef(t)};At.useState=function(t){return Ei.current.useState(t)};At.useSyncExternalStore=function(t,e,r){return Ei.current.useSyncExternalStore(t,e,r)};At.useTransition=function(){return Ei.current.useTransition()};At.version="18.3.1";M5.exports=At;var G=M5.exports;const oe=jt(G),HJ=SJ({__proto__:null,default:oe},[G]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jJ=G,BJ=Symbol.for("react.element"),VJ=Symbol.for("react.fragment"),UJ=Object.prototype.hasOwnProperty,WJ=jJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zJ={key:!0,ref:!0,__self:!0,__source:!0};function V5(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)UJ.call(e,n)&&!zJ.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:BJ,type:t,key:s,ref:o,props:i,_owner:WJ.current}}rb.Fragment=VJ;rb.jsx=V5;rb.jsxs=V5;N5.exports=rb;var p=N5.exports,U5={exports:{}},ls={},W5={exports:{}},z5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,y){var _=P.length;P.push(y);e:for(;0<_;){var R=_-1>>>1,A=P[R];if(0<i(A,y))P[R]=y,P[_]=A,_=R;else break e}}function r(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var y=P[0],_=P.pop();if(_!==y){P[0]=_;e:for(var R=0,A=P.length,O=A>>>1;R<O;){var N=2*(R+1)-1,F=P[N],j=N+1,z=P[j];if(0>i(F,_))j<A&&0>i(z,F)?(P[R]=z,P[j]=_,R=j):(P[R]=F,P[N]=_,R=N);else if(j<A&&0>i(z,_))P[R]=z,P[j]=_,R=j;else break e}}return y}function i(P,y){var _=P.sortIndex-y.sortIndex;return _!==0?_:P.id-y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,m=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var y=r(c);y!==null;){if(y.callback===null)n(c);else if(y.startTime<=P)n(c),y.sortIndex=y.expirationTime,e(l,y);else break;y=r(c)}}function C(P){if(g=!1,x(P),!m)if(r(l)!==null)m=!0,ie(S);else{var y=r(c);y!==null&&se(C,y.startTime-P)}}function S(P,y){m=!1,g&&(g=!1,w(I),I=-1),f=!0;var _=d;try{for(x(y),h=r(l);h!==null&&(!(h.expirationTime>y)||P&&!D());){var R=h.callback;if(typeof R=="function"){h.callback=null,d=h.priorityLevel;var A=R(h.expirationTime<=y);y=t.unstable_now(),typeof A=="function"?h.callback=A:h===r(l)&&n(l),x(y)}else n(l);h=r(l)}if(h!==null)var O=!0;else{var N=r(c);N!==null&&se(C,N.startTime-y),O=!1}return O}finally{h=null,d=_,f=!1}}var E=!1,T=null,I=-1,k=5,M=-1;function D(){return!(t.unstable_now()-M<k)}function L(){if(T!==null){var P=t.unstable_now();M=P;var y=!0;try{y=T(!0,P)}finally{y?U():(E=!1,T=null)}}else E=!1}var U;if(typeof b=="function")U=function(){b(L)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,X=J.port2;J.port1.onmessage=L,U=function(){X.postMessage(null)}}else U=function(){v(L,0)};function ie(P){T=P,E||(E=!0,U())}function se(P,y){I=v(function(){P(t.unstable_now())},y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,ie(S))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(P){switch(d){case 1:case 2:case 3:var y=3;break;default:y=d}var _=d;d=y;try{return P()}finally{d=_}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,y){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var _=d;d=P;try{return y()}finally{d=_}},t.unstable_scheduleCallback=function(P,y,_){var R=t.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?R+_:R):_=R,P){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=_+A,P={id:u++,callback:y,priorityLevel:P,startTime:_,expirationTime:A,sortIndex:-1},_>R?(P.sortIndex=_,e(c,P),r(l)===null&&P===r(c)&&(g?(w(I),I=-1):g=!0,se(C,_-R))):(P.sortIndex=A,e(l,P),m||f||(m=!0,ie(S))),P},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(P){var y=d;return function(){var _=d;d=y;try{return P.apply(this,arguments)}finally{d=_}}}})(z5);W5.exports=z5;var GJ=W5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YJ=G,os=GJ;function Le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var G5=new Set,tp={};function Xu(t,e){Ld(t,e),Ld(t+"Capture",e)}function Ld(t,e){for(tp[t]=e,t=0;t<e.length;t++)G5.add(e[t])}var Ka=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),V_=Object.prototype.hasOwnProperty,KJ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,AD={},OD={};function XJ(t){return V_.call(OD,t)?!0:V_.call(AD,t)?!1:KJ.test(t)?OD[t]=!0:(AD[t]=!0,!1)}function qJ(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JJ(t,e,r,n){if(e===null||typeof e>"u"||qJ(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ti(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jn[t]=new Ti(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jn[e]=new Ti(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jn[t]=new Ti(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jn[t]=new Ti(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jn[t]=new Ti(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jn[t]=new Ti(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jn[t]=new Ti(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jn[t]=new Ti(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jn[t]=new Ti(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nk=/[\-:]([a-z])/g;function Mk(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nk,Mk);jn[e]=new Ti(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nk,Mk);jn[e]=new Ti(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nk,Mk);jn[e]=new Ti(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jn[t]=new Ti(t,1,!1,t.toLowerCase(),null,!1,!1)});jn.xlinkHref=new Ti("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jn[t]=new Ti(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pk(t,e,r,n){var i=jn.hasOwnProperty(e)?jn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JJ(e,r,i,n)&&(r=null),n||i===null?XJ(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ol=YJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cv=Symbol.for("react.element"),Xh=Symbol.for("react.portal"),qh=Symbol.for("react.fragment"),Dk=Symbol.for("react.strict_mode"),U_=Symbol.for("react.profiler"),Y5=Symbol.for("react.provider"),K5=Symbol.for("react.context"),Lk=Symbol.for("react.forward_ref"),W_=Symbol.for("react.suspense"),z_=Symbol.for("react.suspense_list"),Fk=Symbol.for("react.memo"),Nl=Symbol.for("react.lazy"),X5=Symbol.for("react.offscreen"),kD=Symbol.iterator;function hg(t){return t===null||typeof t!="object"?null:(t=kD&&t[kD]||t["@@iterator"],typeof t=="function"?t:null)}var Fr=Object.assign,MC;function Qg(t){if(MC===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);MC=e&&e[1]||""}return`
`+MC+t}var PC=!1;function DC(t,e){if(!t||PC)return"";PC=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{PC=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Qg(t):""}function ZJ(t){switch(t.tag){case 5:return Qg(t.type);case 16:return Qg("Lazy");case 13:return Qg("Suspense");case 19:return Qg("SuspenseList");case 0:case 2:case 15:return t=DC(t.type,!1),t;case 11:return t=DC(t.type.render,!1),t;case 1:return t=DC(t.type,!0),t;default:return""}}function G_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qh:return"Fragment";case Xh:return"Portal";case U_:return"Profiler";case Dk:return"StrictMode";case W_:return"Suspense";case z_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case K5:return(t.displayName||"Context")+".Consumer";case Y5:return(t._context.displayName||"Context")+".Provider";case Lk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fk:return e=t.displayName||null,e!==null?e:G_(t.type)||"Memo";case Nl:e=t._payload,t=t._init;try{return G_(t(e))}catch{}}return null}function QJ(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G_(e);case 8:return e===Dk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function q5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eZ(t){var e=q5(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ev(t){t._valueTracker||(t._valueTracker=eZ(t))}function J5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=q5(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Dw(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Y_(t,e){var r=e.checked;return Fr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function ID(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=fc(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Z5(t,e){e=e.checked,e!=null&&Pk(t,"checked",e,!1)}function K_(t,e){Z5(t,e);var r=fc(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?X_(t,e.type,r):e.hasOwnProperty("defaultValue")&&X_(t,e.type,fc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ND(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function X_(t,e,r){(e!=="number"||Dw(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var em=Array.isArray;function vd(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+fc(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function q_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Le(91));return Fr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function MD(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Le(92));if(em(r)){if(1<r.length)throw Error(Le(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:fc(r)}}function Q5(t,e){var r=fc(e.value),n=fc(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function PD(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function e8(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function J_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?e8(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tv,t8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tv=Tv||document.createElement("div"),Tv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rp(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var pm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tZ=["Webkit","ms","Moz","O"];Object.keys(pm).forEach(function(t){tZ.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pm[e]=pm[t]})});function r8(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||pm.hasOwnProperty(t)&&pm[t]?(""+e).trim():e+"px"}function n8(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=r8(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var rZ=Fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Z_(t,e){if(e){if(rZ[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Le(62))}}function Q_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eR=null;function $k(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var tR=null,yd=null,wd=null;function DD(t){if(t=I0(t)){if(typeof tR!="function")throw Error(Le(280));var e=t.stateNode;e&&(e=ab(e),tR(t.stateNode,t.type,e))}}function i8(t){yd?wd?wd.push(t):wd=[t]:yd=t}function s8(){if(yd){var t=yd,e=wd;if(wd=yd=null,DD(t),e)for(t=0;t<e.length;t++)DD(e[t])}}function o8(t,e){return t(e)}function a8(){}var LC=!1;function l8(t,e,r){if(LC)return t(e,r);LC=!0;try{return o8(t,e,r)}finally{LC=!1,(yd!==null||wd!==null)&&(a8(),s8())}}function np(t,e){var r=t.stateNode;if(r===null)return null;var n=ab(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Le(231,e,typeof r));return r}var rR=!1;if(Ka)try{var dg={};Object.defineProperty(dg,"passive",{get:function(){rR=!0}}),window.addEventListener("test",dg,dg),window.removeEventListener("test",dg,dg)}catch{rR=!1}function nZ(t,e,r,n,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var vm=!1,Lw=null,Fw=!1,nR=null,iZ={onError:function(t){vm=!0,Lw=t}};function sZ(t,e,r,n,i,s,o,a,l){vm=!1,Lw=null,nZ.apply(iZ,arguments)}function oZ(t,e,r,n,i,s,o,a,l){if(sZ.apply(this,arguments),vm){if(vm){var c=Lw;vm=!1,Lw=null}else throw Error(Le(198));Fw||(Fw=!0,nR=c)}}function qu(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function c8(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function LD(t){if(qu(t)!==t)throw Error(Le(188))}function aZ(t){var e=t.alternate;if(!e){if(e=qu(t),e===null)throw Error(Le(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return LD(i),t;if(s===n)return LD(i),e;s=s.sibling}throw Error(Le(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(Le(189))}}if(r.alternate!==n)throw Error(Le(190))}if(r.tag!==3)throw Error(Le(188));return r.stateNode.current===r?t:e}function u8(t){return t=aZ(t),t!==null?h8(t):null}function h8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=h8(t);if(e!==null)return e;t=t.sibling}return null}var d8=os.unstable_scheduleCallback,FD=os.unstable_cancelCallback,lZ=os.unstable_shouldYield,cZ=os.unstable_requestPaint,Jr=os.unstable_now,uZ=os.unstable_getCurrentPriorityLevel,Hk=os.unstable_ImmediatePriority,f8=os.unstable_UserBlockingPriority,$w=os.unstable_NormalPriority,hZ=os.unstable_LowPriority,g8=os.unstable_IdlePriority,nb=null,Yo=null;function dZ(t){if(Yo&&typeof Yo.onCommitFiberRoot=="function")try{Yo.onCommitFiberRoot(nb,t,void 0,(t.current.flags&128)===128)}catch{}}var fo=Math.clz32?Math.clz32:mZ,fZ=Math.log,gZ=Math.LN2;function mZ(t){return t>>>=0,t===0?32:31-(fZ(t)/gZ|0)|0}var _v=64,Rv=4194304;function tm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hw(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=tm(a):(s&=o,s!==0&&(n=tm(s)))}else o=r&~i,o!==0?n=tm(o):s!==0&&(n=tm(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-fo(e),i=1<<r,n|=t[r],e&=~i;return n}function pZ(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vZ(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-fo(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=pZ(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function iR(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function m8(){var t=_v;return _v<<=1,!(_v&4194240)&&(_v=64),t}function FC(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function O0(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fo(e),t[e]=r}function yZ(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-fo(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function jk(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-fo(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Gt=0;function p8(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var v8,Bk,y8,w8,x8,sR=!1,Av=[],ql=null,Jl=null,Zl=null,ip=new Map,sp=new Map,Dl=[],wZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $D(t,e){switch(t){case"focusin":case"focusout":ql=null;break;case"dragenter":case"dragleave":Jl=null;break;case"mouseover":case"mouseout":Zl=null;break;case"pointerover":case"pointerout":ip.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sp.delete(e.pointerId)}}function fg(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=I0(e),e!==null&&Bk(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function xZ(t,e,r,n,i){switch(e){case"focusin":return ql=fg(ql,t,e,r,n,i),!0;case"dragenter":return Jl=fg(Jl,t,e,r,n,i),!0;case"mouseover":return Zl=fg(Zl,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return ip.set(s,fg(ip.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,sp.set(s,fg(sp.get(s)||null,t,e,r,n,i)),!0}return!1}function b8(t){var e=au(t.target);if(e!==null){var r=qu(e);if(r!==null){if(e=r.tag,e===13){if(e=c8(r),e!==null){t.blockedOn=e,x8(t.priority,function(){y8(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function aw(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=oR(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);eR=n,r.target.dispatchEvent(n),eR=null}else return e=I0(r),e!==null&&Bk(e),t.blockedOn=r,!1;e.shift()}return!0}function HD(t,e,r){aw(t)&&r.delete(e)}function bZ(){sR=!1,ql!==null&&aw(ql)&&(ql=null),Jl!==null&&aw(Jl)&&(Jl=null),Zl!==null&&aw(Zl)&&(Zl=null),ip.forEach(HD),sp.forEach(HD)}function gg(t,e){t.blockedOn===e&&(t.blockedOn=null,sR||(sR=!0,os.unstable_scheduleCallback(os.unstable_NormalPriority,bZ)))}function op(t){function e(i){return gg(i,t)}if(0<Av.length){gg(Av[0],t);for(var r=1;r<Av.length;r++){var n=Av[r];n.blockedOn===t&&(n.blockedOn=null)}}for(ql!==null&&gg(ql,t),Jl!==null&&gg(Jl,t),Zl!==null&&gg(Zl,t),ip.forEach(e),sp.forEach(e),r=0;r<Dl.length;r++)n=Dl[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Dl.length&&(r=Dl[0],r.blockedOn===null);)b8(r),r.blockedOn===null&&Dl.shift()}var xd=ol.ReactCurrentBatchConfig,jw=!0;function SZ(t,e,r,n){var i=Gt,s=xd.transition;xd.transition=null;try{Gt=1,Vk(t,e,r,n)}finally{Gt=i,xd.transition=s}}function CZ(t,e,r,n){var i=Gt,s=xd.transition;xd.transition=null;try{Gt=4,Vk(t,e,r,n)}finally{Gt=i,xd.transition=s}}function Vk(t,e,r,n){if(jw){var i=oR(t,e,r,n);if(i===null)YC(t,e,n,Bw,r),$D(t,n);else if(xZ(i,t,e,r,n))n.stopPropagation();else if($D(t,n),e&4&&-1<wZ.indexOf(t)){for(;i!==null;){var s=I0(i);if(s!==null&&v8(s),s=oR(t,e,r,n),s===null&&YC(t,e,n,Bw,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else YC(t,e,n,null,r)}}var Bw=null;function oR(t,e,r,n){if(Bw=null,t=$k(n),t=au(t),t!==null)if(e=qu(t),e===null)t=null;else if(r=e.tag,r===13){if(t=c8(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bw=t,null}function S8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uZ()){case Hk:return 1;case f8:return 4;case $w:case hZ:return 16;case g8:return 536870912;default:return 16}default:return 16}}var Bl=null,Uk=null,lw=null;function C8(){if(lw)return lw;var t,e=Uk,r=e.length,n,i="value"in Bl?Bl.value:Bl.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return lw=i.slice(t,1<n?1-n:void 0)}function cw(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ov(){return!0}function jD(){return!1}function cs(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ov:jD,this.isPropagationStopped=jD,this}return Fr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ov)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ov)},persist:function(){},isPersistent:Ov}),e}var If={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wk=cs(If),k0=Fr({},If,{view:0,detail:0}),EZ=cs(k0),$C,HC,mg,ib=Fr({},k0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==mg&&(mg&&t.type==="mousemove"?($C=t.screenX-mg.screenX,HC=t.screenY-mg.screenY):HC=$C=0,mg=t),$C)},movementY:function(t){return"movementY"in t?t.movementY:HC}}),BD=cs(ib),TZ=Fr({},ib,{dataTransfer:0}),_Z=cs(TZ),RZ=Fr({},k0,{relatedTarget:0}),jC=cs(RZ),AZ=Fr({},If,{animationName:0,elapsedTime:0,pseudoElement:0}),OZ=cs(AZ),kZ=Fr({},If,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),IZ=cs(kZ),NZ=Fr({},If,{data:0}),VD=cs(NZ),MZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LZ(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=DZ[t])?!!e[t]:!1}function zk(){return LZ}var FZ=Fr({},k0,{key:function(t){if(t.key){var e=MZ[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cw(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?PZ[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zk,charCode:function(t){return t.type==="keypress"?cw(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cw(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$Z=cs(FZ),HZ=Fr({},ib,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),UD=cs(HZ),jZ=Fr({},k0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zk}),BZ=cs(jZ),VZ=Fr({},If,{propertyName:0,elapsedTime:0,pseudoElement:0}),UZ=cs(VZ),WZ=Fr({},ib,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),zZ=cs(WZ),GZ=[9,13,27,32],Gk=Ka&&"CompositionEvent"in window,ym=null;Ka&&"documentMode"in document&&(ym=document.documentMode);var YZ=Ka&&"TextEvent"in window&&!ym,E8=Ka&&(!Gk||ym&&8<ym&&11>=ym),WD=" ",zD=!1;function T8(t,e){switch(t){case"keyup":return GZ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Jh=!1;function KZ(t,e){switch(t){case"compositionend":return _8(e);case"keypress":return e.which!==32?null:(zD=!0,WD);case"textInput":return t=e.data,t===WD&&zD?null:t;default:return null}}function XZ(t,e){if(Jh)return t==="compositionend"||!Gk&&T8(t,e)?(t=C8(),lw=Uk=Bl=null,Jh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return E8&&e.locale!=="ko"?null:e.data;default:return null}}var qZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function GD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!qZ[t.type]:e==="textarea"}function R8(t,e,r,n){i8(n),e=Vw(e,"onChange"),0<e.length&&(r=new Wk("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var wm=null,ap=null;function JZ(t){$8(t,0)}function sb(t){var e=ed(t);if(J5(e))return t}function ZZ(t,e){if(t==="change")return e}var A8=!1;if(Ka){var BC;if(Ka){var VC="oninput"in document;if(!VC){var YD=document.createElement("div");YD.setAttribute("oninput","return;"),VC=typeof YD.oninput=="function"}BC=VC}else BC=!1;A8=BC&&(!document.documentMode||9<document.documentMode)}function KD(){wm&&(wm.detachEvent("onpropertychange",O8),ap=wm=null)}function O8(t){if(t.propertyName==="value"&&sb(ap)){var e=[];R8(e,ap,t,$k(t)),l8(JZ,e)}}function QZ(t,e,r){t==="focusin"?(KD(),wm=e,ap=r,wm.attachEvent("onpropertychange",O8)):t==="focusout"&&KD()}function eQ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return sb(ap)}function tQ(t,e){if(t==="click")return sb(e)}function rQ(t,e){if(t==="input"||t==="change")return sb(e)}function nQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yo=typeof Object.is=="function"?Object.is:nQ;function lp(t,e){if(yo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!V_.call(e,i)||!yo(t[i],e[i]))return!1}return!0}function XD(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qD(t,e){var r=XD(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=XD(r)}}function k8(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?k8(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function I8(){for(var t=window,e=Dw();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Dw(t.document)}return e}function Yk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function iQ(t){var e=I8(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&k8(r.ownerDocument.documentElement,r)){if(n!==null&&Yk(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=qD(r,s);var o=qD(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var sQ=Ka&&"documentMode"in document&&11>=document.documentMode,Zh=null,aR=null,xm=null,lR=!1;function JD(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lR||Zh==null||Zh!==Dw(n)||(n=Zh,"selectionStart"in n&&Yk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xm&&lp(xm,n)||(xm=n,n=Vw(aR,"onSelect"),0<n.length&&(e=new Wk("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Zh)))}function kv(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Qh={animationend:kv("Animation","AnimationEnd"),animationiteration:kv("Animation","AnimationIteration"),animationstart:kv("Animation","AnimationStart"),transitionend:kv("Transition","TransitionEnd")},UC={},N8={};Ka&&(N8=document.createElement("div").style,"AnimationEvent"in window||(delete Qh.animationend.animation,delete Qh.animationiteration.animation,delete Qh.animationstart.animation),"TransitionEvent"in window||delete Qh.transitionend.transition);function ob(t){if(UC[t])return UC[t];if(!Qh[t])return t;var e=Qh[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in N8)return UC[t]=e[r];return t}var M8=ob("animationend"),P8=ob("animationiteration"),D8=ob("animationstart"),L8=ob("transitionend"),F8=new Map,ZD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yc(t,e){F8.set(t,e),Xu(e,[t])}for(var WC=0;WC<ZD.length;WC++){var zC=ZD[WC],oQ=zC.toLowerCase(),aQ=zC[0].toUpperCase()+zC.slice(1);yc(oQ,"on"+aQ)}yc(M8,"onAnimationEnd");yc(P8,"onAnimationIteration");yc(D8,"onAnimationStart");yc("dblclick","onDoubleClick");yc("focusin","onFocus");yc("focusout","onBlur");yc(L8,"onTransitionEnd");Ld("onMouseEnter",["mouseout","mouseover"]);Ld("onMouseLeave",["mouseout","mouseover"]);Ld("onPointerEnter",["pointerout","pointerover"]);Ld("onPointerLeave",["pointerout","pointerover"]);Xu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(rm));function QD(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,oZ(n,e,void 0,t),t.currentTarget=null}function $8(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;QD(i,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;QD(i,a,c),s=l}}}if(Fw)throw t=nR,Fw=!1,nR=null,t}function vr(t,e){var r=e[fR];r===void 0&&(r=e[fR]=new Set);var n=t+"__bubble";r.has(n)||(H8(e,t,2,!1),r.add(n))}function GC(t,e,r){var n=0;e&&(n|=4),H8(r,t,n,e)}var Iv="_reactListening"+Math.random().toString(36).slice(2);function cp(t){if(!t[Iv]){t[Iv]=!0,G5.forEach(function(r){r!=="selectionchange"&&(lQ.has(r)||GC(r,!1,t),GC(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Iv]||(e[Iv]=!0,GC("selectionchange",!1,e))}}function H8(t,e,r,n){switch(S8(e)){case 1:var i=SZ;break;case 4:i=CZ;break;default:i=Vk}r=i.bind(null,e,r,t),i=void 0,!rR||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function YC(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=au(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}l8(function(){var c=s,u=$k(r),h=[];e:{var d=F8.get(t);if(d!==void 0){var f=Wk,m=t;switch(t){case"keypress":if(cw(r)===0)break e;case"keydown":case"keyup":f=$Z;break;case"focusin":m="focus",f=jC;break;case"focusout":m="blur",f=jC;break;case"beforeblur":case"afterblur":f=jC;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=BD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=_Z;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=BZ;break;case M8:case P8:case D8:f=OZ;break;case L8:f=UZ;break;case"scroll":f=EZ;break;case"wheel":f=zZ;break;case"copy":case"cut":case"paste":f=IZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=UD}var g=(e&4)!==0,v=!g&&t==="scroll",w=g?d!==null?d+"Capture":null:d;g=[];for(var b=c,x;b!==null;){x=b;var C=x.stateNode;if(x.tag===5&&C!==null&&(x=C,w!==null&&(C=np(b,w),C!=null&&g.push(up(b,C,x)))),v)break;b=b.return}0<g.length&&(d=new f(d,m,null,r,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&r!==eR&&(m=r.relatedTarget||r.fromElement)&&(au(m)||m[Xa]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(m=r.relatedTarget||r.toElement,f=c,m=m?au(m):null,m!==null&&(v=qu(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=c),f!==m)){if(g=BD,C="onMouseLeave",w="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(g=UD,C="onPointerLeave",w="onPointerEnter",b="pointer"),v=f==null?d:ed(f),x=m==null?d:ed(m),d=new g(C,b+"leave",f,r,u),d.target=v,d.relatedTarget=x,C=null,au(u)===c&&(g=new g(w,b+"enter",m,r,u),g.target=x,g.relatedTarget=v,C=g),v=C,f&&m)t:{for(g=f,w=m,b=0,x=g;x;x=yh(x))b++;for(x=0,C=w;C;C=yh(C))x++;for(;0<b-x;)g=yh(g),b--;for(;0<x-b;)w=yh(w),x--;for(;b--;){if(g===w||w!==null&&g===w.alternate)break t;g=yh(g),w=yh(w)}g=null}else g=null;f!==null&&eL(h,d,f,g,!1),m!==null&&v!==null&&eL(h,v,m,g,!0)}}e:{if(d=c?ed(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var S=ZZ;else if(GD(d))if(A8)S=rQ;else{S=eQ;var E=QZ}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=tQ);if(S&&(S=S(t,c))){R8(h,S,r,u);break e}E&&E(t,d,c),t==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&X_(d,"number",d.value)}switch(E=c?ed(c):window,t){case"focusin":(GD(E)||E.contentEditable==="true")&&(Zh=E,aR=c,xm=null);break;case"focusout":xm=aR=Zh=null;break;case"mousedown":lR=!0;break;case"contextmenu":case"mouseup":case"dragend":lR=!1,JD(h,r,u);break;case"selectionchange":if(sQ)break;case"keydown":case"keyup":JD(h,r,u)}var T;if(Gk)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Jh?T8(t,r)&&(I="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(E8&&r.locale!=="ko"&&(Jh||I!=="onCompositionStart"?I==="onCompositionEnd"&&Jh&&(T=C8()):(Bl=u,Uk="value"in Bl?Bl.value:Bl.textContent,Jh=!0)),E=Vw(c,I),0<E.length&&(I=new VD(I,t,null,r,u),h.push({event:I,listeners:E}),T?I.data=T:(T=_8(r),T!==null&&(I.data=T)))),(T=YZ?KZ(t,r):XZ(t,r))&&(c=Vw(c,"onBeforeInput"),0<c.length&&(u=new VD("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=T))}$8(h,e)})}function up(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Vw(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=np(t,r),s!=null&&n.unshift(up(t,s,i)),s=np(t,e),s!=null&&n.push(up(t,s,i))),t=t.return}return n}function yh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function eL(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,i?(l=np(r,s),l!=null&&o.unshift(up(r,l,a))):i||(l=np(r,s),l!=null&&o.push(up(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var cQ=/\r\n?/g,uQ=/\u0000|\uFFFD/g;function tL(t){return(typeof t=="string"?t:""+t).replace(cQ,`
`).replace(uQ,"")}function Nv(t,e,r){if(e=tL(e),tL(t)!==e&&r)throw Error(Le(425))}function Uw(){}var cR=null,uR=null;function hR(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dR=typeof setTimeout=="function"?setTimeout:void 0,hQ=typeof clearTimeout=="function"?clearTimeout:void 0,rL=typeof Promise=="function"?Promise:void 0,dQ=typeof queueMicrotask=="function"?queueMicrotask:typeof rL<"u"?function(t){return rL.resolve(null).then(t).catch(fQ)}:dR;function fQ(t){setTimeout(function(){throw t})}function KC(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),op(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);op(e)}function Ql(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nL(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Bo="__reactFiber$"+Nf,hp="__reactProps$"+Nf,Xa="__reactContainer$"+Nf,fR="__reactEvents$"+Nf,gQ="__reactListeners$"+Nf,mQ="__reactHandles$"+Nf;function au(t){var e=t[Bo];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Xa]||r[Bo]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=nL(t);t!==null;){if(r=t[Bo])return r;t=nL(t)}return e}t=r,r=t.parentNode}return null}function I0(t){return t=t[Bo]||t[Xa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ed(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Le(33))}function ab(t){return t[hp]||null}var gR=[],td=-1;function wc(t){return{current:t}}function xr(t){0>td||(t.current=gR[td],gR[td]=null,td--)}function cr(t,e){td++,gR[td]=t.current,t.current=e}var gc={},ri=wc(gc),Fi=wc(!1),ku=gc;function Fd(t,e){var r=t.type.contextTypes;if(!r)return gc;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function $i(t){return t=t.childContextTypes,t!=null}function Ww(){xr(Fi),xr(ri)}function iL(t,e,r){if(ri.current!==gc)throw Error(Le(168));cr(ri,e),cr(Fi,r)}function j8(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Le(108,QJ(t)||"Unknown",i));return Fr({},r,n)}function zw(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gc,ku=ri.current,cr(ri,t),cr(Fi,Fi.current),!0}function sL(t,e,r){var n=t.stateNode;if(!n)throw Error(Le(169));r?(t=j8(t,e,ku),n.__reactInternalMemoizedMergedChildContext=t,xr(Fi),xr(ri),cr(ri,t)):xr(Fi),cr(Fi,r)}var Oa=null,lb=!1,XC=!1;function B8(t){Oa===null?Oa=[t]:Oa.push(t)}function pQ(t){lb=!0,B8(t)}function xc(){if(!XC&&Oa!==null){XC=!0;var t=0,e=Gt;try{var r=Oa;for(Gt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Oa=null,lb=!1}catch(i){throw Oa!==null&&(Oa=Oa.slice(t+1)),d8(Hk,xc),i}finally{Gt=e,XC=!1}}return null}var rd=[],nd=0,Gw=null,Yw=0,Ts=[],_s=0,Iu=null,Ia=1,Na="";function Zc(t,e){rd[nd++]=Yw,rd[nd++]=Gw,Gw=t,Yw=e}function V8(t,e,r){Ts[_s++]=Ia,Ts[_s++]=Na,Ts[_s++]=Iu,Iu=t;var n=Ia;t=Na;var i=32-fo(n)-1;n&=~(1<<i),r+=1;var s=32-fo(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Ia=1<<32-fo(e)+i|r<<i|n,Na=s+t}else Ia=1<<s|r<<i|n,Na=t}function Kk(t){t.return!==null&&(Zc(t,1),V8(t,1,0))}function Xk(t){for(;t===Gw;)Gw=rd[--nd],rd[nd]=null,Yw=rd[--nd],rd[nd]=null;for(;t===Iu;)Iu=Ts[--_s],Ts[_s]=null,Na=Ts[--_s],Ts[_s]=null,Ia=Ts[--_s],Ts[_s]=null}var ns=null,ts=null,Ar=!1,so=null;function U8(t,e){var r=Os(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function oL(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ns=t,ts=Ql(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ns=t,ts=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Iu!==null?{id:Ia,overflow:Na}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Os(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,ns=t,ts=null,!0):!1;default:return!1}}function mR(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pR(t){if(Ar){var e=ts;if(e){var r=e;if(!oL(t,e)){if(mR(t))throw Error(Le(418));e=Ql(r.nextSibling);var n=ns;e&&oL(t,e)?U8(n,r):(t.flags=t.flags&-4097|2,Ar=!1,ns=t)}}else{if(mR(t))throw Error(Le(418));t.flags=t.flags&-4097|2,Ar=!1,ns=t}}}function aL(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ns=t}function Mv(t){if(t!==ns)return!1;if(!Ar)return aL(t),Ar=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hR(t.type,t.memoizedProps)),e&&(e=ts)){if(mR(t))throw W8(),Error(Le(418));for(;e;)U8(t,e),e=Ql(e.nextSibling)}if(aL(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ts=Ql(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ts=null}}else ts=ns?Ql(t.stateNode.nextSibling):null;return!0}function W8(){for(var t=ts;t;)t=Ql(t.nextSibling)}function $d(){ts=ns=null,Ar=!1}function qk(t){so===null?so=[t]:so.push(t)}var vQ=ol.ReactCurrentBatchConfig;function pg(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Le(309));var n=r.stateNode}if(!n)throw Error(Le(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Le(284));if(!r._owner)throw Error(Le(290,t))}return t}function Pv(t,e){throw t=Object.prototype.toString.call(e),Error(Le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lL(t){var e=t._init;return e(t._payload)}function z8(t){function e(w,b){if(t){var x=w.deletions;x===null?(w.deletions=[b],w.flags|=16):x.push(b)}}function r(w,b){if(!t)return null;for(;b!==null;)e(w,b),b=b.sibling;return null}function n(w,b){for(w=new Map;b!==null;)b.key!==null?w.set(b.key,b):w.set(b.index,b),b=b.sibling;return w}function i(w,b){return w=nc(w,b),w.index=0,w.sibling=null,w}function s(w,b,x){return w.index=x,t?(x=w.alternate,x!==null?(x=x.index,x<b?(w.flags|=2,b):x):(w.flags|=2,b)):(w.flags|=1048576,b)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,b,x,C){return b===null||b.tag!==6?(b=rE(x,w.mode,C),b.return=w,b):(b=i(b,x),b.return=w,b)}function l(w,b,x,C){var S=x.type;return S===qh?u(w,b,x.props.children,C,x.key):b!==null&&(b.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Nl&&lL(S)===b.type)?(C=i(b,x.props),C.ref=pg(w,b,x),C.return=w,C):(C=pw(x.type,x.key,x.props,null,w.mode,C),C.ref=pg(w,b,x),C.return=w,C)}function c(w,b,x,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=nE(x,w.mode,C),b.return=w,b):(b=i(b,x.children||[]),b.return=w,b)}function u(w,b,x,C,S){return b===null||b.tag!==7?(b=xu(x,w.mode,C,S),b.return=w,b):(b=i(b,x),b.return=w,b)}function h(w,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=rE(""+b,w.mode,x),b.return=w,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Cv:return x=pw(b.type,b.key,b.props,null,w.mode,x),x.ref=pg(w,null,b),x.return=w,x;case Xh:return b=nE(b,w.mode,x),b.return=w,b;case Nl:var C=b._init;return h(w,C(b._payload),x)}if(em(b)||hg(b))return b=xu(b,w.mode,x,null),b.return=w,b;Pv(w,b)}return null}function d(w,b,x,C){var S=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:a(w,b,""+x,C);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Cv:return x.key===S?l(w,b,x,C):null;case Xh:return x.key===S?c(w,b,x,C):null;case Nl:return S=x._init,d(w,b,S(x._payload),C)}if(em(x)||hg(x))return S!==null?null:u(w,b,x,C,null);Pv(w,x)}return null}function f(w,b,x,C,S){if(typeof C=="string"&&C!==""||typeof C=="number")return w=w.get(x)||null,a(b,w,""+C,S);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Cv:return w=w.get(C.key===null?x:C.key)||null,l(b,w,C,S);case Xh:return w=w.get(C.key===null?x:C.key)||null,c(b,w,C,S);case Nl:var E=C._init;return f(w,b,x,E(C._payload),S)}if(em(C)||hg(C))return w=w.get(x)||null,u(b,w,C,S,null);Pv(b,C)}return null}function m(w,b,x,C){for(var S=null,E=null,T=b,I=b=0,k=null;T!==null&&I<x.length;I++){T.index>I?(k=T,T=null):k=T.sibling;var M=d(w,T,x[I],C);if(M===null){T===null&&(T=k);break}t&&T&&M.alternate===null&&e(w,T),b=s(M,b,I),E===null?S=M:E.sibling=M,E=M,T=k}if(I===x.length)return r(w,T),Ar&&Zc(w,I),S;if(T===null){for(;I<x.length;I++)T=h(w,x[I],C),T!==null&&(b=s(T,b,I),E===null?S=T:E.sibling=T,E=T);return Ar&&Zc(w,I),S}for(T=n(w,T);I<x.length;I++)k=f(T,w,I,x[I],C),k!==null&&(t&&k.alternate!==null&&T.delete(k.key===null?I:k.key),b=s(k,b,I),E===null?S=k:E.sibling=k,E=k);return t&&T.forEach(function(D){return e(w,D)}),Ar&&Zc(w,I),S}function g(w,b,x,C){var S=hg(x);if(typeof S!="function")throw Error(Le(150));if(x=S.call(x),x==null)throw Error(Le(151));for(var E=S=null,T=b,I=b=0,k=null,M=x.next();T!==null&&!M.done;I++,M=x.next()){T.index>I?(k=T,T=null):k=T.sibling;var D=d(w,T,M.value,C);if(D===null){T===null&&(T=k);break}t&&T&&D.alternate===null&&e(w,T),b=s(D,b,I),E===null?S=D:E.sibling=D,E=D,T=k}if(M.done)return r(w,T),Ar&&Zc(w,I),S;if(T===null){for(;!M.done;I++,M=x.next())M=h(w,M.value,C),M!==null&&(b=s(M,b,I),E===null?S=M:E.sibling=M,E=M);return Ar&&Zc(w,I),S}for(T=n(w,T);!M.done;I++,M=x.next())M=f(T,w,I,M.value,C),M!==null&&(t&&M.alternate!==null&&T.delete(M.key===null?I:M.key),b=s(M,b,I),E===null?S=M:E.sibling=M,E=M);return t&&T.forEach(function(L){return e(w,L)}),Ar&&Zc(w,I),S}function v(w,b,x,C){if(typeof x=="object"&&x!==null&&x.type===qh&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Cv:e:{for(var S=x.key,E=b;E!==null;){if(E.key===S){if(S=x.type,S===qh){if(E.tag===7){r(w,E.sibling),b=i(E,x.props.children),b.return=w,w=b;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Nl&&lL(S)===E.type){r(w,E.sibling),b=i(E,x.props),b.ref=pg(w,E,x),b.return=w,w=b;break e}r(w,E);break}else e(w,E);E=E.sibling}x.type===qh?(b=xu(x.props.children,w.mode,C,x.key),b.return=w,w=b):(C=pw(x.type,x.key,x.props,null,w.mode,C),C.ref=pg(w,b,x),C.return=w,w=C)}return o(w);case Xh:e:{for(E=x.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){r(w,b.sibling),b=i(b,x.children||[]),b.return=w,w=b;break e}else{r(w,b);break}else e(w,b);b=b.sibling}b=nE(x,w.mode,C),b.return=w,w=b}return o(w);case Nl:return E=x._init,v(w,b,E(x._payload),C)}if(em(x))return m(w,b,x,C);if(hg(x))return g(w,b,x,C);Pv(w,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(r(w,b.sibling),b=i(b,x),b.return=w,w=b):(r(w,b),b=rE(x,w.mode,C),b.return=w,w=b),o(w)):r(w,b)}return v}var Hd=z8(!0),G8=z8(!1),Kw=wc(null),Xw=null,id=null,Jk=null;function Zk(){Jk=id=Xw=null}function Qk(t){var e=Kw.current;xr(Kw),t._currentValue=e}function vR(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function bd(t,e){Xw=t,Jk=id=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pi=!0),t.firstContext=null)}function Ns(t){var e=t._currentValue;if(Jk!==t)if(t={context:t,memoizedValue:e,next:null},id===null){if(Xw===null)throw Error(Le(308));id=t,Xw.dependencies={lanes:0,firstContext:t}}else id=id.next=t;return e}var lu=null;function e2(t){lu===null?lu=[t]:lu.push(t)}function Y8(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,e2(e)):(r.next=i.next,i.next=r),e.interleaved=r,qa(t,n)}function qa(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ml=!1;function t2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K8(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ja(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ec(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Dt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,qa(t,r)}return i=n.interleaved,i===null?(e.next=e,e2(n)):(e.next=i.next,i.next=e),n.interleaved=e,qa(t,r)}function uw(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,jk(t,r)}}function cL(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function qw(t,e,r,n){var i=t.updateQueue;Ml=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,u=c=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(d=e,f=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(f,h,d):m,d==null)break e;h=Fr({},h,d);break e;case 2:Ml=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Mu|=o,t.lanes=o,t.memoizedState=h}}function uL(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Le(191,i));i.call(n)}}}var N0={},Ko=wc(N0),dp=wc(N0),fp=wc(N0);function cu(t){if(t===N0)throw Error(Le(174));return t}function r2(t,e){switch(cr(fp,e),cr(dp,t),cr(Ko,N0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:J_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=J_(e,t)}xr(Ko),cr(Ko,e)}function jd(){xr(Ko),xr(dp),xr(fp)}function X8(t){cu(fp.current);var e=cu(Ko.current),r=J_(e,t.type);e!==r&&(cr(dp,t),cr(Ko,r))}function n2(t){dp.current===t&&(xr(Ko),xr(dp))}var Nr=wc(0);function Jw(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qC=[];function i2(){for(var t=0;t<qC.length;t++)qC[t]._workInProgressVersionPrimary=null;qC.length=0}var hw=ol.ReactCurrentDispatcher,JC=ol.ReactCurrentBatchConfig,Nu=0,Dr=null,dn=null,Tn=null,Zw=!1,bm=!1,gp=0,yQ=0;function Un(){throw Error(Le(321))}function s2(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!yo(t[r],e[r]))return!1;return!0}function o2(t,e,r,n,i,s){if(Nu=s,Dr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hw.current=t===null||t.memoizedState===null?SQ:CQ,t=r(n,i),bm){s=0;do{if(bm=!1,gp=0,25<=s)throw Error(Le(301));s+=1,Tn=dn=null,e.updateQueue=null,hw.current=EQ,t=r(n,i)}while(bm)}if(hw.current=Qw,e=dn!==null&&dn.next!==null,Nu=0,Tn=dn=Dr=null,Zw=!1,e)throw Error(Le(300));return t}function a2(){var t=gp!==0;return gp=0,t}function Fo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Dr.memoizedState=Tn=t:Tn=Tn.next=t,Tn}function Ms(){if(dn===null){var t=Dr.alternate;t=t!==null?t.memoizedState:null}else t=dn.next;var e=Tn===null?Dr.memoizedState:Tn.next;if(e!==null)Tn=e,dn=t;else{if(t===null)throw Error(Le(310));dn=t,t={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},Tn===null?Dr.memoizedState=Tn=t:Tn=Tn.next=t}return Tn}function mp(t,e){return typeof e=="function"?e(t):e}function ZC(t){var e=Ms(),r=e.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=t;var n=dn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Nu&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,Dr.lanes|=u,Mu|=u}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,yo(n,e.memoizedState)||(Pi=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Dr.lanes|=s,Mu|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function QC(t){var e=Ms(),r=e.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);yo(s,e.memoizedState)||(Pi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function q8(){}function J8(t,e){var r=Dr,n=Ms(),i=e(),s=!yo(n.memoizedState,i);if(s&&(n.memoizedState=i,Pi=!0),n=n.queue,l2(eV.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Tn!==null&&Tn.memoizedState.tag&1){if(r.flags|=2048,pp(9,Q8.bind(null,r,n,i,e),void 0,null),Rn===null)throw Error(Le(349));Nu&30||Z8(r,e,i)}return i}function Z8(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Dr.updateQueue,e===null?(e={lastEffect:null,stores:null},Dr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Q8(t,e,r,n){e.value=r,e.getSnapshot=n,tV(e)&&rV(t)}function eV(t,e,r){return r(function(){tV(e)&&rV(t)})}function tV(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!yo(t,r)}catch{return!0}}function rV(t){var e=qa(t,1);e!==null&&go(e,t,1,-1)}function hL(t){var e=Fo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mp,lastRenderedState:t},e.queue=t,t=t.dispatch=bQ.bind(null,Dr,t),[e.memoizedState,t]}function pp(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Dr.updateQueue,e===null?(e={lastEffect:null,stores:null},Dr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function nV(){return Ms().memoizedState}function dw(t,e,r,n){var i=Fo();Dr.flags|=t,i.memoizedState=pp(1|e,r,void 0,n===void 0?null:n)}function cb(t,e,r,n){var i=Ms();n=n===void 0?null:n;var s=void 0;if(dn!==null){var o=dn.memoizedState;if(s=o.destroy,n!==null&&s2(n,o.deps)){i.memoizedState=pp(e,r,s,n);return}}Dr.flags|=t,i.memoizedState=pp(1|e,r,s,n)}function dL(t,e){return dw(8390656,8,t,e)}function l2(t,e){return cb(2048,8,t,e)}function iV(t,e){return cb(4,2,t,e)}function sV(t,e){return cb(4,4,t,e)}function oV(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function aV(t,e,r){return r=r!=null?r.concat([t]):null,cb(4,4,oV.bind(null,e,t),r)}function c2(){}function lV(t,e){var r=Ms();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&s2(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function cV(t,e){var r=Ms();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&s2(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function uV(t,e,r){return Nu&21?(yo(r,e)||(r=m8(),Dr.lanes|=r,Mu|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pi=!0),t.memoizedState=r)}function wQ(t,e){var r=Gt;Gt=r!==0&&4>r?r:4,t(!0);var n=JC.transition;JC.transition={};try{t(!1),e()}finally{Gt=r,JC.transition=n}}function hV(){return Ms().memoizedState}function xQ(t,e,r){var n=rc(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},dV(t))fV(e,r);else if(r=Y8(t,e,r,n),r!==null){var i=wi();go(r,t,n,i),gV(r,e,n)}}function bQ(t,e,r){var n=rc(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(dV(t))fV(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,yo(a,o)){var l=e.interleaved;l===null?(i.next=i,e2(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Y8(t,e,i,n),r!==null&&(i=wi(),go(r,t,n,i),gV(r,e,n))}}function dV(t){var e=t.alternate;return t===Dr||e!==null&&e===Dr}function fV(t,e){bm=Zw=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function gV(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,jk(t,r)}}var Qw={readContext:Ns,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useInsertionEffect:Un,useLayoutEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useMutableSource:Un,useSyncExternalStore:Un,useId:Un,unstable_isNewReconciler:!1},SQ={readContext:Ns,useCallback:function(t,e){return Fo().memoizedState=[t,e===void 0?null:e],t},useContext:Ns,useEffect:dL,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,dw(4194308,4,oV.bind(null,e,t),r)},useLayoutEffect:function(t,e){return dw(4194308,4,t,e)},useInsertionEffect:function(t,e){return dw(4,2,t,e)},useMemo:function(t,e){var r=Fo();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Fo();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=xQ.bind(null,Dr,t),[n.memoizedState,t]},useRef:function(t){var e=Fo();return t={current:t},e.memoizedState=t},useState:hL,useDebugValue:c2,useDeferredValue:function(t){return Fo().memoizedState=t},useTransition:function(){var t=hL(!1),e=t[0];return t=wQ.bind(null,t[1]),Fo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Dr,i=Fo();if(Ar){if(r===void 0)throw Error(Le(407));r=r()}else{if(r=e(),Rn===null)throw Error(Le(349));Nu&30||Z8(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,dL(eV.bind(null,n,s,t),[t]),n.flags|=2048,pp(9,Q8.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Fo(),e=Rn.identifierPrefix;if(Ar){var r=Na,n=Ia;r=(n&~(1<<32-fo(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=gp++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=yQ++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CQ={readContext:Ns,useCallback:lV,useContext:Ns,useEffect:l2,useImperativeHandle:aV,useInsertionEffect:iV,useLayoutEffect:sV,useMemo:cV,useReducer:ZC,useRef:nV,useState:function(){return ZC(mp)},useDebugValue:c2,useDeferredValue:function(t){var e=Ms();return uV(e,dn.memoizedState,t)},useTransition:function(){var t=ZC(mp)[0],e=Ms().memoizedState;return[t,e]},useMutableSource:q8,useSyncExternalStore:J8,useId:hV,unstable_isNewReconciler:!1},EQ={readContext:Ns,useCallback:lV,useContext:Ns,useEffect:l2,useImperativeHandle:aV,useInsertionEffect:iV,useLayoutEffect:sV,useMemo:cV,useReducer:QC,useRef:nV,useState:function(){return QC(mp)},useDebugValue:c2,useDeferredValue:function(t){var e=Ms();return dn===null?e.memoizedState=t:uV(e,dn.memoizedState,t)},useTransition:function(){var t=QC(mp)[0],e=Ms().memoizedState;return[t,e]},useMutableSource:q8,useSyncExternalStore:J8,useId:hV,unstable_isNewReconciler:!1};function to(t,e){if(t&&t.defaultProps){e=Fr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function yR(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Fr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var ub={isMounted:function(t){return(t=t._reactInternals)?qu(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=wi(),i=rc(t),s=ja(n,i);s.payload=e,r!=null&&(s.callback=r),e=ec(t,s,i),e!==null&&(go(e,t,i,n),uw(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=wi(),i=rc(t),s=ja(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=ec(t,s,i),e!==null&&(go(e,t,i,n),uw(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=wi(),n=rc(t),i=ja(r,n);i.tag=2,e!=null&&(i.callback=e),e=ec(t,i,n),e!==null&&(go(e,t,n,r),uw(e,t,n))}};function fL(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!lp(r,n)||!lp(i,s):!0}function mV(t,e,r){var n=!1,i=gc,s=e.contextType;return typeof s=="object"&&s!==null?s=Ns(s):(i=$i(e)?ku:ri.current,n=e.contextTypes,s=(n=n!=null)?Fd(t,i):gc),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ub,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function gL(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&ub.enqueueReplaceState(e,e.state,null)}function wR(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},t2(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ns(s):(s=$i(e)?ku:ri.current,i.context=Fd(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(yR(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ub.enqueueReplaceState(i,i.state,null),qw(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Bd(t,e){try{var r="",n=e;do r+=ZJ(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function eE(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function xR(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var TQ=typeof WeakMap=="function"?WeakMap:Map;function pV(t,e,r){r=ja(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){tx||(tx=!0,kR=n),xR(t,e)},r}function vV(t,e,r){r=ja(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){xR(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){xR(t,e),typeof n!="function"&&(tc===null?tc=new Set([this]):tc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function mL(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new TQ;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=HQ.bind(null,t,e,r),e.then(t,t))}function pL(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vL(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ja(-1,1),e.tag=2,ec(r,e,1))),r.lanes|=1),t)}var _Q=ol.ReactCurrentOwner,Pi=!1;function di(t,e,r,n){e.child=t===null?G8(e,null,r,n):Hd(e,t.child,r,n)}function yL(t,e,r,n,i){r=r.render;var s=e.ref;return bd(e,i),n=o2(t,e,r,n,s,i),r=a2(),t!==null&&!Pi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ja(t,e,i)):(Ar&&r&&Kk(e),e.flags|=1,di(t,e,n,i),e.child)}function wL(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!v2(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,yV(t,e,s,n,i)):(t=pw(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:lp,r(o,n)&&t.ref===e.ref)return Ja(t,e,i)}return e.flags|=1,t=nc(s,n),t.ref=e.ref,t.return=e,e.child=t}function yV(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(lp(s,n)&&t.ref===e.ref)if(Pi=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Pi=!0);else return e.lanes=t.lanes,Ja(t,e,i)}return bR(t,e,r,n,i)}function wV(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(od,Ki),Ki|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,cr(od,Ki),Ki|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,cr(od,Ki),Ki|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,cr(od,Ki),Ki|=n;return di(t,e,i,r),e.child}function xV(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function bR(t,e,r,n,i){var s=$i(r)?ku:ri.current;return s=Fd(e,s),bd(e,i),r=o2(t,e,r,n,s,i),n=a2(),t!==null&&!Pi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ja(t,e,i)):(Ar&&n&&Kk(e),e.flags|=1,di(t,e,r,i),e.child)}function xL(t,e,r,n,i){if($i(r)){var s=!0;zw(e)}else s=!1;if(bd(e,i),e.stateNode===null)fw(t,e),mV(e,r,n),wR(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ns(c):(c=$i(r)?ku:ri.current,c=Fd(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&gL(e,o,n,c),Ml=!1;var d=e.memoizedState;o.state=d,qw(e,n,o,i),l=e.memoizedState,a!==n||d!==l||Fi.current||Ml?(typeof u=="function"&&(yR(e,r,u,n),l=e.memoizedState),(a=Ml||fL(e,r,a,n,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,K8(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:to(e.type,a),o.props=c,h=e.pendingProps,d=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ns(l):(l=$i(r)?ku:ri.current,l=Fd(e,l));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&gL(e,o,n,l),Ml=!1,d=e.memoizedState,o.state=d,qw(e,n,o,i);var m=e.memoizedState;a!==h||d!==m||Fi.current||Ml?(typeof f=="function"&&(yR(e,r,f,n),m=e.memoizedState),(c=Ml||fL(e,r,c,n,d,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return SR(t,e,r,n,s,i)}function SR(t,e,r,n,i,s){xV(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&sL(e,r,!1),Ja(t,e,s);n=e.stateNode,_Q.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Hd(e,t.child,null,s),e.child=Hd(e,null,a,s)):di(t,e,a,s),e.memoizedState=n.state,i&&sL(e,r,!0),e.child}function bV(t){var e=t.stateNode;e.pendingContext?iL(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iL(t,e.context,!1),r2(t,e.containerInfo)}function bL(t,e,r,n,i){return $d(),qk(i),e.flags|=256,di(t,e,r,n),e.child}var CR={dehydrated:null,treeContext:null,retryLane:0};function ER(t){return{baseLanes:t,cachePool:null,transitions:null}}function SV(t,e,r){var n=e.pendingProps,i=Nr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),cr(Nr,i&1),t===null)return pR(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=fb(o,n,0,null),t=xu(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ER(r),e.memoizedState=CR,t):u2(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return RQ(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=nc(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=nc(a,s):(s=xu(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?ER(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=CR,n}return s=t.child,t=s.sibling,n=nc(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function u2(t,e){return e=fb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Dv(t,e,r,n){return n!==null&&qk(n),Hd(e,t.child,null,r),t=u2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function RQ(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=eE(Error(Le(422))),Dv(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=fb({mode:"visible",children:n.children},i,0,null),s=xu(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Hd(e,t.child,null,o),e.child.memoizedState=ER(o),e.memoizedState=CR,s);if(!(e.mode&1))return Dv(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Le(419)),n=eE(s,n,void 0),Dv(t,e,o,n)}if(a=(o&t.childLanes)!==0,Pi||a){if(n=Rn,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,qa(t,i),go(n,t,i,-1))}return p2(),n=eE(Error(Le(421))),Dv(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jQ.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ts=Ql(i.nextSibling),ns=e,Ar=!0,so=null,t!==null&&(Ts[_s++]=Ia,Ts[_s++]=Na,Ts[_s++]=Iu,Ia=t.id,Na=t.overflow,Iu=e),e=u2(e,n.children),e.flags|=4096,e)}function SL(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),vR(t.return,e,r)}function tE(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function CV(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(di(t,e,n.children,r),n=Nr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&SL(t,r,e);else if(t.tag===19)SL(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(cr(Nr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Jw(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),tE(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Jw(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}tE(e,!0,r,null,s);break;case"together":tE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fw(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ja(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Mu|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Le(153));if(e.child!==null){for(t=e.child,r=nc(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=nc(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function AQ(t,e,r){switch(e.tag){case 3:bV(e),$d();break;case 5:X8(e);break;case 1:$i(e.type)&&zw(e);break;case 4:r2(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;cr(Kw,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(cr(Nr,Nr.current&1),e.flags|=128,null):r&e.child.childLanes?SV(t,e,r):(cr(Nr,Nr.current&1),t=Ja(t,e,r),t!==null?t.sibling:null);cr(Nr,Nr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return CV(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),cr(Nr,Nr.current),n)break;return null;case 22:case 23:return e.lanes=0,wV(t,e,r)}return Ja(t,e,r)}var EV,TR,TV,_V;EV=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};TR=function(){};TV=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,cu(Ko.current);var s=null;switch(r){case"input":i=Y_(t,i),n=Y_(t,n),s=[];break;case"select":i=Fr({},i,{value:void 0}),n=Fr({},n,{value:void 0}),s=[];break;case"textarea":i=q_(t,i),n=q_(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Uw)}Z_(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(tp.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(tp.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&vr("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};_V=function(t,e,r,n){r!==n&&(e.flags|=4)};function vg(t,e){if(!Ar)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Wn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function OQ(t,e,r){var n=e.pendingProps;switch(Xk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(e),null;case 1:return $i(e.type)&&Ww(),Wn(e),null;case 3:return n=e.stateNode,jd(),xr(Fi),xr(ri),i2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Mv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,so!==null&&(MR(so),so=null))),TR(t,e),Wn(e),null;case 5:n2(e);var i=cu(fp.current);if(r=e.type,t!==null&&e.stateNode!=null)TV(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Le(166));return Wn(e),null}if(t=cu(Ko.current),Mv(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Bo]=e,n[hp]=s,t=(e.mode&1)!==0,r){case"dialog":vr("cancel",n),vr("close",n);break;case"iframe":case"object":case"embed":vr("load",n);break;case"video":case"audio":for(i=0;i<rm.length;i++)vr(rm[i],n);break;case"source":vr("error",n);break;case"img":case"image":case"link":vr("error",n),vr("load",n);break;case"details":vr("toggle",n);break;case"input":ID(n,s),vr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},vr("invalid",n);break;case"textarea":MD(n,s),vr("invalid",n)}Z_(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Nv(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Nv(n.textContent,a,t),i=["children",""+a]):tp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&vr("scroll",n)}switch(r){case"input":Ev(n),ND(n,s,!0);break;case"textarea":Ev(n),PD(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Uw)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=e8(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Bo]=e,t[hp]=n,EV(t,e,!1,!1),e.stateNode=t;e:{switch(o=Q_(r,n),r){case"dialog":vr("cancel",t),vr("close",t),i=n;break;case"iframe":case"object":case"embed":vr("load",t),i=n;break;case"video":case"audio":for(i=0;i<rm.length;i++)vr(rm[i],t);i=n;break;case"source":vr("error",t),i=n;break;case"img":case"image":case"link":vr("error",t),vr("load",t),i=n;break;case"details":vr("toggle",t),i=n;break;case"input":ID(t,n),i=Y_(t,n),vr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Fr({},n,{value:void 0}),vr("invalid",t);break;case"textarea":MD(t,n),i=q_(t,n),vr("invalid",t);break;default:i=n}Z_(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?n8(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&t8(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&rp(t,l):typeof l=="number"&&rp(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(tp.hasOwnProperty(s)?l!=null&&s==="onScroll"&&vr("scroll",t):l!=null&&Pk(t,s,l,o))}switch(r){case"input":Ev(t),ND(t,n,!1);break;case"textarea":Ev(t),PD(t);break;case"option":n.value!=null&&t.setAttribute("value",""+fc(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?vd(t,!!n.multiple,s,!1):n.defaultValue!=null&&vd(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Uw)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wn(e),null;case 6:if(t&&e.stateNode!=null)_V(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Le(166));if(r=cu(fp.current),cu(Ko.current),Mv(e)){if(n=e.stateNode,r=e.memoizedProps,n[Bo]=e,(s=n.nodeValue!==r)&&(t=ns,t!==null))switch(t.tag){case 3:Nv(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Nv(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Bo]=e,e.stateNode=n}return Wn(e),null;case 13:if(xr(Nr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ar&&ts!==null&&e.mode&1&&!(e.flags&128))W8(),$d(),e.flags|=98560,s=!1;else if(s=Mv(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Le(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Le(317));s[Bo]=e}else $d(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wn(e),s=!1}else so!==null&&(MR(so),so=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Nr.current&1?gn===0&&(gn=3):p2())),e.updateQueue!==null&&(e.flags|=4),Wn(e),null);case 4:return jd(),TR(t,e),t===null&&cp(e.stateNode.containerInfo),Wn(e),null;case 10:return Qk(e.type._context),Wn(e),null;case 17:return $i(e.type)&&Ww(),Wn(e),null;case 19:if(xr(Nr),s=e.memoizedState,s===null)return Wn(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)vg(s,!1);else{if(gn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Jw(t),o!==null){for(e.flags|=128,vg(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return cr(Nr,Nr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Jr()>Vd&&(e.flags|=128,n=!0,vg(s,!1),e.lanes=4194304)}else{if(!n)if(t=Jw(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),vg(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ar)return Wn(e),null}else 2*Jr()-s.renderingStartTime>Vd&&r!==1073741824&&(e.flags|=128,n=!0,vg(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Jr(),e.sibling=null,r=Nr.current,cr(Nr,n?r&1|2:r&1),e):(Wn(e),null);case 22:case 23:return m2(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ki&1073741824&&(Wn(e),e.subtreeFlags&6&&(e.flags|=8192)):Wn(e),null;case 24:return null;case 25:return null}throw Error(Le(156,e.tag))}function kQ(t,e){switch(Xk(e),e.tag){case 1:return $i(e.type)&&Ww(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return jd(),xr(Fi),xr(ri),i2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return n2(e),null;case 13:if(xr(Nr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Le(340));$d()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xr(Nr),null;case 4:return jd(),null;case 10:return Qk(e.type._context),null;case 22:case 23:return m2(),null;case 24:return null;default:return null}}var Lv=!1,Xn=!1,IQ=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function sd(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vr(t,e,n)}else r.current=null}function _R(t,e,r){try{r()}catch(n){Vr(t,e,n)}}var CL=!1;function NQ(t,e){if(cR=jw,t=I8(),Yk(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===r&&++c===i&&(a=o),d===s&&++u===n&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(uR={focusedElem:t,selectionRange:r},jw=!1,Xe=e;Xe!==null;)if(e=Xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Xe=t;else for(;Xe!==null;){e=Xe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,v=m.memoizedState,w=e.stateNode,b=w.getSnapshotBeforeUpdate(e.elementType===e.type?g:to(e.type,g),v);w.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(C){Vr(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,Xe=t;break}Xe=e.return}return m=CL,CL=!1,m}function Sm(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&_R(e,r,s)}i=i.next}while(i!==n)}}function hb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function RR(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function RV(t){var e=t.alternate;e!==null&&(t.alternate=null,RV(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Bo],delete e[hp],delete e[fR],delete e[gQ],delete e[mQ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function AV(t){return t.tag===5||t.tag===3||t.tag===4}function EL(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||AV(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function AR(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Uw));else if(n!==4&&(t=t.child,t!==null))for(AR(t,e,r),t=t.sibling;t!==null;)AR(t,e,r),t=t.sibling}function OR(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(OR(t,e,r),t=t.sibling;t!==null;)OR(t,e,r),t=t.sibling}var Dn=null,ro=!1;function yl(t,e,r){for(r=r.child;r!==null;)OV(t,e,r),r=r.sibling}function OV(t,e,r){if(Yo&&typeof Yo.onCommitFiberUnmount=="function")try{Yo.onCommitFiberUnmount(nb,r)}catch{}switch(r.tag){case 5:Xn||sd(r,e);case 6:var n=Dn,i=ro;Dn=null,yl(t,e,r),Dn=n,ro=i,Dn!==null&&(ro?(t=Dn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Dn.removeChild(r.stateNode));break;case 18:Dn!==null&&(ro?(t=Dn,r=r.stateNode,t.nodeType===8?KC(t.parentNode,r):t.nodeType===1&&KC(t,r),op(t)):KC(Dn,r.stateNode));break;case 4:n=Dn,i=ro,Dn=r.stateNode.containerInfo,ro=!0,yl(t,e,r),Dn=n,ro=i;break;case 0:case 11:case 14:case 15:if(!Xn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&_R(r,e,o),i=i.next}while(i!==n)}yl(t,e,r);break;case 1:if(!Xn&&(sd(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Vr(r,e,a)}yl(t,e,r);break;case 21:yl(t,e,r);break;case 22:r.mode&1?(Xn=(n=Xn)||r.memoizedState!==null,yl(t,e,r),Xn=n):yl(t,e,r);break;default:yl(t,e,r)}}function TL(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new IQ),e.forEach(function(n){var i=BQ.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Gs(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Dn=a.stateNode,ro=!1;break e;case 3:Dn=a.stateNode.containerInfo,ro=!0;break e;case 4:Dn=a.stateNode.containerInfo,ro=!0;break e}a=a.return}if(Dn===null)throw Error(Le(160));OV(s,o,i),Dn=null,ro=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Vr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)kV(e,t),e=e.sibling}function kV(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gs(e,t),Eo(t),n&4){try{Sm(3,t,t.return),hb(3,t)}catch(g){Vr(t,t.return,g)}try{Sm(5,t,t.return)}catch(g){Vr(t,t.return,g)}}break;case 1:Gs(e,t),Eo(t),n&512&&r!==null&&sd(r,r.return);break;case 5:if(Gs(e,t),Eo(t),n&512&&r!==null&&sd(r,r.return),t.flags&32){var i=t.stateNode;try{rp(i,"")}catch(g){Vr(t,t.return,g)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Z5(i,s),Q_(a,o);var c=Q_(a,s);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?n8(i,h):u==="dangerouslySetInnerHTML"?t8(i,h):u==="children"?rp(i,h):Pk(i,u,h,c)}switch(a){case"input":K_(i,s);break;case"textarea":Q5(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?vd(i,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?vd(i,!!s.multiple,s.defaultValue,!0):vd(i,!!s.multiple,s.multiple?[]:"",!1))}i[hp]=s}catch(g){Vr(t,t.return,g)}}break;case 6:if(Gs(e,t),Eo(t),n&4){if(t.stateNode===null)throw Error(Le(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Vr(t,t.return,g)}}break;case 3:if(Gs(e,t),Eo(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{op(e.containerInfo)}catch(g){Vr(t,t.return,g)}break;case 4:Gs(e,t),Eo(t);break;case 13:Gs(e,t),Eo(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(f2=Jr())),n&4&&TL(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Xn=(c=Xn)||u,Gs(e,t),Xn=c):Gs(e,t),Eo(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Xe=t,u=t.child;u!==null;){for(h=Xe=u;Xe!==null;){switch(d=Xe,f=d.child,d.tag){case 0:case 11:case 14:case 15:Sm(4,d,d.return);break;case 1:sd(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Vr(n,r,g)}}break;case 5:sd(d,d.return);break;case 22:if(d.memoizedState!==null){RL(h);continue}}f!==null?(f.return=d,Xe=f):RL(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=r8("display",o))}catch(g){Vr(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Vr(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Gs(e,t),Eo(t),n&4&&TL(t);break;case 21:break;default:Gs(e,t),Eo(t)}}function Eo(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(AV(r)){var n=r;break e}r=r.return}throw Error(Le(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(rp(i,""),n.flags&=-33);var s=EL(t);OR(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=EL(t);AR(t,a,o);break;default:throw Error(Le(161))}}catch(l){Vr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function MQ(t,e,r){Xe=t,IV(t)}function IV(t,e,r){for(var n=(t.mode&1)!==0;Xe!==null;){var i=Xe,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Lv;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Xn;a=Lv;var c=Xn;if(Lv=o,(Xn=l)&&!c)for(Xe=i;Xe!==null;)o=Xe,l=o.child,o.tag===22&&o.memoizedState!==null?AL(i):l!==null?(l.return=o,Xe=l):AL(i);for(;s!==null;)Xe=s,IV(s),s=s.sibling;Xe=i,Lv=a,Xn=c}_L(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Xe=s):_L(t)}}function _L(t){for(;Xe!==null;){var e=Xe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xn||hb(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Xn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:to(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&uL(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}uL(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&op(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}Xn||e.flags&512&&RR(e)}catch(d){Vr(e,e.return,d)}}if(e===t){Xe=null;break}if(r=e.sibling,r!==null){r.return=e.return,Xe=r;break}Xe=e.return}}function RL(t){for(;Xe!==null;){var e=Xe;if(e===t){Xe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Xe=r;break}Xe=e.return}}function AL(t){for(;Xe!==null;){var e=Xe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{hb(4,e)}catch(l){Vr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Vr(e,i,l)}}var s=e.return;try{RR(e)}catch(l){Vr(e,s,l)}break;case 5:var o=e.return;try{RR(e)}catch(l){Vr(e,o,l)}}}catch(l){Vr(e,e.return,l)}if(e===t){Xe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Xe=a;break}Xe=e.return}}var PQ=Math.ceil,ex=ol.ReactCurrentDispatcher,h2=ol.ReactCurrentOwner,Is=ol.ReactCurrentBatchConfig,Dt=0,Rn=null,on=null,Fn=0,Ki=0,od=wc(0),gn=0,vp=null,Mu=0,db=0,d2=0,Cm=null,Ni=null,f2=0,Vd=1/0,Ta=null,tx=!1,kR=null,tc=null,Fv=!1,Vl=null,rx=0,Em=0,IR=null,gw=-1,mw=0;function wi(){return Dt&6?Jr():gw!==-1?gw:gw=Jr()}function rc(t){return t.mode&1?Dt&2&&Fn!==0?Fn&-Fn:vQ.transition!==null?(mw===0&&(mw=m8()),mw):(t=Gt,t!==0||(t=window.event,t=t===void 0?16:S8(t.type)),t):1}function go(t,e,r,n){if(50<Em)throw Em=0,IR=null,Error(Le(185));O0(t,r,n),(!(Dt&2)||t!==Rn)&&(t===Rn&&(!(Dt&2)&&(db|=r),gn===4&&Ll(t,Fn)),Hi(t,n),r===1&&Dt===0&&!(e.mode&1)&&(Vd=Jr()+500,lb&&xc()))}function Hi(t,e){var r=t.callbackNode;vZ(t,e);var n=Hw(t,t===Rn?Fn:0);if(n===0)r!==null&&FD(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&FD(r),e===1)t.tag===0?pQ(OL.bind(null,t)):B8(OL.bind(null,t)),dQ(function(){!(Dt&6)&&xc()}),r=null;else{switch(p8(n)){case 1:r=Hk;break;case 4:r=f8;break;case 16:r=$w;break;case 536870912:r=g8;break;default:r=$w}r=HV(r,NV.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function NV(t,e){if(gw=-1,mw=0,Dt&6)throw Error(Le(327));var r=t.callbackNode;if(Sd()&&t.callbackNode!==r)return null;var n=Hw(t,t===Rn?Fn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=nx(t,n);else{e=n;var i=Dt;Dt|=2;var s=PV();(Rn!==t||Fn!==e)&&(Ta=null,Vd=Jr()+500,wu(t,e));do try{FQ();break}catch(a){MV(t,a)}while(!0);Zk(),ex.current=s,Dt=i,on!==null?e=0:(Rn=null,Fn=0,e=gn)}if(e!==0){if(e===2&&(i=iR(t),i!==0&&(n=i,e=NR(t,i))),e===1)throw r=vp,wu(t,0),Ll(t,n),Hi(t,Jr()),r;if(e===6)Ll(t,n);else{if(i=t.current.alternate,!(n&30)&&!DQ(i)&&(e=nx(t,n),e===2&&(s=iR(t),s!==0&&(n=s,e=NR(t,s))),e===1))throw r=vp,wu(t,0),Ll(t,n),Hi(t,Jr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Le(345));case 2:Qc(t,Ni,Ta);break;case 3:if(Ll(t,n),(n&130023424)===n&&(e=f2+500-Jr(),10<e)){if(Hw(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){wi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=dR(Qc.bind(null,t,Ni,Ta),e);break}Qc(t,Ni,Ta);break;case 4:if(Ll(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-fo(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=Jr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*PQ(n/1960))-n,10<n){t.timeoutHandle=dR(Qc.bind(null,t,Ni,Ta),n);break}Qc(t,Ni,Ta);break;case 5:Qc(t,Ni,Ta);break;default:throw Error(Le(329))}}}return Hi(t,Jr()),t.callbackNode===r?NV.bind(null,t):null}function NR(t,e){var r=Cm;return t.current.memoizedState.isDehydrated&&(wu(t,e).flags|=256),t=nx(t,e),t!==2&&(e=Ni,Ni=r,e!==null&&MR(e)),t}function MR(t){Ni===null?Ni=t:Ni.push.apply(Ni,t)}function DQ(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!yo(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ll(t,e){for(e&=~d2,e&=~db,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-fo(e),n=1<<r;t[r]=-1,e&=~n}}function OL(t){if(Dt&6)throw Error(Le(327));Sd();var e=Hw(t,0);if(!(e&1))return Hi(t,Jr()),null;var r=nx(t,e);if(t.tag!==0&&r===2){var n=iR(t);n!==0&&(e=n,r=NR(t,n))}if(r===1)throw r=vp,wu(t,0),Ll(t,e),Hi(t,Jr()),r;if(r===6)throw Error(Le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qc(t,Ni,Ta),Hi(t,Jr()),null}function g2(t,e){var r=Dt;Dt|=1;try{return t(e)}finally{Dt=r,Dt===0&&(Vd=Jr()+500,lb&&xc())}}function Pu(t){Vl!==null&&Vl.tag===0&&!(Dt&6)&&Sd();var e=Dt;Dt|=1;var r=Is.transition,n=Gt;try{if(Is.transition=null,Gt=1,t)return t()}finally{Gt=n,Is.transition=r,Dt=e,!(Dt&6)&&xc()}}function m2(){Ki=od.current,xr(od)}function wu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,hQ(r)),on!==null)for(r=on.return;r!==null;){var n=r;switch(Xk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ww();break;case 3:jd(),xr(Fi),xr(ri),i2();break;case 5:n2(n);break;case 4:jd();break;case 13:xr(Nr);break;case 19:xr(Nr);break;case 10:Qk(n.type._context);break;case 22:case 23:m2()}r=r.return}if(Rn=t,on=t=nc(t.current,null),Fn=Ki=e,gn=0,vp=null,d2=db=Mu=0,Ni=Cm=null,lu!==null){for(e=0;e<lu.length;e++)if(r=lu[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}lu=null}return t}function MV(t,e){do{var r=on;try{if(Zk(),hw.current=Qw,Zw){for(var n=Dr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Zw=!1}if(Nu=0,Tn=dn=Dr=null,bm=!1,gp=0,h2.current=null,r===null||r.return===null){gn=1,vp=e,on=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=Fn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=pL(o);if(f!==null){f.flags&=-257,vL(f,o,a,s,e),f.mode&1&&mL(s,c,e),e=f,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){mL(s,c,e),p2();break e}l=Error(Le(426))}}else if(Ar&&a.mode&1){var v=pL(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),vL(v,o,a,s,e),qk(Bd(l,a));break e}}s=l=Bd(l,a),gn!==4&&(gn=2),Cm===null?Cm=[s]:Cm.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=pV(s,l,e);cL(s,w);break e;case 1:a=l;var b=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(tc===null||!tc.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var C=vV(s,a,e);cL(s,C);break e}}s=s.return}while(s!==null)}LV(r)}catch(S){e=S,on===r&&r!==null&&(on=r=r.return);continue}break}while(!0)}function PV(){var t=ex.current;return ex.current=Qw,t===null?Qw:t}function p2(){(gn===0||gn===3||gn===2)&&(gn=4),Rn===null||!(Mu&268435455)&&!(db&268435455)||Ll(Rn,Fn)}function nx(t,e){var r=Dt;Dt|=2;var n=PV();(Rn!==t||Fn!==e)&&(Ta=null,wu(t,e));do try{LQ();break}catch(i){MV(t,i)}while(!0);if(Zk(),Dt=r,ex.current=n,on!==null)throw Error(Le(261));return Rn=null,Fn=0,gn}function LQ(){for(;on!==null;)DV(on)}function FQ(){for(;on!==null&&!lZ();)DV(on)}function DV(t){var e=$V(t.alternate,t,Ki);t.memoizedProps=t.pendingProps,e===null?LV(t):on=e,h2.current=null}function LV(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=kQ(r,e),r!==null){r.flags&=32767,on=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{gn=6,on=null;return}}else if(r=OQ(r,e,Ki),r!==null){on=r;return}if(e=e.sibling,e!==null){on=e;return}on=e=t}while(e!==null);gn===0&&(gn=5)}function Qc(t,e,r){var n=Gt,i=Is.transition;try{Is.transition=null,Gt=1,$Q(t,e,r,n)}finally{Is.transition=i,Gt=n}return null}function $Q(t,e,r,n){do Sd();while(Vl!==null);if(Dt&6)throw Error(Le(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Le(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(yZ(t,s),t===Rn&&(on=Rn=null,Fn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fv||(Fv=!0,HV($w,function(){return Sd(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Is.transition,Is.transition=null;var o=Gt;Gt=1;var a=Dt;Dt|=4,h2.current=null,NQ(t,r),kV(r,t),iQ(uR),jw=!!cR,uR=cR=null,t.current=r,MQ(r),cZ(),Dt=a,Gt=o,Is.transition=s}else t.current=r;if(Fv&&(Fv=!1,Vl=t,rx=i),s=t.pendingLanes,s===0&&(tc=null),dZ(r.stateNode),Hi(t,Jr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(tx)throw tx=!1,t=kR,kR=null,t;return rx&1&&t.tag!==0&&Sd(),s=t.pendingLanes,s&1?t===IR?Em++:(Em=0,IR=t):Em=0,xc(),null}function Sd(){if(Vl!==null){var t=p8(rx),e=Is.transition,r=Gt;try{if(Is.transition=null,Gt=16>t?16:t,Vl===null)var n=!1;else{if(t=Vl,Vl=null,rx=0,Dt&6)throw Error(Le(331));var i=Dt;for(Dt|=4,Xe=t.current;Xe!==null;){var s=Xe,o=s.child;if(Xe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Xe=c;Xe!==null;){var u=Xe;switch(u.tag){case 0:case 11:case 15:Sm(8,u,s)}var h=u.child;if(h!==null)h.return=u,Xe=h;else for(;Xe!==null;){u=Xe;var d=u.sibling,f=u.return;if(RV(u),u===c){Xe=null;break}if(d!==null){d.return=f,Xe=d;break}Xe=f}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}Xe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Xe=o;else e:for(;Xe!==null;){if(s=Xe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sm(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Xe=w;break e}Xe=s.return}}var b=t.current;for(Xe=b;Xe!==null;){o=Xe;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Xe=x;else e:for(o=b;Xe!==null;){if(a=Xe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:hb(9,a)}}catch(S){Vr(a,a.return,S)}if(a===o){Xe=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,Xe=C;break e}Xe=a.return}}if(Dt=i,xc(),Yo&&typeof Yo.onPostCommitFiberRoot=="function")try{Yo.onPostCommitFiberRoot(nb,t)}catch{}n=!0}return n}finally{Gt=r,Is.transition=e}}return!1}function kL(t,e,r){e=Bd(r,e),e=pV(t,e,1),t=ec(t,e,1),e=wi(),t!==null&&(O0(t,1,e),Hi(t,e))}function Vr(t,e,r){if(t.tag===3)kL(t,t,r);else for(;e!==null;){if(e.tag===3){kL(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(tc===null||!tc.has(n))){t=Bd(r,t),t=vV(e,t,1),e=ec(e,t,1),t=wi(),e!==null&&(O0(e,1,t),Hi(e,t));break}}e=e.return}}function HQ(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=wi(),t.pingedLanes|=t.suspendedLanes&r,Rn===t&&(Fn&r)===r&&(gn===4||gn===3&&(Fn&130023424)===Fn&&500>Jr()-f2?wu(t,0):d2|=r),Hi(t,e)}function FV(t,e){e===0&&(t.mode&1?(e=Rv,Rv<<=1,!(Rv&130023424)&&(Rv=4194304)):e=1);var r=wi();t=qa(t,e),t!==null&&(O0(t,e,r),Hi(t,r))}function jQ(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),FV(t,r)}function BQ(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Le(314))}n!==null&&n.delete(e),FV(t,r)}var $V;$V=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fi.current)Pi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Pi=!1,AQ(t,e,r);Pi=!!(t.flags&131072)}else Pi=!1,Ar&&e.flags&1048576&&V8(e,Yw,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;fw(t,e),t=e.pendingProps;var i=Fd(e,ri.current);bd(e,r),i=o2(null,e,n,t,i,r);var s=a2();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$i(n)?(s=!0,zw(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,t2(e),i.updater=ub,e.stateNode=i,i._reactInternals=e,wR(e,n,t,r),e=SR(null,e,n,!0,s,r)):(e.tag=0,Ar&&s&&Kk(e),di(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(fw(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=UQ(n),t=to(n,t),i){case 0:e=bR(null,e,n,t,r);break e;case 1:e=xL(null,e,n,t,r);break e;case 11:e=yL(null,e,n,t,r);break e;case 14:e=wL(null,e,n,to(n.type,t),r);break e}throw Error(Le(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:to(n,i),bR(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:to(n,i),xL(t,e,n,i,r);case 3:e:{if(bV(e),t===null)throw Error(Le(387));n=e.pendingProps,s=e.memoizedState,i=s.element,K8(t,e),qw(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Bd(Error(Le(423)),e),e=bL(t,e,n,r,i);break e}else if(n!==i){i=Bd(Error(Le(424)),e),e=bL(t,e,n,r,i);break e}else for(ts=Ql(e.stateNode.containerInfo.firstChild),ns=e,Ar=!0,so=null,r=G8(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if($d(),n===i){e=Ja(t,e,r);break e}di(t,e,n,r)}e=e.child}return e;case 5:return X8(e),t===null&&pR(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,hR(n,i)?o=null:s!==null&&hR(n,s)&&(e.flags|=32),xV(t,e),di(t,e,o,r),e.child;case 6:return t===null&&pR(e),null;case 13:return SV(t,e,r);case 4:return r2(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Hd(e,null,n,r):di(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:to(n,i),yL(t,e,n,i,r);case 7:return di(t,e,e.pendingProps,r),e.child;case 8:return di(t,e,e.pendingProps.children,r),e.child;case 12:return di(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,cr(Kw,n._currentValue),n._currentValue=o,s!==null)if(yo(s.value,o)){if(s.children===i.children&&!Fi.current){e=Ja(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ja(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),vR(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Le(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),vR(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}di(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,bd(e,r),i=Ns(i),n=n(i),e.flags|=1,di(t,e,n,r),e.child;case 14:return n=e.type,i=to(n,e.pendingProps),i=to(n.type,i),wL(t,e,n,i,r);case 15:return yV(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:to(n,i),fw(t,e),e.tag=1,$i(n)?(t=!0,zw(e)):t=!1,bd(e,r),mV(e,n,i),wR(e,n,i,r),SR(null,e,n,!0,t,r);case 19:return CV(t,e,r);case 22:return wV(t,e,r)}throw Error(Le(156,e.tag))};function HV(t,e){return d8(t,e)}function VQ(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Os(t,e,r,n){return new VQ(t,e,r,n)}function v2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function UQ(t){if(typeof t=="function")return v2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Lk)return 11;if(t===Fk)return 14}return 2}function nc(t,e){var r=t.alternate;return r===null?(r=Os(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function pw(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")v2(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qh:return xu(r.children,i,s,e);case Dk:o=8,i|=8;break;case U_:return t=Os(12,r,e,i|2),t.elementType=U_,t.lanes=s,t;case W_:return t=Os(13,r,e,i),t.elementType=W_,t.lanes=s,t;case z_:return t=Os(19,r,e,i),t.elementType=z_,t.lanes=s,t;case X5:return fb(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Y5:o=10;break e;case K5:o=9;break e;case Lk:o=11;break e;case Fk:o=14;break e;case Nl:o=16,n=null;break e}throw Error(Le(130,t==null?t:typeof t,""))}return e=Os(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function xu(t,e,r,n){return t=Os(7,t,n,e),t.lanes=r,t}function fb(t,e,r,n){return t=Os(22,t,n,e),t.elementType=X5,t.lanes=r,t.stateNode={isHidden:!1},t}function rE(t,e,r){return t=Os(6,t,null,e),t.lanes=r,t}function nE(t,e,r){return e=Os(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WQ(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=FC(0),this.expirationTimes=FC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=FC(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function y2(t,e,r,n,i,s,o,a,l){return t=new WQ(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Os(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},t2(s),t}function zQ(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xh,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function jV(t){if(!t)return gc;t=t._reactInternals;e:{if(qu(t)!==t||t.tag!==1)throw Error(Le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($i(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Le(171))}if(t.tag===1){var r=t.type;if($i(r))return j8(t,r,e)}return e}function BV(t,e,r,n,i,s,o,a,l){return t=y2(r,n,!0,t,i,s,o,a,l),t.context=jV(null),r=t.current,n=wi(),i=rc(r),s=ja(n,i),s.callback=e??null,ec(r,s,i),t.current.lanes=i,O0(t,i,n),Hi(t,n),t}function gb(t,e,r,n){var i=e.current,s=wi(),o=rc(i);return r=jV(r),e.context===null?e.context=r:e.pendingContext=r,e=ja(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=ec(i,e,o),t!==null&&(go(t,i,o,s),uw(t,i,o)),o}function ix(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function IL(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function w2(t,e){IL(t,e),(t=t.alternate)&&IL(t,e)}function GQ(){return null}var VV=typeof reportError=="function"?reportError:function(t){console.error(t)};function x2(t){this._internalRoot=t}mb.prototype.render=x2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Le(409));gb(t,e,null,null)};mb.prototype.unmount=x2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Pu(function(){gb(null,t,null,null)}),e[Xa]=null}};function mb(t){this._internalRoot=t}mb.prototype.unstable_scheduleHydration=function(t){if(t){var e=w8();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Dl.length&&e!==0&&e<Dl[r].priority;r++);Dl.splice(r,0,t),r===0&&b8(t)}};function b2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function NL(){}function YQ(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=ix(o);s.call(c)}}var o=BV(e,n,t,0,null,!1,!1,"",NL);return t._reactRootContainer=o,t[Xa]=o.current,cp(t.nodeType===8?t.parentNode:t),Pu(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var c=ix(l);a.call(c)}}var l=y2(t,0,!1,null,null,!1,!1,"",NL);return t._reactRootContainer=l,t[Xa]=l.current,cp(t.nodeType===8?t.parentNode:t),Pu(function(){gb(e,l,r,n)}),l}function vb(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ix(o);a.call(l)}}gb(e,o,t,i)}else o=YQ(r,e,t,i,n);return ix(o)}v8=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=tm(e.pendingLanes);r!==0&&(jk(e,r|1),Hi(e,Jr()),!(Dt&6)&&(Vd=Jr()+500,xc()))}break;case 13:Pu(function(){var n=qa(t,1);if(n!==null){var i=wi();go(n,t,1,i)}}),w2(t,1)}};Bk=function(t){if(t.tag===13){var e=qa(t,134217728);if(e!==null){var r=wi();go(e,t,134217728,r)}w2(t,134217728)}};y8=function(t){if(t.tag===13){var e=rc(t),r=qa(t,e);if(r!==null){var n=wi();go(r,t,e,n)}w2(t,e)}};w8=function(){return Gt};x8=function(t,e){var r=Gt;try{return Gt=t,e()}finally{Gt=r}};tR=function(t,e,r){switch(e){case"input":if(K_(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=ab(n);if(!i)throw Error(Le(90));J5(n),K_(n,i)}}}break;case"textarea":Q5(t,r);break;case"select":e=r.value,e!=null&&vd(t,!!r.multiple,e,!1)}};o8=g2;a8=Pu;var KQ={usingClientEntryPoint:!1,Events:[I0,ed,ab,i8,s8,g2]},yg={findFiberByHostInstance:au,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},XQ={bundleType:yg.bundleType,version:yg.version,rendererPackageName:yg.rendererPackageName,rendererConfig:yg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ol.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=u8(t),t===null?null:t.stateNode},findFiberByHostInstance:yg.findFiberByHostInstance||GQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $v=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$v.isDisabled&&$v.supportsFiber)try{nb=$v.inject(XQ),Yo=$v}catch{}}ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KQ;ls.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b2(e))throw Error(Le(200));return zQ(t,e,null,r)};ls.createRoot=function(t,e){if(!b2(t))throw Error(Le(299));var r=!1,n="",i=VV;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=y2(t,1,!1,null,null,r,!1,n,i),t[Xa]=e.current,cp(t.nodeType===8?t.parentNode:t),new x2(e)};ls.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Le(188)):(t=Object.keys(t).join(","),Error(Le(268,t)));return t=u8(e),t=t===null?null:t.stateNode,t};ls.flushSync=function(t){return Pu(t)};ls.hydrate=function(t,e,r){if(!pb(e))throw Error(Le(200));return vb(null,t,e,!0,r)};ls.hydrateRoot=function(t,e,r){if(!b2(t))throw Error(Le(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=VV;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=BV(e,null,t,1,r??null,i,!1,s,o),t[Xa]=e.current,cp(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new mb(e)};ls.render=function(t,e,r){if(!pb(e))throw Error(Le(200));return vb(null,t,e,!1,r)};ls.unmountComponentAtNode=function(t){if(!pb(t))throw Error(Le(40));return t._reactRootContainer?(Pu(function(){vb(null,null,t,!1,function(){t._reactRootContainer=null,t[Xa]=null})}),!0):!1};ls.unstable_batchedUpdates=g2;ls.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!pb(r))throw Error(Le(200));if(t==null||t._reactInternals===void 0)throw Error(Le(38));return vb(t,e,r,!1,n)};ls.version="18.3.1-next-f1338f8080-20240426";function UV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UV)}catch(t){console.error(t)}}UV(),U5.exports=ls;var WV=U5.exports;const zV=jt(WV);var GV,ML=WV;GV=ML.createRoot,ML.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yp(){return yp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yp.apply(this,arguments)}var Ul;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ul||(Ul={}));const PL="popstate";function qQ(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return PR("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:sx(i)}return ZQ(e,r,null,t)}function Gr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function YV(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JQ(){return Math.random().toString(36).substr(2,8)}function DL(t,e){return{usr:t.state,key:t.key,idx:e}}function PR(t,e,r,n){return r===void 0&&(r=null),yp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Mf(e):e,{state:r,key:e&&e.key||n||JQ()})}function sx(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Mf(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function ZQ(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=Ul.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(yp({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Ul.Pop;let v=u(),w=v==null?null:v-c;c=v,l&&l({action:a,location:g.location,delta:w})}function d(v,w){a=Ul.Push;let b=PR(g.location,v,w);c=u()+1;let x=DL(b,c),C=g.createHref(b);try{o.pushState(x,"",C)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(C)}s&&l&&l({action:a,location:g.location,delta:1})}function f(v,w){a=Ul.Replace;let b=PR(g.location,v,w);c=u();let x=DL(b,c),C=g.createHref(b);o.replaceState(x,"",C),s&&l&&l({action:a,location:g.location,delta:0})}function m(v){let w=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof v=="string"?v:sx(v);return b=b.replace(/ $/,"%20"),Gr(w,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,w)}let g={get action(){return a},get location(){return t(i,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(PL,h),l=v,()=>{i.removeEventListener(PL,h),l=null}},createHref(v){return e(i,v)},createURL:m,encodeLocation(v){let w=m(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:d,replace:f,go(v){return o.go(v)}};return g}var LL;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(LL||(LL={}));function QQ(t,e,r){return r===void 0&&(r="/"),eee(t,e,r)}function eee(t,e,r,n){let i=typeof e=="string"?Mf(e):e,s=Ud(i.pathname||"/",r);if(s==null)return null;let o=KV(t);tee(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=dee(s);a=uee(o[l],c)}return a}function KV(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Gr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ic([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Gr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),KV(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:lee(c,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of XV(s.path))i(s,o,l)}),e}function XV(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=XV(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function tee(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:cee(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const ree=/^:[\w-]+$/,nee=3,iee=2,see=1,oee=10,aee=-2,FL=t=>t==="*";function lee(t,e){let r=t.split("/"),n=r.length;return r.some(FL)&&(n+=aee),e&&(n+=iee),r.filter(i=>!FL(i)).reduce((i,s)=>i+(ree.test(s)?nee:s===""?see:oee),n)}function cee(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function uee(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",h=DR({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:ic([s,h.pathname]),pathnameBase:pee(ic([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=ic([s,h.pathnameBase]))}return o}function DR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=hee(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let g=a[h]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[h];return f&&!m?c[d]=void 0:c[d]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:t}}function hee(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),YV(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function dee(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return YV(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ud(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function fee(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Mf(t):t;return{pathname:r?r.startsWith("/")?r:gee(r,e):e,search:vee(n),hash:yee(i)}}function gee(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function iE(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function mee(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function qV(t,e){let r=mee(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function JV(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Mf(t):(i=yp({},t),Gr(!i.pathname||!i.pathname.includes("?"),iE("?","pathname","search",i)),Gr(!i.pathname||!i.pathname.includes("#"),iE("#","pathname","hash",i)),Gr(!i.search||!i.search.includes("#"),iE("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=fee(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ic=t=>t.join("/").replace(/\/\/+/g,"/"),pee=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),vee=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yee=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wee(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ZV=["post","put","patch","delete"];new Set(ZV);const xee=["get",...ZV];new Set(xee);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wp(){return wp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wp.apply(this,arguments)}const yb=G.createContext(null),QV=G.createContext(null),bc=G.createContext(null),wb=G.createContext(null),Sc=G.createContext({outlet:null,matches:[],isDataRoute:!1}),eU=G.createContext(null);function bee(t,e){let{relative:r}=e===void 0?{}:e;M0()||Gr(!1);let{basename:n,navigator:i}=G.useContext(bc),{hash:s,pathname:o,search:a}=xb(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:ic([n,o])),i.createHref({pathname:l,search:a,hash:s})}function M0(){return G.useContext(wb)!=null}function Pf(){return M0()||Gr(!1),G.useContext(wb).location}function tU(t){G.useContext(bc).static||G.useLayoutEffect(t)}function See(){let{isDataRoute:t}=G.useContext(Sc);return t?Fee():Cee()}function Cee(){M0()||Gr(!1);let t=G.useContext(yb),{basename:e,future:r,navigator:n}=G.useContext(bc),{matches:i}=G.useContext(Sc),{pathname:s}=Pf(),o=JSON.stringify(qV(i,r.v7_relativeSplatPath)),a=G.useRef(!1);return tU(()=>{a.current=!0}),G.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let h=JV(c,JSON.parse(o),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ic([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,o,s,t])}const Eee=G.createContext(null);function Tee(t){let e=G.useContext(Sc).outlet;return e&&G.createElement(Eee.Provider,{value:t},e)}function xb(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=G.useContext(bc),{matches:i}=G.useContext(Sc),{pathname:s}=Pf(),o=JSON.stringify(qV(i,n.v7_relativeSplatPath));return G.useMemo(()=>JV(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function _ee(t,e){return Ree(t,e)}function Ree(t,e,r,n){M0()||Gr(!1);let{navigator:i,static:s}=G.useContext(bc),{matches:o}=G.useContext(Sc),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=Pf(),h;if(e){var d;let w=typeof e=="string"?Mf(e):e;c==="/"||(d=w.pathname)!=null&&d.startsWith(c)||Gr(!1),h=w}else h=u;let f=h.pathname||"/",m=f;if(c!=="/"){let w=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(w.length).join("/")}let g=QQ(t,{pathname:m}),v=Nee(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:ic([c,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:ic([c,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return e&&v?G.createElement(wb.Provider,{value:{location:wp({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ul.Pop}},v):v}function Aee(){let t=Lee(),e=wee(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),r?G.createElement("pre",{style:i},r):null,null)}const Oee=G.createElement(Aee,null);class kee extends G.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?G.createElement(Sc.Provider,{value:this.props.routeContext},G.createElement(eU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Iee(t){let{routeContext:e,match:r,children:n}=t,i=G.useContext(yb);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),G.createElement(Sc.Provider,{value:e},n)}function Nee(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Gr(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:f}=r,m=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||m){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,d)=>{let f,m=!1,g=null,v=null;r&&(f=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||Oee,l&&(c<0&&d===0?($ee("route-fallback"),m=!0,v=null):c===d&&(m=!0,v=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,d+1)),b=()=>{let x;return f?x=g:m?x=v:h.route.Component?x=G.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,G.createElement(Iee,{match:h,routeContext:{outlet:u,matches:w,isDataRoute:r!=null},children:x})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?G.createElement(kee,{location:r.location,revalidation:r.revalidation,component:g,error:f,children:b(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):b()},null)}var rU=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(rU||{}),nU=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(nU||{});function Mee(t){let e=G.useContext(yb);return e||Gr(!1),e}function Pee(t){let e=G.useContext(QV);return e||Gr(!1),e}function Dee(t){let e=G.useContext(Sc);return e||Gr(!1),e}function iU(t){let e=Dee(),r=e.matches[e.matches.length-1];return r.route.id||Gr(!1),r.route.id}function Lee(){var t;let e=G.useContext(eU),r=Pee(),n=iU();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function Fee(){let{router:t}=Mee(rU.UseNavigateStable),e=iU(nU.UseNavigateStable),r=G.useRef(!1);return tU(()=>{r.current=!0}),G.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,wp({fromRouteId:e},s)))},[t,e])}const $L={};function $ee(t,e,r){$L[t]||($L[t]=!0)}function Hee(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function jee(t){return Tee(t.context)}function eu(t){Gr(!1)}function Bee(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ul.Pop,navigator:s,static:o=!1,future:a}=t;M0()&&Gr(!1);let l=e.replace(/^\/*/,"/"),c=G.useMemo(()=>({basename:l,navigator:s,static:o,future:wp({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=Mf(n));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:m="default"}=n,g=G.useMemo(()=>{let v=Ud(u,l);return v==null?null:{location:{pathname:v,search:h,hash:d,state:f,key:m},navigationType:i}},[l,u,h,d,f,m,i]);return g==null?null:G.createElement(bc.Provider,{value:c},G.createElement(wb.Provider,{children:r,value:g}))}function Vee(t){let{children:e,location:r}=t;return _ee(LR(e),r)}new Promise(()=>{});function LR(t,e){e===void 0&&(e=[]);let r=[];return G.Children.forEach(t,(n,i)=>{if(!G.isValidElement(n))return;let s=[...e,i];if(n.type===G.Fragment){r.push.apply(r,LR(n.props.children,s));return}n.type!==eu&&Gr(!1),!n.props.index||!n.props.children||Gr(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=LR(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ox(){return ox=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ox.apply(this,arguments)}function sU(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Uee(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Wee(t,e){return t.button===0&&(!e||e==="_self")&&!Uee(t)}const zee=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Gee=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Yee="6";try{window.__reactRouterVersion=Yee}catch{}const Kee=G.createContext({isTransitioning:!1}),Xee="startTransition",HL=HJ[Xee];function qee(t){let{basename:e,children:r,future:n,window:i}=t,s=G.useRef();s.current==null&&(s.current=qQ({window:i,v5Compat:!0}));let o=s.current,[a,l]=G.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},u=G.useCallback(h=>{c&&HL?HL(()=>l(h)):l(h)},[l,c]);return G.useLayoutEffect(()=>o.listen(u),[o,u]),G.useEffect(()=>Hee(n),[n]),G.createElement(Bee,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const Jee=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Zee=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wd=G.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,d=sU(e,zee),{basename:f}=G.useContext(bc),m,g=!1;if(typeof c=="string"&&Zee.test(c)&&(m=c,Jee))try{let x=new URL(window.location.href),C=c.startsWith("//")?new URL(x.protocol+c):new URL(c),S=Ud(C.pathname,f);C.origin===x.origin&&S!=null?c=S+C.search+C.hash:g=!0}catch{}let v=bee(c,{relative:i}),w=ete(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:h});function b(x){n&&n(x),x.defaultPrevented||w(x)}return G.createElement("a",ox({},d,{href:m||v,onClick:g||s?n:b,ref:r,target:l}))}),jL=G.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:o=!1,style:a,to:l,viewTransition:c,children:u}=e,h=sU(e,Gee),d=xb(l,{relative:h.relative}),f=Pf(),m=G.useContext(QV),{navigator:g,basename:v}=G.useContext(bc),w=m!=null&&tte(d)&&c===!0,b=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,x=f.pathname,C=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;i||(x=x.toLowerCase(),C=C?C.toLowerCase():null,b=b.toLowerCase()),C&&v&&(C=Ud(C,v)||C);const S=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let E=x===b||!o&&x.startsWith(b)&&x.charAt(S)==="/",T=C!=null&&(C===b||!o&&C.startsWith(b)&&C.charAt(b.length)==="/"),I={isActive:E,isPending:T,isTransitioning:w},k=E?n:void 0,M;typeof s=="function"?M=s(I):M=[s,E?"active":null,T?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let D=typeof a=="function"?a(I):a;return G.createElement(Wd,ox({},h,{"aria-current":k,className:M,ref:r,style:D,to:l,viewTransition:c}),typeof u=="function"?u(I):u)});var FR;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(FR||(FR={}));var BL;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(BL||(BL={}));function Qee(t){let e=G.useContext(yb);return e||Gr(!1),e}function ete(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=See(),c=Pf(),u=xb(t,{relative:o});return G.useCallback(h=>{if(Wee(h,r)){h.preventDefault();let d=n!==void 0?n:sx(c)===sx(u);l(t,{replace:d,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[c,l,u,n,i,r,t,s,o,a])}function tte(t,e){e===void 0&&(e={});let r=G.useContext(Kee);r==null&&Gr(!1);let{basename:n}=Qee(FR.useViewTransitionState),i=xb(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=Ud(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Ud(r.nextLocation.pathname,n)||r.nextLocation.pathname;return DR(i.pathname,o)!=null||DR(i.pathname,s)!=null}/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rte={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),et=(t,e)=>{const r=G.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:l,...c},u)=>G.createElement("svg",{ref:u,...rte,width:i,height:i,stroke:n,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${nte(t)}`,a].join(" "),...c},[...e.map(([h,d])=>G.createElement(h,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=et("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=et("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=et("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=et("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=et("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=et("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=et("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=et("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=et("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=et("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=et("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ote=et("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lU=et("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ate=et("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=et("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=et("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=et("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=et("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=et("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=et("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uU=et("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=et("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=et("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=et("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=et("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=et("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=et("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=et("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=et("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=et("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=et("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hU=et("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=et("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=et("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=et("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gte=et("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=et("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dU=et("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=et("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=et("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=et("Rows2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=et("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fU=et("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gU=et("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=et("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=et("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=et("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=et("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mU=et("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=et("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pU=et("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=et("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bte=et("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=et("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Sb={GRID_DATA:"bill_generator_grid_data",CUSTOMER_PREFIX:"customer_",SPLIT_BILL_PREFIX:"split_bill_",INVOICES_PREFIX:"invoices_"};function Cb(){const t=[];for(let e=0;e<localStorage.length;e++){const r=localStorage.key(e);r&&r.startsWith(Sb.INVOICES_PREFIX)&&t.push(r)}return t}function Ste(){const t=Cb();console.log(`Clearing ${t.length} invoice keys from localStorage`),t.forEach(e=>{localStorage.removeItem(e)})}function Cte(t){localStorage.setItem(Sb.GRID_DATA,JSON.stringify(t))}function wg(){try{const t=localStorage.getItem(Sb.GRID_DATA);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading local sheet data:",t),[]}}function vU(t){try{const e=localStorage.getItem(`${Sb.INVOICES_PREFIX}${t}`);return e?JSON.parse(e):[]}catch{return[]}}const YL=[{name:"Dashboard",to:"/",icon:hU},{name:"Generate Bills",to:"/generate",icon:xp},{name:"Bulk Import",to:"/bulk-import",icon:Za},{name:"Bill History",to:"/history",icon:dte,showPendingBadge:!0},{name:"Settings",to:"/settings",icon:yte}];function Ete(){const[t,e]=G.useState(!1),[r,n]=G.useState(!1),[i,s]=G.useState(!1),[o,a]=G.useState(0);G.useEffect(()=>(c(),window.addEventListener("storage",l),()=>{window.removeEventListener("storage",l)}),[]);const l=f=>{(f.key&&f.key.startsWith("invoices_")||f.key==="invoices_updated")&&c()},c=()=>{let f=0;Cb().forEach(g=>{const v=g.replace("invoices_",""),w=vU(v);f+=w.filter(b=>!b.isPaid).length}),a(f)},u=()=>{e(f=>!f)},h=()=>{n(f=>!f),i&&s(!1)},d=()=>{s(f=>!f),r&&n(!1)};return p.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:[p.jsxs("header",{className:"bg-white border-b sticky top-0 z-10 shadow-sm",children:[p.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"flex justify-between h-16",children:[p.jsxs("div",{className:"flex",children:[p.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[p.jsx(xp,{className:"w-8 h-8 text-blue-600"}),p.jsx("span",{className:"ml-2 text-lg sm:text-xl font-bold text-gray-900 truncate",children:"GST Bill Generator"})]}),p.jsx("div",{className:"hidden md:ml-6 md:flex md:space-x-8",children:YL.map(f=>p.jsxs(jL,{to:f.to,className:({isActive:m})=>`inline-flex items-center px-1 pt-1 text-sm font-medium ${m?"border-b-2 border-blue-500 text-gray-900":"text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:[p.jsx(f.icon,{className:"w-4 h-4 mr-2"}),f.name,f.showPendingBadge&&o>0&&p.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 bg-red-100 text-red-600 text-xs font-medium rounded-full",children:o})]},f.name))})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsxs("div",{className:"relative",children:[p.jsx("button",{className:"ml-2 sm:ml-4 p-2 rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:d,children:p.jsx(ste,{className:"w-5 h-5"})}),i&&p.jsxs("div",{className:"origin-top-right absolute right-0 mt-2 w-80 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",children:[p.jsx("div",{className:"py-2 px-4 border-b border-gray-100",children:p.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Notifications"})}),p.jsxs("div",{className:"max-h-60 overflow-y-auto py-1",children:[p.jsx("div",{className:"px-4 py-2 hover:bg-gray-50 border-l-2 border-transparent hover:border-blue-500",children:p.jsxs("div",{className:"flex items-start",children:[p.jsx("div",{className:"flex-shrink-0 mt-0.5",children:p.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:p.jsx(xp,{className:"h-4 w-4 text-blue-600"})})}),p.jsxs("div",{className:"ml-3 w-0 flex-1",children:[p.jsx("p",{className:"text-sm font-medium text-gray-900",children:"New invoice created"}),p.jsx("p",{className:"text-xs text-gray-500",children:"10 minutes ago"})]})]})}),p.jsx("div",{className:"px-4 py-2 hover:bg-gray-50",children:p.jsx("p",{className:"text-center text-sm text-gray-500",children:"No more notifications"})})]}),p.jsx("div",{className:"py-1 border-t border-gray-100",children:p.jsx(Wd,{to:"/",className:"block px-4 py-2 text-sm text-blue-600 hover:bg-gray-50 text-center",children:"View all notifications"})})]})]}),p.jsx("a",{href:"https://example.com/help",target:"_blank",rel:"noopener noreferrer",className:"ml-2 sm:ml-4 p-2 rounded-full text-gray-500 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:p.jsx(hte,{className:"w-5 h-5"})}),p.jsxs("div",{className:"relative ml-2 sm:ml-4",children:[p.jsxs("button",{className:"flex items-center text-sm rounded-full bg-gray-100 p-1 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:h,children:[p.jsx("span",{className:"sr-only",children:"Open user menu"}),p.jsx("div",{className:"h-7 w-7 sm:h-8 sm:w-8 rounded-full bg-blue-200 flex items-center justify-center text-blue-800 font-semibold text-sm sm:text-base",children:"VM"}),p.jsx(aU,{className:"w-4 h-4 ml-1 mr-1 text-gray-500"})]}),r&&p.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",children:p.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu-button",children:[p.jsx("div",{className:"block px-4 py-2 text-xs text-gray-500 border-b border-gray-100 pb-2 mb-1",children:"VM Jewellers"}),p.jsx(Wd,{to:"/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Settings"}),p.jsxs("div",{className:"border-t border-gray-100 mt-1 pt-1",children:[p.jsx("p",{className:"block px-4 py-1 text-xs text-gray-500",children:"Data Management"}),p.jsx("button",{onClick:()=>{window.confirm("This will refresh all cached data. Continue?")&&(sessionStorage.clear(),window.location.reload())},className:"block w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-blue-50",role:"menuitem",children:"Refresh Cache"}),p.jsx("button",{onClick:()=>{if(window.confirm("This will clear invoice data but keep settings. Continue?")){for(let f=0;f<localStorage.length;f++){const m=localStorage.key(f);m&&(m.startsWith("invoices_")||m.startsWith("bill_generator_"))&&localStorage.removeItem(m)}alert("Invoice data cleared. The page will reload."),window.location.reload()}},className:"block w-full text-left px-4 py-2 text-sm text-orange-600 hover:bg-orange-50",role:"menuitem",children:"Clear Invoice Data"}),p.jsx("button",{onClick:()=>{window.confirm("WARNING: This will clear ALL data including settings. This cannot be undone. Continue?")&&(localStorage.clear(),sessionStorage.clear(),alert("All data cleared. The page will reload."),window.location.reload())},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",role:"menuitem",children:"Reset All Data"})]})]})})]}),p.jsx("div",{className:"md:hidden ml-4",children:p.jsxs("button",{className:"bg-white p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:u,children:[p.jsx("span",{className:"sr-only",children:"Open menu"}),t?p.jsx(D0,{className:"block h-6 w-6","aria-hidden":"true"}):p.jsx(gte,{className:"block h-6 w-6","aria-hidden":"true"})]})})]})]})}),t&&p.jsx("div",{className:"md:hidden",children:p.jsx("div",{className:"pt-2 pb-3 space-y-1",children:YL.map(f=>p.jsx(jL,{to:f.to,className:({isActive:m})=>`block pl-3 pr-4 py-2 border-l-4 text-base font-medium ${m?"border-blue-500 text-blue-700 bg-blue-50":"border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700"}`,onClick:()=>e(!1),children:p.jsxs("div",{className:"flex items-center",children:[p.jsx(f.icon,{className:"w-5 h-5 mr-3"}),f.name,f.showPendingBadge&&o>0&&p.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 bg-red-100 text-red-600 text-xs font-medium rounded-full",children:o})]})},f.name))})})]}),p.jsx("main",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-8",children:p.jsx(jee,{})}),p.jsx("footer",{className:"bg-white border-t",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:p.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[p.jsx("div",{className:"mb-4 md:mb-0",children:p.jsxs("p",{className:"text-sm text-gray-500",children:[" ",new Date().getFullYear()," VM Jewellers. All rights reserved."]})}),p.jsxs("div",{className:"flex space-x-6",children:[p.jsx("a",{href:"#",className:"text-sm text-gray-500 hover:text-gray-900",children:"Privacy Policy"}),p.jsx("a",{href:"#",className:"text-sm text-gray-500 hover:text-gray-900",children:"Terms of Service"}),p.jsxs("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 hover:text-gray-900 flex items-center",children:[p.jsx("span",{children:"GitHub"}),p.jsx(E2,{className:"ml-1 w-3 h-3"})]})]})]})})})]})}function yU(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=yU(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function xt(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=yU(t))&&(n&&(n+=" "),n+=e);return n}var Tte=Array.isArray,ji=Tte,_te=typeof ka=="object"&&ka&&ka.Object===Object&&ka,wU=_te,Rte=wU,Ate=typeof self=="object"&&self&&self.Object===Object&&self,Ote=Rte||Ate||Function("return this")(),ia=Ote,kte=ia,Ite=kte.Symbol,L0=Ite,KL=L0,xU=Object.prototype,Nte=xU.hasOwnProperty,Mte=xU.toString,xg=KL?KL.toStringTag:void 0;function Pte(t){var e=Nte.call(t,xg),r=t[xg];try{t[xg]=void 0;var n=!0}catch{}var i=Mte.call(t);return n&&(e?t[xg]=r:delete t[xg]),i}var Dte=Pte,Lte=Object.prototype,Fte=Lte.toString;function $te(t){return Fte.call(t)}var Hte=$te,XL=L0,jte=Dte,Bte=Hte,Vte="[object Null]",Ute="[object Undefined]",qL=XL?XL.toStringTag:void 0;function Wte(t){return t==null?t===void 0?Ute:Vte:qL&&qL in Object(t)?jte(t):Bte(t)}var al=Wte;function zte(t){return t!=null&&typeof t=="object"}var ll=zte,Gte=al,Yte=ll,Kte="[object Symbol]";function Xte(t){return typeof t=="symbol"||Yte(t)&&Gte(t)==Kte}var Df=Xte,qte=ji,Jte=Df,Zte=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qte=/^\w*$/;function ere(t,e){if(qte(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Jte(t)?!0:Qte.test(t)||!Zte.test(t)||e!=null&&t in Object(e)}var A2=ere;function tre(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Cc=tre;const Lf=jt(Cc);var rre=al,nre=Cc,ire="[object AsyncFunction]",sre="[object Function]",ore="[object GeneratorFunction]",are="[object Proxy]";function lre(t){if(!nre(t))return!1;var e=rre(t);return e==sre||e==ore||e==ire||e==are}var O2=lre;const at=jt(O2);var cre=ia,ure=cre["__core-js_shared__"],hre=ure,sE=hre,JL=function(){var t=/[^.]+$/.exec(sE&&sE.keys&&sE.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function dre(t){return!!JL&&JL in t}var fre=dre,gre=Function.prototype,mre=gre.toString;function pre(t){if(t!=null){try{return mre.call(t)}catch{}try{return t+""}catch{}}return""}var bU=pre,vre=O2,yre=fre,wre=Cc,xre=bU,bre=/[\\^$.*+?()[\]{}|]/g,Sre=/^\[object .+?Constructor\]$/,Cre=Function.prototype,Ere=Object.prototype,Tre=Cre.toString,_re=Ere.hasOwnProperty,Rre=RegExp("^"+Tre.call(_re).replace(bre,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Are(t){if(!wre(t)||yre(t))return!1;var e=vre(t)?Rre:Sre;return e.test(xre(t))}var Ore=Are;function kre(t,e){return t==null?void 0:t[e]}var Ire=kre,Nre=Ore,Mre=Ire;function Pre(t,e){var r=Mre(t,e);return Nre(r)?r:void 0}var Ju=Pre,Dre=Ju,Lre=Dre(Object,"create"),Eb=Lre,ZL=Eb;function Fre(){this.__data__=ZL?ZL(null):{},this.size=0}var $re=Fre;function Hre(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var jre=Hre,Bre=Eb,Vre="__lodash_hash_undefined__",Ure=Object.prototype,Wre=Ure.hasOwnProperty;function zre(t){var e=this.__data__;if(Bre){var r=e[t];return r===Vre?void 0:r}return Wre.call(e,t)?e[t]:void 0}var Gre=zre,Yre=Eb,Kre=Object.prototype,Xre=Kre.hasOwnProperty;function qre(t){var e=this.__data__;return Yre?e[t]!==void 0:Xre.call(e,t)}var Jre=qre,Zre=Eb,Qre="__lodash_hash_undefined__";function ene(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Zre&&e===void 0?Qre:e,this}var tne=ene,rne=$re,nne=jre,ine=Gre,sne=Jre,one=tne;function Ff(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ff.prototype.clear=rne;Ff.prototype.delete=nne;Ff.prototype.get=ine;Ff.prototype.has=sne;Ff.prototype.set=one;var ane=Ff;function lne(){this.__data__=[],this.size=0}var cne=lne;function une(t,e){return t===e||t!==t&&e!==e}var k2=une,hne=k2;function dne(t,e){for(var r=t.length;r--;)if(hne(t[r][0],e))return r;return-1}var Tb=dne,fne=Tb,gne=Array.prototype,mne=gne.splice;function pne(t){var e=this.__data__,r=fne(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():mne.call(e,r,1),--this.size,!0}var vne=pne,yne=Tb;function wne(t){var e=this.__data__,r=yne(e,t);return r<0?void 0:e[r][1]}var xne=wne,bne=Tb;function Sne(t){return bne(this.__data__,t)>-1}var Cne=Sne,Ene=Tb;function Tne(t,e){var r=this.__data__,n=Ene(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var _ne=Tne,Rne=cne,Ane=vne,One=xne,kne=Cne,Ine=_ne;function $f(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$f.prototype.clear=Rne;$f.prototype.delete=Ane;$f.prototype.get=One;$f.prototype.has=kne;$f.prototype.set=Ine;var _b=$f,Nne=Ju,Mne=ia,Pne=Nne(Mne,"Map"),I2=Pne,QL=ane,Dne=_b,Lne=I2;function Fne(){this.size=0,this.__data__={hash:new QL,map:new(Lne||Dne),string:new QL}}var $ne=Fne;function Hne(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var jne=Hne,Bne=jne;function Vne(t,e){var r=t.__data__;return Bne(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Rb=Vne,Une=Rb;function Wne(t){var e=Une(this,t).delete(t);return this.size-=e?1:0,e}var zne=Wne,Gne=Rb;function Yne(t){return Gne(this,t).get(t)}var Kne=Yne,Xne=Rb;function qne(t){return Xne(this,t).has(t)}var Jne=qne,Zne=Rb;function Qne(t,e){var r=Zne(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var eie=Qne,tie=$ne,rie=zne,nie=Kne,iie=Jne,sie=eie;function Hf(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Hf.prototype.clear=tie;Hf.prototype.delete=rie;Hf.prototype.get=nie;Hf.prototype.has=iie;Hf.prototype.set=sie;var N2=Hf,SU=N2,oie="Expected a function";function M2(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(oie);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(M2.Cache||SU),r}M2.Cache=SU;var CU=M2;const aie=jt(CU);var lie=CU,cie=500;function uie(t){var e=lie(t,function(n){return r.size===cie&&r.clear(),n}),r=e.cache;return e}var hie=uie,die=hie,fie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gie=/\\(\\)?/g,mie=die(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(fie,function(r,n,i,s){e.push(i?s.replace(gie,"$1"):n||r)}),e}),pie=mie;function vie(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var P2=vie,eF=L0,yie=P2,wie=ji,xie=Df,tF=eF?eF.prototype:void 0,rF=tF?tF.toString:void 0;function EU(t){if(typeof t=="string")return t;if(wie(t))return yie(t,EU)+"";if(xie(t))return rF?rF.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var bie=EU,Sie=bie;function Cie(t){return t==null?"":Sie(t)}var TU=Cie,Eie=ji,Tie=A2,_ie=pie,Rie=TU;function Aie(t,e){return Eie(t)?t:Tie(t,e)?[t]:_ie(Rie(t))}var _U=Aie,Oie=Df;function kie(t){if(typeof t=="string"||Oie(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var Ab=kie,Iie=_U,Nie=Ab;function Mie(t,e){e=Iie(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Nie(e[r++])];return r&&r==n?t:void 0}var D2=Mie,Pie=D2;function Die(t,e,r){var n=t==null?void 0:Pie(t,e);return n===void 0?r:n}var RU=Die;const is=jt(RU);function Lie(t){return t==null}var Fie=Lie;const dt=jt(Fie);var $ie=al,Hie=ji,jie=ll,Bie="[object String]";function Vie(t){return typeof t=="string"||!Hie(t)&&jie(t)&&$ie(t)==Bie}var Uie=Vie;const F0=jt(Uie);var AU={exports:{}},Yt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L2=Symbol.for("react.element"),F2=Symbol.for("react.portal"),Ob=Symbol.for("react.fragment"),kb=Symbol.for("react.strict_mode"),Ib=Symbol.for("react.profiler"),Nb=Symbol.for("react.provider"),Mb=Symbol.for("react.context"),Wie=Symbol.for("react.server_context"),Pb=Symbol.for("react.forward_ref"),Db=Symbol.for("react.suspense"),Lb=Symbol.for("react.suspense_list"),Fb=Symbol.for("react.memo"),$b=Symbol.for("react.lazy"),zie=Symbol.for("react.offscreen"),OU;OU=Symbol.for("react.module.reference");function Hs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case L2:switch(t=t.type,t){case Ob:case Ib:case kb:case Db:case Lb:return t;default:switch(t=t&&t.$$typeof,t){case Wie:case Mb:case Pb:case $b:case Fb:case Nb:return t;default:return e}}case F2:return e}}}Yt.ContextConsumer=Mb;Yt.ContextProvider=Nb;Yt.Element=L2;Yt.ForwardRef=Pb;Yt.Fragment=Ob;Yt.Lazy=$b;Yt.Memo=Fb;Yt.Portal=F2;Yt.Profiler=Ib;Yt.StrictMode=kb;Yt.Suspense=Db;Yt.SuspenseList=Lb;Yt.isAsyncMode=function(){return!1};Yt.isConcurrentMode=function(){return!1};Yt.isContextConsumer=function(t){return Hs(t)===Mb};Yt.isContextProvider=function(t){return Hs(t)===Nb};Yt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===L2};Yt.isForwardRef=function(t){return Hs(t)===Pb};Yt.isFragment=function(t){return Hs(t)===Ob};Yt.isLazy=function(t){return Hs(t)===$b};Yt.isMemo=function(t){return Hs(t)===Fb};Yt.isPortal=function(t){return Hs(t)===F2};Yt.isProfiler=function(t){return Hs(t)===Ib};Yt.isStrictMode=function(t){return Hs(t)===kb};Yt.isSuspense=function(t){return Hs(t)===Db};Yt.isSuspenseList=function(t){return Hs(t)===Lb};Yt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Ob||t===Ib||t===kb||t===Db||t===Lb||t===zie||typeof t=="object"&&t!==null&&(t.$$typeof===$b||t.$$typeof===Fb||t.$$typeof===Nb||t.$$typeof===Mb||t.$$typeof===Pb||t.$$typeof===OU||t.getModuleId!==void 0)};Yt.typeOf=Hs;AU.exports=Yt;var Gie=AU.exports,Yie=al,Kie=ll,Xie="[object Number]";function qie(t){return typeof t=="number"||Kie(t)&&Yie(t)==Xie}var kU=qie;const Jie=jt(kU);var Zie=kU;function Qie(t){return Zie(t)&&t!=+t}var ese=Qie;const $0=jt(ese);var mi=function(e){return e===0?0:e>0?1:-1},uu=function(e){return F0(e)&&e.indexOf("%")===e.length-1},Ue=function(e){return Jie(e)&&!$0(e)},mn=function(e){return Ue(e)||F0(e)},tse=0,jf=function(e){var r=++tse;return"".concat(e||"").concat(r)},pi=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ue(e)&&!F0(e))return n;var s;if(uu(e)){var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return $0(s)&&(s=n),i&&s>r&&(s=r),s},$l=function(e){if(!e)return null;var r=Object.keys(e);return r&&r.length?e[r[0]]:null},rse=function(e){if(!Array.isArray(e))return!1;for(var r=e.length,n={},i=0;i<r;i++)if(!n[e[i]])n[e[i]]=!0;else return!0;return!1},qi=function(e,r){return Ue(e)&&Ue(r)?function(n){return e+n*(r-e)}:function(){return r}};function cx(t,e,r){return!t||!t.length?null:t.find(function(n){return n&&(typeof e=="function"?e(n):is(n,e))===r})}function Ed(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function jR(t){"@babel/helpers - typeof";return jR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jR(t)}var nse=["viewBox","children"],ise=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],nF=["points","pathLength"],oE={svg:nse,polygon:nF,polyline:nF},$2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ux=function(e,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(G.isValidElement(e)&&(n=e.props),!Lf(n))return null;var i={};return Object.keys(n).forEach(function(s){$2.includes(s)&&(i[s]=r||function(o){return n[s](n,o)})}),i},sse=function(e,r,n){return function(i){return e(r,n,i),null}},Du=function(e,r,n){if(!Lf(e)||jR(e)!=="object")return null;var i=null;return Object.keys(e).forEach(function(s){var o=e[s];$2.includes(s)&&typeof o=="function"&&(i||(i={}),i[s]=sse(o,r,n))}),i},ose=["children"],ase=["children"];function iF(t,e){if(t==null)return{};var r=lse(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function lse(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function BR(t){"@babel/helpers - typeof";return BR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BR(t)}var sF={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Ba=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},oF=null,aE=null,H2=function t(e){if(e===oF&&Array.isArray(aE))return aE;var r=[];return G.Children.forEach(e,function(n){dt(n)||(Gie.isFragment(n)?r=r.concat(t(n.props.children)):r.push(n))}),aE=r,oF=e,r};function ss(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(function(i){return Ba(i)}):n=[Ba(e)],H2(t).forEach(function(i){var s=is(i,"type.displayName")||is(i,"type.name");n.indexOf(s)!==-1&&r.push(i)}),r}function Xi(t,e){var r=ss(t,e);return r&&r[0]}var aF=function(e){if(!e||!e.props)return!1;var r=e.props,n=r.width,i=r.height;return!(!Ue(n)||n<=0||!Ue(i)||i<=0)},cse=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],use=function(e){return e&&e.type&&F0(e.type)&&cse.indexOf(e.type)>=0},hse=function(e){return e&&BR(e)==="object"&&"clipDot"in e},dse=function(e,r,n,i){var s,o=(s=oE==null?void 0:oE[i])!==null&&s!==void 0?s:[];return r.startsWith("data-")||!at(e)&&(i&&o.includes(r)||ise.includes(r))||n&&$2.includes(r)},rt=function(e,r,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(G.isValidElement(e)&&(i=e.props),!Lf(i))return null;var s={};return Object.keys(i).forEach(function(o){var a;dse((a=i)===null||a===void 0?void 0:a[o],o,r,n)&&(s[o]=i[o])}),s},VR=function t(e,r){if(e===r)return!0;var n=G.Children.count(e);if(n!==G.Children.count(r))return!1;if(n===0)return!0;if(n===1)return lF(Array.isArray(e)?e[0]:e,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var s=e[i],o=r[i];if(Array.isArray(s)||Array.isArray(o)){if(!t(s,o))return!1}else if(!lF(s,o))return!1}return!0},lF=function(e,r){if(dt(e)&&dt(r))return!0;if(!dt(e)&&!dt(r)){var n=e.props||{},i=n.children,s=iF(n,ose),o=r.props||{},a=o.children,l=iF(o,ase);return i&&a?Ed(s,l)&&VR(i,a):!i&&!a?Ed(s,l):!1}return!1},cF=function(e,r){var n=[],i={};return H2(e).forEach(function(s,o){if(use(s))n.push(s);else if(s){var a=Ba(s.type),l=r[a]||{},c=l.handler,u=l.once;if(c&&(!u||!i[a])){var h=c(s,a,o);n.push(h),i[a]=!0}}}),n},fse=function(e){var r=e&&e.type;return r&&sF[r]?sF[r]:null},gse=function(e,r){return H2(r).indexOf(e)},mse=["children","width","height","viewBox","className","style","title","desc"];function UR(){return UR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},UR.apply(this,arguments)}function pse(t,e){if(t==null)return{};var r=vse(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function vse(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function WR(t){var e=t.children,r=t.width,n=t.height,i=t.viewBox,s=t.className,o=t.style,a=t.title,l=t.desc,c=pse(t,mse),u=i||{width:r,height:n,x:0,y:0},h=xt("recharts-surface",s);return oe.createElement("svg",UR({},rt(c,!0,"svg"),{className:h,width:r,height:n,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),oe.createElement("title",null,a),oe.createElement("desc",null,l),e)}var yse=["children","className"];function zR(){return zR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zR.apply(this,arguments)}function wse(t,e){if(t==null)return{};var r=xse(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function xse(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Ft=oe.forwardRef(function(t,e){var r=t.children,n=t.className,i=wse(t,yse),s=xt("recharts-layer",n);return oe.createElement("g",zR({className:s},rt(i,!0),{ref:e}),r)}),mo=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s]};function bse(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=Array(i);++n<i;)s[n]=t[n+e];return s}var Sse=bse,Cse=Sse;function Ese(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:Cse(t,e,r)}var Tse=Ese,_se="\\ud800-\\udfff",Rse="\\u0300-\\u036f",Ase="\\ufe20-\\ufe2f",Ose="\\u20d0-\\u20ff",kse=Rse+Ase+Ose,Ise="\\ufe0e\\ufe0f",Nse="\\u200d",Mse=RegExp("["+Nse+_se+kse+Ise+"]");function Pse(t){return Mse.test(t)}var IU=Pse;function Dse(t){return t.split("")}var Lse=Dse,NU="\\ud800-\\udfff",Fse="\\u0300-\\u036f",$se="\\ufe20-\\ufe2f",Hse="\\u20d0-\\u20ff",jse=Fse+$se+Hse,Bse="\\ufe0e\\ufe0f",Vse="["+NU+"]",GR="["+jse+"]",YR="\\ud83c[\\udffb-\\udfff]",Use="(?:"+GR+"|"+YR+")",MU="[^"+NU+"]",PU="(?:\\ud83c[\\udde6-\\uddff]){2}",DU="[\\ud800-\\udbff][\\udc00-\\udfff]",Wse="\\u200d",LU=Use+"?",FU="["+Bse+"]?",zse="(?:"+Wse+"(?:"+[MU,PU,DU].join("|")+")"+FU+LU+")*",Gse=FU+LU+zse,Yse="(?:"+[MU+GR+"?",GR,PU,DU,Vse].join("|")+")",Kse=RegExp(YR+"(?="+YR+")|"+Yse+Gse,"g");function Xse(t){return t.match(Kse)||[]}var qse=Xse,Jse=Lse,Zse=IU,Qse=qse;function eoe(t){return Zse(t)?Qse(t):Jse(t)}var toe=eoe,roe=Tse,noe=IU,ioe=toe,soe=TU;function ooe(t){return function(e){e=soe(e);var r=noe(e)?ioe(e):void 0,n=r?r[0]:e.charAt(0),i=r?roe(r,1).join(""):e.slice(1);return n[t]()+i}}var aoe=ooe,loe=aoe,coe=loe("toUpperCase"),uoe=coe;const Hb=jt(uoe);function or(t){return function(){return t}}const $U=Math.cos,hx=Math.sin,bo=Math.sqrt,dx=Math.PI,jb=2*dx,KR=Math.PI,XR=2*KR,tu=1e-6,hoe=XR-tu;function HU(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function doe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return HU;const r=10**e;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class foe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?HU:doe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,s,o){this._append`C${+e},${+r},${+n},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,i,s){if(e=+e,r=+r,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=n-e,c=i-r,u=o-e,h=a-r,d=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(d>tu)if(!(Math.abs(h*l-c*u)>tu)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let f=n-o,m=i-a,g=l*l+c*c,v=f*f+m*m,w=Math.sqrt(g),b=Math.sqrt(d),x=s*Math.tan((KR-Math.acos((g+d-v)/(2*w*b)))/2),C=x/b,S=x/w;Math.abs(C-1)>tu&&this._append`L${e+C*u},${r+C*h}`,this._append`A${s},${s},0,0,${+(h*f>u*m)},${this._x1=e+S*l},${this._y1=r+S*c}`}}arc(e,r,n,i,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(i),l=n*Math.sin(i),c=e+a,u=r+l,h=1^o,d=o?i-s:s-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>tu||Math.abs(this._y1-u)>tu)&&this._append`L${c},${u}`,n&&(d<0&&(d=d%XR+XR),d>hoe?this._append`A${n},${n},0,1,${h},${e-a},${r-l}A${n},${n},0,1,${h},${this._x1=c},${this._y1=u}`:d>tu&&this._append`A${n},${n},0,${+(d>=KR)},${h},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function j2(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new foe(e)}function B2(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function jU(t){this._context=t}jU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Bb(t){return new jU(t)}function BU(t){return t[0]}function VU(t){return t[1]}function UU(t,e){var r=or(!0),n=null,i=Bb,s=null,o=j2(a);t=typeof t=="function"?t:t===void 0?BU:or(t),e=typeof e=="function"?e:e===void 0?VU:or(e);function a(l){var c,u=(l=B2(l)).length,h,d=!1,f;for(n==null&&(s=i(f=o())),c=0;c<=u;++c)!(c<u&&r(h=l[c],c,l))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+t(h,c,l),+e(h,c,l));if(f)return s=null,f+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:or(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:or(+l),a):e},a.defined=function(l){return arguments.length?(r=typeof l=="function"?l:or(!!l),a):r},a.curve=function(l){return arguments.length?(i=l,n!=null&&(s=i(n)),a):i},a.context=function(l){return arguments.length?(l==null?n=s=null:s=i(n=l),a):n},a}function Hv(t,e,r){var n=null,i=or(!0),s=null,o=Bb,a=null,l=j2(c);t=typeof t=="function"?t:t===void 0?BU:or(+t),e=typeof e=="function"?e:or(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?VU:or(+r);function c(h){var d,f,m,g=(h=B2(h)).length,v,w=!1,b,x=new Array(g),C=new Array(g);for(s==null&&(a=o(b=l())),d=0;d<=g;++d){if(!(d<g&&i(v=h[d],d,h))===w)if(w=!w)f=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),m=d-1;m>=f;--m)a.point(x[m],C[m]);a.lineEnd(),a.areaEnd()}w&&(x[d]=+t(v,d,h),C[d]=+e(v,d,h),a.point(n?+n(v,d,h):x[d],r?+r(v,d,h):C[d]))}if(b)return a=null,b+""||null}function u(){return UU().defined(i).curve(o).context(s)}return c.x=function(h){return arguments.length?(t=typeof h=="function"?h:or(+h),n=null,c):t},c.x0=function(h){return arguments.length?(t=typeof h=="function"?h:or(+h),c):t},c.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:or(+h),c):n},c.y=function(h){return arguments.length?(e=typeof h=="function"?h:or(+h),r=null,c):e},c.y0=function(h){return arguments.length?(e=typeof h=="function"?h:or(+h),c):e},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:or(+h),c):r},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(r)},c.lineX1=function(){return u().x(n).y(e)},c.defined=function(h){return arguments.length?(i=typeof h=="function"?h:or(!!h),c):i},c.curve=function(h){return arguments.length?(o=h,s!=null&&(a=o(s)),c):o},c.context=function(h){return arguments.length?(h==null?s=a=null:a=o(s=h),c):s},c}class WU{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function goe(t){return new WU(t,!0)}function moe(t){return new WU(t,!1)}const V2={draw(t,e){const r=bo(e/dx);t.moveTo(r,0),t.arc(0,0,r,0,jb)}},poe={draw(t,e){const r=bo(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},zU=bo(1/3),voe=zU*2,yoe={draw(t,e){const r=bo(e/voe),n=r*zU;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},woe={draw(t,e){const r=bo(e),n=-r/2;t.rect(n,n,r,r)}},xoe=.8908130915292852,GU=hx(dx/10)/hx(7*dx/10),boe=hx(jb/10)*GU,Soe=-$U(jb/10)*GU,Coe={draw(t,e){const r=bo(e*xoe),n=boe*r,i=Soe*r;t.moveTo(0,-r),t.lineTo(n,i);for(let s=1;s<5;++s){const o=jb*s/5,a=$U(o),l=hx(o);t.lineTo(l*r,-a*r),t.lineTo(a*n-l*i,l*n+a*i)}t.closePath()}},lE=bo(3),Eoe={draw(t,e){const r=-bo(e/(lE*3));t.moveTo(0,r*2),t.lineTo(-lE*r,-r),t.lineTo(lE*r,-r),t.closePath()}},fs=-.5,gs=bo(3)/2,qR=1/bo(12),Toe=(qR/2+1)*3,_oe={draw(t,e){const r=bo(e/Toe),n=r/2,i=r*qR,s=n,o=r*qR+r,a=-s,l=o;t.moveTo(n,i),t.lineTo(s,o),t.lineTo(a,l),t.lineTo(fs*n-gs*i,gs*n+fs*i),t.lineTo(fs*s-gs*o,gs*s+fs*o),t.lineTo(fs*a-gs*l,gs*a+fs*l),t.lineTo(fs*n+gs*i,fs*i-gs*n),t.lineTo(fs*s+gs*o,fs*o-gs*s),t.lineTo(fs*a+gs*l,fs*l-gs*a),t.closePath()}};function Roe(t,e){let r=null,n=j2(i);t=typeof t=="function"?t:or(t||V2),e=typeof e=="function"?e:or(e===void 0?64:+e);function i(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(t=typeof s=="function"?s:or(s),i):t},i.size=function(s){return arguments.length?(e=typeof s=="function"?s:or(+s),i):e},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function fx(){}function gx(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function YU(t){this._context=t}YU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:gx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:gx(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Aoe(t){return new YU(t)}function KU(t){this._context=t}KU.prototype={areaStart:fx,areaEnd:fx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:gx(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Ooe(t){return new KU(t)}function XU(t){this._context=t}XU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:gx(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function koe(t){return new XU(t)}function qU(t){this._context=t}qU.prototype={areaStart:fx,areaEnd:fx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function Ioe(t){return new qU(t)}function uF(t){return t<0?-1:1}function hF(t,e,r){var n=t._x1-t._x0,i=e-t._x1,s=(t._y1-t._y0)/(n||i<0&&-0),o=(r-t._y1)/(i||n<0&&-0),a=(s*i+o*n)/(n+i);return(uF(s)+uF(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function dF(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function cE(t,e,r){var n=t._x0,i=t._y0,s=t._x1,o=t._y1,a=(s-n)/3;t._context.bezierCurveTo(n+a,i+a*e,s-a,o-a*r,s,o)}function mx(t){this._context=t}mx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:cE(this,this._t0,dF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,cE(this,dF(this,r=hF(this,t,e)),r);break;default:cE(this,this._t0,r=hF(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function JU(t){this._context=new ZU(t)}(JU.prototype=Object.create(mx.prototype)).point=function(t,e){mx.prototype.point.call(this,e,t)};function ZU(t){this._context=t}ZU.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,s){this._context.bezierCurveTo(e,t,n,r,s,i)}};function Noe(t){return new mx(t)}function Moe(t){return new JU(t)}function QU(t){this._context=t}QU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=fF(t),i=fF(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function fF(t){var e,r=t.length-1,n,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/s[e];for(s[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-i[e+1];return[i,s]}function Poe(t){return new QU(t)}function Vb(t,e){this._context=t,this._t=e}Vb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function Doe(t){return new Vb(t,.5)}function Loe(t){return new Vb(t,0)}function Foe(t){return new Vb(t,1)}function Yd(t,e){if((o=t.length)>1)for(var r=1,n,i,s=t[e[0]],o,a=s.length;r<o;++r)for(i=s,s=t[e[r]],n=0;n<a;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function JR(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function $oe(t,e){return t[e]}function Hoe(t){const e=[];return e.key=t,e}function joe(){var t=or([]),e=JR,r=Yd,n=$oe;function i(s){var o=Array.from(t.apply(this,arguments),Hoe),a,l=o.length,c=-1,u;for(const h of s)for(a=0,++c;a<l;++a)(o[a][c]=[0,+n(h,o[a].key,c,s)]).data=h;for(a=0,u=B2(e(o));a<l;++a)o[u[a]].index=a;return r(o,u),o}return i.keys=function(s){return arguments.length?(t=typeof s=="function"?s:or(Array.from(s)),i):t},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:or(+s),i):n},i.order=function(s){return arguments.length?(e=s==null?JR:typeof s=="function"?s:or(Array.from(s)),i):e},i.offset=function(s){return arguments.length?(r=s??Yd,i):r},i}function Boe(t,e){if((n=t.length)>0){for(var r,n,i=0,s=t[0].length,o;i<s;++i){for(o=r=0;r<n;++r)o+=t[r][i][1]||0;if(o)for(r=0;r<n;++r)t[r][i][1]/=o}Yd(t,e)}}function Voe(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,s=n.length;r<s;++r){for(var o=0,a=0;o<i;++o)a+=t[o][r][1]||0;n[r][1]+=n[r][0]=-a/2}Yd(t,e)}}function Uoe(t,e){if(!(!((o=t.length)>0)||!((s=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,s,o;n<s;++n){for(var a=0,l=0,c=0;a<o;++a){for(var u=t[e[a]],h=u[n][1]||0,d=u[n-1][1]||0,f=(h-d)/2,m=0;m<a;++m){var g=t[e[m]],v=g[n][1]||0,w=g[n-1][1]||0;f+=v-w}l+=h,c+=f*h}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,Yd(t,e)}}function bp(t){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bp(t)}var Woe=["type","size","sizeType"];function ZR(){return ZR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZR.apply(this,arguments)}function gF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gF(Object(r),!0).forEach(function(n){zoe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zoe(t,e,r){return e=Goe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Goe(t){var e=Yoe(t,"string");return bp(e)=="symbol"?e:e+""}function Yoe(t,e){if(bp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(bp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Koe(t,e){if(t==null)return{};var r=Xoe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Xoe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var eW={symbolCircle:V2,symbolCross:poe,symbolDiamond:yoe,symbolSquare:woe,symbolStar:Coe,symbolTriangle:Eoe,symbolWye:_oe},qoe=Math.PI/180,Joe=function(e){var r="symbol".concat(Hb(e));return eW[r]||V2},Zoe=function(e,r,n){if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*qoe;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},Qoe=function(e,r){eW["symbol".concat(Hb(e))]=r},U2=function(e){var r=e.type,n=r===void 0?"circle":r,i=e.size,s=i===void 0?64:i,o=e.sizeType,a=o===void 0?"area":o,l=Koe(e,Woe),c=mF(mF({},l),{},{type:n,size:s,sizeType:a}),u=function(){var v=Joe(n),w=Roe().type(v).size(Zoe(s,a,n));return w()},h=c.className,d=c.cx,f=c.cy,m=rt(c,!0);return d===+d&&f===+f&&s===+s?oe.createElement("path",ZR({},m,{className:xt("recharts-symbols",h),transform:"translate(".concat(d,", ").concat(f,")"),d:u()})):null};U2.registerSymbol=Qoe;function Kd(t){"@babel/helpers - typeof";return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kd(t)}function QR(){return QR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},QR.apply(this,arguments)}function pF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function eae(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pF(Object(r),!0).forEach(function(n){Sp(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rW(n.key),n)}}function nae(t,e,r){return e&&rae(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function iae(t,e,r){return e=px(e),sae(t,tW()?Reflect.construct(e,r||[],px(t).constructor):e.apply(t,r))}function sae(t,e){if(e&&(Kd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oae(t)}function oae(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tW=function(){return!!t})()}function px(t){return px=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},px(t)}function aae(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eA(t,e)}function eA(t,e){return eA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eA(t,e)}function Sp(t,e,r){return e=rW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rW(t){var e=lae(t,"string");return Kd(e)=="symbol"?e:e+""}function lae(t,e){if(Kd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Kd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ys=32,W2=function(t){function e(){return tae(this,e),iae(this,e,arguments)}return aae(e,t),nae(e,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,s=Ys/2,o=Ys/6,a=Ys/3,l=n.inactive?i:n.color;if(n.type==="plainline")return oe.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:s,x2:Ys,y2:s,className:"recharts-legend-icon"});if(n.type==="line")return oe.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(s,"h").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*a,",").concat(s,`
            H`).concat(Ys,"M").concat(2*a,",").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(a,",").concat(s),className:"recharts-legend-icon"});if(n.type==="rect")return oe.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ys/8,"h").concat(Ys,"v").concat(Ys*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(oe.isValidElement(n.legendIcon)){var c=eae({},n);return delete c.legendIcon,oe.cloneElement(n.legendIcon,c)}return oe.createElement(U2,{fill:l,cx:s,cy:s,size:Ys,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,s=i.payload,o=i.iconSize,a=i.layout,l=i.formatter,c=i.inactiveColor,u={x:0,y:0,width:Ys,height:Ys},h={display:a==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(f,m){var g=f.formatter||l,v=xt(Sp(Sp({"recharts-legend-item":!0},"legend-item-".concat(m),!0),"inactive",f.inactive));if(f.type==="none")return null;var w=at(f.value)?null:f.value;mo(!at(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=f.inactive?c:f.color;return oe.createElement("li",QR({className:v,style:h,key:"legend-item-".concat(m)},Du(n.props,f,m)),oe.createElement(WR,{width:o,height:o,viewBox:u,style:d},n.renderIcon(f)),oe.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(w,f,m):w))})}},{key:"render",value:function(){var n=this.props,i=n.payload,s=n.layout,o=n.align;if(!i||!i.length)return null;var a={padding:0,margin:0,textAlign:s==="horizontal"?o:"left"};return oe.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(G.PureComponent);Sp(W2,"displayName","Legend");Sp(W2,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var cae=_b;function uae(){this.__data__=new cae,this.size=0}var hae=uae;function dae(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var fae=dae;function gae(t){return this.__data__.get(t)}var mae=gae;function pae(t){return this.__data__.has(t)}var vae=pae,yae=_b,wae=I2,xae=N2,bae=200;function Sae(t,e){var r=this.__data__;if(r instanceof yae){var n=r.__data__;if(!wae||n.length<bae-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new xae(n)}return r.set(t,e),this.size=r.size,this}var Cae=Sae,Eae=_b,Tae=hae,_ae=fae,Rae=mae,Aae=vae,Oae=Cae;function Bf(t){var e=this.__data__=new Eae(t);this.size=e.size}Bf.prototype.clear=Tae;Bf.prototype.delete=_ae;Bf.prototype.get=Rae;Bf.prototype.has=Aae;Bf.prototype.set=Oae;var nW=Bf,kae="__lodash_hash_undefined__";function Iae(t){return this.__data__.set(t,kae),this}var Nae=Iae;function Mae(t){return this.__data__.has(t)}var Pae=Mae,Dae=N2,Lae=Nae,Fae=Pae;function vx(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Dae;++e<r;)this.add(t[e])}vx.prototype.add=vx.prototype.push=Lae;vx.prototype.has=Fae;var iW=vx;function $ae(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var sW=$ae;function Hae(t,e){return t.has(e)}var oW=Hae,jae=iW,Bae=sW,Vae=oW,Uae=1,Wae=2;function zae(t,e,r,n,i,s){var o=r&Uae,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var h=-1,d=!0,f=r&Wae?new jae:void 0;for(s.set(t,e),s.set(e,t);++h<a;){var m=t[h],g=e[h];if(n)var v=o?n(g,m,h,e,t,s):n(m,g,h,t,e,s);if(v!==void 0){if(v)continue;d=!1;break}if(f){if(!Bae(e,function(w,b){if(!Vae(f,b)&&(m===w||i(m,w,r,n,s)))return f.push(b)})){d=!1;break}}else if(!(m===g||i(m,g,r,n,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var aW=zae,Gae=ia,Yae=Gae.Uint8Array,Kae=Yae;function Xae(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var qae=Xae;function Jae(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var z2=Jae,vF=L0,yF=Kae,Zae=k2,Qae=aW,ele=qae,tle=z2,rle=1,nle=2,ile="[object Boolean]",sle="[object Date]",ole="[object Error]",ale="[object Map]",lle="[object Number]",cle="[object RegExp]",ule="[object Set]",hle="[object String]",dle="[object Symbol]",fle="[object ArrayBuffer]",gle="[object DataView]",wF=vF?vF.prototype:void 0,uE=wF?wF.valueOf:void 0;function mle(t,e,r,n,i,s,o){switch(r){case gle:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case fle:return!(t.byteLength!=e.byteLength||!s(new yF(t),new yF(e)));case ile:case sle:case lle:return Zae(+t,+e);case ole:return t.name==e.name&&t.message==e.message;case cle:case hle:return t==e+"";case ale:var a=ele;case ule:var l=n&rle;if(a||(a=tle),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;n|=nle,o.set(t,e);var u=Qae(a(t),a(e),n,i,s,o);return o.delete(t),u;case dle:if(uE)return uE.call(t)==uE.call(e)}return!1}var ple=mle;function vle(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var lW=vle,yle=lW,wle=ji;function xle(t,e,r){var n=e(t);return wle(t)?n:yle(n,r(t))}var ble=xle;function Sle(t,e){for(var r=-1,n=t==null?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}var Cle=Sle;function Ele(){return[]}var Tle=Ele,_le=Cle,Rle=Tle,Ale=Object.prototype,Ole=Ale.propertyIsEnumerable,xF=Object.getOwnPropertySymbols,kle=xF?function(t){return t==null?[]:(t=Object(t),_le(xF(t),function(e){return Ole.call(t,e)}))}:Rle,Ile=kle;function Nle(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Mle=Nle,Ple=al,Dle=ll,Lle="[object Arguments]";function Fle(t){return Dle(t)&&Ple(t)==Lle}var $le=Fle,bF=$le,Hle=ll,cW=Object.prototype,jle=cW.hasOwnProperty,Ble=cW.propertyIsEnumerable,Vle=bF(function(){return arguments}())?bF:function(t){return Hle(t)&&jle.call(t,"callee")&&!Ble.call(t,"callee")},G2=Vle,yx={exports:{}};function Ule(){return!1}var Wle=Ule;yx.exports;(function(t,e){var r=ia,n=Wle,i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===i,a=o?r.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||n;t.exports=c})(yx,yx.exports);var uW=yx.exports,zle=9007199254740991,Gle=/^(?:0|[1-9]\d*)$/;function Yle(t,e){var r=typeof t;return e=e??zle,!!e&&(r=="number"||r!="symbol"&&Gle.test(t))&&t>-1&&t%1==0&&t<e}var Y2=Yle,Kle=9007199254740991;function Xle(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Kle}var K2=Xle,qle=al,Jle=K2,Zle=ll,Qle="[object Arguments]",ece="[object Array]",tce="[object Boolean]",rce="[object Date]",nce="[object Error]",ice="[object Function]",sce="[object Map]",oce="[object Number]",ace="[object Object]",lce="[object RegExp]",cce="[object Set]",uce="[object String]",hce="[object WeakMap]",dce="[object ArrayBuffer]",fce="[object DataView]",gce="[object Float32Array]",mce="[object Float64Array]",pce="[object Int8Array]",vce="[object Int16Array]",yce="[object Int32Array]",wce="[object Uint8Array]",xce="[object Uint8ClampedArray]",bce="[object Uint16Array]",Sce="[object Uint32Array]",yr={};yr[gce]=yr[mce]=yr[pce]=yr[vce]=yr[yce]=yr[wce]=yr[xce]=yr[bce]=yr[Sce]=!0;yr[Qle]=yr[ece]=yr[dce]=yr[tce]=yr[fce]=yr[rce]=yr[nce]=yr[ice]=yr[sce]=yr[oce]=yr[ace]=yr[lce]=yr[cce]=yr[uce]=yr[hce]=!1;function Cce(t){return Zle(t)&&Jle(t.length)&&!!yr[qle(t)]}var Ece=Cce;function Tce(t){return function(e){return t(e)}}var hW=Tce,wx={exports:{}};wx.exports;(function(t,e){var r=wU,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===n,o=s&&r.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(wx,wx.exports);var _ce=wx.exports,Rce=Ece,Ace=hW,SF=_ce,CF=SF&&SF.isTypedArray,Oce=CF?Ace(CF):Rce,dW=Oce,kce=Mle,Ice=G2,Nce=ji,Mce=uW,Pce=Y2,Dce=dW,Lce=Object.prototype,Fce=Lce.hasOwnProperty;function $ce(t,e){var r=Nce(t),n=!r&&Ice(t),i=!r&&!n&&Mce(t),s=!r&&!n&&!i&&Dce(t),o=r||n||i||s,a=o?kce(t.length,String):[],l=a.length;for(var c in t)(e||Fce.call(t,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Pce(c,l)))&&a.push(c);return a}var Hce=$ce,jce=Object.prototype;function Bce(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||jce;return t===r}var Vce=Bce;function Uce(t,e){return function(r){return t(e(r))}}var fW=Uce,Wce=fW,zce=Wce(Object.keys,Object),Gce=zce,Yce=Vce,Kce=Gce,Xce=Object.prototype,qce=Xce.hasOwnProperty;function Jce(t){if(!Yce(t))return Kce(t);var e=[];for(var r in Object(t))qce.call(t,r)&&r!="constructor"&&e.push(r);return e}var Zce=Jce,Qce=O2,eue=K2;function tue(t){return t!=null&&eue(t.length)&&!Qce(t)}var H0=tue,rue=Hce,nue=Zce,iue=H0;function sue(t){return iue(t)?rue(t):nue(t)}var Ub=sue,oue=ble,aue=Ile,lue=Ub;function cue(t){return oue(t,lue,aue)}var uue=cue,EF=uue,hue=1,due=Object.prototype,fue=due.hasOwnProperty;function gue(t,e,r,n,i,s){var o=r&hue,a=EF(t),l=a.length,c=EF(e),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var d=a[h];if(!(o?d in e:fue.call(e,d)))return!1}var f=s.get(t),m=s.get(e);if(f&&m)return f==e&&m==t;var g=!0;s.set(t,e),s.set(e,t);for(var v=o;++h<l;){d=a[h];var w=t[d],b=e[d];if(n)var x=o?n(b,w,d,e,t,s):n(w,b,d,t,e,s);if(!(x===void 0?w===b||i(w,b,r,n,s):x)){g=!1;break}v||(v=d=="constructor")}if(g&&!v){var C=t.constructor,S=e.constructor;C!=S&&"constructor"in t&&"constructor"in e&&!(typeof C=="function"&&C instanceof C&&typeof S=="function"&&S instanceof S)&&(g=!1)}return s.delete(t),s.delete(e),g}var mue=gue,pue=Ju,vue=ia,yue=pue(vue,"DataView"),wue=yue,xue=Ju,bue=ia,Sue=xue(bue,"Promise"),Cue=Sue,Eue=Ju,Tue=ia,_ue=Eue(Tue,"Set"),gW=_ue,Rue=Ju,Aue=ia,Oue=Rue(Aue,"WeakMap"),kue=Oue,tA=wue,rA=I2,nA=Cue,iA=gW,sA=kue,mW=al,Vf=bU,TF="[object Map]",Iue="[object Object]",_F="[object Promise]",RF="[object Set]",AF="[object WeakMap]",OF="[object DataView]",Nue=Vf(tA),Mue=Vf(rA),Pue=Vf(nA),Due=Vf(iA),Lue=Vf(sA),ru=mW;(tA&&ru(new tA(new ArrayBuffer(1)))!=OF||rA&&ru(new rA)!=TF||nA&&ru(nA.resolve())!=_F||iA&&ru(new iA)!=RF||sA&&ru(new sA)!=AF)&&(ru=function(t){var e=mW(t),r=e==Iue?t.constructor:void 0,n=r?Vf(r):"";if(n)switch(n){case Nue:return OF;case Mue:return TF;case Pue:return _F;case Due:return RF;case Lue:return AF}return e});var Fue=ru,hE=nW,$ue=aW,Hue=ple,jue=mue,kF=Fue,IF=ji,NF=uW,Bue=dW,Vue=1,MF="[object Arguments]",PF="[object Array]",jv="[object Object]",Uue=Object.prototype,DF=Uue.hasOwnProperty;function Wue(t,e,r,n,i,s){var o=IF(t),a=IF(e),l=o?PF:kF(t),c=a?PF:kF(e);l=l==MF?jv:l,c=c==MF?jv:c;var u=l==jv,h=c==jv,d=l==c;if(d&&NF(t)){if(!NF(e))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new hE),o||Bue(t)?$ue(t,e,r,n,i,s):Hue(t,e,l,r,n,i,s);if(!(r&Vue)){var f=u&&DF.call(t,"__wrapped__"),m=h&&DF.call(e,"__wrapped__");if(f||m){var g=f?t.value():t,v=m?e.value():e;return s||(s=new hE),i(g,v,r,n,s)}}return d?(s||(s=new hE),jue(t,e,r,n,i,s)):!1}var zue=Wue,Gue=zue,LF=ll;function pW(t,e,r,n,i){return t===e?!0:t==null||e==null||!LF(t)&&!LF(e)?t!==t&&e!==e:Gue(t,e,r,n,pW,i)}var X2=pW,Yue=nW,Kue=X2,Xue=1,que=2;function Jue(t,e,r,n){var i=r.length,s=i,o=!n;if(t==null)return!s;for(t=Object(t);i--;){var a=r[i];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){a=r[i];var l=a[0],c=t[l],u=a[1];if(o&&a[2]){if(c===void 0&&!(l in t))return!1}else{var h=new Yue;if(n)var d=n(c,u,l,t,e,h);if(!(d===void 0?Kue(u,c,Xue|que,n,h):d))return!1}}return!0}var Zue=Jue,Que=Cc;function ehe(t){return t===t&&!Que(t)}var vW=ehe,the=vW,rhe=Ub;function nhe(t){for(var e=rhe(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,the(i)]}return e}var ihe=nhe;function she(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var yW=she,ohe=Zue,ahe=ihe,lhe=yW;function che(t){var e=ahe(t);return e.length==1&&e[0][2]?lhe(e[0][0],e[0][1]):function(r){return r===t||ohe(r,t,e)}}var uhe=che;function hhe(t,e){return t!=null&&e in Object(t)}var dhe=hhe,fhe=_U,ghe=G2,mhe=ji,phe=Y2,vhe=K2,yhe=Ab;function whe(t,e,r){e=fhe(e,t);for(var n=-1,i=e.length,s=!1;++n<i;){var o=yhe(e[n]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++n!=i?s:(i=t==null?0:t.length,!!i&&vhe(i)&&phe(o,i)&&(mhe(t)||ghe(t)))}var xhe=whe,bhe=dhe,She=xhe;function Che(t,e){return t!=null&&She(t,e,bhe)}var Ehe=Che,The=X2,_he=RU,Rhe=Ehe,Ahe=A2,Ohe=vW,khe=yW,Ihe=Ab,Nhe=1,Mhe=2;function Phe(t,e){return Ahe(t)&&Ohe(e)?khe(Ihe(t),e):function(r){var n=_he(r,t);return n===void 0&&n===e?Rhe(r,t):The(e,n,Nhe|Mhe)}}var Dhe=Phe;function Lhe(t){return t}var Uf=Lhe;function Fhe(t){return function(e){return e==null?void 0:e[t]}}var $he=Fhe,Hhe=D2;function jhe(t){return function(e){return Hhe(e,t)}}var Bhe=jhe,Vhe=$he,Uhe=Bhe,Whe=A2,zhe=Ab;function Ghe(t){return Whe(t)?Vhe(zhe(t)):Uhe(t)}var Yhe=Ghe,Khe=uhe,Xhe=Dhe,qhe=Uf,Jhe=ji,Zhe=Yhe;function Qhe(t){return typeof t=="function"?t:t==null?qhe:typeof t=="object"?Jhe(t)?Xhe(t[0],t[1]):Khe(t):Zhe(t)}var sa=Qhe;function ede(t,e,r,n){for(var i=t.length,s=r+(n?1:-1);n?s--:++s<i;)if(e(t[s],s,t))return s;return-1}var wW=ede;function tde(t){return t!==t}var rde=tde;function nde(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}var ide=nde,sde=wW,ode=rde,ade=ide;function lde(t,e,r){return e===e?ade(t,e,r):sde(t,ode,r)}var cde=lde,ude=cde;function hde(t,e){var r=t==null?0:t.length;return!!r&&ude(t,e,0)>-1}var dde=hde;function fde(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}var gde=fde;function mde(){}var pde=mde,dE=gW,vde=pde,yde=z2,wde=1/0,xde=dE&&1/yde(new dE([,-0]))[1]==wde?function(t){return new dE(t)}:vde,bde=xde,Sde=iW,Cde=dde,Ede=gde,Tde=oW,_de=bde,Rde=z2,Ade=200;function Ode(t,e,r){var n=-1,i=Cde,s=t.length,o=!0,a=[],l=a;if(r)o=!1,i=Ede;else if(s>=Ade){var c=e?null:_de(t);if(c)return Rde(c);o=!1,i=Tde,l=new Sde}else l=e?[]:a;e:for(;++n<s;){var u=t[n],h=e?e(u):u;if(u=r||u!==0?u:0,o&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue e;e&&l.push(h),a.push(u)}else i(l,h,r)||(l!==a&&l.push(h),a.push(u))}return a}var kde=Ode,Ide=sa,Nde=kde;function Mde(t,e){return t&&t.length?Nde(t,Ide(e)):[]}var Pde=Mde;const FF=jt(Pde);function xW(t,e,r){return e===!0?FF(t,r):at(e)?FF(t,e):t}function Xd(t){"@babel/helpers - typeof";return Xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xd(t)}var Dde=["ref"];function $F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ga(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$F(Object(r),!0).forEach(function(n){Wb(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$F(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,SW(n.key),n)}}function Fde(t,e,r){return e&&HF(t.prototype,e),r&&HF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $de(t,e,r){return e=xx(e),Hde(t,bW()?Reflect.construct(e,r||[],xx(t).constructor):e.apply(t,r))}function Hde(t,e){if(e&&(Xd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jde(t)}function jde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bW=function(){return!!t})()}function xx(t){return xx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xx(t)}function Bde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oA(t,e)}function oA(t,e){return oA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oA(t,e)}function Wb(t,e,r){return e=SW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SW(t){var e=Vde(t,"string");return Xd(e)=="symbol"?e:e+""}function Vde(t,e){if(Xd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Xd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Ude(t,e){if(t==null)return{};var r=Wde(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Wde(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function zde(t){return t.value}function Gde(t,e){if(oe.isValidElement(t))return oe.cloneElement(t,e);if(typeof t=="function")return oe.createElement(t,e);e.ref;var r=Ude(e,Dde);return oe.createElement(W2,r)}var jF=1,sc=function(t){function e(){var r;Lde(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r=$de(this,e,[].concat(i)),Wb(r,"lastBoundingBox",{width:-1,height:-1}),r}return Bde(e,t),Fde(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>jF||Math.abs(i.height-this.lastBoundingBox.height)>jF)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ga({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,s=i.layout,o=i.align,a=i.verticalAlign,l=i.margin,c=i.chartWidth,u=i.chartHeight,h,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&s==="vertical"){var f=this.getBBoxSnapshot();h={left:((c||0)-f.width)/2}}else h=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(a==="middle"){var m=this.getBBoxSnapshot();d={top:((u||0)-m.height)/2}}else d=a==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return ga(ga({},h),d)}},{key:"render",value:function(){var n=this,i=this.props,s=i.content,o=i.width,a=i.height,l=i.wrapperStyle,c=i.payloadUniqBy,u=i.payload,h=ga(ga({position:"absolute",width:o||"auto",height:a||"auto"},this.getDefaultPosition(l)),l);return oe.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(f){n.wrapperNode=f}},Gde(s,ga(ga({},this.props),{},{payload:xW(u,c,zde)})))}}],[{key:"getWithHeight",value:function(n,i){var s=ga(ga({},this.defaultProps),n.props),o=s.layout;return o==="vertical"&&Ue(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||i}:null}}])}(G.PureComponent);Wb(sc,"displayName","Legend");Wb(sc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var BF=L0,Yde=G2,Kde=ji,VF=BF?BF.isConcatSpreadable:void 0;function Xde(t){return Kde(t)||Yde(t)||!!(VF&&t&&t[VF])}var qde=Xde,Jde=lW,Zde=qde;function CW(t,e,r,n,i){var s=-1,o=t.length;for(r||(r=Zde),i||(i=[]);++s<o;){var a=t[s];e>0&&r(a)?e>1?CW(a,e-1,r,n,i):Jde(i,a):n||(i[i.length]=a)}return i}var EW=CW;function Qde(t){return function(e,r,n){for(var i=-1,s=Object(e),o=n(e),a=o.length;a--;){var l=o[t?a:++i];if(r(s[l],l,s)===!1)break}return e}}var efe=Qde,tfe=efe,rfe=tfe(),nfe=rfe,ife=nfe,sfe=Ub;function ofe(t,e){return t&&ife(t,e,sfe)}var TW=ofe,afe=H0;function lfe(t,e){return function(r,n){if(r==null)return r;if(!afe(r))return t(r,n);for(var i=r.length,s=e?i:-1,o=Object(r);(e?s--:++s<i)&&n(o[s],s,o)!==!1;);return r}}var cfe=lfe,ufe=TW,hfe=cfe,dfe=hfe(ufe),q2=dfe,ffe=q2,gfe=H0;function mfe(t,e){var r=-1,n=gfe(t)?Array(t.length):[];return ffe(t,function(i,s,o){n[++r]=e(i,s,o)}),n}var _W=mfe;function pfe(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var vfe=pfe,UF=Df;function yfe(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,s=UF(t),o=e!==void 0,a=e===null,l=e===e,c=UF(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||n&&o&&l||!r&&l||!i)return 1;if(!n&&!s&&!c&&t<e||c&&r&&i&&!n&&!s||a&&r&&i||!o&&i||!l)return-1}return 0}var wfe=yfe,xfe=wfe;function bfe(t,e,r){for(var n=-1,i=t.criteria,s=e.criteria,o=i.length,a=r.length;++n<o;){var l=xfe(i[n],s[n]);if(l){if(n>=a)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return t.index-e.index}var Sfe=bfe,fE=P2,Cfe=D2,Efe=sa,Tfe=_W,_fe=vfe,Rfe=hW,Afe=Sfe,Ofe=Uf,kfe=ji;function Ife(t,e,r){e.length?e=fE(e,function(s){return kfe(s)?function(o){return Cfe(o,s.length===1?s[0]:s)}:s}):e=[Ofe];var n=-1;e=fE(e,Rfe(Efe));var i=Tfe(t,function(s,o,a){var l=fE(e,function(c){return c(s)});return{criteria:l,index:++n,value:s}});return _fe(i,function(s,o){return Afe(s,o,r)})}var Nfe=Ife;function Mfe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var Pfe=Mfe,Dfe=Pfe,WF=Math.max;function Lfe(t,e,r){return e=WF(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,s=WF(n.length-e,0),o=Array(s);++i<s;)o[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(o),Dfe(t,this,a)}}var Ffe=Lfe;function $fe(t){return function(){return t}}var Hfe=$fe,jfe=Ju,Bfe=function(){try{var t=jfe(Object,"defineProperty");return t({},"",{}),t}catch{}}(),RW=Bfe,Vfe=Hfe,zF=RW,Ufe=Uf,Wfe=zF?function(t,e){return zF(t,"toString",{configurable:!0,enumerable:!1,value:Vfe(e),writable:!0})}:Ufe,zfe=Wfe,Gfe=800,Yfe=16,Kfe=Date.now;function Xfe(t){var e=0,r=0;return function(){var n=Kfe(),i=Yfe-(n-r);if(r=n,i>0){if(++e>=Gfe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var qfe=Xfe,Jfe=zfe,Zfe=qfe,Qfe=Zfe(Jfe),ege=Qfe,tge=Uf,rge=Ffe,nge=ege;function ige(t,e){return nge(rge(t,e,tge),t+"")}var sge=ige,oge=k2,age=H0,lge=Y2,cge=Cc;function uge(t,e,r){if(!cge(r))return!1;var n=typeof e;return(n=="number"?age(r)&&lge(e,r.length):n=="string"&&e in r)?oge(r[e],t):!1}var zb=uge,hge=EW,dge=Nfe,fge=sge,GF=zb,gge=fge(function(t,e){if(t==null)return[];var r=e.length;return r>1&&GF(t,e[0],e[1])?e=[]:r>2&&GF(e[0],e[1],e[2])&&(e=[e[0]]),dge(t,hge(e,1),[])}),mge=gge;const J2=jt(mge);function Cp(t){"@babel/helpers - typeof";return Cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cp(t)}function aA(){return aA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aA.apply(this,arguments)}function pge(t,e){return xge(t)||wge(t,e)||yge(t,e)||vge()}function vge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yge(t,e){if(t){if(typeof t=="string")return YF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YF(t,e)}}function YF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wge(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function xge(t){if(Array.isArray(t))return t}function KF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KF(Object(r),!0).forEach(function(n){bge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bge(t,e,r){return e=Sge(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sge(t){var e=Cge(t,"string");return Cp(e)=="symbol"?e:e+""}function Cge(t,e){if(Cp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Cp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ege(t){return Array.isArray(t)&&mn(t[0])&&mn(t[1])?t.join(" ~ "):t}var Tge=function(e){var r=e.separator,n=r===void 0?" : ":r,i=e.contentStyle,s=i===void 0?{}:i,o=e.itemStyle,a=o===void 0?{}:o,l=e.labelStyle,c=l===void 0?{}:l,u=e.payload,h=e.formatter,d=e.itemSorter,f=e.wrapperClassName,m=e.labelClassName,g=e.label,v=e.labelFormatter,w=e.accessibilityLayer,b=w===void 0?!1:w,x=function(){if(u&&u.length){var L={padding:0,margin:0},U=(d?J2(u,d):u).map(function(J,X){if(J.type==="none")return null;var ie=gE({display:"block",paddingTop:4,paddingBottom:4,color:J.color||"#000"},a),se=J.formatter||h||Ege,P=J.value,y=J.name,_=P,R=y;if(se&&_!=null&&R!=null){var A=se(P,y,J,X,u);if(Array.isArray(A)){var O=pge(A,2);_=O[0],R=O[1]}else _=A}return oe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(X),style:ie},mn(R)?oe.createElement("span",{className:"recharts-tooltip-item-name"},R):null,mn(R)?oe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,oe.createElement("span",{className:"recharts-tooltip-item-value"},_),oe.createElement("span",{className:"recharts-tooltip-item-unit"},J.unit||""))});return oe.createElement("ul",{className:"recharts-tooltip-item-list",style:L},U)}return null},C=gE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),S=gE({margin:0},c),E=!dt(g),T=E?g:"",I=xt("recharts-default-tooltip",f),k=xt("recharts-tooltip-label",m);E&&v&&u!==void 0&&u!==null&&(T=v(g,u));var M=b?{role:"status","aria-live":"assertive"}:{};return oe.createElement("div",aA({className:I,style:C},M),oe.createElement("p",{className:k,style:S},oe.isValidElement(T)?T:"".concat(T)),x())};function Ep(t){"@babel/helpers - typeof";return Ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ep(t)}function Bv(t,e,r){return e=_ge(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _ge(t){var e=Rge(t,"string");return Ep(e)=="symbol"?e:e+""}function Rge(t,e){if(Ep(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ep(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bg="recharts-tooltip-wrapper",Age={visibility:"hidden"};function Oge(t){var e=t.coordinate,r=t.translateX,n=t.translateY;return xt(bg,Bv(Bv(Bv(Bv({},"".concat(bg,"-right"),Ue(r)&&e&&Ue(e.x)&&r>=e.x),"".concat(bg,"-left"),Ue(r)&&e&&Ue(e.x)&&r<e.x),"".concat(bg,"-bottom"),Ue(n)&&e&&Ue(e.y)&&n>=e.y),"".concat(bg,"-top"),Ue(n)&&e&&Ue(e.y)&&n<e.y))}function XF(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.key,i=t.offsetTopLeft,s=t.position,o=t.reverseDirection,a=t.tooltipDimension,l=t.viewBox,c=t.viewBoxDimension;if(s&&Ue(s[n]))return s[n];var u=r[n]-a-i,h=r[n]+i;if(e[n])return o[n]?u:h;if(o[n]){var d=u,f=l[n];return d<f?Math.max(h,l[n]):Math.max(u,l[n])}var m=h+a,g=l[n]+c;return m>g?Math.max(u,l[n]):Math.max(h,l[n])}function kge(t){var e=t.translateX,r=t.translateY,n=t.useTranslate3d;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function Ige(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.offsetTopLeft,i=t.position,s=t.reverseDirection,o=t.tooltipBox,a=t.useTranslate3d,l=t.viewBox,c,u,h;return o.height>0&&o.width>0&&r?(u=XF({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:s,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),h=XF({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:s,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),c=kge({translateX:u,translateY:h,useTranslate3d:a})):c=Age,{cssProperties:c,cssClasses:Oge({translateX:u,translateY:h,coordinate:r})}}function qd(t){"@babel/helpers - typeof";return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qd(t)}function qF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function JF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qF(Object(r),!0).forEach(function(n){cA(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OW(n.key),n)}}function Pge(t,e,r){return e&&Mge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dge(t,e,r){return e=bx(e),Lge(t,AW()?Reflect.construct(e,r||[],bx(t).constructor):e.apply(t,r))}function Lge(t,e){if(e&&(qd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fge(t)}function Fge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AW=function(){return!!t})()}function bx(t){return bx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bx(t)}function $ge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lA(t,e)}function lA(t,e){return lA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lA(t,e)}function cA(t,e,r){return e=OW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OW(t){var e=Hge(t,"string");return qd(e)=="symbol"?e:e+""}function Hge(t,e){if(qd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(qd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ZF=1,jge=function(t){function e(){var r;Nge(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r=Dge(this,e,[].concat(i)),cA(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),cA(r,"handleKeyDown",function(o){if(o.key==="Escape"){var a,l,c,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(l=r.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&a!==void 0?a:0,y:(c=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0}})}}),r}return $ge(e,t),Pge(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>ZF||Math.abs(n.height-this.state.lastBoundingBox.height)>ZF)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,s=i.active,o=i.allowEscapeViewBox,a=i.animationDuration,l=i.animationEasing,c=i.children,u=i.coordinate,h=i.hasPayload,d=i.isAnimationActive,f=i.offset,m=i.position,g=i.reverseDirection,v=i.useTranslate3d,w=i.viewBox,b=i.wrapperStyle,x=Ige({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:f,position:m,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:w}),C=x.cssClasses,S=x.cssProperties,E=JF(JF({transition:d&&s?"transform ".concat(a,"ms ").concat(l):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&h?"visible":"hidden",position:"absolute",top:0,left:0},b);return oe.createElement("div",{tabIndex:-1,className:C,style:E,ref:function(I){n.wrapperNode=I}},c)}}])}(G.PureComponent),Bge=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Zu={isSsr:Bge()};function Jd(t){"@babel/helpers - typeof";return Jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jd(t)}function QF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function e$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QF(Object(r),!0).forEach(function(n){Z2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Vge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IW(n.key),n)}}function Wge(t,e,r){return e&&Uge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zge(t,e,r){return e=Sx(e),Gge(t,kW()?Reflect.construct(e,r||[],Sx(t).constructor):e.apply(t,r))}function Gge(t,e){if(e&&(Jd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yge(t)}function Yge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kW=function(){return!!t})()}function Sx(t){return Sx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sx(t)}function Kge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uA(t,e)}function uA(t,e){return uA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uA(t,e)}function Z2(t,e,r){return e=IW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IW(t){var e=Xge(t,"string");return Jd(e)=="symbol"?e:e+""}function Xge(t,e){if(Jd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Jd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function qge(t){return t.dataKey}function Jge(t,e){return oe.isValidElement(t)?oe.cloneElement(t,e):typeof t=="function"?oe.createElement(t,e):oe.createElement(Tge,e)}var Es=function(t){function e(){return Vge(this,e),zge(this,e,arguments)}return Kge(e,t),Wge(e,[{key:"render",value:function(){var n=this,i=this.props,s=i.active,o=i.allowEscapeViewBox,a=i.animationDuration,l=i.animationEasing,c=i.content,u=i.coordinate,h=i.filterNull,d=i.isAnimationActive,f=i.offset,m=i.payload,g=i.payloadUniqBy,v=i.position,w=i.reverseDirection,b=i.useTranslate3d,x=i.viewBox,C=i.wrapperStyle,S=m??[];h&&S.length&&(S=xW(m.filter(function(T){return T.value!=null&&(T.hide!==!0||n.props.includeHidden)}),g,qge));var E=S.length>0;return oe.createElement(jge,{allowEscapeViewBox:o,animationDuration:a,animationEasing:l,isAnimationActive:d,active:s,coordinate:u,hasPayload:E,offset:f,position:v,reverseDirection:w,useTranslate3d:b,viewBox:x,wrapperStyle:C},Jge(c,e$(e$({},this.props),{},{payload:S})))}}])}(G.PureComponent);Z2(Es,"displayName","Tooltip");Z2(Es,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Zu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Zge=ia,Qge=function(){return Zge.Date.now()},eme=Qge,tme=/\s/;function rme(t){for(var e=t.length;e--&&tme.test(t.charAt(e)););return e}var nme=rme,ime=nme,sme=/^\s+/;function ome(t){return t&&t.slice(0,ime(t)+1).replace(sme,"")}var ame=ome,lme=ame,t$=Cc,cme=Df,r$=NaN,ume=/^[-+]0x[0-9a-f]+$/i,hme=/^0b[01]+$/i,dme=/^0o[0-7]+$/i,fme=parseInt;function gme(t){if(typeof t=="number")return t;if(cme(t))return r$;if(t$(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=t$(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=lme(t);var r=hme.test(t);return r||dme.test(t)?fme(t.slice(2),r?2:8):ume.test(t)?r$:+t}var NW=gme,mme=Cc,mE=eme,n$=NW,pme="Expected a function",vme=Math.max,yme=Math.min;function wme(t,e,r){var n,i,s,o,a,l,c=0,u=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(pme);e=n$(e)||0,mme(r)&&(u=!!r.leading,h="maxWait"in r,s=h?vme(n$(r.maxWait)||0,e):s,d="trailing"in r?!!r.trailing:d);function f(E){var T=n,I=i;return n=i=void 0,c=E,o=t.apply(I,T),o}function m(E){return c=E,a=setTimeout(w,e),u?f(E):o}function g(E){var T=E-l,I=E-c,k=e-T;return h?yme(k,s-I):k}function v(E){var T=E-l,I=E-c;return l===void 0||T>=e||T<0||h&&I>=s}function w(){var E=mE();if(v(E))return b(E);a=setTimeout(w,g(E))}function b(E){return a=void 0,d&&n?f(E):(n=i=void 0,o)}function x(){a!==void 0&&clearTimeout(a),c=0,n=l=i=a=void 0}function C(){return a===void 0?o:b(mE())}function S(){var E=mE(),T=v(E);if(n=arguments,i=this,l=E,T){if(a===void 0)return m(l);if(h)return clearTimeout(a),a=setTimeout(w,e),f(l)}return a===void 0&&(a=setTimeout(w,e)),o}return S.cancel=x,S.flush=C,S}var xme=wme,bme=xme,Sme=Cc,Cme="Expected a function";function Eme(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(Cme);return Sme(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),bme(t,e,{leading:n,maxWait:e,trailing:i})}var Tme=Eme;const MW=jt(Tme);function Tp(t){"@babel/helpers - typeof";return Tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tp(t)}function i$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?i$(Object(r),!0).forEach(function(n){_me(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _me(t,e,r){return e=Rme(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rme(t){var e=Ame(t,"string");return Tp(e)=="symbol"?e:e+""}function Ame(t,e){if(Tp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Tp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ome(t,e){return Mme(t)||Nme(t,e)||Ime(t,e)||kme()}function kme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ime(t,e){if(t){if(typeof t=="string")return s$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s$(t,e)}}function s$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Nme(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function Mme(t){if(Array.isArray(t))return t}var Q2=G.forwardRef(function(t,e){var r=t.aspect,n=t.initialDimension,i=n===void 0?{width:-1,height:-1}:n,s=t.width,o=s===void 0?"100%":s,a=t.height,l=a===void 0?"100%":a,c=t.minWidth,u=c===void 0?0:c,h=t.minHeight,d=t.maxHeight,f=t.children,m=t.debounce,g=m===void 0?0:m,v=t.id,w=t.className,b=t.onResize,x=t.style,C=x===void 0?{}:x,S=G.useRef(null),E=G.useRef();E.current=b,G.useImperativeHandle(e,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var T=G.useState({containerWidth:i.width,containerHeight:i.height}),I=Ome(T,2),k=I[0],M=I[1],D=G.useCallback(function(U,J){M(function(X){var ie=Math.round(U),se=Math.round(J);return X.containerWidth===ie&&X.containerHeight===se?X:{containerWidth:ie,containerHeight:se}})},[]);G.useEffect(function(){var U=function(y){var _,R=y[0].contentRect,A=R.width,O=R.height;D(A,O),(_=E.current)===null||_===void 0||_.call(E,A,O)};g>0&&(U=MW(U,g,{trailing:!0,leading:!1}));var J=new ResizeObserver(U),X=S.current.getBoundingClientRect(),ie=X.width,se=X.height;return D(ie,se),J.observe(S.current),function(){J.disconnect()}},[D,g]);var L=G.useMemo(function(){var U=k.containerWidth,J=k.containerHeight;if(U<0||J<0)return null;mo(uu(o)||uu(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),mo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var X=uu(o)?U:o,ie=uu(l)?J:l;r&&r>0&&(X?ie=X/r:ie&&(X=ie*r),d&&ie>d&&(ie=d)),mo(X>0||ie>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,X,ie,o,l,u,h,r);var se=!Array.isArray(f)&&Ba(f.type).endsWith("Chart");return oe.Children.map(f,function(P){return oe.isValidElement(P)?G.cloneElement(P,Vv({width:X,height:ie},se?{style:Vv({height:"100%",width:"100%",maxHeight:ie,maxWidth:X},P.props.style)}:{})):P})},[r,f,l,d,h,u,k,o]);return oe.createElement("div",{id:v?"".concat(v):void 0,className:xt("recharts-responsive-container",w),style:Vv(Vv({},C),{},{width:o,height:l,minWidth:u,minHeight:h,maxHeight:d}),ref:S},L)}),Gb=function(e){return null};Gb.displayName="Cell";function _p(t){"@babel/helpers - typeof";return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_p(t)}function o$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function hA(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?o$(Object(r),!0).forEach(function(n){Pme(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Pme(t,e,r){return e=Dme(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dme(t){var e=Lme(t,"string");return _p(e)=="symbol"?e:e+""}function Lme(t,e){if(_p(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_p(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wh={widthCache:{},cacheCount:0},Fme=2e3,$me={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},a$="recharts_measurement_span";function Hme(t){var e=hA({},t);return Object.keys(e).forEach(function(r){e[r]||delete e[r]}),e}var Tm=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Zu.isSsr)return{width:0,height:0};var n=Hme(r),i=JSON.stringify({text:e,copyStyle:n});if(wh.widthCache[i])return wh.widthCache[i];try{var s=document.getElementById(a$);s||(s=document.createElement("span"),s.setAttribute("id",a$),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var o=hA(hA({},$me),n);Object.assign(s.style,o),s.textContent="".concat(e);var a=s.getBoundingClientRect(),l={width:a.width,height:a.height};return wh.widthCache[i]=l,++wh.cacheCount>Fme&&(wh.cacheCount=0,wh.widthCache={}),l}catch{return{width:0,height:0}}},jme=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Rp(t){"@babel/helpers - typeof";return Rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rp(t)}function Cx(t,e){return Wme(t)||Ume(t,e)||Vme(t,e)||Bme()}function Bme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vme(t,e){if(t){if(typeof t=="string")return l$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l$(t,e)}}function l$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ume(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function Wme(t){if(Array.isArray(t))return t}function zme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yme(n.key),n)}}function Gme(t,e,r){return e&&c$(t.prototype,e),r&&c$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Yme(t){var e=Kme(t,"string");return Rp(e)=="symbol"?e:e+""}function Kme(t,e){if(Rp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Rp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var u$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,h$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Xme=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,qme=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,PW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Jme=Object.keys(PW),ad="NaN";function Zme(t,e){return t*PW[e]}var Uv=function(){function t(e,r){zme(this,t),this.num=e,this.unit=r,this.num=e,this.unit=r,Number.isNaN(e)&&(this.unit=""),r!==""&&!Xme.test(r)&&(this.num=NaN,this.unit=""),Jme.includes(r)&&(this.num=Zme(e,r),this.unit="px")}return Gme(t,[{key:"add",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=qme.exec(r))!==null&&n!==void 0?n:[],s=Cx(i,3),o=s[1],a=s[2];return new t(parseFloat(o),a??"")}}])}();function DW(t){if(t.includes(ad))return ad;for(var e=t;e.includes("*")||e.includes("/");){var r,n=(r=u$.exec(e))!==null&&r!==void 0?r:[],i=Cx(n,4),s=i[1],o=i[2],a=i[3],l=Uv.parse(s??""),c=Uv.parse(a??""),u=o==="*"?l.multiply(c):l.divide(c);if(u.isNaN())return ad;e=e.replace(u$,u.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var h,d=(h=h$.exec(e))!==null&&h!==void 0?h:[],f=Cx(d,4),m=f[1],g=f[2],v=f[3],w=Uv.parse(m??""),b=Uv.parse(v??""),x=g==="+"?w.add(b):w.subtract(b);if(x.isNaN())return ad;e=e.replace(h$,x.toString())}return e}var d$=/\(([^()]*)\)/;function Qme(t){for(var e=t;e.includes("(");){var r=d$.exec(e),n=Cx(r,2),i=n[1];e=e.replace(d$,DW(i))}return e}function epe(t){var e=t.replace(/\s+/g,"");return e=Qme(e),e=DW(e),e}function tpe(t){try{return epe(t)}catch{return ad}}function pE(t){var e=tpe(t.slice(5,-1));return e===ad?"":e}var rpe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],npe=["dx","dy","angle","className","breakAll"];function dA(){return dA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dA.apply(this,arguments)}function f$(t,e){if(t==null)return{};var r=ipe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ipe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function g$(t,e){return lpe(t)||ape(t,e)||ope(t,e)||spe()}function spe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ope(t,e){if(t){if(typeof t=="string")return m$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m$(t,e)}}function m$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ape(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function lpe(t){if(Array.isArray(t))return t}var LW=/[ \f\n\r\t\v\u2028\u2029]+/,FW=function(e){var r=e.children,n=e.breakAll,i=e.style;try{var s=[];dt(r)||(n?s=r.toString().split(""):s=r.toString().split(LW));var o=s.map(function(l){return{word:l,width:Tm(l,i).width}}),a=n?0:Tm("",i).width;return{wordsWithComputedWidth:o,spaceWidth:a}}catch{return null}},cpe=function(e,r,n,i,s){var o=e.maxLines,a=e.children,l=e.style,c=e.breakAll,u=Ue(o),h=a,d=function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return X.reduce(function(ie,se){var P=se.word,y=se.width,_=ie[ie.length-1];if(_&&(i==null||s||_.width+y+n<Number(i)))_.words.push(P),_.width+=y+n;else{var R={words:[P],width:y};ie.push(R)}return ie},[])},f=d(r),m=function(X){return X.reduce(function(ie,se){return ie.width>se.width?ie:se})};if(!u)return f;for(var g="",v=function(X){var ie=h.slice(0,X),se=FW({breakAll:c,style:l,children:ie+g}).wordsWithComputedWidth,P=d(se),y=P.length>o||m(P).width>Number(i);return[y,P]},w=0,b=h.length-1,x=0,C;w<=b&&x<=h.length-1;){var S=Math.floor((w+b)/2),E=S-1,T=v(E),I=g$(T,2),k=I[0],M=I[1],D=v(S),L=g$(D,1),U=L[0];if(!k&&!U&&(w=S+1),k&&U&&(b=S-1),!k&&U){C=M;break}x++}return C||f},p$=function(e){var r=dt(e)?[]:e.toString().split(LW);return[{words:r}]},upe=function(e){var r=e.width,n=e.scaleToFit,i=e.children,s=e.style,o=e.breakAll,a=e.maxLines;if((r||n)&&!Zu.isSsr){var l,c,u=FW({breakAll:o,children:i,style:s});if(u){var h=u.wordsWithComputedWidth,d=u.spaceWidth;l=h,c=d}else return p$(i);return cpe({breakAll:o,children:i,maxLines:a,style:s},l,c,r,n)}return p$(i)},v$="#808080",Lu=function(e){var r=e.x,n=r===void 0?0:r,i=e.y,s=i===void 0?0:i,o=e.lineHeight,a=o===void 0?"1em":o,l=e.capHeight,c=l===void 0?"0.71em":l,u=e.scaleToFit,h=u===void 0?!1:u,d=e.textAnchor,f=d===void 0?"start":d,m=e.verticalAnchor,g=m===void 0?"end":m,v=e.fill,w=v===void 0?v$:v,b=f$(e,rpe),x=G.useMemo(function(){return upe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:h,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,h,b.style,b.width]),C=b.dx,S=b.dy,E=b.angle,T=b.className,I=b.breakAll,k=f$(b,npe);if(!mn(n)||!mn(s))return null;var M=n+(Ue(C)?C:0),D=s+(Ue(S)?S:0),L;switch(g){case"start":L=pE("calc(".concat(c,")"));break;case"middle":L=pE("calc(".concat((x.length-1)/2," * -").concat(a," + (").concat(c," / 2))"));break;default:L=pE("calc(".concat(x.length-1," * -").concat(a,")"));break}var U=[];if(h){var J=x[0].width,X=b.width;U.push("scale(".concat((Ue(X)?X/J:1)/J,")"))}return E&&U.push("rotate(".concat(E,", ").concat(M,", ").concat(D,")")),U.length&&(k.transform=U.join(" ")),oe.createElement("text",dA({},rt(k,!0),{x:M,y:D,className:xt("recharts-text",T),textAnchor:f,fill:w.includes("url")?v$:w}),x.map(function(ie,se){var P=ie.words.join(I?"":" ");return oe.createElement("tspan",{x:M,dy:se===0?L:a,key:"".concat(P,"-").concat(se)},P)}))};function oc(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hpe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eI(t){let e,r,n;t.length!==2?(e=oc,r=(a,l)=>oc(t(a),l),n=(a,l)=>t(a)-l):(e=t===oc||t===hpe?t:dpe,r=t,n=t);function i(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;r(a[h],l)<0?c=h+1:u=h}while(c<u)}return c}function s(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;r(a[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function o(a,l,c=0,u=a.length){const h=i(a,l,c,u-1);return h>c&&n(a[h-1],l)>-n(a[h],l)?h-1:h}return{left:i,center:o,right:s}}function dpe(){return 0}function $W(t){return t===null?NaN:+t}function*fpe(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const gpe=eI(oc),j0=gpe.right;eI($W).center;class y$ extends Map{constructor(e,r=vpe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(w$(this,e))}has(e){return super.has(w$(this,e))}set(e,r){return super.set(mpe(this,e),r)}delete(e){return super.delete(ppe(this,e))}}function w$({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function mpe({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function ppe({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function vpe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function ype(t=oc){if(t===oc)return HW;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function HW(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const wpe=Math.sqrt(50),xpe=Math.sqrt(10),bpe=Math.sqrt(2);function Ex(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=wpe?10:s>=xpe?5:s>=bpe?2:1;let a,l,c;return i<0?(c=Math.pow(10,-i)/o,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*o,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=r&&r<2?Ex(t,e,r*2):[a,l,c]}function fA(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,s,o]=n?Ex(e,t,r):Ex(t,e,r);if(!(s>=i))return[];const a=s-i+1,l=new Array(a);if(n)if(o<0)for(let c=0;c<a;++c)l[c]=(s-c)/-o;else for(let c=0;c<a;++c)l[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)l[c]=(i+c)/-o;else for(let c=0;c<a;++c)l[c]=(i+c)*o;return l}function gA(t,e,r){return e=+e,t=+t,r=+r,Ex(t,e,r)[2]}function mA(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?gA(e,t,r):gA(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function x$(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function b$(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function jW(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?HW:ype(i);n>r;){if(n-r>600){const l=n-r+1,c=e-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),f=Math.max(r,Math.floor(e-c*h/l+d)),m=Math.min(n,Math.floor(e+(l-c)*h/l+d));jW(t,e,f,m,i)}const s=t[e];let o=r,a=n;for(Sg(t,r,e),i(t[n],s)>0&&Sg(t,r,n);o<a;){for(Sg(t,o,a),++o,--a;i(t[o],s)<0;)++o;for(;i(t[a],s)>0;)--a}i(t[r],s)===0?Sg(t,r,a):(++a,Sg(t,a,n)),a<=e&&(r=a+1),e<=a&&(n=a-1)}return t}function Sg(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Spe(t,e,r){if(t=Float64Array.from(fpe(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return b$(t);if(e>=1)return x$(t);var n,i=(n-1)*e,s=Math.floor(i),o=x$(jW(t,s).subarray(0,s+1)),a=b$(t.subarray(s+1));return o+(a-o)*(i-s)}}function Cpe(t,e,r=$W){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,s=Math.floor(i),o=+r(t[s],s,t),a=+r(t[s+1],s+1,t);return o+(a-o)*(i-s)}}function Epe(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(i);++n<i;)s[n]=t+n*r;return s}function js(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function cl(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const pA=Symbol("implicit");function tI(){var t=new y$,e=[],r=[],n=pA;function i(s){let o=t.get(s);if(o===void 0){if(n!==pA)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new y$;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return tI(e,r).unknown(n)},js.apply(i,arguments),i}function Ap(){var t=tI().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,s,o,a=!1,l=0,c=0,u=.5;delete t.unknown;function h(){var d=e().length,f=i<n,m=f?i:n,g=f?n:i;s=(g-m)/Math.max(1,d-l+c*2),a&&(s=Math.floor(s)),m+=(g-m-s*(d-l))*u,o=s*(1-l),a&&(m=Math.round(m),o=Math.round(o));var v=Epe(d).map(function(w){return m+s*w});return r(f?v.reverse():v)}return t.domain=function(d){return arguments.length?(e(d),h()):e()},t.range=function(d){return arguments.length?([n,i]=d,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(d){return[n,i]=d,n=+n,i=+i,a=!0,h()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(d){return arguments.length?(a=!!d,h()):a},t.padding=function(d){return arguments.length?(l=Math.min(1,c=+d),h()):l},t.paddingInner=function(d){return arguments.length?(l=Math.min(1,d),h()):l},t.paddingOuter=function(d){return arguments.length?(c=+d,h()):c},t.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),h()):u},t.copy=function(){return Ap(e(),[n,i]).round(a).paddingInner(l).paddingOuter(c).align(u)},js.apply(h(),arguments)}function BW(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return BW(e())},t}function _m(){return BW(Ap.apply(null,arguments).paddingInner(1))}function rI(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function VW(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function B0(){}var Op=.7,Tx=1/Op,Td="\\s*([+-]?\\d+)\\s*",kp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tpe=/^#([0-9a-f]{3,8})$/,_pe=new RegExp(`^rgb\\(${Td},${Td},${Td}\\)$`),Rpe=new RegExp(`^rgb\\(${Xo},${Xo},${Xo}\\)$`),Ape=new RegExp(`^rgba\\(${Td},${Td},${Td},${kp}\\)$`),Ope=new RegExp(`^rgba\\(${Xo},${Xo},${Xo},${kp}\\)$`),kpe=new RegExp(`^hsl\\(${kp},${Xo},${Xo}\\)$`),Ipe=new RegExp(`^hsla\\(${kp},${Xo},${Xo},${kp}\\)$`),S$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rI(B0,Ip,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:C$,formatHex:C$,formatHex8:Npe,formatHsl:Mpe,formatRgb:E$,toString:E$});function C$(){return this.rgb().formatHex()}function Npe(){return this.rgb().formatHex8()}function Mpe(){return UW(this).formatHsl()}function E$(){return this.rgb().formatRgb()}function Ip(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Tpe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?T$(e):r===3?new Di(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Wv(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Wv(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=_pe.exec(t))?new Di(e[1],e[2],e[3],1):(e=Rpe.exec(t))?new Di(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ape.exec(t))?Wv(e[1],e[2],e[3],e[4]):(e=Ope.exec(t))?Wv(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kpe.exec(t))?A$(e[1],e[2]/100,e[3]/100,1):(e=Ipe.exec(t))?A$(e[1],e[2]/100,e[3]/100,e[4]):S$.hasOwnProperty(t)?T$(S$[t]):t==="transparent"?new Di(NaN,NaN,NaN,0):null}function T$(t){return new Di(t>>16&255,t>>8&255,t&255,1)}function Wv(t,e,r,n){return n<=0&&(t=e=r=NaN),new Di(t,e,r,n)}function Ppe(t){return t instanceof B0||(t=Ip(t)),t?(t=t.rgb(),new Di(t.r,t.g,t.b,t.opacity)):new Di}function vA(t,e,r,n){return arguments.length===1?Ppe(t):new Di(t,e,r,n??1)}function Di(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}rI(Di,vA,VW(B0,{brighter(t){return t=t==null?Tx:Math.pow(Tx,t),new Di(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Op:Math.pow(Op,t),new Di(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Di(bu(this.r),bu(this.g),bu(this.b),_x(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_$,formatHex:_$,formatHex8:Dpe,formatRgb:R$,toString:R$}));function _$(){return`#${hu(this.r)}${hu(this.g)}${hu(this.b)}`}function Dpe(){return`#${hu(this.r)}${hu(this.g)}${hu(this.b)}${hu((isNaN(this.opacity)?1:this.opacity)*255)}`}function R$(){const t=_x(this.opacity);return`${t===1?"rgb(":"rgba("}${bu(this.r)}, ${bu(this.g)}, ${bu(this.b)}${t===1?")":`, ${t})`}`}function _x(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function bu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hu(t){return t=bu(t),(t<16?"0":"")+t.toString(16)}function A$(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ao(t,e,r,n)}function UW(t){if(t instanceof ao)return new ao(t.h,t.s,t.l,t.opacity);if(t instanceof B0||(t=Ip(t)),!t)return new ao;if(t instanceof ao)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(r-n)/a+(r<n)*6:r===s?o=(n-e)/a+2:o=(e-r)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new ao(o,a,l,t.opacity)}function Lpe(t,e,r,n){return arguments.length===1?UW(t):new ao(t,e,r,n??1)}function ao(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}rI(ao,Lpe,VW(B0,{brighter(t){return t=t==null?Tx:Math.pow(Tx,t),new ao(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Op:Math.pow(Op,t),new ao(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Di(vE(t>=240?t-240:t+120,i,n),vE(t,i,n),vE(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new ao(O$(this.h),zv(this.s),zv(this.l),_x(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=_x(this.opacity);return`${t===1?"hsl(":"hsla("}${O$(this.h)}, ${zv(this.s)*100}%, ${zv(this.l)*100}%${t===1?")":`, ${t})`}`}}));function O$(t){return t=(t||0)%360,t<0?t+360:t}function zv(t){return Math.max(0,Math.min(1,t||0))}function vE(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const nI=t=>()=>t;function Fpe(t,e){return function(r){return t+r*e}}function $pe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Hpe(t){return(t=+t)==1?WW:function(e,r){return r-e?$pe(e,r,t):nI(isNaN(e)?r:e)}}function WW(t,e){var r=e-t;return r?Fpe(t,r):nI(isNaN(t)?e:t)}const k$=function t(e){var r=Hpe(e);function n(i,s){var o=r((i=vA(i)).r,(s=vA(s)).r),a=r(i.g,s.g),l=r(i.b,s.b),c=WW(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=l(u),i.opacity=c(u),i+""}}return n.gamma=t,n}(1);function jpe(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(s){for(i=0;i<r;++i)n[i]=t[i]*(1-s)+e[i]*s;return n}}function Bpe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Vpe(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)i[o]=Wf(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(a){for(o=0;o<n;++o)s[o]=i[o](a);return s}}function Upe(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Rx(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Wpe(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Wf(t[i],e[i]):n[i]=e[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var yA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yE=new RegExp(yA.source,"g");function zpe(t){return function(){return t}}function Gpe(t){return function(e){return t(e)+""}}function Ype(t,e){var r=yA.lastIndex=yE.lastIndex=0,n,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(n=yA.exec(t))&&(i=yE.exec(e));)(s=i.index)>r&&(s=e.slice(r,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Rx(n,i)})),r=yE.lastIndex;return r<e.length&&(s=e.slice(r),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?Gpe(l[0].x):zpe(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)a[(h=l[u]).i]=h.x(c);return a.join("")})}function Wf(t,e){var r=typeof e,n;return e==null||r==="boolean"?nI(e):(r==="number"?Rx:r==="string"?(n=Ip(e))?(e=n,k$):Ype:e instanceof Ip?k$:e instanceof Date?Upe:Bpe(e)?jpe:Array.isArray(e)?Vpe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Wpe:Rx)(t,e)}function iI(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Kpe(t,e){e===void 0&&(e=t,t=Wf);for(var r=0,n=e.length-1,i=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(i,i=e[++r]);return function(o){var a=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[a](o-a)}}function Xpe(t){return function(){return t}}function Ax(t){return+t}var I$=[0,1];function vi(t){return t}function wA(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Xpe(isNaN(e)?NaN:.5)}function qpe(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function Jpe(t,e,r){var n=t[0],i=t[1],s=e[0],o=e[1];return i<n?(n=wA(i,n),s=r(o,s)):(n=wA(n,i),s=r(s,o)),function(a){return s(n(a))}}function Zpe(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)i[o]=wA(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(a){var l=j0(t,a,1,n)-1;return s[l](i[l](a))}}function V0(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Yb(){var t=I$,e=I$,r=Wf,n,i,s,o=vi,a,l,c;function u(){var d=Math.min(t.length,e.length);return o!==vi&&(o=qpe(t[0],t[d-1])),a=d>2?Zpe:Jpe,l=c=null,h}function h(d){return d==null||isNaN(d=+d)?s:(l||(l=a(t.map(n),e,r)))(n(o(d)))}return h.invert=function(d){return o(i((c||(c=a(e,t.map(n),Rx)))(d)))},h.domain=function(d){return arguments.length?(t=Array.from(d,Ax),u()):t.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),u()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),r=iI,u()},h.clamp=function(d){return arguments.length?(o=d?!0:vi,u()):o!==vi},h.interpolate=function(d){return arguments.length?(r=d,u()):r},h.unknown=function(d){return arguments.length?(s=d,h):s},function(d,f){return n=d,i=f,u()}}function sI(){return Yb()(vi,vi)}function Qpe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Ox(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Zd(t){return t=Ox(Math.abs(t)),t?t[1]:NaN}function e0e(t,e){return function(r,n){for(var i=r.length,s=[],o=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),s.push(r.substring(i-=a,i+a)),!((l+=a+1)>n));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function t0e(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var r0e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Np(t){if(!(e=r0e.exec(t)))throw new Error("invalid format: "+t);var e;return new oI({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Np.prototype=oI.prototype;function oI(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}oI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function n0e(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var zW;function i0e(t,e){var r=Ox(t,e);if(!r)return t+"";var n=r[0],i=r[1],s=i-(zW=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Ox(t,Math.max(0,e+s-1))[0]}function N$(t,e){var r=Ox(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const M$={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Qpe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>N$(t*100,e),r:N$,s:i0e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function P$(t){return t}var D$=Array.prototype.map,L$=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function s0e(t){var e=t.grouping===void 0||t.thousands===void 0?P$:e0e(D$.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?P$:t0e(D$.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(h){h=Np(h);var d=h.fill,f=h.align,m=h.sign,g=h.symbol,v=h.zero,w=h.width,b=h.comma,x=h.precision,C=h.trim,S=h.type;S==="n"?(b=!0,S="g"):M$[S]||(x===void 0&&(x=12),C=!0,S="g"),(v||d==="0"&&f==="=")&&(v=!0,d="0",f="=");var E=g==="$"?r:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",T=g==="$"?n:/[%p]/.test(S)?o:"",I=M$[S],k=/[defgprs%]/.test(S);x=x===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function M(D){var L=E,U=T,J,X,ie;if(S==="c")U=I(D)+U,D="";else{D=+D;var se=D<0||1/D<0;if(D=isNaN(D)?l:I(Math.abs(D),x),C&&(D=n0e(D)),se&&+D==0&&m!=="+"&&(se=!1),L=(se?m==="("?m:a:m==="-"||m==="("?"":m)+L,U=(S==="s"?L$[8+zW/3]:"")+U+(se&&m==="("?")":""),k){for(J=-1,X=D.length;++J<X;)if(ie=D.charCodeAt(J),48>ie||ie>57){U=(ie===46?i+D.slice(J+1):D.slice(J))+U,D=D.slice(0,J);break}}}b&&!v&&(D=e(D,1/0));var P=L.length+D.length+U.length,y=P<w?new Array(w-P+1).join(d):"";switch(b&&v&&(D=e(y+D,y.length?w-U.length:1/0),y=""),f){case"<":D=L+D+U+y;break;case"=":D=L+y+D+U;break;case"^":D=y.slice(0,P=y.length>>1)+L+D+U+y.slice(P);break;default:D=y+L+D+U;break}return s(D)}return M.toString=function(){return h+""},M}function u(h,d){var f=c((h=Np(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(Zd(d)/3)))*3,g=Math.pow(10,-m),v=L$[8+m/3];return function(w){return f(g*w)+v}}return{format:c,formatPrefix:u}}var Gv,aI,GW;o0e({thousands:",",grouping:[3],currency:["$",""]});function o0e(t){return Gv=s0e(t),aI=Gv.format,GW=Gv.formatPrefix,Gv}function a0e(t){return Math.max(0,-Zd(Math.abs(t)))}function l0e(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zd(e)/3)))*3-Zd(Math.abs(t)))}function c0e(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Zd(e)-Zd(t))+1}function YW(t,e,r,n){var i=mA(t,e,r),s;switch(n=Np(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=l0e(i,o))&&(n.precision=s),GW(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=c0e(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=a0e(i))&&(n.precision=s-(n.type==="%")*2);break}}return aI(n)}function Ec(t){var e=t.domain;return t.ticks=function(r){var n=e();return fA(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return YW(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,s=n.length-1,o=n[i],a=n[s],l,c,u=10;for(a<o&&(c=o,o=a,a=c,c=i,i=s,s=c);u-- >0;){if(c=gA(o,a,r),c===l)return n[i]=o,n[s]=a,e(n);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return t},t}function kx(){var t=sI();return t.copy=function(){return V0(t,kx())},js.apply(t,arguments),Ec(t)}function KW(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Ax),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return KW(t).unknown(e)},t=arguments.length?Array.from(t,Ax):[0,1],Ec(r)}function XW(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],s=t[n],o;return s<i&&(o=r,r=n,n=o,o=i,i=s,s=o),t[r]=e.floor(i),t[n]=e.ceil(s),t}function F$(t){return Math.log(t)}function $$(t){return Math.exp(t)}function u0e(t){return-Math.log(-t)}function h0e(t){return-Math.exp(-t)}function d0e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function f0e(t){return t===10?d0e:t===Math.E?Math.exp:e=>Math.pow(t,e)}function g0e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function H$(t){return(e,r)=>-t(-e,r)}function lI(t){const e=t(F$,$$),r=e.domain;let n=10,i,s;function o(){return i=g0e(n),s=f0e(n),r()[0]<0?(i=H$(i),s=H$(s),t(u0e,h0e)):t(F$,$$),e}return e.base=function(a){return arguments.length?(n=+a,o()):n},e.domain=function(a){return arguments.length?(r(a),o()):r()},e.ticks=a=>{const l=r();let c=l[0],u=l[l.length-1];const h=u<c;h&&([c,u]=[u,c]);let d=i(c),f=i(u),m,g;const v=a==null?10:+a;let w=[];if(!(n%1)&&f-d<v){if(d=Math.floor(d),f=Math.ceil(f),c>0){for(;d<=f;++d)for(m=1;m<n;++m)if(g=d<0?m/s(-d):m*s(d),!(g<c)){if(g>u)break;w.push(g)}}else for(;d<=f;++d)for(m=n-1;m>=1;--m)if(g=d>0?m/s(-d):m*s(d),!(g<c)){if(g>u)break;w.push(g)}w.length*2<v&&(w=fA(c,u,v))}else w=fA(d,f,Math.min(f-d,v)).map(s);return h?w.reverse():w},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Np(l)).precision==null&&(l.trim=!0),l=aI(l)),a===1/0)return l;const c=Math.max(1,n*a/e.ticks().length);return u=>{let h=u/s(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=c?l(u):""}},e.nice=()=>r(XW(r(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),e}function qW(){const t=lI(Yb()).domain([1,10]);return t.copy=()=>V0(t,qW()).base(t.base()),js.apply(t,arguments),t}function j$(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function B$(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function cI(t){var e=1,r=t(j$(e),B$(e));return r.constant=function(n){return arguments.length?t(j$(e=+n),B$(e)):e},Ec(r)}function JW(){var t=cI(Yb());return t.copy=function(){return V0(t,JW()).constant(t.constant())},js.apply(t,arguments)}function V$(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function m0e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function p0e(t){return t<0?-t*t:t*t}function uI(t){var e=t(vi,vi),r=1;function n(){return r===1?t(vi,vi):r===.5?t(m0e,p0e):t(V$(r),V$(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},Ec(e)}function hI(){var t=uI(Yb());return t.copy=function(){return V0(t,hI()).exponent(t.exponent())},js.apply(t,arguments),t}function v0e(){return hI.apply(null,arguments).exponent(.5)}function U$(t){return Math.sign(t)*t*t}function y0e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function ZW(){var t=sI(),e=[0,1],r=!1,n;function i(s){var o=y0e(t(s));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(s){return t.invert(U$(s))},i.domain=function(s){return arguments.length?(t.domain(s),i):t.domain()},i.range=function(s){return arguments.length?(t.range((e=Array.from(s,Ax)).map(U$)),i):e.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(t.clamp(s),i):t.clamp()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return ZW(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},js.apply(i,arguments),Ec(i)}function QW(){var t=[],e=[],r=[],n;function i(){var o=0,a=Math.max(1,e.length);for(r=new Array(a-1);++o<a;)r[o-1]=Cpe(t,o/a);return s}function s(o){return o==null||isNaN(o=+o)?n:e[j0(r,o)]}return s.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let a of o)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(oc),i()},s.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return QW().domain(t).range(e).unknown(n)},js.apply(s,arguments)}function e7(){var t=0,e=1,r=1,n=[.5],i=[0,1],s;function o(l){return l!=null&&l<=l?i[j0(n,l,0,r)]:s}function a(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*e-(l-r)*t)/(r+1);return o}return o.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,a()):[t,e]},o.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,a()):i.slice()},o.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[t,n[0]]:c>=r?[n[r-1],e]:[n[c-1],n[c]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return e7().domain([t,e]).range(i).unknown(s)},js.apply(Ec(o),arguments)}function t7(){var t=[.5],e=[0,1],r,n=1;function i(s){return s!=null&&s<=s?e[j0(t,s,0,n)]:r}return i.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return t7().domain(t).range(e).unknown(r)},js.apply(i,arguments)}const wE=new Date,xE=new Date;function xn(t,e,r,n){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const l=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;let c;do l.push(c=new Date(+s)),e(s,a),t(s);while(c<s&&s<o);return l},i.filter=s=>xn(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););}),r&&(i.count=(s,o)=>(wE.setTime(+s),xE.setTime(+o),t(wE),t(xE),Math.floor(r(wE,xE))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?o=>n(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Ix=xn(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Ix.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?xn(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Ix);Ix.range;const Ma=1e3,ks=Ma*60,Pa=ks*60,el=Pa*24,dI=el*7,W$=el*30,bE=el*365,du=xn(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Ma)},(t,e)=>(e-t)/Ma,t=>t.getUTCSeconds());du.range;const fI=xn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ma)},(t,e)=>{t.setTime(+t+e*ks)},(t,e)=>(e-t)/ks,t=>t.getMinutes());fI.range;const gI=xn(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*ks)},(t,e)=>(e-t)/ks,t=>t.getUTCMinutes());gI.range;const mI=xn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ma-t.getMinutes()*ks)},(t,e)=>{t.setTime(+t+e*Pa)},(t,e)=>(e-t)/Pa,t=>t.getHours());mI.range;const pI=xn(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Pa)},(t,e)=>(e-t)/Pa,t=>t.getUTCHours());pI.range;const U0=xn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ks)/el,t=>t.getDate()-1);U0.range;const Kb=xn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/el,t=>t.getUTCDate()-1);Kb.range;const r7=xn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/el,t=>Math.floor(t/el));r7.range;function Qu(t){return xn(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*ks)/dI)}const Xb=Qu(0),Nx=Qu(1),w0e=Qu(2),x0e=Qu(3),Qd=Qu(4),b0e=Qu(5),S0e=Qu(6);Xb.range;Nx.range;w0e.range;x0e.range;Qd.range;b0e.range;S0e.range;function eh(t){return xn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/dI)}const qb=eh(0),Mx=eh(1),C0e=eh(2),E0e=eh(3),ef=eh(4),T0e=eh(5),_0e=eh(6);qb.range;Mx.range;C0e.range;E0e.range;ef.range;T0e.range;_0e.range;const vI=xn(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());vI.range;const yI=xn(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());yI.range;const tl=xn(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());tl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xn(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});tl.range;const rl=xn(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());rl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});rl.range;function n7(t,e,r,n,i,s){const o=[[du,1,Ma],[du,5,5*Ma],[du,15,15*Ma],[du,30,30*Ma],[s,1,ks],[s,5,5*ks],[s,15,15*ks],[s,30,30*ks],[i,1,Pa],[i,3,3*Pa],[i,6,6*Pa],[i,12,12*Pa],[n,1,el],[n,2,2*el],[r,1,dI],[e,1,W$],[e,3,3*W$],[t,1,bE]];function a(c,u,h){const d=u<c;d&&([c,u]=[u,c]);const f=h&&typeof h.range=="function"?h:l(c,u,h),m=f?f.range(c,+u+1):[];return d?m.reverse():m}function l(c,u,h){const d=Math.abs(u-c)/h,f=eI(([,,v])=>v).right(o,d);if(f===o.length)return t.every(mA(c/bE,u/bE,h));if(f===0)return Ix.every(Math.max(mA(c,u,h),1));const[m,g]=o[d/o[f-1][2]<o[f][2]/d?f-1:f];return m.every(g)}return[a,l]}const[R0e,A0e]=n7(rl,yI,qb,r7,pI,gI),[O0e,k0e]=n7(tl,vI,Xb,U0,mI,fI);function SE(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function CE(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Cg(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function I0e(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,s=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,c=Eg(i),u=Tg(i),h=Eg(s),d=Tg(s),f=Eg(o),m=Tg(o),g=Eg(a),v=Tg(a),w=Eg(l),b=Tg(l),x={a:se,A:P,b:y,B:_,c:null,d:q$,e:q$,f:eve,g:uve,G:dve,H:J0e,I:Z0e,j:Q0e,L:i7,m:tve,M:rve,p:R,q:A,Q:Q$,s:eH,S:nve,u:ive,U:sve,V:ove,w:ave,W:lve,x:null,X:null,y:cve,Y:hve,Z:fve,"%":Z$},C={a:O,A:N,b:F,B:j,c:null,d:J$,e:J$,f:vve,g:Rve,G:Ove,H:gve,I:mve,j:pve,L:o7,m:yve,M:wve,p:z,q:Q,Q:Q$,s:eH,S:xve,u:bve,U:Sve,V:Cve,w:Eve,W:Tve,x:null,X:null,y:_ve,Y:Ave,Z:kve,"%":Z$},S={a:M,A:D,b:L,B:U,c:J,d:K$,e:K$,f:Y0e,g:Y$,G:G$,H:X$,I:X$,j:U0e,L:G0e,m:V0e,M:W0e,p:k,q:B0e,Q:X0e,s:q0e,S:z0e,u:L0e,U:F0e,V:$0e,w:D0e,W:H0e,x:X,X:ie,y:Y$,Y:G$,Z:j0e,"%":K0e};x.x=E(r,x),x.X=E(n,x),x.c=E(e,x),C.x=E(r,C),C.X=E(n,C),C.c=E(e,C);function E(W,ae){return function(ye){var H=[],Re=-1,ue=0,Pe=W.length,ke,be,Fe;for(ye instanceof Date||(ye=new Date(+ye));++Re<Pe;)W.charCodeAt(Re)===37&&(H.push(W.slice(ue,Re)),(be=z$[ke=W.charAt(++Re)])!=null?ke=W.charAt(++Re):be=ke==="e"?" ":"0",(Fe=ae[ke])&&(ke=Fe(ye,be)),H.push(ke),ue=Re+1);return H.push(W.slice(ue,Re)),H.join("")}}function T(W,ae){return function(ye){var H=Cg(1900,void 0,1),Re=I(H,W,ye+="",0),ue,Pe;if(Re!=ye.length)return null;if("Q"in H)return new Date(H.Q);if("s"in H)return new Date(H.s*1e3+("L"in H?H.L:0));if(ae&&!("Z"in H)&&(H.Z=0),"p"in H&&(H.H=H.H%12+H.p*12),H.m===void 0&&(H.m="q"in H?H.q:0),"V"in H){if(H.V<1||H.V>53)return null;"w"in H||(H.w=1),"Z"in H?(ue=CE(Cg(H.y,0,1)),Pe=ue.getUTCDay(),ue=Pe>4||Pe===0?Mx.ceil(ue):Mx(ue),ue=Kb.offset(ue,(H.V-1)*7),H.y=ue.getUTCFullYear(),H.m=ue.getUTCMonth(),H.d=ue.getUTCDate()+(H.w+6)%7):(ue=SE(Cg(H.y,0,1)),Pe=ue.getDay(),ue=Pe>4||Pe===0?Nx.ceil(ue):Nx(ue),ue=U0.offset(ue,(H.V-1)*7),H.y=ue.getFullYear(),H.m=ue.getMonth(),H.d=ue.getDate()+(H.w+6)%7)}else("W"in H||"U"in H)&&("w"in H||(H.w="u"in H?H.u%7:"W"in H?1:0),Pe="Z"in H?CE(Cg(H.y,0,1)).getUTCDay():SE(Cg(H.y,0,1)).getDay(),H.m=0,H.d="W"in H?(H.w+6)%7+H.W*7-(Pe+5)%7:H.w+H.U*7-(Pe+6)%7);return"Z"in H?(H.H+=H.Z/100|0,H.M+=H.Z%100,CE(H)):SE(H)}}function I(W,ae,ye,H){for(var Re=0,ue=ae.length,Pe=ye.length,ke,be;Re<ue;){if(H>=Pe)return-1;if(ke=ae.charCodeAt(Re++),ke===37){if(ke=ae.charAt(Re++),be=S[ke in z$?ae.charAt(Re++):ke],!be||(H=be(W,ye,H))<0)return-1}else if(ke!=ye.charCodeAt(H++))return-1}return H}function k(W,ae,ye){var H=c.exec(ae.slice(ye));return H?(W.p=u.get(H[0].toLowerCase()),ye+H[0].length):-1}function M(W,ae,ye){var H=f.exec(ae.slice(ye));return H?(W.w=m.get(H[0].toLowerCase()),ye+H[0].length):-1}function D(W,ae,ye){var H=h.exec(ae.slice(ye));return H?(W.w=d.get(H[0].toLowerCase()),ye+H[0].length):-1}function L(W,ae,ye){var H=w.exec(ae.slice(ye));return H?(W.m=b.get(H[0].toLowerCase()),ye+H[0].length):-1}function U(W,ae,ye){var H=g.exec(ae.slice(ye));return H?(W.m=v.get(H[0].toLowerCase()),ye+H[0].length):-1}function J(W,ae,ye){return I(W,e,ae,ye)}function X(W,ae,ye){return I(W,r,ae,ye)}function ie(W,ae,ye){return I(W,n,ae,ye)}function se(W){return o[W.getDay()]}function P(W){return s[W.getDay()]}function y(W){return l[W.getMonth()]}function _(W){return a[W.getMonth()]}function R(W){return i[+(W.getHours()>=12)]}function A(W){return 1+~~(W.getMonth()/3)}function O(W){return o[W.getUTCDay()]}function N(W){return s[W.getUTCDay()]}function F(W){return l[W.getUTCMonth()]}function j(W){return a[W.getUTCMonth()]}function z(W){return i[+(W.getUTCHours()>=12)]}function Q(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var ae=E(W+="",x);return ae.toString=function(){return W},ae},parse:function(W){var ae=T(W+="",!1);return ae.toString=function(){return W},ae},utcFormat:function(W){var ae=E(W+="",C);return ae.toString=function(){return W},ae},utcParse:function(W){var ae=T(W+="",!0);return ae.toString=function(){return W},ae}}}var z$={"-":"",_:" ",0:"0"},kn=/^\s*\d+/,N0e=/^%/,M0e=/[\\^$*+?|[\]().{}]/g;function Ht(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",s=i.length;return n+(s<r?new Array(r-s+1).join(e)+i:i)}function P0e(t){return t.replace(M0e,"\\$&")}function Eg(t){return new RegExp("^(?:"+t.map(P0e).join("|")+")","i")}function Tg(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function D0e(t,e,r){var n=kn.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function L0e(t,e,r){var n=kn.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function F0e(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function $0e(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function H0e(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function G$(t,e,r){var n=kn.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Y$(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function j0e(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function B0e(t,e,r){var n=kn.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function V0e(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function K$(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function U0e(t,e,r){var n=kn.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function X$(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function W0e(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function z0e(t,e,r){var n=kn.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function G0e(t,e,r){var n=kn.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function Y0e(t,e,r){var n=kn.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function K0e(t,e,r){var n=N0e.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function X0e(t,e,r){var n=kn.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function q0e(t,e,r){var n=kn.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function q$(t,e){return Ht(t.getDate(),e,2)}function J0e(t,e){return Ht(t.getHours(),e,2)}function Z0e(t,e){return Ht(t.getHours()%12||12,e,2)}function Q0e(t,e){return Ht(1+U0.count(tl(t),t),e,3)}function i7(t,e){return Ht(t.getMilliseconds(),e,3)}function eve(t,e){return i7(t,e)+"000"}function tve(t,e){return Ht(t.getMonth()+1,e,2)}function rve(t,e){return Ht(t.getMinutes(),e,2)}function nve(t,e){return Ht(t.getSeconds(),e,2)}function ive(t){var e=t.getDay();return e===0?7:e}function sve(t,e){return Ht(Xb.count(tl(t)-1,t),e,2)}function s7(t){var e=t.getDay();return e>=4||e===0?Qd(t):Qd.ceil(t)}function ove(t,e){return t=s7(t),Ht(Qd.count(tl(t),t)+(tl(t).getDay()===4),e,2)}function ave(t){return t.getDay()}function lve(t,e){return Ht(Nx.count(tl(t)-1,t),e,2)}function cve(t,e){return Ht(t.getFullYear()%100,e,2)}function uve(t,e){return t=s7(t),Ht(t.getFullYear()%100,e,2)}function hve(t,e){return Ht(t.getFullYear()%1e4,e,4)}function dve(t,e){var r=t.getDay();return t=r>=4||r===0?Qd(t):Qd.ceil(t),Ht(t.getFullYear()%1e4,e,4)}function fve(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ht(e/60|0,"0",2)+Ht(e%60,"0",2)}function J$(t,e){return Ht(t.getUTCDate(),e,2)}function gve(t,e){return Ht(t.getUTCHours(),e,2)}function mve(t,e){return Ht(t.getUTCHours()%12||12,e,2)}function pve(t,e){return Ht(1+Kb.count(rl(t),t),e,3)}function o7(t,e){return Ht(t.getUTCMilliseconds(),e,3)}function vve(t,e){return o7(t,e)+"000"}function yve(t,e){return Ht(t.getUTCMonth()+1,e,2)}function wve(t,e){return Ht(t.getUTCMinutes(),e,2)}function xve(t,e){return Ht(t.getUTCSeconds(),e,2)}function bve(t){var e=t.getUTCDay();return e===0?7:e}function Sve(t,e){return Ht(qb.count(rl(t)-1,t),e,2)}function a7(t){var e=t.getUTCDay();return e>=4||e===0?ef(t):ef.ceil(t)}function Cve(t,e){return t=a7(t),Ht(ef.count(rl(t),t)+(rl(t).getUTCDay()===4),e,2)}function Eve(t){return t.getUTCDay()}function Tve(t,e){return Ht(Mx.count(rl(t)-1,t),e,2)}function _ve(t,e){return Ht(t.getUTCFullYear()%100,e,2)}function Rve(t,e){return t=a7(t),Ht(t.getUTCFullYear()%100,e,2)}function Ave(t,e){return Ht(t.getUTCFullYear()%1e4,e,4)}function Ove(t,e){var r=t.getUTCDay();return t=r>=4||r===0?ef(t):ef.ceil(t),Ht(t.getUTCFullYear()%1e4,e,4)}function kve(){return"+0000"}function Z$(){return"%"}function Q$(t){return+t}function eH(t){return Math.floor(+t/1e3)}var xh,l7,c7;Ive({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ive(t){return xh=I0e(t),l7=xh.format,xh.parse,c7=xh.utcFormat,xh.utcParse,xh}function Nve(t){return new Date(t)}function Mve(t){return t instanceof Date?+t:+new Date(+t)}function wI(t,e,r,n,i,s,o,a,l,c){var u=sI(),h=u.invert,d=u.domain,f=c(".%L"),m=c(":%S"),g=c("%I:%M"),v=c("%I %p"),w=c("%a %d"),b=c("%b %d"),x=c("%B"),C=c("%Y");function S(E){return(l(E)<E?f:a(E)<E?m:o(E)<E?g:s(E)<E?v:n(E)<E?i(E)<E?w:b:r(E)<E?x:C)(E)}return u.invert=function(E){return new Date(h(E))},u.domain=function(E){return arguments.length?d(Array.from(E,Mve)):d().map(Nve)},u.ticks=function(E){var T=d();return t(T[0],T[T.length-1],E??10)},u.tickFormat=function(E,T){return T==null?S:c(T)},u.nice=function(E){var T=d();return(!E||typeof E.range!="function")&&(E=e(T[0],T[T.length-1],E??10)),E?d(XW(T,E)):u},u.copy=function(){return V0(u,wI(t,e,r,n,i,s,o,a,l,c))},u}function Pve(){return js.apply(wI(O0e,k0e,tl,vI,Xb,U0,mI,fI,du,l7).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Dve(){return js.apply(wI(R0e,A0e,rl,yI,qb,Kb,pI,gI,du,c7).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Jb(){var t=0,e=1,r,n,i,s,o=vi,a=!1,l;function c(h){return h==null||isNaN(h=+h)?l:o(i===0?.5:(h=(s(h)-r)*i,a?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([t,e]=h,r=s(t=+t),n=s(e=+e),i=r===n?0:1/(n-r),c):[t,e]},c.clamp=function(h){return arguments.length?(a=!!h,c):a},c.interpolator=function(h){return arguments.length?(o=h,c):o};function u(h){return function(d){var f,m;return arguments.length?([f,m]=d,o=h(f,m),c):[o(0),o(1)]}}return c.range=u(Wf),c.rangeRound=u(iI),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return s=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),c}}function Tc(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function u7(){var t=Ec(Jb()(vi));return t.copy=function(){return Tc(t,u7())},cl.apply(t,arguments)}function h7(){var t=lI(Jb()).domain([1,10]);return t.copy=function(){return Tc(t,h7()).base(t.base())},cl.apply(t,arguments)}function d7(){var t=cI(Jb());return t.copy=function(){return Tc(t,d7()).constant(t.constant())},cl.apply(t,arguments)}function xI(){var t=uI(Jb());return t.copy=function(){return Tc(t,xI()).exponent(t.exponent())},cl.apply(t,arguments)}function Lve(){return xI.apply(null,arguments).exponent(.5)}function f7(){var t=[],e=vi;function r(n){if(n!=null&&!isNaN(n=+n))return e((j0(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(oc),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,s)=>Spe(t,s/n))},r.copy=function(){return f7(e).domain(t)},cl.apply(r,arguments)}function Zb(){var t=0,e=.5,r=1,n=1,i,s,o,a,l,c=vi,u,h=!1,d;function f(g){return isNaN(g=+g)?d:(g=.5+((g=+u(g))-s)*(n*g<n*s?a:l),c(h?Math.max(0,Math.min(1,g)):g))}f.domain=function(g){return arguments.length?([t,e,r]=g,i=u(t=+t),s=u(e=+e),o=u(r=+r),a=i===s?0:.5/(s-i),l=s===o?0:.5/(o-s),n=s<i?-1:1,f):[t,e,r]},f.clamp=function(g){return arguments.length?(h=!!g,f):h},f.interpolator=function(g){return arguments.length?(c=g,f):c};function m(g){return function(v){var w,b,x;return arguments.length?([w,b,x]=v,c=Kpe(g,[w,b,x]),f):[c(0),c(.5),c(1)]}}return f.range=m(Wf),f.rangeRound=m(iI),f.unknown=function(g){return arguments.length?(d=g,f):d},function(g){return u=g,i=g(t),s=g(e),o=g(r),a=i===s?0:.5/(s-i),l=s===o?0:.5/(o-s),n=s<i?-1:1,f}}function g7(){var t=Ec(Zb()(vi));return t.copy=function(){return Tc(t,g7())},cl.apply(t,arguments)}function m7(){var t=lI(Zb()).domain([.1,1,10]);return t.copy=function(){return Tc(t,m7()).base(t.base())},cl.apply(t,arguments)}function p7(){var t=cI(Zb());return t.copy=function(){return Tc(t,p7()).constant(t.constant())},cl.apply(t,arguments)}function bI(){var t=uI(Zb());return t.copy=function(){return Tc(t,bI()).exponent(t.exponent())},cl.apply(t,arguments)}function Fve(){return bI.apply(null,arguments).exponent(.5)}const tH=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ap,scaleDiverging:g7,scaleDivergingLog:m7,scaleDivergingPow:bI,scaleDivergingSqrt:Fve,scaleDivergingSymlog:p7,scaleIdentity:KW,scaleImplicit:pA,scaleLinear:kx,scaleLog:qW,scaleOrdinal:tI,scalePoint:_m,scalePow:hI,scaleQuantile:QW,scaleQuantize:e7,scaleRadial:ZW,scaleSequential:u7,scaleSequentialLog:h7,scaleSequentialPow:xI,scaleSequentialQuantile:f7,scaleSequentialSqrt:Lve,scaleSequentialSymlog:d7,scaleSqrt:v0e,scaleSymlog:JW,scaleThreshold:t7,scaleTime:Pve,scaleUtc:Dve,tickFormat:YW},Symbol.toStringTag,{value:"Module"}));var $ve=Df;function Hve(t,e,r){for(var n=-1,i=t.length;++n<i;){var s=t[n],o=e(s);if(o!=null&&(a===void 0?o===o&&!$ve(o):r(o,a)))var a=o,l=s}return l}var Qb=Hve;function jve(t,e){return t>e}var v7=jve,Bve=Qb,Vve=v7,Uve=Uf;function Wve(t){return t&&t.length?Bve(t,Uve,Vve):void 0}var zve=Wve;const eS=jt(zve);function Gve(t,e){return t<e}var y7=Gve,Yve=Qb,Kve=y7,Xve=Uf;function qve(t){return t&&t.length?Yve(t,Xve,Kve):void 0}var Jve=qve;const tS=jt(Jve);var Zve=P2,Qve=sa,eye=_W,tye=ji;function rye(t,e){var r=tye(t)?Zve:eye;return r(t,Qve(e))}var nye=rye,iye=EW,sye=nye;function oye(t,e){return iye(sye(t,e),1)}var aye=oye;const lye=jt(aye);var cye=X2;function uye(t,e){return cye(t,e)}var hye=uye;const W0=jt(hye);var zf=1e9,dye={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},CI,Or=!0,Ps="[DecimalError] ",Su=Ps+"Invalid argument: ",SI=Ps+"Exponent out of range: ",Gf=Math.floor,nu=Math.pow,fye=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Qi,Sn=1e7,wr=7,w7=9007199254740991,Px=Gf(w7/wr),qe={};qe.absoluteValue=qe.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};qe.comparedTo=qe.cmp=function(t){var e,r,n,i,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===i?0:n>i^s.s<0?1:-1};qe.decimalPlaces=qe.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*wr;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};qe.dividedBy=qe.div=function(t){return Va(this,new this.constructor(t))};qe.dividedToIntegerBy=qe.idiv=function(t){var e=this,r=e.constructor;return er(Va(e,new r(t),0,1),r.precision)};qe.equals=qe.eq=function(t){return!this.cmp(t)};qe.exponent=function(){return ln(this)};qe.greaterThan=qe.gt=function(t){return this.cmp(t)>0};qe.greaterThanOrEqualTo=qe.gte=function(t){return this.cmp(t)>=0};qe.isInteger=qe.isint=function(){return this.e>this.d.length-2};qe.isNegative=qe.isneg=function(){return this.s<0};qe.isPositive=qe.ispos=function(){return this.s>0};qe.isZero=function(){return this.s===0};qe.lessThan=qe.lt=function(t){return this.cmp(t)<0};qe.lessThanOrEqualTo=qe.lte=function(t){return this.cmp(t)<1};qe.logarithm=qe.log=function(t){var e,r=this,n=r.constructor,i=n.precision,s=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Qi))throw Error(Ps+"NaN");if(r.s<1)throw Error(Ps+(r.s?"NaN":"-Infinity"));return r.eq(Qi)?new n(0):(Or=!1,e=Va(Mp(r,s),Mp(t,s),s),Or=!0,er(e,i))};qe.minus=qe.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?S7(e,t):x7(e,(t.s=-t.s,t))};qe.modulo=qe.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(Ps+"NaN");return r.s?(Or=!1,e=Va(r,t,0,1).times(t),Or=!0,r.minus(e)):er(new n(r),i)};qe.naturalExponential=qe.exp=function(){return b7(this)};qe.naturalLogarithm=qe.ln=function(){return Mp(this)};qe.negated=qe.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};qe.plus=qe.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?x7(e,t):S7(e,(t.s=-t.s,t))};qe.precision=qe.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Su+t);if(e=ln(i)+1,n=i.d.length-1,r=n*wr+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};qe.squareRoot=qe.sqrt=function(){var t,e,r,n,i,s,o,a=this,l=a.constructor;if(a.s<1){if(!a.s)return new l(0);throw Error(Ps+"NaN")}for(t=ln(a),Or=!1,i=Math.sqrt(+a),i==0||i==1/0?(e=zo(a.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Gf((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new l(e)):n=new l(i.toString()),r=l.precision,i=o=r+3;;)if(s=n,n=s.plus(Va(a,s,o+2)).times(.5),zo(s.d).slice(0,o)===(e=zo(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(er(s,r+1,0),s.times(s).eq(a)){n=s;break}}else if(e!="9999")break;o+=4}return Or=!0,er(n,r)};qe.times=qe.mul=function(t){var e,r,n,i,s,o,a,l,c,u=this,h=u.constructor,d=u.d,f=(t=new h(t)).d;if(!u.s||!t.s)return new h(0);for(t.s*=u.s,r=u.e+t.e,l=d.length,c=f.length,l<c&&(s=d,d=f,f=s,o=l,l=c,c=o),s=[],o=l+c,n=o;n--;)s.push(0);for(n=c;--n>=0;){for(e=0,i=l+n;i>n;)a=s[i]+f[n]*d[i-n-1]+e,s[i--]=a%Sn|0,e=a/Sn|0;s[i]=(s[i]+e)%Sn|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,Or?er(t,h.precision):t};qe.toDecimalPlaces=qe.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Zo(t,0,zf),e===void 0?e=n.rounding:Zo(e,0,8),er(r,t+ln(r)+1,e))};qe.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Fu(n,!0):(Zo(t,0,zf),e===void 0?e=i.rounding:Zo(e,0,8),n=er(new i(n),t+1,e),r=Fu(n,!0,t+1)),r};qe.toFixed=function(t,e){var r,n,i=this,s=i.constructor;return t===void 0?Fu(i):(Zo(t,0,zf),e===void 0?e=s.rounding:Zo(e,0,8),n=er(new s(i),t+ln(i)+1,e),r=Fu(n.abs(),!1,t+ln(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};qe.toInteger=qe.toint=function(){var t=this,e=t.constructor;return er(new e(t),ln(t)+1,e.rounding)};qe.toNumber=function(){return+this};qe.toPower=qe.pow=function(t){var e,r,n,i,s,o,a=this,l=a.constructor,c=12,u=+(t=new l(t));if(!t.s)return new l(Qi);if(a=new l(a),!a.s){if(t.s<1)throw Error(Ps+"Infinity");return a}if(a.eq(Qi))return a;if(n=l.precision,t.eq(Qi))return er(a,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=a.s,o){if((r=u<0?-u:u)<=w7){for(i=new l(Qi),e=Math.ceil(n/wr+4),Or=!1;r%2&&(i=i.times(a),nH(i.d,e)),r=Gf(r/2),r!==0;)a=a.times(a),nH(a.d,e);return Or=!0,t.s<0?new l(Qi).div(i):er(i,n)}}else if(s<0)throw Error(Ps+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,a.s=1,Or=!1,i=t.times(Mp(a,n+c)),Or=!0,i=b7(i),i.s=s,i};qe.toPrecision=function(t,e){var r,n,i=this,s=i.constructor;return t===void 0?(r=ln(i),n=Fu(i,r<=s.toExpNeg||r>=s.toExpPos)):(Zo(t,1,zf),e===void 0?e=s.rounding:Zo(e,0,8),i=er(new s(i),t,e),r=ln(i),n=Fu(i,t<=r||r<=s.toExpNeg,t)),n};qe.toSignificantDigits=qe.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Zo(t,1,zf),e===void 0?e=n.rounding:Zo(e,0,8)),er(new n(r),t,e)};qe.toString=qe.valueOf=qe.val=qe.toJSON=qe[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=ln(t),r=t.constructor;return Fu(t,e<=r.toExpNeg||e>=r.toExpPos)};function x7(t,e){var r,n,i,s,o,a,l,c,u=t.constructor,h=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Or?er(e,h):e;if(l=t.d,c=e.d,o=t.e,i=e.e,l=l.slice(),s=o-i,s){for(s<0?(n=l,s=-s,a=c.length):(n=c,i=o,a=l.length),o=Math.ceil(h/wr),a=o>a?o+1:a+1,s>a&&(s=a,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(a=l.length,s=c.length,a-s<0&&(s=a,n=c,c=l,l=n),r=0;s;)r=(l[--s]=l[s]+c[s]+r)/Sn|0,l[s]%=Sn;for(r&&(l.unshift(r),++i),a=l.length;l[--a]==0;)l.pop();return e.d=l,e.e=i,Or?er(e,h):e}function Zo(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Su+t)}function zo(t){var e,r,n,i=t.length-1,s="",o=t[0];if(i>0){for(s+=o,e=1;e<i;e++)n=t[e]+"",r=wr-n.length,r&&(s+=Pl(r)),s+=n;o=t[e],n=o+"",r=wr-n.length,r&&(s+=Pl(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Va=function(){function t(n,i){var s,o=0,a=n.length;for(n=n.slice();a--;)s=n[a]*i+o,n[a]=s%Sn|0,o=s/Sn|0;return o&&n.unshift(o),n}function e(n,i,s,o){var a,l;if(s!=o)l=s>o?1:-1;else for(a=l=0;a<s;a++)if(n[a]!=i[a]){l=n[a]>i[a]?1:-1;break}return l}function r(n,i,s){for(var o=0;s--;)n[s]-=o,o=n[s]<i[s]?1:0,n[s]=o*Sn+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,o){var a,l,c,u,h,d,f,m,g,v,w,b,x,C,S,E,T,I,k=n.constructor,M=n.s==i.s?1:-1,D=n.d,L=i.d;if(!n.s)return new k(n);if(!i.s)throw Error(Ps+"Division by zero");for(l=n.e-i.e,T=L.length,S=D.length,f=new k(M),m=f.d=[],c=0;L[c]==(D[c]||0);)++c;if(L[c]>(D[c]||0)&&--l,s==null?b=s=k.precision:o?b=s+(ln(n)-ln(i))+1:b=s,b<0)return new k(0);if(b=b/wr+2|0,c=0,T==1)for(u=0,L=L[0],b++;(c<S||u)&&b--;c++)x=u*Sn+(D[c]||0),m[c]=x/L|0,u=x%L|0;else{for(u=Sn/(L[0]+1)|0,u>1&&(L=t(L,u),D=t(D,u),T=L.length,S=D.length),C=T,g=D.slice(0,T),v=g.length;v<T;)g[v++]=0;I=L.slice(),I.unshift(0),E=L[0],L[1]>=Sn/2&&++E;do u=0,a=e(L,g,T,v),a<0?(w=g[0],T!=v&&(w=w*Sn+(g[1]||0)),u=w/E|0,u>1?(u>=Sn&&(u=Sn-1),h=t(L,u),d=h.length,v=g.length,a=e(h,g,d,v),a==1&&(u--,r(h,T<d?I:L,d))):(u==0&&(a=u=1),h=L.slice()),d=h.length,d<v&&h.unshift(0),r(g,h,v),a==-1&&(v=g.length,a=e(L,g,T,v),a<1&&(u++,r(g,T<v?I:L,v))),v=g.length):a===0&&(u++,g=[0]),m[c++]=u,a&&g[0]?g[v++]=D[C]||0:(g=[D[C]],v=1);while((C++<S||g[0]!==void 0)&&b--)}return m[0]||m.shift(),f.e=l,er(f,o?s+ln(f)+1:s)}}();function b7(t,e){var r,n,i,s,o,a,l=0,c=0,u=t.constructor,h=u.precision;if(ln(t)>16)throw Error(SI+ln(t));if(!t.s)return new u(Qi);for(Or=!1,a=h,o=new u(.03125);t.abs().gte(.1);)t=t.times(o),c+=5;for(n=Math.log(nu(2,c))/Math.LN10*2+5|0,a+=n,r=i=s=new u(Qi),u.precision=a;;){if(i=er(i.times(t),a),r=r.times(++l),o=s.plus(Va(i,r,a)),zo(o.d).slice(0,a)===zo(s.d).slice(0,a)){for(;c--;)s=er(s.times(s),a);return u.precision=h,e==null?(Or=!0,er(s,h)):s}s=o}}function ln(t){for(var e=t.e*wr,r=t.d[0];r>=10;r/=10)e++;return e}function EE(t,e,r){if(e>t.LN10.sd())throw Or=!0,r&&(t.precision=r),Error(Ps+"LN10 precision limit exceeded");return er(new t(t.LN10),e)}function Pl(t){for(var e="";t--;)e+="0";return e}function Mp(t,e){var r,n,i,s,o,a,l,c,u,h=1,d=10,f=t,m=f.d,g=f.constructor,v=g.precision;if(f.s<1)throw Error(Ps+(f.s?"NaN":"-Infinity"));if(f.eq(Qi))return new g(0);if(e==null?(Or=!1,c=v):c=e,f.eq(10))return e==null&&(Or=!0),EE(g,c);if(c+=d,g.precision=c,r=zo(m),n=r.charAt(0),s=ln(f),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)f=f.times(t),r=zo(f.d),n=r.charAt(0),h++;s=ln(f),n>1?(f=new g("0."+r),s++):f=new g(n+"."+r.slice(1))}else return l=EE(g,c+2,v).times(s+""),f=Mp(new g(n+"."+r.slice(1)),c-d).plus(l),g.precision=v,e==null?(Or=!0,er(f,v)):f;for(a=o=f=Va(f.minus(Qi),f.plus(Qi),c),u=er(f.times(f),c),i=3;;){if(o=er(o.times(u),c),l=a.plus(Va(o,new g(i),c)),zo(l.d).slice(0,c)===zo(a.d).slice(0,c))return a=a.times(2),s!==0&&(a=a.plus(EE(g,c+2,v).times(s+""))),a=Va(a,new g(h),c),g.precision=v,e==null?(Or=!0,er(a,v)):a;a=l,i+=2}}function rH(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=Gf(r/wr),t.d=[],n=(r+1)%wr,r<0&&(n+=wr),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=wr;n<i;)t.d.push(+e.slice(n,n+=wr));e=e.slice(n),n=wr-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Or&&(t.e>Px||t.e<-Px))throw Error(SI+r)}else t.s=0,t.e=0,t.d=[0];return t}function er(t,e,r){var n,i,s,o,a,l,c,u,h=t.d;for(o=1,s=h[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=wr,i=e,c=h[u=0];else{if(u=Math.ceil((n+1)/wr),s=h.length,u>=s)return t;for(c=s=h[u],o=1;s>=10;s/=10)o++;n%=wr,i=n-wr+o}if(r!==void 0&&(s=nu(10,o-i-1),a=c/s%10|0,l=e<0||h[u+1]!==void 0||c%s,l=r<4?(a||l)&&(r==0||r==(t.s<0?3:2)):a>5||a==5&&(r==4||l||r==6&&(n>0?i>0?c/nu(10,o-i):0:h[u-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return l?(s=ln(t),h.length=1,e=e-s-1,h[0]=nu(10,(wr-e%wr)%wr),t.e=Gf(-e/wr)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=u,s=1,u--):(h.length=u+1,s=nu(10,wr-n),h[u]=i>0?(c/nu(10,o-i)%nu(10,i)|0)*s:0),l)for(;;)if(u==0){(h[0]+=s)==Sn&&(h[0]=1,++t.e);break}else{if(h[u]+=s,h[u]!=Sn)break;h[u--]=0,s=1}for(n=h.length;h[--n]===0;)h.pop();if(Or&&(t.e>Px||t.e<-Px))throw Error(SI+ln(t));return t}function S7(t,e){var r,n,i,s,o,a,l,c,u,h,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new d(t),Or?er(e,f):e;if(l=t.d,h=e.d,n=e.e,c=t.e,l=l.slice(),o=c-n,o){for(u=o<0,u?(r=l,o=-o,a=h.length):(r=h,n=c,a=l.length),i=Math.max(Math.ceil(f/wr),a)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=l.length,a=h.length,u=i<a,u&&(a=i),i=0;i<a;i++)if(l[i]!=h[i]){u=l[i]<h[i];break}o=0}for(u&&(r=l,l=h,h=r,e.s=-e.s),a=l.length,i=h.length-a;i>0;--i)l[a++]=0;for(i=h.length;i>o;){if(l[--i]<h[i]){for(s=i;s&&l[--s]===0;)l[s]=Sn-1;--l[s],l[i]+=Sn}l[i]-=h[i]}for(;l[--a]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=n,Or?er(e,f):e):new d(0)}function Fu(t,e,r){var n,i=ln(t),s=zo(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Pl(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Pl(-i-1)+s,r&&(n=r-o)>0&&(s+=Pl(n))):i>=o?(s+=Pl(i+1-o),r&&(n=r-i-1)>0&&(s=s+"."+Pl(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(s+="."),s+=Pl(n))),t.s<0?"-"+s:s}function nH(t,e){if(t.length>e)return t.length=e,!0}function C7(t){var e,r,n;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Su+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return rH(o,s.toString())}else if(typeof s!="string")throw Error(Su+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,fye.test(s))rH(o,s);else throw Error(Su+s)}if(i.prototype=qe,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=C7,i.config=i.set=gye,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function gye(t){if(!t||typeof t!="object")throw Error(Ps+"Object expected");var e,r,n,i=["precision",1,zf,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(Gf(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(Su+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Su+r+": "+n);return this}var CI=C7(dye);Qi=new CI(1);const Xt=CI;function mye(t){return wye(t)||yye(t)||vye(t)||pye()}function pye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vye(t,e){if(t){if(typeof t=="string")return xA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xA(t,e)}}function yye(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function wye(t){if(Array.isArray(t))return xA(t)}function xA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var xye=function(e){return e},E7={},T7=function(e){return e===E7},iH=function(e){return function r(){return arguments.length===0||arguments.length===1&&T7(arguments.length<=0?void 0:arguments[0])?r:e.apply(void 0,arguments)}},bye=function t(e,r){return e===1?r:iH(function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var o=i.filter(function(a){return a!==E7}).length;return o>=e?r.apply(void 0,i):t(e-o,iH(function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];var u=i.map(function(h){return T7(h)?l.shift():h});return r.apply(void 0,mye(u).concat(l))}))})},rS=function(e){return bye(e.length,e)},bA=function(e,r){for(var n=[],i=e;i<r;++i)n[i-e]=i;return n},Sye=rS(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(r){return e[r]}).map(t)}),Cye=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return xye;var i=r.reverse(),s=i[0],o=i.slice(1);return function(){return o.reduce(function(a,l){return l(a)},s.apply(void 0,arguments))}},SA=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},_7=function(e){var r=null,n=null;return function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r&&s.every(function(a,l){return a===r[l]})||(r=s,n=e.apply(void 0,s)),n}};function Eye(t){var e;return t===0?e=1:e=Math.floor(new Xt(t).abs().log(10).toNumber())+1,e}function Tye(t,e,r){for(var n=new Xt(t),i=0,s=[];n.lt(e)&&i<1e5;)s.push(n.toNumber()),n=n.add(r),i++;return s}var _ye=rS(function(t,e,r){var n=+t,i=+e;return n+r*(i-n)}),Rye=rS(function(t,e,r){var n=e-+t;return n=n||1/0,(r-t)/n}),Aye=rS(function(t,e,r){var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});const nS={rangeStep:Tye,getDigitCount:Eye,interpolateNumber:_ye,uninterpolateNumber:Rye,uninterpolateTruncation:Aye};function CA(t){return Iye(t)||kye(t)||R7(t)||Oye()}function Oye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kye(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Iye(t){if(Array.isArray(t))return EA(t)}function Pp(t,e){return Pye(t)||Mye(t,e)||R7(t,e)||Nye()}function Nye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R7(t,e){if(t){if(typeof t=="string")return EA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EA(t,e)}}function EA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mye(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,s=void 0;try{for(var o=t[Symbol.iterator](),a;!(n=(a=o.next()).done)&&(r.push(a.value),!(e&&r.length===e));n=!0);}catch(l){i=!0,s=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw s}}return r}}function Pye(t){if(Array.isArray(t))return t}function A7(t){var e=Pp(t,2),r=e[0],n=e[1],i=r,s=n;return r>n&&(i=n,s=r),[i,s]}function O7(t,e,r){if(t.lte(0))return new Xt(0);var n=nS.getDigitCount(t.toNumber()),i=new Xt(10).pow(n),s=t.div(i),o=n!==1?.05:.1,a=new Xt(Math.ceil(s.div(o).toNumber())).add(r).mul(o),l=a.mul(i);return e?l:new Xt(Math.ceil(l))}function Dye(t,e,r){var n=1,i=new Xt(t);if(!i.isint()&&r){var s=Math.abs(t);s<1?(n=new Xt(10).pow(nS.getDigitCount(t)-1),i=new Xt(Math.floor(i.div(n).toNumber())).mul(n)):s>1&&(i=new Xt(Math.floor(t)))}else t===0?i=new Xt(Math.floor((e-1)/2)):r||(i=new Xt(Math.floor(t)));var o=Math.floor((e-1)/2),a=Cye(Sye(function(l){return i.add(new Xt(l-o).mul(n)).toNumber()}),bA);return a(0,e)}function k7(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(r-1)))return{step:new Xt(0),tickMin:new Xt(0),tickMax:new Xt(0)};var s=O7(new Xt(e).sub(t).div(r-1),n,i),o;t<=0&&e>=0?o=new Xt(0):(o=new Xt(t).add(e).div(2),o=o.sub(new Xt(o).mod(s)));var a=Math.ceil(o.sub(t).div(s).toNumber()),l=Math.ceil(new Xt(e).sub(o).div(s).toNumber()),c=a+l+1;return c>r?k7(t,e,r,n,i+1):(c<r&&(l=e>0?l+(r-c):l,a=e>0?a:a+(r-c)),{step:s,tickMin:o.sub(new Xt(a).mul(s)),tickMax:o.add(new Xt(l).mul(s))})}function Lye(t){var e=Pp(t,2),r=e[0],n=e[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),a=A7([r,n]),l=Pp(a,2),c=l[0],u=l[1];if(c===-1/0||u===1/0){var h=u===1/0?[c].concat(CA(bA(0,i-1).map(function(){return 1/0}))):[].concat(CA(bA(0,i-1).map(function(){return-1/0})),[u]);return r>n?SA(h):h}if(c===u)return Dye(c,i,s);var d=k7(c,u,o,s),f=d.step,m=d.tickMin,g=d.tickMax,v=nS.rangeStep(m,g.add(new Xt(.1).mul(f)),f);return r>n?SA(v):v}function Fye(t,e){var r=Pp(t,2),n=r[0],i=r[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=A7([n,i]),a=Pp(o,2),l=a[0],c=a[1];if(l===-1/0||c===1/0)return[n,i];if(l===c)return[l];var u=Math.max(e,2),h=O7(new Xt(c).sub(l).div(u-1),s,0),d=[].concat(CA(nS.rangeStep(new Xt(l),new Xt(c).sub(new Xt(.99).mul(h)),h)),[c]);return n>i?SA(d):d}var $ye=_7(Lye),Hye=_7(Fye),jye="Invariant failed";function $u(t,e){throw new Error(jye)}var Bye=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function tf(t){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tf(t)}function Dx(){return Dx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Dx.apply(this,arguments)}function Vye(t,e){return Gye(t)||zye(t,e)||Wye(t,e)||Uye()}function Uye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wye(t,e){if(t){if(typeof t=="string")return sH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sH(t,e)}}function sH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function Gye(t){if(Array.isArray(t))return t}function Yye(t,e){if(t==null)return{};var r=Kye(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Kye(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Xye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M7(n.key),n)}}function Jye(t,e,r){return e&&qye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zye(t,e,r){return e=Lx(e),Qye(t,I7()?Reflect.construct(e,r||[],Lx(t).constructor):e.apply(t,r))}function Qye(t,e){if(e&&(tf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ewe(t)}function ewe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I7(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(I7=function(){return!!t})()}function Lx(t){return Lx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lx(t)}function twe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TA(t,e)}function TA(t,e){return TA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TA(t,e)}function N7(t,e,r){return e=M7(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M7(t){var e=rwe(t,"string");return tf(e)=="symbol"?e:e+""}function rwe(t,e){if(tf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var z0=function(t){function e(){return Xye(this,e),Zye(this,e,arguments)}return twe(e,t),Jye(e,[{key:"render",value:function(){var n=this.props,i=n.offset,s=n.layout,o=n.width,a=n.dataKey,l=n.data,c=n.dataPointFormatter,u=n.xAxis,h=n.yAxis,d=Yye(n,Bye),f=rt(d,!1);this.props.direction==="x"&&u.type!=="number"&&$u();var m=l.map(function(g){var v=c(g,a),w=v.x,b=v.y,x=v.value,C=v.errorVal;if(!C)return null;var S=[],E,T;if(Array.isArray(C)){var I=Vye(C,2);E=I[0],T=I[1]}else E=T=C;if(s==="vertical"){var k=u.scale,M=b+i,D=M+o,L=M-o,U=k(x-E),J=k(x+T);S.push({x1:J,y1:D,x2:J,y2:L}),S.push({x1:U,y1:M,x2:J,y2:M}),S.push({x1:U,y1:D,x2:U,y2:L})}else if(s==="horizontal"){var X=h.scale,ie=w+i,se=ie-o,P=ie+o,y=X(x-E),_=X(x+T);S.push({x1:se,y1:_,x2:P,y2:_}),S.push({x1:ie,y1:y,x2:ie,y2:_}),S.push({x1:se,y1:y,x2:P,y2:y})}return oe.createElement(Ft,Dx({className:"recharts-errorBar",key:"bar-".concat(S.map(function(R){return"".concat(R.x1,"-").concat(R.x2,"-").concat(R.y1,"-").concat(R.y2)}))},f),S.map(function(R){return oe.createElement("line",Dx({},R,{key:"line-".concat(R.x1,"-").concat(R.x2,"-").concat(R.y1,"-").concat(R.y2)}))}))});return oe.createElement(Ft,{className:"recharts-errorBars"},m)}}])}(oe.Component);N7(z0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});N7(z0,"displayName","ErrorBar");function Dp(t){"@babel/helpers - typeof";return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dp(t)}function oH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oH(Object(r),!0).forEach(function(n){nwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nwe(t,e,r){return e=iwe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iwe(t){var e=swe(t,"string");return Dp(e)=="symbol"?e:e+""}function swe(t,e){if(Dp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Dp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var P7=function(e){var r=e.children,n=e.formattedGraphicalItems,i=e.legendWidth,s=e.legendContent,o=Xi(r,sc);if(!o)return null;var a=sc.defaultProps,l=a!==void 0?Nc(Nc({},a),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:s==="children"?c=(n||[]).reduce(function(u,h){var d=h.item,f=h.props,m=f.sectors||f.data||[];return u.concat(m.map(function(g){return{type:o.props.iconType||d.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):c=(n||[]).map(function(u){var h=u.item,d=h.type.defaultProps,f=d!==void 0?Nc(Nc({},d),h.props):{},m=f.dataKey,g=f.name,v=f.legendType,w=f.hide;return{inactive:w,dataKey:m,type:l.iconType||v||"square",color:EI(h),value:g||m,payload:f}}),Nc(Nc(Nc({},l),sc.getWithHeight(o,i)),{},{payload:c,item:o})};function Lp(t){"@babel/helpers - typeof";return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lp(t)}function aH(t){return cwe(t)||lwe(t)||awe(t)||owe()}function owe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function awe(t,e){if(t){if(typeof t=="string")return _A(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _A(t,e)}}function lwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cwe(t){if(Array.isArray(t))return _A(t)}function _A(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ur(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lH(Object(r),!0).forEach(function(n){_d(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _d(t,e,r){return e=uwe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uwe(t){var e=hwe(t,"string");return Lp(e)=="symbol"?e:e+""}function hwe(t,e){if(Lp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Lp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fn(t,e,r){return dt(t)||dt(e)?r:mn(e)?is(t,e,r):at(e)?e(t):r}function Rm(t,e,r,n){var i=lye(t,function(a){return fn(a,e)});if(r==="number"){var s=i.filter(function(a){return Ue(a)||parseFloat(a)});return s.length?[tS(s),eS(s)]:[1/0,-1/0]}var o=n?i.filter(function(a){return!dt(a)}):i;return o.map(function(a){return mn(a)||a instanceof Date?a:""})}var dwe=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,o=-1,a=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(a<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var l=s.range,c=0;c<a;c++){var u=c>0?i[c-1].coordinate:i[a-1].coordinate,h=i[c].coordinate,d=c>=a-1?i[0].coordinate:i[c+1].coordinate,f=void 0;if(mi(h-u)!==mi(d-h)){var m=[];if(mi(d-h)===mi(l[1]-l[0])){f=d;var g=h+l[1]-l[0];m[0]=Math.min(g,(g+u)/2),m[1]=Math.max(g,(g+u)/2)}else{f=u;var v=d+l[1]-l[0];m[0]=Math.min(h,(v+h)/2),m[1]=Math.max(h,(v+h)/2)}var w=[Math.min(h,(f+h)/2),Math.max(h,(f+h)/2)];if(e>w[0]&&e<=w[1]||e>=m[0]&&e<=m[1]){o=i[c].index;break}}else{var b=Math.min(u,d),x=Math.max(u,d);if(e>(b+h)/2&&e<=(x+h)/2){o=i[c].index;break}}}else for(var C=0;C<a;C++)if(C===0&&e<=(n[C].coordinate+n[C+1].coordinate)/2||C>0&&C<a-1&&e>(n[C].coordinate+n[C-1].coordinate)/2&&e<=(n[C].coordinate+n[C+1].coordinate)/2||C===a-1&&e>(n[C].coordinate+n[C-1].coordinate)/2){o=n[C].index;break}return o},EI=function(e){var r,n=e,i=n.type.displayName,s=(r=e.type)!==null&&r!==void 0&&r.defaultProps?Ur(Ur({},e.type.defaultProps),e.props):e.props,o=s.stroke,a=s.fill,l;switch(i){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:a;break;default:l=a;break}return l},fwe=function(e){var r=e.barSize,n=e.totalSize,i=e.stackGroups,s=i===void 0?{}:i;if(!s)return{};for(var o={},a=Object.keys(s),l=0,c=a.length;l<c;l++)for(var u=s[a[l]].stackGroups,h=Object.keys(u),d=0,f=h.length;d<f;d++){var m=u[h[d]],g=m.items,v=m.cateAxisId,w=g.filter(function(T){return Ba(T.type).indexOf("Bar")>=0});if(w&&w.length){var b=w[0].type.defaultProps,x=b!==void 0?Ur(Ur({},b),w[0].props):w[0].props,C=x.barSize,S=x[v];o[S]||(o[S]=[]);var E=dt(C)?r:C;o[S].push({item:w[0],stackList:w.slice(1),barSize:dt(E)?void 0:pi(E,n,0)})}}return o},gwe=function(e){var r=e.barGap,n=e.barCategoryGap,i=e.bandSize,s=e.sizeList,o=s===void 0?[]:s,a=e.maxBarSize,l=o.length;if(l<1)return null;var c=pi(r,i,0,!0),u,h=[];if(o[0].barSize===+o[0].barSize){var d=!1,f=i/l,m=o.reduce(function(C,S){return C+S.barSize||0},0);m+=(l-1)*c,m>=i&&(m-=(l-1)*c,c=0),m>=i&&f>0&&(d=!0,f*=.9,m=l*f);var g=(i-m)/2>>0,v={offset:g-c,size:0};u=o.reduce(function(C,S){var E={item:S.item,position:{offset:v.offset+v.size+c,size:d?f:S.barSize}},T=[].concat(aH(C),[E]);return v=T[T.length-1].position,S.stackList&&S.stackList.length&&S.stackList.forEach(function(I){T.push({item:I,position:v})}),T},h)}else{var w=pi(n,i,0,!0);i-2*w-(l-1)*c<=0&&(c=0);var b=(i-2*w-(l-1)*c)/l;b>1&&(b>>=0);var x=a===+a?Math.min(b,a):b;u=o.reduce(function(C,S,E){var T=[].concat(aH(C),[{item:S.item,position:{offset:w+(b+c)*E+(b-x)/2,size:x}}]);return S.stackList&&S.stackList.length&&S.stackList.forEach(function(I){T.push({item:I,position:T[T.length-1].position})}),T},h)}return u},mwe=function(e,r,n,i){var s=n.children,o=n.width,a=n.margin,l=o-(a.left||0)-(a.right||0),c=P7({children:s,legendWidth:l});if(c){var u=i||{},h=u.width,d=u.height,f=c.align,m=c.verticalAlign,g=c.layout;if((g==="vertical"||g==="horizontal"&&m==="middle")&&f!=="center"&&Ue(e[f]))return Ur(Ur({},e),{},_d({},f,e[f]+(h||0)));if((g==="horizontal"||g==="vertical"&&f==="center")&&m!=="middle"&&Ue(e[m]))return Ur(Ur({},e),{},_d({},m,e[m]+(d||0)))}return e},pwe=function(e,r,n){return dt(r)?!0:e==="horizontal"?r==="yAxis":e==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},D7=function(e,r,n,i,s){var o=r.props.children,a=ss(o,z0).filter(function(c){return pwe(i,s,c.props.direction)});if(a&&a.length){var l=a.map(function(c){return c.props.dataKey});return e.reduce(function(c,u){var h=fn(u,n);if(dt(h))return c;var d=Array.isArray(h)?[tS(h),eS(h)]:[h,h],f=l.reduce(function(m,g){var v=fn(u,g,0),w=d[0]-Math.abs(Array.isArray(v)?v[0]:v),b=d[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(w,m[0]),Math.max(b,m[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},vwe=function(e,r,n,i,s){var o=r.map(function(a){return D7(e,a,n,s,i)}).filter(function(a){return!dt(a)});return o&&o.length?o.reduce(function(a,l){return[Math.min(a[0],l[0]),Math.max(a[1],l[1])]},[1/0,-1/0]):null},L7=function(e,r,n,i,s){var o=r.map(function(l){var c=l.props.dataKey;return n==="number"&&c&&D7(e,l,c,i)||Rm(e,c,n,s)});if(n==="number")return o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var a={};return o.reduce(function(l,c){for(var u=0,h=c.length;u<h;u++)a[c[u]]||(a[c[u]]=!0,l.push(c[u]));return l},[])},F7=function(e,r){return e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis"},$7=function(e,r,n,i){if(i)return e.map(function(l){return l.coordinate});var s,o,a=e.map(function(l){return l.coordinate===r&&(s=!0),l.coordinate===n&&(o=!0),l.coordinate});return s||a.push(r),o||a.push(n),a},Da=function(e,r,n){if(!e)return null;var i=e.scale,s=e.duplicateDomain,o=e.type,a=e.range,l=e.realScaleType==="scaleBand"?i.bandwidth()/2:2,c=(r||n)&&o==="category"&&i.bandwidth?i.bandwidth()/l:0;if(c=e.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?mi(a[0]-a[1])*2*c:c,r&&(e.ticks||e.niceTicks)){var u=(e.ticks||e.niceTicks).map(function(h){var d=s?s.indexOf(h):h;return{coordinate:i(d)+c,value:h,offset:c}});return u.filter(function(h){return!$0(h.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(h,d){return{coordinate:i(h)+c,value:h,index:d,offset:c}}):i.ticks&&!n?i.ticks(e.tickCount).map(function(h){return{coordinate:i(h)+c,value:h,offset:c}}):i.domain().map(function(h,d){return{coordinate:i(h)+c,value:s?s[h]:h,index:d,offset:c}})},TE=new WeakMap,Yv=function(e,r){if(typeof r!="function")return e;TE.has(e)||TE.set(e,new WeakMap);var n=TE.get(e);if(n.has(r))return n.get(r);var i=function(){e.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},H7=function(e,r,n){var i=e.scale,s=e.type,o=e.layout,a=e.axisType;if(i==="auto")return o==="radial"&&a==="radiusAxis"?{scale:Ap(),realScaleType:"band"}:o==="radial"&&a==="angleAxis"?{scale:kx(),realScaleType:"linear"}:s==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:_m(),realScaleType:"point"}:s==="category"?{scale:Ap(),realScaleType:"band"}:{scale:kx(),realScaleType:"linear"};if(F0(i)){var l="scale".concat(Hb(i));return{scale:(tH[l]||_m)(),realScaleType:tH[l]?l:"point"}}return at(i)?{scale:i}:{scale:_m(),realScaleType:"point"}},cH=1e-4,j7=function(e){var r=e.domain();if(!(!r||r.length<=2)){var n=r.length,i=e.range(),s=Math.min(i[0],i[1])-cH,o=Math.max(i[0],i[1])+cH,a=e(r[0]),l=e(r[n-1]);(a<s||a>o||l<s||l>o)&&e.domain([r[0],r[n-1]])}},ywe=function(e,r){if(!e)return null;for(var n=0,i=e.length;n<i;n++)if(e[n].item===r)return e[n].position;return null},wwe=function(e,r){if(!r||r.length!==2||!Ue(r[0])||!Ue(r[1]))return e;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),s=[e[0],e[1]];return(!Ue(e[0])||e[0]<n)&&(s[0]=n),(!Ue(e[1])||e[1]>i)&&(s[1]=i),s[0]>i&&(s[0]=i),s[1]<n&&(s[1]=n),s},xwe=function(e){var r=e.length;if(!(r<=0))for(var n=0,i=e[0].length;n<i;++n)for(var s=0,o=0,a=0;a<r;++a){var l=$0(e[a][n][1])?e[a][n][0]:e[a][n][1];l>=0?(e[a][n][0]=s,e[a][n][1]=s+l,s=e[a][n][1]):(e[a][n][0]=o,e[a][n][1]=o+l,o=e[a][n][1])}},bwe=function(e){var r=e.length;if(!(r<=0))for(var n=0,i=e[0].length;n<i;++n)for(var s=0,o=0;o<r;++o){var a=$0(e[o][n][1])?e[o][n][0]:e[o][n][1];a>=0?(e[o][n][0]=s,e[o][n][1]=s+a,s=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},Swe={sign:xwe,expand:Boe,none:Yd,silhouette:Voe,wiggle:Uoe,positive:bwe},Cwe=function(e,r,n){var i=r.map(function(a){return a.props.dataKey}),s=Swe[n],o=joe().keys(i).value(function(a,l){return+fn(a,l,0)}).order(JR).offset(s);return o(e)},Ewe=function(e,r,n,i,s,o){if(!e)return null;var a=o?r.reverse():r,l={},c=a.reduce(function(h,d){var f,m=(f=d.type)!==null&&f!==void 0&&f.defaultProps?Ur(Ur({},d.type.defaultProps),d.props):d.props,g=m.stackId,v=m.hide;if(v)return h;var w=m[n],b=h[w]||{hasStack:!1,stackGroups:{}};if(mn(g)){var x=b.stackGroups[g]||{numericAxisId:n,cateAxisId:i,items:[]};x.items.push(d),b.hasStack=!0,b.stackGroups[g]=x}else b.stackGroups[jf("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[d]};return Ur(Ur({},h),{},_d({},w,b))},l),u={};return Object.keys(c).reduce(function(h,d){var f=c[d];if(f.hasStack){var m={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(g,v){var w=f.stackGroups[v];return Ur(Ur({},g),{},_d({},v,{numericAxisId:n,cateAxisId:i,items:w.items,stackedData:Cwe(e,w.items,s)}))},m)}return Ur(Ur({},h),{},_d({},d,f))},u)},B7=function(e,r){var n=r.realScaleType,i=r.type,s=r.tickCount,o=r.originalDomain,a=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(s&&i==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var u=$ye(c,s,a);return e.domain([tS(u),eS(u)]),{niceTicks:u}}if(s&&i==="number"){var h=e.domain(),d=Hye(h,s,a);return{niceTicks:d}}return null};function uH(t){var e=t.axis,r=t.ticks,n=t.bandSize,i=t.entry,s=t.index,o=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!dt(i[e.dataKey])){var a=cx(r,"value",i[e.dataKey]);if(a)return a.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var l=fn(i,dt(o)?e.dataKey:o);return dt(l)?null:e.scale(l)}var hH=function(e){var r=e.axis,n=e.ticks,i=e.offset,s=e.bandSize,o=e.entry,a=e.index;if(r.type==="category")return n[a]?n[a].coordinate+i:null;var l=fn(o,r.dataKey,r.domain[a]);return dt(l)?null:r.scale(l)-s/2+i},Twe=function(e){var r=e.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return i<=0&&s>=0?0:s<0?s:i}return n[0]},_we=function(e,r){var n,i=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Ur(Ur({},e.type.defaultProps),e.props):e.props,s=i.stackId;if(mn(s)){var o=r[s];if(o){var a=o.items.indexOf(e);return a>=0?o.stackedData[a]:null}}return null},Rwe=function(e){return e.reduce(function(r,n){return[tS(n.concat([r[0]]).filter(Ue)),eS(n.concat([r[1]]).filter(Ue))]},[1/0,-1/0])},V7=function(e,r,n){return Object.keys(e).reduce(function(i,s){var o=e[s],a=o.stackedData,l=a.reduce(function(c,u){var h=Rwe(u.slice(r,n+1));return[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},dH=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,fH=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,RA=function(e,r,n){if(at(e))return e(r,n);if(!Array.isArray(e))return r;var i=[];if(Ue(e[0]))i[0]=n?e[0]:Math.min(e[0],r[0]);else if(dH.test(e[0])){var s=+dH.exec(e[0])[1];i[0]=r[0]-s}else at(e[0])?i[0]=e[0](r[0]):i[0]=r[0];if(Ue(e[1]))i[1]=n?e[1]:Math.max(e[1],r[1]);else if(fH.test(e[1])){var o=+fH.exec(e[1])[1];i[1]=r[1]+o}else at(e[1])?i[1]=e[1](r[1]):i[1]=r[1];return i},Fx=function(e,r,n){if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!n||i>0)return i}if(e&&r&&r.length>=2){for(var s=J2(r,function(h){return h.coordinate}),o=1/0,a=1,l=s.length;a<l;a++){var c=s[a],u=s[a-1];o=Math.min((c.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},gH=function(e,r,n){return!e||!e.length||W0(e,is(n,"type.defaultProps.domain"))?r:e},U7=function(e,r){var n=e.type.defaultProps?Ur(Ur({},e.type.defaultProps),e.props):e.props,i=n.dataKey,s=n.name,o=n.unit,a=n.formatter,l=n.tooltipType,c=n.chartType,u=n.hide;return Ur(Ur({},rt(e,!1)),{},{dataKey:i,unit:o,formatter:a,name:s||i,color:EI(e),value:fn(r,i),type:l,payload:r,chartType:c,hide:u})};function Fp(t){"@babel/helpers - typeof";return Fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fp(t)}function mH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _a(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mH(Object(r),!0).forEach(function(n){W7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function W7(t,e,r){return e=Awe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Awe(t){var e=Owe(t,"string");return Fp(e)=="symbol"?e:e+""}function Owe(t,e){if(Fp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Fp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kwe(t,e){return Pwe(t)||Mwe(t,e)||Nwe(t,e)||Iwe()}function Iwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nwe(t,e){if(t){if(typeof t=="string")return pH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pH(t,e)}}function pH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mwe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function Pwe(t){if(Array.isArray(t))return t}var $x=Math.PI/180,Dwe=function(e){return e*180/Math.PI},hr=function(e,r,n,i){return{x:e+Math.cos(-$x*i)*n,y:r+Math.sin(-$x*i)*n}},z7=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Lwe=function(e,r,n,i,s){var o=e.width,a=e.height,l=e.startAngle,c=e.endAngle,u=pi(e.cx,o,o/2),h=pi(e.cy,a,a/2),d=z7(o,a,n),f=pi(e.innerRadius,d,0),m=pi(e.outerRadius,d,d*.8),g=Object.keys(r);return g.reduce(function(v,w){var b=r[w],x=b.domain,C=b.reversed,S;if(dt(b.range))i==="angleAxis"?S=[l,c]:i==="radiusAxis"&&(S=[f,m]),C&&(S=[S[1],S[0]]);else{S=b.range;var E=S,T=kwe(E,2);l=T[0],c=T[1]}var I=H7(b,s),k=I.realScaleType,M=I.scale;M.domain(x).range(S),j7(M);var D=B7(M,_a(_a({},b),{},{realScaleType:k})),L=_a(_a(_a({},b),D),{},{range:S,radius:m,realScaleType:k,scale:M,cx:u,cy:h,innerRadius:f,outerRadius:m,startAngle:l,endAngle:c});return _a(_a({},v),{},W7({},w,L))},{})},Fwe=function(e,r){var n=e.x,i=e.y,s=r.x,o=r.y;return Math.sqrt(Math.pow(n-s,2)+Math.pow(i-o,2))},$we=function(e,r){var n=e.x,i=e.y,s=r.cx,o=r.cy,a=Fwe({x:n,y:i},{x:s,y:o});if(a<=0)return{radius:a};var l=(n-s)/a,c=Math.acos(l);return i>o&&(c=2*Math.PI-c),{radius:a,angle:Dwe(c),angleInRadian:c}},Hwe=function(e){var r=e.startAngle,n=e.endAngle,i=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(i,s);return{startAngle:r-o*360,endAngle:n-o*360}},jwe=function(e,r){var n=r.startAngle,i=r.endAngle,s=Math.floor(n/360),o=Math.floor(i/360),a=Math.min(s,o);return e+a*360},vH=function(e,r){var n=e.x,i=e.y,s=$we({x:n,y:i},r),o=s.radius,a=s.angle,l=r.innerRadius,c=r.outerRadius;if(o<l||o>c)return!1;if(o===0)return!0;var u=Hwe(r),h=u.startAngle,d=u.endAngle,f=a,m;if(h<=d){for(;f>d;)f-=360;for(;f<h;)f+=360;m=f>=h&&f<=d}else{for(;f>h;)f-=360;for(;f<d;)f+=360;m=f>=d&&f<=h}return m?_a(_a({},r),{},{radius:o,angle:jwe(f,r)}):null},G7=function(e){return!G.isValidElement(e)&&!at(e)&&typeof e!="boolean"?e.className:""};function $p(t){"@babel/helpers - typeof";return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$p(t)}var Bwe=["offset"];function Vwe(t){return Gwe(t)||zwe(t)||Wwe(t)||Uwe()}function Uwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wwe(t,e){if(t){if(typeof t=="string")return AA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AA(t,e)}}function zwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Gwe(t){if(Array.isArray(t))return AA(t)}function AA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ywe(t,e){if(t==null)return{};var r=Kwe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Kwe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function yH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function un(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yH(Object(r),!0).forEach(function(n){Xwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xwe(t,e,r){return e=qwe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qwe(t){var e=Jwe(t,"string");return $p(e)=="symbol"?e:e+""}function Jwe(t,e){if($p(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if($p(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hp(){return Hp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hp.apply(this,arguments)}var Zwe=function(e){var r=e.value,n=e.formatter,i=dt(e.children)?r:e.children;return at(n)?n(i):i},Qwe=function(e,r){var n=mi(r-e),i=Math.min(Math.abs(r-e),360);return n*i},exe=function(e,r,n){var i=e.position,s=e.viewBox,o=e.offset,a=e.className,l=s,c=l.cx,u=l.cy,h=l.innerRadius,d=l.outerRadius,f=l.startAngle,m=l.endAngle,g=l.clockWise,v=(h+d)/2,w=Qwe(f,m),b=w>=0?1:-1,x,C;i==="insideStart"?(x=f+b*o,C=g):i==="insideEnd"?(x=m-b*o,C=!g):i==="end"&&(x=m+b*o,C=g),C=w<=0?C:!C;var S=hr(c,u,v,x),E=hr(c,u,v,x+(C?1:-1)*359),T="M".concat(S.x,",").concat(S.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(C?0:1,`,
    `).concat(E.x,",").concat(E.y),I=dt(e.id)?jf("recharts-radial-line-"):e.id;return oe.createElement("text",Hp({},n,{dominantBaseline:"central",className:xt("recharts-radial-bar-label",a)}),oe.createElement("defs",null,oe.createElement("path",{id:I,d:T})),oe.createElement("textPath",{xlinkHref:"#".concat(I)},r))},txe=function(e){var r=e.viewBox,n=e.offset,i=e.position,s=r,o=s.cx,a=s.cy,l=s.innerRadius,c=s.outerRadius,u=s.startAngle,h=s.endAngle,d=(u+h)/2;if(i==="outside"){var f=hr(o,a,c+n,d),m=f.x,g=f.y;return{x:m,y:g,textAnchor:m>=o?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:o,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:o,y:a,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:o,y:a,textAnchor:"middle",verticalAnchor:"end"};var v=(l+c)/2,w=hr(o,a,v,d),b=w.x,x=w.y;return{x:b,y:x,textAnchor:"middle",verticalAnchor:"middle"}},rxe=function(e){var r=e.viewBox,n=e.parentViewBox,i=e.offset,s=e.position,o=r,a=o.x,l=o.y,c=o.width,u=o.height,h=u>=0?1:-1,d=h*i,f=h>0?"end":"start",m=h>0?"start":"end",g=c>=0?1:-1,v=g*i,w=g>0?"end":"start",b=g>0?"start":"end";if(s==="top"){var x={x:a+c/2,y:l-h*i,textAnchor:"middle",verticalAnchor:f};return un(un({},x),n?{height:Math.max(l-n.y,0),width:c}:{})}if(s==="bottom"){var C={x:a+c/2,y:l+u+d,textAnchor:"middle",verticalAnchor:m};return un(un({},C),n?{height:Math.max(n.y+n.height-(l+u),0),width:c}:{})}if(s==="left"){var S={x:a-v,y:l+u/2,textAnchor:w,verticalAnchor:"middle"};return un(un({},S),n?{width:Math.max(S.x-n.x,0),height:u}:{})}if(s==="right"){var E={x:a+c+v,y:l+u/2,textAnchor:b,verticalAnchor:"middle"};return un(un({},E),n?{width:Math.max(n.x+n.width-E.x,0),height:u}:{})}var T=n?{width:c,height:u}:{};return s==="insideLeft"?un({x:a+v,y:l+u/2,textAnchor:b,verticalAnchor:"middle"},T):s==="insideRight"?un({x:a+c-v,y:l+u/2,textAnchor:w,verticalAnchor:"middle"},T):s==="insideTop"?un({x:a+c/2,y:l+d,textAnchor:"middle",verticalAnchor:m},T):s==="insideBottom"?un({x:a+c/2,y:l+u-d,textAnchor:"middle",verticalAnchor:f},T):s==="insideTopLeft"?un({x:a+v,y:l+d,textAnchor:b,verticalAnchor:m},T):s==="insideTopRight"?un({x:a+c-v,y:l+d,textAnchor:w,verticalAnchor:m},T):s==="insideBottomLeft"?un({x:a+v,y:l+u-d,textAnchor:b,verticalAnchor:f},T):s==="insideBottomRight"?un({x:a+c-v,y:l+u-d,textAnchor:w,verticalAnchor:f},T):Lf(s)&&(Ue(s.x)||uu(s.x))&&(Ue(s.y)||uu(s.y))?un({x:a+pi(s.x,c),y:l+pi(s.y,u),textAnchor:"end",verticalAnchor:"end"},T):un({x:a+c/2,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},T)},nxe=function(e){return"cx"in e&&Ue(e.cx)};function _n(t){var e=t.offset,r=e===void 0?5:e,n=Ywe(t,Bwe),i=un({offset:r},n),s=i.viewBox,o=i.position,a=i.value,l=i.children,c=i.content,u=i.className,h=u===void 0?"":u,d=i.textBreakAll;if(!s||dt(a)&&dt(l)&&!G.isValidElement(c)&&!at(c))return null;if(G.isValidElement(c))return G.cloneElement(c,i);var f;if(at(c)){if(f=G.createElement(c,i),G.isValidElement(f))return f}else f=Zwe(i);var m=nxe(s),g=rt(i,!0);if(m&&(o==="insideStart"||o==="insideEnd"||o==="end"))return exe(i,f,g);var v=m?txe(i):rxe(i);return oe.createElement(Lu,Hp({className:xt("recharts-label",h)},g,v,{breakAll:d}),f)}_n.displayName="Label";var Y7=function(e){var r=e.cx,n=e.cy,i=e.angle,s=e.startAngle,o=e.endAngle,a=e.r,l=e.radius,c=e.innerRadius,u=e.outerRadius,h=e.x,d=e.y,f=e.top,m=e.left,g=e.width,v=e.height,w=e.clockWise,b=e.labelViewBox;if(b)return b;if(Ue(g)&&Ue(v)){if(Ue(h)&&Ue(d))return{x:h,y:d,width:g,height:v};if(Ue(f)&&Ue(m))return{x:f,y:m,width:g,height:v}}return Ue(h)&&Ue(d)?{x:h,y:d,width:0,height:0}:Ue(r)&&Ue(n)?{cx:r,cy:n,startAngle:s||i||0,endAngle:o||i||0,innerRadius:c||0,outerRadius:u||l||a||0,clockWise:w}:e.viewBox?e.viewBox:{}},ixe=function(e,r){return e?e===!0?oe.createElement(_n,{key:"label-implicit",viewBox:r}):mn(e)?oe.createElement(_n,{key:"label-implicit",viewBox:r,value:e}):G.isValidElement(e)?e.type===_n?G.cloneElement(e,{key:"label-implicit",viewBox:r}):oe.createElement(_n,{key:"label-implicit",content:e,viewBox:r}):at(e)?oe.createElement(_n,{key:"label-implicit",content:e,viewBox:r}):Lf(e)?oe.createElement(_n,Hp({viewBox:r},e,{key:"label-implicit"})):null:null},sxe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,s=Y7(e),o=ss(i,_n).map(function(l,c){return G.cloneElement(l,{viewBox:r||s,key:"label-".concat(c)})});if(!n)return o;var a=ixe(e.label,r||s);return[a].concat(Vwe(o))};_n.parseViewBox=Y7;_n.renderCallByParent=sxe;function oxe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var axe=oxe;const lxe=jt(axe);function jp(t){"@babel/helpers - typeof";return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jp(t)}var cxe=["valueAccessor"],uxe=["data","dataKey","clockWise","id","textBreakAll"];function hxe(t){return mxe(t)||gxe(t)||fxe(t)||dxe()}function dxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fxe(t,e){if(t){if(typeof t=="string")return OA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OA(t,e)}}function gxe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mxe(t){if(Array.isArray(t))return OA(t)}function OA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Hx(){return Hx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hx.apply(this,arguments)}function wH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wH(Object(r),!0).forEach(function(n){pxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pxe(t,e,r){return e=vxe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vxe(t){var e=yxe(t,"string");return jp(e)=="symbol"?e:e+""}function yxe(t,e){if(jp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bH(t,e){if(t==null)return{};var r=wxe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function wxe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var xxe=function(e){return Array.isArray(e.value)?lxe(e.value):e.value};function Ua(t){var e=t.valueAccessor,r=e===void 0?xxe:e,n=bH(t,cxe),i=n.data,s=n.dataKey,o=n.clockWise,a=n.id,l=n.textBreakAll,c=bH(n,uxe);return!i||!i.length?null:oe.createElement(Ft,{className:"recharts-label-list"},i.map(function(u,h){var d=dt(s)?r(u,h):fn(u&&u.payload,s),f=dt(a)?{}:{id:"".concat(a,"-").concat(h)};return oe.createElement(_n,Hx({},rt(u,!0),c,f,{parentViewBox:u.parentViewBox,value:d,textBreakAll:l,viewBox:_n.parseViewBox(dt(o)?u:xH(xH({},u),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}Ua.displayName="LabelList";function bxe(t,e){return t?t===!0?oe.createElement(Ua,{key:"labelList-implicit",data:e}):oe.isValidElement(t)||at(t)?oe.createElement(Ua,{key:"labelList-implicit",data:e,content:t}):Lf(t)?oe.createElement(Ua,Hx({data:e},t,{key:"labelList-implicit"})):null:null}function Sxe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var n=t.children,i=ss(n,Ua).map(function(o,a){return G.cloneElement(o,{data:e,key:"labelList-".concat(a)})});if(!r)return i;var s=bxe(t.label,e);return[s].concat(hxe(i))}Ua.renderCallByParent=Sxe;function Bp(t){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bp(t)}function kA(){return kA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kA.apply(this,arguments)}function SH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function CH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SH(Object(r),!0).forEach(function(n){Cxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Cxe(t,e,r){return e=Exe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Exe(t){var e=Txe(t,"string");return Bp(e)=="symbol"?e:e+""}function Txe(t,e){if(Bp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Bp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _xe=function(e,r){var n=mi(r-e),i=Math.min(Math.abs(r-e),359.999);return n*i},Kv=function(e){var r=e.cx,n=e.cy,i=e.radius,s=e.angle,o=e.sign,a=e.isExternal,l=e.cornerRadius,c=e.cornerIsExternal,u=l*(a?1:-1)+i,h=Math.asin(l/u)/$x,d=c?s:s+o*h,f=hr(r,n,u,d),m=hr(r,n,i,d),g=c?s-o*h:s,v=hr(r,n,u*Math.cos(h*$x),g);return{center:f,circleTangency:m,lineTangency:v,theta:h}},K7=function(e){var r=e.cx,n=e.cy,i=e.innerRadius,s=e.outerRadius,o=e.startAngle,a=e.endAngle,l=_xe(o,a),c=o+l,u=hr(r,n,s,o),h=hr(r,n,s,c),d="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>c),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(i>0){var f=hr(r,n,i,o),m=hr(r,n,i,c);d+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(r,",").concat(n," Z");return d},Rxe=function(e){var r=e.cx,n=e.cy,i=e.innerRadius,s=e.outerRadius,o=e.cornerRadius,a=e.forceCornerRadius,l=e.cornerIsExternal,c=e.startAngle,u=e.endAngle,h=mi(u-c),d=Kv({cx:r,cy:n,radius:s,angle:c,sign:h,cornerRadius:o,cornerIsExternal:l}),f=d.circleTangency,m=d.lineTangency,g=d.theta,v=Kv({cx:r,cy:n,radius:s,angle:u,sign:-h,cornerRadius:o,cornerIsExternal:l}),w=v.circleTangency,b=v.lineTangency,x=v.theta,C=l?Math.abs(c-u):Math.abs(c-u)-g-x;if(C<0)return a?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):K7({cx:r,cy:n,innerRadius:i,outerRadius:s,startAngle:c,endAngle:u});var S="M ".concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(h<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(b.x,",").concat(b.y,`
  `);if(i>0){var E=Kv({cx:r,cy:n,radius:i,angle:c,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),T=E.circleTangency,I=E.lineTangency,k=E.theta,M=Kv({cx:r,cy:n,radius:i,angle:u,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),D=M.circleTangency,L=M.lineTangency,U=M.theta,J=l?Math.abs(c-u):Math.abs(c-u)-k-U;if(J<0&&o===0)return"".concat(S,"L").concat(r,",").concat(n,"Z");S+="L".concat(L.x,",").concat(L.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(J>180),",").concat(+(h>0),",").concat(T.x,",").concat(T.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(I.x,",").concat(I.y,"Z")}else S+="L".concat(r,",").concat(n,"Z");return S},Axe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},X7=function(e){var r=CH(CH({},Axe),e),n=r.cx,i=r.cy,s=r.innerRadius,o=r.outerRadius,a=r.cornerRadius,l=r.forceCornerRadius,c=r.cornerIsExternal,u=r.startAngle,h=r.endAngle,d=r.className;if(o<s||u===h)return null;var f=xt("recharts-sector",d),m=o-s,g=pi(a,m,0,!0),v;return g>0&&Math.abs(u-h)<360?v=Rxe({cx:n,cy:i,innerRadius:s,outerRadius:o,cornerRadius:Math.min(g,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h}):v=K7({cx:n,cy:i,innerRadius:s,outerRadius:o,startAngle:u,endAngle:h}),oe.createElement("path",kA({},rt(r,!0),{className:f,d:v,role:"img"}))};function Vp(t){"@babel/helpers - typeof";return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vp(t)}function IA(){return IA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IA.apply(this,arguments)}function EH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function TH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EH(Object(r),!0).forEach(function(n){Oxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Oxe(t,e,r){return e=kxe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kxe(t){var e=Ixe(t,"string");return Vp(e)=="symbol"?e:e+""}function Ixe(t,e){if(Vp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Vp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _H={curveBasisClosed:Ooe,curveBasisOpen:koe,curveBasis:Aoe,curveBumpX:goe,curveBumpY:moe,curveLinearClosed:Ioe,curveLinear:Bb,curveMonotoneX:Noe,curveMonotoneY:Moe,curveNatural:Poe,curveStep:Doe,curveStepAfter:Foe,curveStepBefore:Loe},Xv=function(e){return e.x===+e.x&&e.y===+e.y},_g=function(e){return e.x},Rg=function(e){return e.y},Nxe=function(e,r){if(at(e))return e;var n="curve".concat(Hb(e));return(n==="curveMonotone"||n==="curveBump")&&r?_H["".concat(n).concat(r==="vertical"?"Y":"X")]:_H[n]||Bb},Mxe=function(e){var r=e.type,n=r===void 0?"linear":r,i=e.points,s=i===void 0?[]:i,o=e.baseLine,a=e.layout,l=e.connectNulls,c=l===void 0?!1:l,u=Nxe(n,a),h=c?s.filter(function(g){return Xv(g)}):s,d;if(Array.isArray(o)){var f=c?o.filter(function(g){return Xv(g)}):o,m=h.map(function(g,v){return TH(TH({},g),{},{base:f[v]})});return a==="vertical"?d=Hv().y(Rg).x1(_g).x0(function(g){return g.base.x}):d=Hv().x(_g).y1(Rg).y0(function(g){return g.base.y}),d.defined(Xv).curve(u),d(m)}return a==="vertical"&&Ue(o)?d=Hv().y(Rg).x1(_g).x0(o):Ue(o)?d=Hv().x(_g).y1(Rg).y0(o):d=UU().x(_g).y(Rg),d.defined(Xv).curve(u),d(h)},jx=function(e){var r=e.className,n=e.points,i=e.path,s=e.pathRef;if((!n||!n.length)&&!i)return null;var o=n&&n.length?Mxe(e):i;return oe.createElement("path",IA({},rt(e,!1),ux(e),{className:xt("recharts-curve",r),d:o,ref:s}))},q7={exports:{}},Pxe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Dxe=Pxe,Lxe=Dxe;function J7(){}function Z7(){}Z7.resetWarningCache=J7;var Fxe=function(){function t(n,i,s,o,a,l){if(l!==Lxe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Z7,resetWarningCache:J7};return r.PropTypes=r,r};q7.exports=Fxe();var $xe=q7.exports;const Ut=jt($xe);var Hxe=Object.getOwnPropertyNames,jxe=Object.getOwnPropertySymbols,Bxe=Object.prototype.hasOwnProperty;function RH(t,e){return function(n,i,s){return t(n,i,s)&&e(n,i,s)}}function qv(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);var s=i.cache,o=s.get(r),a=s.get(n);if(o&&a)return o===n&&a===r;s.set(r,n),s.set(n,r);var l=t(r,n,i);return s.delete(r),s.delete(n),l}}function AH(t){return Hxe(t).concat(jxe(t))}var Vxe=Object.hasOwn||function(t,e){return Bxe.call(t,e)};function th(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var Uxe="__v",Wxe="__o",zxe="_owner",OH=Object.getOwnPropertyDescriptor,kH=Object.keys;function Gxe(t,e,r){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function Yxe(t,e){return th(t.getTime(),e.getTime())}function Kxe(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function Xxe(t,e){return t===e}function IH(t,e,r){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var i=new Array(n),s=t.entries(),o,a,l=0;(o=s.next())&&!o.done;){for(var c=e.entries(),u=!1,h=0;(a=c.next())&&!a.done;){if(i[h]){h++;continue}var d=o.value,f=a.value;if(r.equals(d[0],f[0],l,h,t,e,r)&&r.equals(d[1],f[1],d[0],f[0],t,e,r)){u=i[h]=!0;break}h++}if(!u)return!1;l++}return!0}var qxe=th;function Jxe(t,e,r){var n=kH(t),i=n.length;if(kH(e).length!==i)return!1;for(;i-- >0;)if(!Q7(t,e,r,n[i]))return!1;return!0}function Ag(t,e,r){var n=AH(t),i=n.length;if(AH(e).length!==i)return!1;for(var s,o,a;i-- >0;)if(s=n[i],!Q7(t,e,r,s)||(o=OH(t,s),a=OH(e,s),(o||a)&&(!o||!a||o.configurable!==a.configurable||o.enumerable!==a.enumerable||o.writable!==a.writable)))return!1;return!0}function Zxe(t,e){return th(t.valueOf(),e.valueOf())}function Qxe(t,e){return t.source===e.source&&t.flags===e.flags}function NH(t,e,r){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var i=new Array(n),s=t.values(),o,a;(o=s.next())&&!o.done;){for(var l=e.values(),c=!1,u=0;(a=l.next())&&!a.done;){if(!i[u]&&r.equals(o.value,a.value,o.value,a.value,t,e,r)){c=i[u]=!0;break}u++}if(!c)return!1}return!0}function e1e(t,e){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function t1e(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function Q7(t,e,r,n){return(n===zxe||n===Wxe||n===Uxe)&&(t.$$typeof||e.$$typeof)?!0:Vxe(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}var r1e="[object Arguments]",n1e="[object Boolean]",i1e="[object Date]",s1e="[object Error]",o1e="[object Map]",a1e="[object Number]",l1e="[object Object]",c1e="[object RegExp]",u1e="[object Set]",h1e="[object String]",d1e="[object URL]",f1e=Array.isArray,MH=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,PH=Object.assign,g1e=Object.prototype.toString.call.bind(Object.prototype.toString);function m1e(t){var e=t.areArraysEqual,r=t.areDatesEqual,n=t.areErrorsEqual,i=t.areFunctionsEqual,s=t.areMapsEqual,o=t.areNumbersEqual,a=t.areObjectsEqual,l=t.arePrimitiveWrappersEqual,c=t.areRegExpsEqual,u=t.areSetsEqual,h=t.areTypedArraysEqual,d=t.areUrlsEqual;return function(m,g,v){if(m===g)return!0;if(m==null||g==null)return!1;var w=typeof m;if(w!==typeof g)return!1;if(w!=="object")return w==="number"?o(m,g,v):w==="function"?i(m,g,v):!1;var b=m.constructor;if(b!==g.constructor)return!1;if(b===Object)return a(m,g,v);if(f1e(m))return e(m,g,v);if(MH!=null&&MH(m))return h(m,g,v);if(b===Date)return r(m,g,v);if(b===RegExp)return c(m,g,v);if(b===Map)return s(m,g,v);if(b===Set)return u(m,g,v);var x=g1e(m);return x===i1e?r(m,g,v):x===c1e?c(m,g,v):x===o1e?s(m,g,v):x===u1e?u(m,g,v):x===l1e?typeof m.then!="function"&&typeof g.then!="function"&&a(m,g,v):x===d1e?d(m,g,v):x===s1e?n(m,g,v):x===r1e?a(m,g,v):x===n1e||x===a1e||x===h1e?l(m,g,v):!1}}function p1e(t){var e=t.circular,r=t.createCustomConfig,n=t.strict,i={areArraysEqual:n?Ag:Gxe,areDatesEqual:Yxe,areErrorsEqual:Kxe,areFunctionsEqual:Xxe,areMapsEqual:n?RH(IH,Ag):IH,areNumbersEqual:qxe,areObjectsEqual:n?Ag:Jxe,arePrimitiveWrappersEqual:Zxe,areRegExpsEqual:Qxe,areSetsEqual:n?RH(NH,Ag):NH,areTypedArraysEqual:n?Ag:e1e,areUrlsEqual:t1e};if(r&&(i=PH({},i,r(i))),e){var s=qv(i.areArraysEqual),o=qv(i.areMapsEqual),a=qv(i.areObjectsEqual),l=qv(i.areSetsEqual);i=PH({},i,{areArraysEqual:s,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:l})}return i}function v1e(t){return function(e,r,n,i,s,o,a){return t(e,r,a)}}function y1e(t){var e=t.circular,r=t.comparator,n=t.createState,i=t.equals,s=t.strict;if(n)return function(l,c){var u=n(),h=u.cache,d=h===void 0?e?new WeakMap:void 0:h,f=u.meta;return r(l,c,{cache:d,equals:i,meta:f,strict:s})};if(e)return function(l,c){return r(l,c,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var o={cache:void 0,equals:i,meta:void 0,strict:s};return function(l,c){return r(l,c,o)}}var w1e=_c();_c({strict:!0});_c({circular:!0});_c({circular:!0,strict:!0});_c({createInternalComparator:function(){return th}});_c({strict:!0,createInternalComparator:function(){return th}});_c({circular:!0,createInternalComparator:function(){return th}});_c({circular:!0,createInternalComparator:function(){return th},strict:!0});function _c(t){t===void 0&&(t={});var e=t.circular,r=e===void 0?!1:e,n=t.createInternalComparator,i=t.createState,s=t.strict,o=s===void 0?!1:s,a=p1e(t),l=m1e(a),c=n?n(l):v1e(l);return y1e({circular:r,comparator:l,createState:i,equals:c,strict:o})}function x1e(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function DH(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(s){r<0&&(r=s),s-r>e?(t(s),r=-1):x1e(i)};requestAnimationFrame(n)}function NA(t){"@babel/helpers - typeof";return NA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NA(t)}function b1e(t){return T1e(t)||E1e(t)||C1e(t)||S1e()}function S1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C1e(t,e){if(t){if(typeof t=="string")return LH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LH(t,e)}}function LH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function E1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function T1e(t){if(Array.isArray(t))return t}function _1e(){var t={},e=function(){return null},r=!1,n=function i(s){if(!r){if(Array.isArray(s)){if(!s.length)return;var o=s,a=b1e(o),l=a[0],c=a.slice(1);if(typeof l=="number"){DH(i.bind(null,c),l);return}i(l),DH(i.bind(null,c));return}NA(s)==="object"&&(t=s,e(t)),typeof s=="function"&&s()}};return{stop:function(){r=!0},start:function(s){r=!1,n(s)},subscribe:function(s){return e=s,function(){e=function(){return null}}}}}function Up(t){"@babel/helpers - typeof";return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Up(t)}function FH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $H(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FH(Object(r),!0).forEach(function(n){ez(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ez(t,e,r){return e=R1e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R1e(t){var e=A1e(t,"string");return Up(e)==="symbol"?e:String(e)}function A1e(t,e){if(Up(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var O1e=function(e,r){return[Object.keys(e),Object.keys(r)].reduce(function(n,i){return n.filter(function(s){return i.includes(s)})})},k1e=function(e){return e},I1e=function(e){return e.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Am=function(e,r){return Object.keys(r).reduce(function(n,i){return $H($H({},n),{},ez({},i,e(i,r[i])))},{})},HH=function(e,r,n){return e.map(function(i){return"".concat(I1e(i)," ").concat(r,"ms ").concat(n)}).join(",")};function N1e(t,e){return D1e(t)||P1e(t,e)||tz(t,e)||M1e()}function M1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P1e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function D1e(t){if(Array.isArray(t))return t}function L1e(t){return H1e(t)||$1e(t)||tz(t)||F1e()}function F1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tz(t,e){if(t){if(typeof t=="string")return MA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MA(t,e)}}function $1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function H1e(t){if(Array.isArray(t))return MA(t)}function MA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Bx=1e-4,rz=function(e,r){return[0,3*e,3*r-6*e,3*e-3*r+1]},nz=function(e,r){return e.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},jH=function(e,r){return function(n){var i=rz(e,r);return nz(i,n)}},j1e=function(e,r){return function(n){var i=rz(e,r),s=[].concat(L1e(i.map(function(o,a){return o*a}).slice(1)),[0]);return nz(s,n)}},BH=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0],s=r[1],o=r[2],a=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,s=0,o=1,a=1;break;case"ease":i=.25,s=.1,o=.25,a=1;break;case"ease-in":i=.42,s=0,o=1,a=1;break;case"ease-out":i=.42,s=0,o=.58,a=1;break;case"ease-in-out":i=0,s=0,o=.58,a=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),u=N1e(c,4);i=u[0],s=u[1],o=u[2],a=u[3]}}}var h=jH(i,o),d=jH(s,a),f=j1e(i,o),m=function(w){return w>1?1:w<0?0:w},g=function(w){for(var b=w>1?1:w,x=b,C=0;C<8;++C){var S=h(x)-b,E=f(x);if(Math.abs(S-b)<Bx||E<Bx)return d(x);x=m(x-S/E)}return d(x)};return g.isStepper=!1,g},B1e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.stiff,n=r===void 0?100:r,i=e.damping,s=i===void 0?8:i,o=e.dt,a=o===void 0?17:o,l=function(u,h,d){var f=-(u-h)*n,m=d*s,g=d+(f-m)*a/1e3,v=d*a/1e3+u;return Math.abs(v-h)<Bx&&Math.abs(g)<Bx?[h,0]:[v,g]};return l.isStepper=!0,l.dt=a,l},V1e=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return BH(i);case"spring":return B1e();default:if(i.split("(")[0]==="cubic-bezier")return BH(i)}return typeof i=="function"?i:null};function Wp(t){"@babel/helpers - typeof";return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wp(t)}function VH(t){return z1e(t)||W1e(t)||iz(t)||U1e()}function U1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function z1e(t){if(Array.isArray(t))return DA(t)}function UH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Pn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UH(Object(r),!0).forEach(function(n){PA(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PA(t,e,r){return e=G1e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G1e(t){var e=Y1e(t,"string");return Wp(e)==="symbol"?e:String(e)}function Y1e(t,e){if(Wp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function K1e(t,e){return J1e(t)||q1e(t,e)||iz(t,e)||X1e()}function X1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iz(t,e){if(t){if(typeof t=="string")return DA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DA(t,e)}}function DA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function q1e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function J1e(t){if(Array.isArray(t))return t}var Vx=function(e,r,n){return e+(r-e)*n},LA=function(e){var r=e.from,n=e.to;return r!==n},Z1e=function t(e,r,n){var i=Am(function(s,o){if(LA(o)){var a=e(o.from,o.to,o.velocity),l=K1e(a,2),c=l[0],u=l[1];return Pn(Pn({},o),{},{from:c,velocity:u})}return o},r);return n<1?Am(function(s,o){return LA(o)?Pn(Pn({},o),{},{velocity:Vx(o.velocity,i[s].velocity,n),from:Vx(o.from,i[s].from,n)}):o},r):t(e,i,n-1)};const Q1e=function(t,e,r,n,i){var s=O1e(t,e),o=s.reduce(function(v,w){return Pn(Pn({},v),{},PA({},w,[t[w],e[w]]))},{}),a=s.reduce(function(v,w){return Pn(Pn({},v),{},PA({},w,{from:t[w],velocity:0,to:e[w]}))},{}),l=-1,c,u,h=function(){return null},d=function(){return Am(function(w,b){return b.from},a)},f=function(){return!Object.values(a).filter(LA).length},m=function(w){c||(c=w);var b=w-c,x=b/r.dt;a=Z1e(r,a,x),i(Pn(Pn(Pn({},t),e),d())),c=w,f()||(l=requestAnimationFrame(h))},g=function(w){u||(u=w);var b=(w-u)/n,x=Am(function(S,E){return Vx.apply(void 0,VH(E).concat([r(b)]))},o);if(i(Pn(Pn(Pn({},t),e),x)),b<1)l=requestAnimationFrame(h);else{var C=Am(function(S,E){return Vx.apply(void 0,VH(E).concat([r(1)]))},o);i(Pn(Pn(Pn({},t),e),C))}};return h=r.isStepper?m:g,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(l)}}};function rf(t){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rf(t)}var ebe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function tbe(t,e){if(t==null)return{};var r=rbe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function rbe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function _E(t){return obe(t)||sbe(t)||ibe(t)||nbe()}function nbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ibe(t,e){if(t){if(typeof t=="string")return FA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FA(t,e)}}function sbe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function obe(t){if(Array.isArray(t))return FA(t)}function FA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ks(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WH(Object(r),!0).forEach(function(n){nm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nm(t,e,r){return e=sz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function abe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sz(n.key),n)}}function cbe(t,e,r){return e&&lbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function sz(t){var e=ube(t,"string");return rf(e)==="symbol"?e:String(e)}function ube(t,e){if(rf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$A(t,e)}function $A(t,e){return $A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$A(t,e)}function dbe(t){var e=fbe();return function(){var n=Ux(t),i;if(e){var s=Ux(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return HA(this,i)}}function HA(t,e){if(e&&(rf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jA(t)}function jA(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ux(t){return Ux=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ux(t)}var Qo=function(t){hbe(r,t);var e=dbe(r);function r(n,i){var s;abe(this,r),s=e.call(this,n,i);var o=s.props,a=o.isActive,l=o.attributeName,c=o.from,u=o.to,h=o.steps,d=o.children,f=o.duration;if(s.handleStyleChange=s.handleStyleChange.bind(jA(s)),s.changeStyle=s.changeStyle.bind(jA(s)),!a||f<=0)return s.state={style:{}},typeof d=="function"&&(s.state={style:u}),HA(s);if(h&&h.length)s.state={style:h[0].style};else if(c){if(typeof d=="function")return s.state={style:c},HA(s);s.state={style:l?nm({},l,c):c}}else s.state={style:{}};return s}return cbe(r,[{key:"componentDidMount",value:function(){var i=this.props,s=i.isActive,o=i.canBegin;this.mounted=!0,!(!s||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var s=this.props,o=s.isActive,a=s.canBegin,l=s.attributeName,c=s.shouldReAnimate,u=s.to,h=s.from,d=this.state.style;if(a){if(!o){var f={style:l?nm({},l,u):u};this.state&&d&&(l&&d[l]!==u||!l&&d!==u)&&this.setState(f);return}if(!(w1e(i.to,u)&&i.canBegin&&i.isActive)){var m=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=m||c?h:i.to;if(this.state&&d){var v={style:l?nm({},l,g):g};(l&&d[l]!==g||!l&&d!==g)&&this.setState(v)}this.runAnimation(Ks(Ks({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var s=this,o=i.from,a=i.to,l=i.duration,c=i.easing,u=i.begin,h=i.onAnimationEnd,d=i.onAnimationStart,f=Q1e(o,a,V1e(c),l,this.changeStyle),m=function(){s.stopJSAnimation=f()};this.manager.start([d,u,m,l,h])}},{key:"runStepAnimation",value:function(i){var s=this,o=i.steps,a=i.begin,l=i.onAnimationStart,c=o[0],u=c.style,h=c.duration,d=h===void 0?0:h,f=function(g,v,w){if(w===0)return g;var b=v.duration,x=v.easing,C=x===void 0?"ease":x,S=v.style,E=v.properties,T=v.onAnimationEnd,I=w>0?o[w-1]:v,k=E||Object.keys(S);if(typeof C=="function"||C==="spring")return[].concat(_E(g),[s.runJSAnimation.bind(s,{from:I.style,to:S,duration:b,easing:C}),b]);var M=HH(k,b,C),D=Ks(Ks(Ks({},I.style),S),{},{transition:M});return[].concat(_E(g),[D,b,T]).filter(k1e)};return this.manager.start([l].concat(_E(o.reduce(f,[u,Math.max(d,a)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=_1e());var s=i.begin,o=i.duration,a=i.attributeName,l=i.to,c=i.easing,u=i.onAnimationStart,h=i.onAnimationEnd,d=i.steps,f=i.children,m=this.manager;if(this.unSubscribe=m.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(i);return}if(d.length>1){this.runStepAnimation(i);return}var g=a?nm({},a,l):l,v=HH(Object.keys(g),o,c);m.start([u,s,Ks(Ks({},g),{},{transition:v}),o,h])}},{key:"render",value:function(){var i=this.props,s=i.children;i.begin;var o=i.duration;i.attributeName,i.easing;var a=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var l=tbe(i,ebe),c=G.Children.count(s),u=this.state.style;if(typeof s=="function")return s(u);if(!a||c===0||o<=0)return s;var h=function(f){var m=f.props,g=m.style,v=g===void 0?{}:g,w=m.className,b=G.cloneElement(f,Ks(Ks({},l),{},{style:Ks(Ks({},v),u),className:w}));return b};return c===1?h(G.Children.only(s)):oe.createElement("div",null,G.Children.map(s,function(d){return h(d)}))}}]),r}(G.PureComponent);Qo.displayName="Animate";Qo.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Qo.propTypes={from:Ut.oneOfType([Ut.object,Ut.string]),to:Ut.oneOfType([Ut.object,Ut.string]),attributeName:Ut.string,duration:Ut.number,begin:Ut.number,easing:Ut.oneOfType([Ut.string,Ut.func]),steps:Ut.arrayOf(Ut.shape({duration:Ut.number.isRequired,style:Ut.object.isRequired,easing:Ut.oneOfType([Ut.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ut.func]),properties:Ut.arrayOf("string"),onAnimationEnd:Ut.func})),children:Ut.oneOfType([Ut.node,Ut.func]),isActive:Ut.bool,canBegin:Ut.bool,onAnimationEnd:Ut.func,shouldReAnimate:Ut.bool,onAnimationStart:Ut.func,onAnimationReStart:Ut.func};function zp(t){"@babel/helpers - typeof";return zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zp(t)}function Wx(){return Wx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wx.apply(this,arguments)}function gbe(t,e){return ybe(t)||vbe(t,e)||pbe(t,e)||mbe()}function mbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pbe(t,e){if(t){if(typeof t=="string")return zH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zH(t,e)}}function zH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vbe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function ybe(t){if(Array.isArray(t))return t}function GH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function YH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GH(Object(r),!0).forEach(function(n){wbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wbe(t,e,r){return e=xbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xbe(t){var e=bbe(t,"string");return zp(e)=="symbol"?e:e+""}function bbe(t,e){if(zp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KH=function(e,r,n,i,s){var o=Math.min(Math.abs(n)/2,Math.abs(i)/2),a=i>=0?1:-1,l=n>=0?1:-1,c=i>=0&&n>=0||i<0&&n<0?1:0,u;if(o>0&&s instanceof Array){for(var h=[0,0,0,0],d=0,f=4;d<f;d++)h[d]=s[d]>o?o:s[d];u="M".concat(e,",").concat(r+a*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(c,",").concat(e+l*h[0],",").concat(r)),u+="L ".concat(e+n-l*h[1],",").concat(r),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(r+a*h[1])),u+="L ".concat(e+n,",").concat(r+i-a*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(c,`,
        `).concat(e+n-l*h[2],",").concat(r+i)),u+="L ".concat(e+l*h[3],",").concat(r+i),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(r+i-a*h[3])),u+="Z"}else if(o>0&&s===+s&&s>0){var m=Math.min(o,s);u="M ".concat(e,",").concat(r+a*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+l*m,",").concat(r,`
            L `).concat(e+n-l*m,",").concat(r,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+n,",").concat(r+a*m,`
            L `).concat(e+n,",").concat(r+i-a*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+n-l*m,",").concat(r+i,`
            L `).concat(e+l*m,",").concat(r+i,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e,",").concat(r+i-a*m," Z")}else u="M ".concat(e,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return u},Sbe=function(e,r){if(!e||!r)return!1;var n=e.x,i=e.y,s=r.x,o=r.y,a=r.width,l=r.height;if(Math.abs(a)>0&&Math.abs(l)>0){var c=Math.min(s,s+a),u=Math.max(s,s+a),h=Math.min(o,o+l),d=Math.max(o,o+l);return n>=c&&n<=u&&i>=h&&i<=d}return!1},Cbe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},TI=function(e){var r=YH(YH({},Cbe),e),n=G.useRef(),i=G.useState(-1),s=gbe(i,2),o=s[0],a=s[1];G.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var C=n.current.getTotalLength();C&&a(C)}catch{}},[]);var l=r.x,c=r.y,u=r.width,h=r.height,d=r.radius,f=r.className,m=r.animationEasing,g=r.animationDuration,v=r.animationBegin,w=r.isAnimationActive,b=r.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||h!==+h||u===0||h===0)return null;var x=xt("recharts-rectangle",f);return b?oe.createElement(Qo,{canBegin:o>0,from:{width:u,height:h,x:l,y:c},to:{width:u,height:h,x:l,y:c},duration:g,animationEasing:m,isActive:b},function(C){var S=C.width,E=C.height,T=C.x,I=C.y;return oe.createElement(Qo,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,isActive:w,easing:m},oe.createElement("path",Wx({},rt(r,!0),{className:x,d:KH(T,I,S,E,d),ref:n})))}):oe.createElement("path",Wx({},rt(r,!0),{className:x,d:KH(l,c,u,h,d)}))},Ebe=["points","className","baseLinePoints","connectNulls"];function ld(){return ld=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ld.apply(this,arguments)}function Tbe(t,e){if(t==null)return{};var r=_be(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function _be(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function XH(t){return kbe(t)||Obe(t)||Abe(t)||Rbe()}function Rbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Abe(t,e){if(t){if(typeof t=="string")return BA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BA(t,e)}}function Obe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function kbe(t){if(Array.isArray(t))return BA(t)}function BA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var qH=function(e){return e&&e.x===+e.x&&e.y===+e.y},Ibe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return e.forEach(function(n){qH(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),qH(e[0])&&r[r.length-1].push(e[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Om=function(e,r){var n=Ibe(e);r&&(n=[n.reduce(function(s,o){return[].concat(XH(s),XH(o))},[])]);var i=n.map(function(s){return s.reduce(function(o,a,l){return"".concat(o).concat(l===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return n.length===1?"".concat(i,"Z"):i},Nbe=function(e,r,n){var i=Om(e,n);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(Om(r.reverse(),n).slice(1))},Mbe=function(e){var r=e.points,n=e.className,i=e.baseLinePoints,s=e.connectNulls,o=Tbe(e,Ebe);if(!r||!r.length)return null;var a=xt("recharts-polygon",n);if(i&&i.length){var l=o.stroke&&o.stroke!=="none",c=Nbe(r,i,s);return oe.createElement("g",{className:a},oe.createElement("path",ld({},rt(o,!0),{fill:c.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:c})),l?oe.createElement("path",ld({},rt(o,!0),{fill:"none",d:Om(r,s)})):null,l?oe.createElement("path",ld({},rt(o,!0),{fill:"none",d:Om(i,s)})):null)}var u=Om(r,s);return oe.createElement("path",ld({},rt(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:a,d:u}))};function VA(){return VA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},VA.apply(this,arguments)}var iS=function(e){var r=e.cx,n=e.cy,i=e.r,s=e.className,o=xt("recharts-dot",s);return r===+r&&n===+n&&i===+i?oe.createElement("circle",VA({},rt(e,!1),ux(e),{className:o,cx:r,cy:n,r:i})):null};function Gp(t){"@babel/helpers - typeof";return Gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gp(t)}var Pbe=["x","y","top","left","width","height","className"];function UA(){return UA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},UA.apply(this,arguments)}function JH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Dbe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JH(Object(r),!0).forEach(function(n){Lbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lbe(t,e,r){return e=Fbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fbe(t){var e=$be(t,"string");return Gp(e)=="symbol"?e:e+""}function $be(t,e){if(Gp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Gp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hbe(t,e){if(t==null)return{};var r=jbe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function jbe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Bbe=function(e,r,n,i,s,o){return"M".concat(e,",").concat(s,"v").concat(i,"M").concat(o,",").concat(r,"h").concat(n)},Vbe=function(e){var r=e.x,n=r===void 0?0:r,i=e.y,s=i===void 0?0:i,o=e.top,a=o===void 0?0:o,l=e.left,c=l===void 0?0:l,u=e.width,h=u===void 0?0:u,d=e.height,f=d===void 0?0:d,m=e.className,g=Hbe(e,Pbe),v=Dbe({x:n,y:s,top:a,left:c,width:h,height:f},g);return!Ue(n)||!Ue(s)||!Ue(h)||!Ue(f)||!Ue(a)||!Ue(c)?null:oe.createElement("path",UA({},rt(v,!0),{className:xt("recharts-cross",m),d:Bbe(n,s,h,f,a,c)}))},Ube=Qb,Wbe=v7,zbe=sa;function Gbe(t,e){return t&&t.length?Ube(t,zbe(e),Wbe):void 0}var Ybe=Gbe;const Kbe=jt(Ybe);var Xbe=Qb,qbe=sa,Jbe=y7;function Zbe(t,e){return t&&t.length?Xbe(t,qbe(e),Jbe):void 0}var Qbe=Zbe;const eSe=jt(Qbe);var tSe=["cx","cy","angle","ticks","axisLine"],rSe=["ticks","tick","angle","tickFormatter","stroke"];function nf(t){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nf(t)}function km(){return km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},km.apply(this,arguments)}function ZH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZH(Object(r),!0).forEach(function(n){sS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QH(t,e){if(t==null)return{};var r=nSe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function nSe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function iSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,az(n.key),n)}}function sSe(t,e,r){return e&&e4(t.prototype,e),r&&e4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oSe(t,e,r){return e=zx(e),aSe(t,oz()?Reflect.construct(e,r||[],zx(t).constructor):e.apply(t,r))}function aSe(t,e){if(e&&(nf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lSe(t)}function lSe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oz=function(){return!!t})()}function zx(t){return zx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zx(t)}function cSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&WA(t,e)}function WA(t,e){return WA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WA(t,e)}function sS(t,e,r){return e=az(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function az(t){var e=uSe(t,"string");return nf(e)=="symbol"?e:e+""}function uSe(t,e){if(nf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var oS=function(t){function e(){return iSe(this,e),oSe(this,e,arguments)}return cSe(e,t),sSe(e,[{key:"getTickValueCoord",value:function(n){var i=n.coordinate,s=this.props,o=s.angle,a=s.cx,l=s.cy;return hr(a,l,i,o)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,i;switch(n){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var n=this.props,i=n.cx,s=n.cy,o=n.angle,a=n.ticks,l=Kbe(a,function(u){return u.coordinate||0}),c=eSe(a,function(u){return u.coordinate||0});return{cx:i,cy:s,startAngle:o,endAngle:o,innerRadius:c.coordinate||0,outerRadius:l.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,s=n.cy,o=n.angle,a=n.ticks,l=n.axisLine,c=QH(n,tSe),u=a.reduce(function(m,g){return[Math.min(m[0],g.coordinate),Math.max(m[1],g.coordinate)]},[1/0,-1/0]),h=hr(i,s,u[0],o),d=hr(i,s,u[1],o),f=Mc(Mc(Mc({},rt(c,!1)),{},{fill:"none"},rt(l,!1)),{},{x1:h.x,y1:h.y,x2:d.x,y2:d.y});return oe.createElement("line",km({className:"recharts-polar-radius-axis-line"},f))}},{key:"renderTicks",value:function(){var n=this,i=this.props,s=i.ticks,o=i.tick,a=i.angle,l=i.tickFormatter,c=i.stroke,u=QH(i,rSe),h=this.getTickTextAnchor(),d=rt(u,!1),f=rt(o,!1),m=s.map(function(g,v){var w=n.getTickValueCoord(g),b=Mc(Mc(Mc(Mc({textAnchor:h,transform:"rotate(".concat(90-a,", ").concat(w.x,", ").concat(w.y,")")},d),{},{stroke:"none",fill:c},f),{},{index:v},w),{},{payload:g});return oe.createElement(Ft,km({className:xt("recharts-polar-radius-axis-tick",G7(o)),key:"tick-".concat(g.coordinate)},Du(n.props,g,v)),e.renderTickItem(o,b,l?l(g.value,v):g.value))});return oe.createElement(Ft,{className:"recharts-polar-radius-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,i=n.ticks,s=n.axisLine,o=n.tick;return!i||!i.length?null:oe.createElement(Ft,{className:xt("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),o&&this.renderTicks(),_n.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,i,s){var o;return oe.isValidElement(n)?o=oe.cloneElement(n,i):at(n)?o=n(i):o=oe.createElement(Lu,km({},i,{className:"recharts-polar-radius-axis-tick-value"}),s),o}}])}(G.PureComponent);sS(oS,"displayName","PolarRadiusAxis");sS(oS,"axisType","radiusAxis");sS(oS,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function sf(t){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sf(t)}function iu(){return iu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},iu.apply(this,arguments)}function t4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Pc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?t4(Object(r),!0).forEach(function(n){aS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cz(n.key),n)}}function dSe(t,e,r){return e&&r4(t.prototype,e),r&&r4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fSe(t,e,r){return e=Gx(e),gSe(t,lz()?Reflect.construct(e,r||[],Gx(t).constructor):e.apply(t,r))}function gSe(t,e){if(e&&(sf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mSe(t)}function mSe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lz=function(){return!!t})()}function Gx(t){return Gx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gx(t)}function pSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zA(t,e)}function zA(t,e){return zA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zA(t,e)}function aS(t,e,r){return e=cz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cz(t){var e=vSe(t,"string");return sf(e)=="symbol"?e:e+""}function vSe(t,e){if(sf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ySe=Math.PI/180,wSe=1e-5,lS=function(t){function e(){return hSe(this,e),fSe(this,e,arguments)}return pSe(e,t),dSe(e,[{key:"getTickLineCoord",value:function(n){var i=this.props,s=i.cx,o=i.cy,a=i.radius,l=i.orientation,c=i.tickSize,u=c||8,h=hr(s,o,a,n.coordinate),d=hr(s,o,a+(l==="inner"?-1:1)*u,n.coordinate);return{x1:h.x,y1:h.y,x2:d.x,y2:d.y}}},{key:"getTickTextAnchor",value:function(n){var i=this.props.orientation,s=Math.cos(-n.coordinate*ySe),o;return s>wSe?o=i==="outer"?"start":"end":s<-1e-5?o=i==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,s=n.cy,o=n.radius,a=n.axisLine,l=n.axisLineType,c=Pc(Pc({},rt(this.props,!1)),{},{fill:"none"},rt(a,!1));if(l==="circle")return oe.createElement(iS,iu({className:"recharts-polar-angle-axis-line"},c,{cx:i,cy:s,r:o}));var u=this.props.ticks,h=u.map(function(d){return hr(i,s,o,d.coordinate)});return oe.createElement(Mbe,iu({className:"recharts-polar-angle-axis-line"},c,{points:h}))}},{key:"renderTicks",value:function(){var n=this,i=this.props,s=i.ticks,o=i.tick,a=i.tickLine,l=i.tickFormatter,c=i.stroke,u=rt(this.props,!1),h=rt(o,!1),d=Pc(Pc({},u),{},{fill:"none"},rt(a,!1)),f=s.map(function(m,g){var v=n.getTickLineCoord(m),w=n.getTickTextAnchor(m),b=Pc(Pc(Pc({textAnchor:w},u),{},{stroke:"none",fill:c},h),{},{index:g,payload:m,x:v.x2,y:v.y2});return oe.createElement(Ft,iu({className:xt("recharts-polar-angle-axis-tick",G7(o)),key:"tick-".concat(m.coordinate)},Du(n.props,m,g)),a&&oe.createElement("line",iu({className:"recharts-polar-angle-axis-tick-line"},d,v)),o&&e.renderTickItem(o,b,l?l(m.value,g):m.value))});return oe.createElement(Ft,{className:"recharts-polar-angle-axis-ticks"},f)}},{key:"render",value:function(){var n=this.props,i=n.ticks,s=n.radius,o=n.axisLine;return s<=0||!i||!i.length?null:oe.createElement(Ft,{className:xt("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,i,s){var o;return oe.isValidElement(n)?o=oe.cloneElement(n,i):at(n)?o=n(i):o=oe.createElement(Lu,iu({},i,{className:"recharts-polar-angle-axis-tick-value"}),s),o}}])}(G.PureComponent);aS(lS,"displayName","PolarAngleAxis");aS(lS,"axisType","angleAxis");aS(lS,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var xSe=fW,bSe=xSe(Object.getPrototypeOf,Object),SSe=bSe,CSe=al,ESe=SSe,TSe=ll,_Se="[object Object]",RSe=Function.prototype,ASe=Object.prototype,uz=RSe.toString,OSe=ASe.hasOwnProperty,kSe=uz.call(Object);function ISe(t){if(!TSe(t)||CSe(t)!=_Se)return!1;var e=ESe(t);if(e===null)return!0;var r=OSe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&uz.call(r)==kSe}var NSe=ISe;const MSe=jt(NSe);var PSe=al,DSe=ll,LSe="[object Boolean]";function FSe(t){return t===!0||t===!1||DSe(t)&&PSe(t)==LSe}var $Se=FSe;const HSe=jt($Se);function Yp(t){"@babel/helpers - typeof";return Yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yp(t)}function Yx(){return Yx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yx.apply(this,arguments)}function jSe(t,e){return WSe(t)||USe(t,e)||VSe(t,e)||BSe()}function BSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VSe(t,e){if(t){if(typeof t=="string")return n4(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n4(t,e)}}function n4(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function USe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function WSe(t){if(Array.isArray(t))return t}function i4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function s4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?i4(Object(r),!0).forEach(function(n){zSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zSe(t,e,r){return e=GSe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GSe(t){var e=YSe(t,"string");return Yp(e)=="symbol"?e:e+""}function YSe(t,e){if(Yp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Yp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var o4=function(e,r,n,i,s){var o=n-i,a;return a="M ".concat(e,",").concat(r),a+="L ".concat(e+n,",").concat(r),a+="L ".concat(e+n-o/2,",").concat(r+s),a+="L ".concat(e+n-o/2-i,",").concat(r+s),a+="L ".concat(e,",").concat(r," Z"),a},KSe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},XSe=function(e){var r=s4(s4({},KSe),e),n=G.useRef(),i=G.useState(-1),s=jSe(i,2),o=s[0],a=s[1];G.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var x=n.current.getTotalLength();x&&a(x)}catch{}},[]);var l=r.x,c=r.y,u=r.upperWidth,h=r.lowerWidth,d=r.height,f=r.className,m=r.animationEasing,g=r.animationDuration,v=r.animationBegin,w=r.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||h!==+h||d!==+d||u===0&&h===0||d===0)return null;var b=xt("recharts-trapezoid",f);return w?oe.createElement(Qo,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:l,y:c},to:{upperWidth:u,lowerWidth:h,height:d,x:l,y:c},duration:g,animationEasing:m,isActive:w},function(x){var C=x.upperWidth,S=x.lowerWidth,E=x.height,T=x.x,I=x.y;return oe.createElement(Qo,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,easing:m},oe.createElement("path",Yx({},rt(r,!0),{className:b,d:o4(T,I,C,S,E),ref:n})))}):oe.createElement("g",null,oe.createElement("path",Yx({},rt(r,!0),{className:b,d:o4(l,c,u,h,d)})))},qSe=["option","shapeType","propTransformer","activeClassName","isActive"];function Kp(t){"@babel/helpers - typeof";return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kp(t)}function JSe(t,e){if(t==null)return{};var r=ZSe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ZSe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function a4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a4(Object(r),!0).forEach(function(n){QSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QSe(t,e,r){return e=eCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eCe(t){var e=tCe(t,"string");return Kp(e)=="symbol"?e:e+""}function tCe(t,e){if(Kp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Kp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rCe(t,e){return Kx(Kx({},e),t)}function nCe(t,e){return t==="symbols"}function l4(t){var e=t.shapeType,r=t.elementProps;switch(e){case"rectangle":return oe.createElement(TI,r);case"trapezoid":return oe.createElement(XSe,r);case"sector":return oe.createElement(X7,r);case"symbols":if(nCe(e))return oe.createElement(U2,r);break;default:return null}}function iCe(t){return G.isValidElement(t)?t.props:t}function hz(t){var e=t.option,r=t.shapeType,n=t.propTransformer,i=n===void 0?rCe:n,s=t.activeClassName,o=s===void 0?"recharts-active-shape":s,a=t.isActive,l=JSe(t,qSe),c;if(G.isValidElement(e))c=G.cloneElement(e,Kx(Kx({},l),iCe(e)));else if(at(e))c=e(l);else if(MSe(e)&&!HSe(e)){var u=i(e,l);c=oe.createElement(l4,{shapeType:r,elementProps:u})}else{var h=l;c=oe.createElement(l4,{shapeType:r,elementProps:h})}return a?oe.createElement(Ft,{className:o},c):c}function cS(t,e){return e!=null&&"trapezoids"in t.props}function uS(t,e){return e!=null&&"sectors"in t.props}function Xp(t,e){return e!=null&&"points"in t.props}function sCe(t,e){var r,n,i=t.x===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.x)||t.x===e.x,s=t.y===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.y)||t.y===e.y;return i&&s}function oCe(t,e){var r=t.endAngle===e.endAngle,n=t.startAngle===e.startAngle;return r&&n}function aCe(t,e){var r=t.x===e.x,n=t.y===e.y,i=t.z===e.z;return r&&n&&i}function lCe(t,e){var r;return cS(t,e)?r=sCe:uS(t,e)?r=oCe:Xp(t,e)&&(r=aCe),r}function cCe(t,e){var r;return cS(t,e)?r="trapezoids":uS(t,e)?r="sectors":Xp(t,e)&&(r="points"),r}function uCe(t,e){if(cS(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(uS(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Xp(t,e)?e.payload:{}}function hCe(t){var e=t.activeTooltipItem,r=t.graphicalItem,n=t.itemData,i=cCe(r,e),s=uCe(r,e),o=n.filter(function(l,c){var u=W0(s,l),h=r.props[i].filter(function(m){var g=lCe(r,e);return g(m,e)}),d=r.props[i].indexOf(h[h.length-1]),f=c===d;return u&&f}),a=n.indexOf(o[o.length-1]);return a}var yw;function of(t){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},of(t)}function cd(){return cd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},cd.apply(this,arguments)}function c4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c4(Object(r),!0).forEach(function(n){As(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fz(n.key),n)}}function fCe(t,e,r){return e&&u4(t.prototype,e),r&&u4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gCe(t,e,r){return e=Xx(e),mCe(t,dz()?Reflect.construct(e,r||[],Xx(t).constructor):e.apply(t,r))}function mCe(t,e){if(e&&(of(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pCe(t)}function pCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dz=function(){return!!t})()}function Xx(t){return Xx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xx(t)}function vCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GA(t,e)}function GA(t,e){return GA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GA(t,e)}function As(t,e,r){return e=fz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fz(t){var e=yCe(t,"string");return of(e)=="symbol"?e:e+""}function yCe(t,e){if(of(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ul=function(t){function e(r){var n;return dCe(this,e),n=gCe(this,e,[r]),As(n,"pieRef",null),As(n,"sectorRefs",[]),As(n,"id",jf("recharts-pie-")),As(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),at(i)&&i()}),As(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),at(i)&&i()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return vCe(e,t),fCe(e,[{key:"isActiveIndex",value:function(n){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(n)!==-1:n===i}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.label,a=s.labelLine,l=s.dataKey,c=s.valueKey,u=rt(this.props,!1),h=rt(o,!1),d=rt(a,!1),f=o&&o.offsetRadius||20,m=n.map(function(g,v){var w=(g.startAngle+g.endAngle)/2,b=hr(g.cx,g.cy,g.outerRadius+f,w),x=sr(sr(sr(sr({},u),g),{},{stroke:"none"},h),{},{index:v,textAnchor:e.getTextAnchor(b.x,g.cx)},b),C=sr(sr(sr(sr({},u),g),{},{fill:"none",stroke:g.fill},d),{},{index:v,points:[hr(g.cx,g.cy,g.outerRadius,w),b]}),S=l;return dt(l)&&dt(c)?S="value":dt(l)&&(S=c),oe.createElement(Ft,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(v)},a&&e.renderLabelLineItem(a,C,"line"),e.renderLabelItem(o,x,fn(g,S)))});return oe.createElement(Ft,{className:"recharts-pie-labels"},m)}},{key:"renderSectorsStatically",value:function(n){var i=this,s=this.props,o=s.activeShape,a=s.blendStroke,l=s.inactiveShape;return n.map(function(c,u){if((c==null?void 0:c.startAngle)===0&&(c==null?void 0:c.endAngle)===0&&n.length!==1)return null;var h=i.isActiveIndex(u),d=l&&i.hasActiveIndex()?l:null,f=h?o:d,m=sr(sr({},c),{},{stroke:a?c.fill:c.stroke,tabIndex:-1});return oe.createElement(Ft,cd({ref:function(v){v&&!i.sectorRefs.includes(v)&&i.sectorRefs.push(v)},tabIndex:-1,className:"recharts-pie-sector"},Du(i.props,c,u),{key:"sector-".concat(c==null?void 0:c.startAngle,"-").concat(c==null?void 0:c.endAngle,"-").concat(c.midAngle,"-").concat(u)}),oe.createElement(hz,cd({option:f,isActive:h,shapeType:"sector"},m)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,i=this.props,s=i.sectors,o=i.isAnimationActive,a=i.animationBegin,l=i.animationDuration,c=i.animationEasing,u=i.animationId,h=this.state,d=h.prevSectors,f=h.prevIsAnimationActive;return oe.createElement(Qo,{begin:a,duration:l,isActive:o,easing:c,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(f),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(m){var g=m.t,v=[],w=s&&s[0],b=w.startAngle;return s.forEach(function(x,C){var S=d&&d[C],E=C>0?is(x,"paddingAngle",0):0;if(S){var T=qi(S.endAngle-S.startAngle,x.endAngle-x.startAngle),I=sr(sr({},x),{},{startAngle:b+E,endAngle:b+T(g)+E});v.push(I),b=I.endAngle}else{var k=x.endAngle,M=x.startAngle,D=qi(0,k-M),L=D(g),U=sr(sr({},x),{},{startAngle:b+E,endAngle:b+L+E});v.push(U),b=U.endAngle}}),oe.createElement(Ft,null,n.renderSectorsStatically(v))})}},{key:"attachKeyboardHandlers",value:function(n){var i=this;n.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var o=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[o].focus(),i.setState({sectorToFocus:o});break}case"ArrowRight":{var a=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[a].focus(),i.setState({sectorToFocus:a});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,i=n.sectors,s=n.isAnimationActive,o=this.state.prevSectors;return s&&i&&i.length&&(!o||!W0(o,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,i=this.props,s=i.hide,o=i.sectors,a=i.className,l=i.label,c=i.cx,u=i.cy,h=i.innerRadius,d=i.outerRadius,f=i.isAnimationActive,m=this.state.isAnimationFinished;if(s||!o||!o.length||!Ue(c)||!Ue(u)||!Ue(h)||!Ue(d))return null;var g=xt("recharts-pie",a);return oe.createElement(Ft,{tabIndex:this.props.rootTabIndex,className:g,ref:function(w){n.pieRef=w}},this.renderSectors(),l&&this.renderLabels(o),_n.renderCallByParent(this.props,null,!1),(!f||m)&&Ua.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return i.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:n.sectors!==i.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,i){return n>i?"start":n<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,i,s){if(oe.isValidElement(n))return oe.cloneElement(n,i);if(at(n))return n(i);var o=xt("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return oe.createElement(jx,cd({},i,{key:s,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(n,i,s){if(oe.isValidElement(n))return oe.cloneElement(n,i);var o=s;if(at(n)&&(o=n(i),oe.isValidElement(o)))return o;var a=xt("recharts-pie-label-text",typeof n!="boolean"&&!at(n)?n.className:"");return oe.createElement(Lu,cd({},i,{alignmentBaseline:"middle",className:a}),o)}}])}(G.PureComponent);yw=ul;As(ul,"displayName","Pie");As(ul,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Zu.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});As(ul,"parseDeltaAngle",function(t,e){var r=mi(e-t),n=Math.min(Math.abs(e-t),360);return r*n});As(ul,"getRealPieData",function(t){var e=t.data,r=t.children,n=rt(t,!1),i=ss(r,Gb);return e&&e.length?e.map(function(s,o){return sr(sr(sr({payload:s},n),s),i&&i[o]&&i[o].props)}):i&&i.length?i.map(function(s){return sr(sr({},n),s.props)}):[]});As(ul,"parseCoordinateOfPie",function(t,e){var r=e.top,n=e.left,i=e.width,s=e.height,o=z7(i,s),a=n+pi(t.cx,i,i/2),l=r+pi(t.cy,s,s/2),c=pi(t.innerRadius,o,0),u=pi(t.outerRadius,o,o*.8),h=t.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:a,cy:l,innerRadius:c,outerRadius:u,maxRadius:h}});As(ul,"getComposedData",function(t){var e=t.item,r=t.offset,n=e.type.defaultProps!==void 0?sr(sr({},e.type.defaultProps),e.props):e.props,i=yw.getRealPieData(n);if(!i||!i.length)return null;var s=n.cornerRadius,o=n.startAngle,a=n.endAngle,l=n.paddingAngle,c=n.dataKey,u=n.nameKey,h=n.valueKey,d=n.tooltipType,f=Math.abs(n.minAngle),m=yw.parseCoordinateOfPie(n,r),g=yw.parseDeltaAngle(o,a),v=Math.abs(g),w=c;dt(c)&&dt(h)?(mo(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),w="value"):dt(c)&&(mo(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),w=h);var b=i.filter(function(I){return fn(I,w,0)!==0}).length,x=(v>=360?b:b-1)*l,C=v-b*f-x,S=i.reduce(function(I,k){var M=fn(k,w,0);return I+(Ue(M)?M:0)},0),E;if(S>0){var T;E=i.map(function(I,k){var M=fn(I,w,0),D=fn(I,u,k),L=(Ue(M)?M:0)/S,U;k?U=T.endAngle+mi(g)*l*(M!==0?1:0):U=o;var J=U+mi(g)*((M!==0?f:0)+L*C),X=(U+J)/2,ie=(m.innerRadius+m.outerRadius)/2,se=[{name:D,value:M,payload:I,dataKey:w,type:d}],P=hr(m.cx,m.cy,ie,X);return T=sr(sr(sr({percent:L,cornerRadius:s,name:D,tooltipPayload:se,midAngle:X,middleRadius:ie,tooltipPosition:P},I),m),{},{value:fn(I,w),startAngle:U,endAngle:J,payload:I,paddingAngle:mi(g)*l}),T})}return sr(sr({},m),{},{sectors:E,data:i})});var wCe=Math.ceil,xCe=Math.max;function bCe(t,e,r,n){for(var i=-1,s=xCe(wCe((e-t)/(r||1)),0),o=Array(s);s--;)o[n?s:++i]=t,t+=r;return o}var SCe=bCe,CCe=NW,ECe=1/0,TCe=17976931348623157e292;function _Ce(t){if(!t)return t===0?t:0;if(t=CCe(t),t===ECe||t===-1/0){var e=t<0?-1:1;return e*TCe}return t===t?t:0}var gz=_Ce,RCe=SCe,ACe=zb,RE=gz;function OCe(t){return function(e,r,n){return n&&typeof n!="number"&&ACe(e,r,n)&&(r=n=void 0),e=RE(e),r===void 0?(r=e,e=0):r=RE(r),n=n===void 0?e<r?1:-1:RE(n),RCe(e,r,n,t)}}var kCe=OCe,ICe=kCe,NCe=ICe(),MCe=NCe;const qx=jt(MCe);function qp(t){"@babel/helpers - typeof";return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qp(t)}function h4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function d4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h4(Object(r),!0).forEach(function(n){mz(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mz(t,e,r){return e=PCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PCe(t){var e=DCe(t,"string");return qp(e)=="symbol"?e:e+""}function DCe(t,e){if(qp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(qp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LCe=["Webkit","Moz","O","ms"],FCe=function(e,r){var n=e.replace(/(\w)/,function(s){return s.toUpperCase()}),i=LCe.reduce(function(s,o){return d4(d4({},s),{},mz({},o+n,r))},{});return i[e]=r,i};function af(t){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},af(t)}function Jx(){return Jx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jx.apply(this,arguments)}function f4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function AE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?f4(Object(r),!0).forEach(function(n){Yi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $Ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vz(n.key),n)}}function HCe(t,e,r){return e&&g4(t.prototype,e),r&&g4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jCe(t,e,r){return e=Zx(e),BCe(t,pz()?Reflect.construct(e,r||[],Zx(t).constructor):e.apply(t,r))}function BCe(t,e){if(e&&(af(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VCe(t)}function VCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pz=function(){return!!t})()}function Zx(t){return Zx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zx(t)}function UCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&YA(t,e)}function YA(t,e){return YA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YA(t,e)}function Yi(t,e,r){return e=vz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vz(t){var e=WCe(t,"string");return af(e)=="symbol"?e:e+""}function WCe(t,e){if(af(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var zCe=function(e){var r=e.data,n=e.startIndex,i=e.endIndex,s=e.x,o=e.width,a=e.travellerWidth;if(!r||!r.length)return{};var l=r.length,c=_m().domain(qx(0,l)).range([s,s+o-a]),u=c.domain().map(function(h){return c(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(i),scale:c,scaleValues:u}},m4=function(e){return e.changedTouches&&!!e.changedTouches.length},lf=function(t){function e(r){var n;return $Ce(this,e),n=jCe(this,e,[r]),Yi(n,"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),Yi(n,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),Yi(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,s=i.endIndex,o=i.onDragEnd,a=i.startIndex;o==null||o({endIndex:s,startIndex:a})}),n.detachDragEndListener()}),Yi(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Yi(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Yi(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Yi(n,"handleSlideDragStart",function(i){var s=m4(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return UCe(e,t),HCe(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,s=n.endX,o=this.state.scaleValues,a=this.props,l=a.gap,c=a.data,u=c.length-1,h=Math.min(i,s),d=Math.max(i,s),f=e.getIndexInRange(o,h),m=e.getIndexInRange(o,d);return{startIndex:f-f%l,endIndex:m===u?u:m-m%l}}},{key:"getTextOfTick",value:function(n){var i=this.props,s=i.data,o=i.tickFormatter,a=i.dataKey,l=fn(s[n],a,n);return at(o)?o(l,n):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,s=i.slideMoveStartX,o=i.startX,a=i.endX,l=this.props,c=l.x,u=l.width,h=l.travellerWidth,d=l.startIndex,f=l.endIndex,m=l.onChange,g=n.pageX-s;g>0?g=Math.min(g,c+u-h-a,c+u-h-o):g<0&&(g=Math.max(g,c-o,c-a));var v=this.getIndex({startX:o+g,endX:a+g});(v.startIndex!==d||v.endIndex!==f)&&m&&m(v),this.setState({startX:o+g,endX:a+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var s=m4(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,s=i.brushMoveStartX,o=i.movingTravellerId,a=i.endX,l=i.startX,c=this.state[o],u=this.props,h=u.x,d=u.width,f=u.travellerWidth,m=u.onChange,g=u.gap,v=u.data,w={startX:this.state.startX,endX:this.state.endX},b=n.pageX-s;b>0?b=Math.min(b,h+d-f-c):b<0&&(b=Math.max(b,h-c)),w[o]=c+b;var x=this.getIndex(w),C=x.startIndex,S=x.endIndex,E=function(){var I=v.length-1;return o==="startX"&&(a>l?C%g===0:S%g===0)||a<l&&S===I||o==="endX"&&(a>l?S%g===0:C%g===0)||a>l&&S===I};this.setState(Yi(Yi({},o,c+b),"brushMoveStartX",n.pageX),function(){m&&E()&&m(x)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var s=this,o=this.state,a=o.scaleValues,l=o.startX,c=o.endX,u=this.state[i],h=a.indexOf(u);if(h!==-1){var d=h+n;if(!(d===-1||d>=a.length)){var f=a[d];i==="startX"&&f>=c||i==="endX"&&f<=l||this.setState(Yi({},i,f),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,s=n.y,o=n.width,a=n.height,l=n.fill,c=n.stroke;return oe.createElement("rect",{stroke:c,fill:l,x:i,y:s,width:o,height:a})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,s=n.y,o=n.width,a=n.height,l=n.data,c=n.children,u=n.padding,h=G.Children.only(c);return h?oe.cloneElement(h,{x:i,y:s,width:o,height:a,margin:u,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(n,i){var s,o,a=this,l=this.props,c=l.y,u=l.travellerWidth,h=l.height,d=l.traveller,f=l.ariaLabel,m=l.data,g=l.startIndex,v=l.endIndex,w=Math.max(n,this.props.x),b=AE(AE({},rt(this.props,!1)),{},{x:w,y:c,width:u,height:h}),x=f||"Min value: ".concat((s=m[g])===null||s===void 0?void 0:s.name,", Max value: ").concat((o=m[v])===null||o===void 0?void 0:o.name);return oe.createElement(Ft,{tabIndex:0,role:"slider","aria-label":x,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(S){["ArrowLeft","ArrowRight"].includes(S.key)&&(S.preventDefault(),S.stopPropagation(),a.handleTravellerMoveKeyboard(S.key==="ArrowRight"?1:-1,i))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,i){var s=this.props,o=s.y,a=s.height,l=s.stroke,c=s.travellerWidth,u=Math.min(n,i)+c,h=Math.max(Math.abs(i-n)-c,0);return oe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:u,y:o,width:h,height:a})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,s=n.endIndex,o=n.y,a=n.height,l=n.travellerWidth,c=n.stroke,u=this.state,h=u.startX,d=u.endX,f=5,m={pointerEvents:"none",fill:c};return oe.createElement(Ft,{className:"recharts-brush-texts"},oe.createElement(Lu,Jx({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,d)-f,y:o+a/2},m),this.getTextOfTick(i)),oe.createElement(Lu,Jx({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,d)+l+f,y:o+a/2},m),this.getTextOfTick(s)))}},{key:"render",value:function(){var n=this.props,i=n.data,s=n.className,o=n.children,a=n.x,l=n.y,c=n.width,u=n.height,h=n.alwaysShowText,d=this.state,f=d.startX,m=d.endX,g=d.isTextActive,v=d.isSlideMoving,w=d.isTravellerMoving,b=d.isTravellerFocused;if(!i||!i.length||!Ue(a)||!Ue(l)||!Ue(c)||!Ue(u)||c<=0||u<=0)return null;var x=xt("recharts-brush",s),C=oe.Children.count(o)===1,S=FCe("userSelect","none");return oe.createElement(Ft,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),C&&this.renderPanorama(),this.renderSlide(f,m),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(m,"endX"),(g||v||w||b||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,s=n.y,o=n.width,a=n.height,l=n.stroke,c=Math.floor(s+a/2)-1;return oe.createElement(oe.Fragment,null,oe.createElement("rect",{x:i,y:s,width:o,height:a,fill:l,stroke:"none"}),oe.createElement("line",{x1:i+1,y1:c,x2:i+o-1,y2:c,fill:"none",stroke:"#fff"}),oe.createElement("line",{x1:i+1,y1:c+2,x2:i+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var s;return oe.isValidElement(n)?s=oe.cloneElement(n,i):at(n)?s=n(i):s=e.renderDefaultTraveller(i),s}},{key:"getDerivedStateFromProps",value:function(n,i){var s=n.data,o=n.width,a=n.x,l=n.travellerWidth,c=n.updateId,u=n.startIndex,h=n.endIndex;if(s!==i.prevData||c!==i.prevUpdateId)return AE({prevData:s,prevTravellerWidth:l,prevUpdateId:c,prevX:a,prevWidth:o},s&&s.length?zCe({data:s,width:o,x:a,travellerWidth:l,startIndex:u,endIndex:h}):{scale:null,scaleValues:null});if(i.scale&&(o!==i.prevWidth||a!==i.prevX||l!==i.prevTravellerWidth)){i.scale.range([a,a+o-l]);var d=i.scale.domain().map(function(f){return i.scale(f)});return{prevData:s,prevTravellerWidth:l,prevUpdateId:c,prevX:a,prevWidth:o,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,i){for(var s=n.length,o=0,a=s-1;a-o>1;){var l=Math.floor((o+a)/2);n[l]>i?a=l:o=l}return i>=n[a]?a:o}}])}(G.PureComponent);Yi(lf,"displayName","Brush");Yi(lf,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var GCe=q2;function YCe(t,e){var r;return GCe(t,function(n,i,s){return r=e(n,i,s),!r}),!!r}var KCe=YCe,XCe=sW,qCe=sa,JCe=KCe,ZCe=ji,QCe=zb;function eEe(t,e,r){var n=ZCe(t)?XCe:JCe;return r&&QCe(t,e,r)&&(e=void 0),n(t,qCe(e))}var tEe=eEe;const rEe=jt(tEe);var qo=function(e,r){var n=e.alwaysShow,i=e.ifOverflow;return n&&(i="extendDomain"),i===r},p4=RW;function nEe(t,e,r){e=="__proto__"&&p4?p4(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var iEe=nEe,sEe=iEe,oEe=TW,aEe=sa;function lEe(t,e){var r={};return e=aEe(e),oEe(t,function(n,i,s){sEe(r,i,e(n,i,s))}),r}var cEe=lEe;const uEe=jt(cEe);function hEe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}var dEe=hEe,fEe=q2;function gEe(t,e){var r=!0;return fEe(t,function(n,i,s){return r=!!e(n,i,s),r}),r}var mEe=gEe,pEe=dEe,vEe=mEe,yEe=sa,wEe=ji,xEe=zb;function bEe(t,e,r){var n=wEe(t)?pEe:vEe;return r&&xEe(t,e,r)&&(e=void 0),n(t,yEe(e))}var SEe=bEe;const yz=jt(SEe);var CEe=["x","y"];function Jp(t){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jp(t)}function KA(){return KA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},KA.apply(this,arguments)}function v4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Og(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?v4(Object(r),!0).forEach(function(n){EEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EEe(t,e,r){return e=TEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TEe(t){var e=_Ee(t,"string");return Jp(e)=="symbol"?e:e+""}function _Ee(t,e){if(Jp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function REe(t,e){if(t==null)return{};var r=AEe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function AEe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function OEe(t,e){var r=t.x,n=t.y,i=REe(t,CEe),s="".concat(r),o=parseInt(s,10),a="".concat(n),l=parseInt(a,10),c="".concat(e.height||i.height),u=parseInt(c,10),h="".concat(e.width||i.width),d=parseInt(h,10);return Og(Og(Og(Og(Og({},e),i),o?{x:o}:{}),l?{y:l}:{}),{},{height:u,width:d,name:e.name,radius:e.radius})}function y4(t){return oe.createElement(hz,KA({shapeType:"rectangle",propTransformer:OEe,activeClassName:"recharts-active-bar"},t))}var kEe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,i){if(typeof e=="number")return e;var s=typeof n=="number";return s?e(n,i):(s||$u(),r)}},IEe=["value","background"],wz;function cf(t){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cf(t)}function NEe(t,e){if(t==null)return{};var r=MEe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function MEe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Qx(){return Qx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qx.apply(this,arguments)}function w4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?w4(Object(r),!0).forEach(function(n){Wl(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bz(n.key),n)}}function DEe(t,e,r){return e&&x4(t.prototype,e),r&&x4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LEe(t,e,r){return e=e1(e),FEe(t,xz()?Reflect.construct(e,r||[],e1(t).constructor):e.apply(t,r))}function FEe(t,e){if(e&&(cf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ee(t)}function $Ee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xz=function(){return!!t})()}function e1(t){return e1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},e1(t)}function HEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XA(t,e)}function XA(t,e){return XA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XA(t,e)}function Wl(t,e,r){return e=bz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bz(t){var e=jEe(t,"string");return cf(e)=="symbol"?e:e+""}function jEe(t,e){if(cf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var rh=function(t){function e(){var r;PEe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r=LEe(this,e,[].concat(i)),Wl(r,"state",{isAnimationFinished:!1}),Wl(r,"id",jf("recharts-bar-")),Wl(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),Wl(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return HEe(e,t),DEe(e,[{key:"renderRectanglesStatically",value:function(n){var i=this,s=this.props,o=s.shape,a=s.dataKey,l=s.activeIndex,c=s.activeBar,u=rt(this.props,!1);return n&&n.map(function(h,d){var f=d===l,m=f?c:o,g=rn(rn(rn({},u),h),{},{isActive:f,option:m,index:d,dataKey:a,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return oe.createElement(Ft,Qx({className:"recharts-bar-rectangle"},Du(i.props,h,d),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(d)}),oe.createElement(y4,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,i=this.props,s=i.data,o=i.layout,a=i.isAnimationActive,l=i.animationBegin,c=i.animationDuration,u=i.animationEasing,h=i.animationId,d=this.state.prevData;return oe.createElement(Qo,{begin:l,duration:c,isActive:a,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var m=f.t,g=s.map(function(v,w){var b=d&&d[w];if(b){var x=qi(b.x,v.x),C=qi(b.y,v.y),S=qi(b.width,v.width),E=qi(b.height,v.height);return rn(rn({},v),{},{x:x(m),y:C(m),width:S(m),height:E(m)})}if(o==="horizontal"){var T=qi(0,v.height),I=T(m);return rn(rn({},v),{},{y:v.y+v.height-I,height:I})}var k=qi(0,v.width),M=k(m);return rn(rn({},v),{},{width:M})});return oe.createElement(Ft,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,i=n.data,s=n.isAnimationActive,o=this.state.prevData;return s&&i&&i.length&&(!o||!W0(o,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var n=this,i=this.props,s=i.data,o=i.dataKey,a=i.activeIndex,l=rt(this.props.background,!1);return s.map(function(c,u){c.value;var h=c.background,d=NEe(c,IEe);if(!h)return null;var f=rn(rn(rn(rn(rn({},d),{},{fill:"#eee"},h),l),Du(n.props,c,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return oe.createElement(y4,Qx({key:"background-bar-".concat(u),option:n.props.background,isActive:u===a},f))})}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.data,a=s.xAxis,l=s.yAxis,c=s.layout,u=s.children,h=ss(u,z0);if(!h)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,f=function(v,w){var b=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:b,errorVal:fn(v,w)}},m={clipPath:n?"url(#clipPath-".concat(i,")"):null};return oe.createElement(Ft,m,h.map(function(g){return oe.cloneElement(g,{key:"error-bar-".concat(i,"-").concat(g.props.dataKey),data:o,xAxis:a,yAxis:l,layout:c,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,i=n.hide,s=n.data,o=n.className,a=n.xAxis,l=n.yAxis,c=n.left,u=n.top,h=n.width,d=n.height,f=n.isAnimationActive,m=n.background,g=n.id;if(i||!s||!s.length)return null;var v=this.state.isAnimationFinished,w=xt("recharts-bar",o),b=a&&a.allowDataOverflow,x=l&&l.allowDataOverflow,C=b||x,S=dt(g)?this.id:g;return oe.createElement(Ft,{className:w},b||x?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(S)},oe.createElement("rect",{x:b?c:c-h/2,y:x?u:u-d/2,width:b?h:h*2,height:x?d:d*2}))):null,oe.createElement(Ft,{className:"recharts-bar-rectangles",clipPath:C?"url(#clipPath-".concat(S,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(C,S),(!f||v)&&Ua.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:i.curData}:n.data!==i.curData?{curData:n.data}:null}}])}(G.PureComponent);wz=rh;Wl(rh,"displayName","Bar");Wl(rh,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Zu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Wl(rh,"getComposedData",function(t){var e=t.props,r=t.item,n=t.barPosition,i=t.bandSize,s=t.xAxis,o=t.yAxis,a=t.xAxisTicks,l=t.yAxisTicks,c=t.stackedData,u=t.dataStartIndex,h=t.displayedData,d=t.offset,f=ywe(n,r);if(!f)return null;var m=e.layout,g=r.type.defaultProps,v=g!==void 0?rn(rn({},g),r.props):r.props,w=v.dataKey,b=v.children,x=v.minPointSize,C=m==="horizontal"?o:s,S=c?C.scale.domain():null,E=Twe({numericAxis:C}),T=ss(b,Gb),I=h.map(function(k,M){var D,L,U,J,X,ie;c?D=wwe(c[u+M],S):(D=fn(k,w),Array.isArray(D)||(D=[E,D]));var se=kEe(x,wz.defaultProps.minPointSize)(D[1],M);if(m==="horizontal"){var P,y=[o.scale(D[0]),o.scale(D[1])],_=y[0],R=y[1];L=hH({axis:s,ticks:a,bandSize:i,offset:f.offset,entry:k,index:M}),U=(P=R??_)!==null&&P!==void 0?P:void 0,J=f.size;var A=_-R;if(X=Number.isNaN(A)?0:A,ie={x:L,y:o.y,width:J,height:o.height},Math.abs(se)>0&&Math.abs(X)<Math.abs(se)){var O=mi(X||se)*(Math.abs(se)-Math.abs(X));U-=O,X+=O}}else{var N=[s.scale(D[0]),s.scale(D[1])],F=N[0],j=N[1];if(L=F,U=hH({axis:o,ticks:l,bandSize:i,offset:f.offset,entry:k,index:M}),J=j-F,X=f.size,ie={x:s.x,y:U,width:s.width,height:X},Math.abs(se)>0&&Math.abs(J)<Math.abs(se)){var z=mi(J||se)*(Math.abs(se)-Math.abs(J));J+=z}}return rn(rn(rn({},k),{},{x:L,y:U,width:J,height:X,value:c?D:D[1],payload:k,background:ie},T&&T[M]&&T[M].props),{},{tooltipPayload:[U7(r,k)],tooltipPosition:{x:L+J/2,y:U+X/2}})});return rn({data:I,layout:m},d)});function Zp(t){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zp(t)}function BEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sz(n.key),n)}}function VEe(t,e,r){return e&&b4(t.prototype,e),r&&b4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function S4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function no(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?S4(Object(r),!0).forEach(function(n){hS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hS(t,e,r){return e=Sz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sz(t){var e=UEe(t,"string");return Zp(e)=="symbol"?e:e+""}function UEe(t,e){if(Zp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cz=function(e,r,n,i,s){var o=e.width,a=e.height,l=e.layout,c=e.children,u=Object.keys(r),h={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:a-n.bottom,bottomMirror:a-n.bottom},d=!!Xi(c,rh);return u.reduce(function(f,m){var g=r[m],v=g.orientation,w=g.domain,b=g.padding,x=b===void 0?{}:b,C=g.mirror,S=g.reversed,E="".concat(v).concat(C?"Mirror":""),T,I,k,M,D;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var L=w[1]-w[0],U=1/0,J=g.categoricalDomain.sort();if(J.forEach(function(N,F){F>0&&(U=Math.min((N||0)-(J[F-1]||0),U))}),Number.isFinite(U)){var X=U/L,ie=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(T=X*ie/2),g.padding==="no-gap"){var se=pi(e.barCategoryGap,X*ie),P=X*ie/2;T=P-se-(P-se)/ie*se}}}i==="xAxis"?I=[n.left+(x.left||0)+(T||0),n.left+n.width-(x.right||0)-(T||0)]:i==="yAxis"?I=l==="horizontal"?[n.top+n.height-(x.bottom||0),n.top+(x.top||0)]:[n.top+(x.top||0)+(T||0),n.top+n.height-(x.bottom||0)-(T||0)]:I=g.range,S&&(I=[I[1],I[0]]);var y=H7(g,s,d),_=y.scale,R=y.realScaleType;_.domain(w).range(I),j7(_);var A=B7(_,no(no({},g),{},{realScaleType:R}));i==="xAxis"?(D=v==="top"&&!C||v==="bottom"&&C,k=n.left,M=h[E]-D*g.height):i==="yAxis"&&(D=v==="left"&&!C||v==="right"&&C,k=h[E]-D*g.width,M=n.top);var O=no(no(no({},g),A),{},{realScaleType:R,x:k,y:M,scale:_,width:i==="xAxis"?n.width:g.width,height:i==="yAxis"?n.height:g.height});return O.bandSize=Fx(O,A),!g.hide&&i==="xAxis"?h[E]+=(D?-1:1)*O.height:g.hide||(h[E]+=(D?-1:1)*O.width),no(no({},f),{},hS({},m,O))},{})},Ez=function(e,r){var n=e.x,i=e.y,s=r.x,o=r.y;return{x:Math.min(n,s),y:Math.min(i,o),width:Math.abs(s-n),height:Math.abs(o-i)}},WEe=function(e){var r=e.x1,n=e.y1,i=e.x2,s=e.y2;return Ez({x:r,y:n},{x:i,y:s})},Tz=function(){function t(e){BEe(this,t),this.scale=e}return VEe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,s=n.position;if(r!==void 0){if(s)switch(s){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(r)+a}default:return this.scale(r)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],s=n[n.length-1];return i<=s?r>=i&&r<=s:r>=s&&r<=i}}],[{key:"create",value:function(r){return new t(r)}}])}();hS(Tz,"EPS",1e-4);var _I=function(e){var r=Object.keys(e).reduce(function(n,i){return no(no({},n),{},hS({},i,Tz.create(e[i])))},{});return no(no({},r),{},{apply:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.bandAware,a=s.position;return uEe(i,function(l,c){return r[c].apply(l,{bandAware:o,position:a})})},isInRange:function(i){return yz(i,function(s,o){return r[o].isInRange(s)})}})};function zEe(t){return(t%180+180)%180}var GEe=function(e){var r=e.width,n=e.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=zEe(i),o=s*Math.PI/180,a=Math.atan(n/r),l=o>a&&o<Math.PI-a?n/Math.sin(o):r/Math.cos(o);return Math.abs(l)},YEe=sa,KEe=H0,XEe=Ub;function qEe(t){return function(e,r,n){var i=Object(e);if(!KEe(e)){var s=YEe(r);e=XEe(e),r=function(a){return s(i[a],a,i)}}var o=t(e,r,n);return o>-1?i[s?e[o]:o]:void 0}}var JEe=qEe,ZEe=gz;function QEe(t){var e=ZEe(t),r=e%1;return e===e?r?e-r:e:0}var eTe=QEe,tTe=wW,rTe=sa,nTe=eTe,iTe=Math.max;function sTe(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:nTe(r);return i<0&&(i=iTe(n+i,0)),tTe(t,rTe(e),i)}var oTe=sTe,aTe=JEe,lTe=oTe,cTe=aTe(lTe),uTe=cTe;const hTe=jt(uTe);var dTe=aie(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),RI=G.createContext(void 0),AI=G.createContext(void 0),_z=G.createContext(void 0),Rz=G.createContext({}),Az=G.createContext(void 0),Oz=G.createContext(0),kz=G.createContext(0),C4=function(e){var r=e.state,n=r.xAxisMap,i=r.yAxisMap,s=r.offset,o=e.clipPathId,a=e.children,l=e.width,c=e.height,u=dTe(s);return oe.createElement(RI.Provider,{value:n},oe.createElement(AI.Provider,{value:i},oe.createElement(Rz.Provider,{value:s},oe.createElement(_z.Provider,{value:u},oe.createElement(Az.Provider,{value:o},oe.createElement(Oz.Provider,{value:c},oe.createElement(kz.Provider,{value:l},a)))))))},fTe=function(){return G.useContext(Az)},Iz=function(e){var r=G.useContext(RI);r==null&&$u();var n=r[e];return n==null&&$u(),n},gTe=function(){var e=G.useContext(RI);return $l(e)},mTe=function(){var e=G.useContext(AI),r=hTe(e,function(n){return yz(n.domain,Number.isFinite)});return r||$l(e)},Nz=function(e){var r=G.useContext(AI);r==null&&$u();var n=r[e];return n==null&&$u(),n},pTe=function(){var e=G.useContext(_z);return e},vTe=function(){return G.useContext(Rz)},OI=function(){return G.useContext(kz)},kI=function(){return G.useContext(Oz)};function uf(t){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uf(t)}function yTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wTe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pz(n.key),n)}}function xTe(t,e,r){return e&&wTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function bTe(t,e,r){return e=t1(e),STe(t,Mz()?Reflect.construct(e,r||[],t1(t).constructor):e.apply(t,r))}function STe(t,e){if(e&&(uf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CTe(t)}function CTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mz=function(){return!!t})()}function t1(t){return t1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},t1(t)}function ETe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qA(t,e)}function qA(t,e){return qA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qA(t,e)}function E4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function T4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?E4(Object(r),!0).forEach(function(n){II(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function II(t,e,r){return e=Pz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pz(t){var e=TTe(t,"string");return uf(e)=="symbol"?e:e+""}function TTe(t,e){if(uf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(uf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function _Te(t,e){return kTe(t)||OTe(t,e)||ATe(t,e)||RTe()}function RTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ATe(t,e){if(t){if(typeof t=="string")return _4(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _4(t,e)}}function _4(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function OTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function kTe(t){if(Array.isArray(t))return t}function JA(){return JA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},JA.apply(this,arguments)}var ITe=function(e,r){var n;return oe.isValidElement(e)?n=oe.cloneElement(e,r):at(e)?n=e(r):n=oe.createElement("line",JA({},r,{className:"recharts-reference-line-line"})),n},NTe=function(e,r,n,i,s,o,a,l,c){var u=s.x,h=s.y,d=s.width,f=s.height;if(n){var m=c.y,g=e.y.apply(m,{position:o});if(qo(c,"discard")&&!e.y.isInRange(g))return null;var v=[{x:u+d,y:g},{x:u,y:g}];return l==="left"?v.reverse():v}if(r){var w=c.x,b=e.x.apply(w,{position:o});if(qo(c,"discard")&&!e.x.isInRange(b))return null;var x=[{x:b,y:h+f},{x:b,y:h}];return a==="top"?x.reverse():x}if(i){var C=c.segment,S=C.map(function(E){return e.apply(E,{position:o})});return qo(c,"discard")&&rEe(S,function(E){return!e.isInRange(E)})?null:S}return null};function MTe(t){var e=t.x,r=t.y,n=t.segment,i=t.xAxisId,s=t.yAxisId,o=t.shape,a=t.className,l=t.alwaysShow,c=fTe(),u=Iz(i),h=Nz(s),d=pTe();if(!c||!d)return null;mo(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=_I({x:u.scale,y:h.scale}),m=mn(e),g=mn(r),v=n&&n.length===2,w=NTe(f,m,g,v,d,t.position,u.orientation,h.orientation,t);if(!w)return null;var b=_Te(w,2),x=b[0],C=x.x,S=x.y,E=b[1],T=E.x,I=E.y,k=qo(t,"hidden")?"url(#".concat(c,")"):void 0,M=T4(T4({clipPath:k},rt(t,!0)),{},{x1:C,y1:S,x2:T,y2:I});return oe.createElement(Ft,{className:xt("recharts-reference-line",a)},ITe(o,M),_n.renderCallByParent(t,WEe({x1:C,y1:S,x2:T,y2:I})))}var NI=function(t){function e(){return yTe(this,e),bTe(this,e,arguments)}return ETe(e,t),xTe(e,[{key:"render",value:function(){return oe.createElement(MTe,this.props)}}])}(oe.Component);II(NI,"displayName","ReferenceLine");II(NI,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function ZA(){return ZA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZA.apply(this,arguments)}function hf(t){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hf(t)}function R4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function A4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?R4(Object(r),!0).forEach(function(n){dS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DTe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lz(n.key),n)}}function LTe(t,e,r){return e&&DTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function FTe(t,e,r){return e=r1(e),$Te(t,Dz()?Reflect.construct(e,r||[],r1(t).constructor):e.apply(t,r))}function $Te(t,e){if(e&&(hf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HTe(t)}function HTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dz=function(){return!!t})()}function r1(t){return r1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},r1(t)}function jTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QA(t,e)}function QA(t,e){return QA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QA(t,e)}function dS(t,e,r){return e=Lz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lz(t){var e=BTe(t,"string");return hf(e)=="symbol"?e:e+""}function BTe(t,e){if(hf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(hf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var VTe=function(e){var r=e.x,n=e.y,i=e.xAxis,s=e.yAxis,o=_I({x:i.scale,y:s.scale}),a=o.apply({x:r,y:n},{bandAware:!0});return qo(e,"discard")&&!o.isInRange(a)?null:a},fS=function(t){function e(){return PTe(this,e),FTe(this,e,arguments)}return jTe(e,t),LTe(e,[{key:"render",value:function(){var n=this.props,i=n.x,s=n.y,o=n.r,a=n.alwaysShow,l=n.clipPathId,c=mn(i),u=mn(s);if(mo(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!u)return null;var h=VTe(this.props);if(!h)return null;var d=h.x,f=h.y,m=this.props,g=m.shape,v=m.className,w=qo(this.props,"hidden")?"url(#".concat(l,")"):void 0,b=A4(A4({clipPath:w},rt(this.props,!0)),{},{cx:d,cy:f});return oe.createElement(Ft,{className:xt("recharts-reference-dot",v)},e.renderDot(g,b),_n.renderCallByParent(this.props,{x:d-o,y:f-o,width:2*o,height:2*o}))}}])}(oe.Component);dS(fS,"displayName","ReferenceDot");dS(fS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});dS(fS,"renderDot",function(t,e){var r;return oe.isValidElement(t)?r=oe.cloneElement(t,e):at(t)?r=t(e):r=oe.createElement(iS,ZA({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),r});function eO(){return eO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eO.apply(this,arguments)}function df(t){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},df(t)}function O4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function k4(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?O4(Object(r),!0).forEach(function(n){gS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WTe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$z(n.key),n)}}function zTe(t,e,r){return e&&WTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function GTe(t,e,r){return e=n1(e),YTe(t,Fz()?Reflect.construct(e,r||[],n1(t).constructor):e.apply(t,r))}function YTe(t,e){if(e&&(df(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KTe(t)}function KTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fz=function(){return!!t})()}function n1(t){return n1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},n1(t)}function XTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tO(t,e)}function tO(t,e){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tO(t,e)}function gS(t,e,r){return e=$z(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $z(t){var e=qTe(t,"string");return df(e)=="symbol"?e:e+""}function qTe(t,e){if(df(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var JTe=function(e,r,n,i,s){var o=s.x1,a=s.x2,l=s.y1,c=s.y2,u=s.xAxis,h=s.yAxis;if(!u||!h)return null;var d=_I({x:u.scale,y:h.scale}),f={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(l,{position:"start"}):d.y.rangeMin},m={x:r?d.x.apply(a,{position:"end"}):d.x.rangeMax,y:i?d.y.apply(c,{position:"end"}):d.y.rangeMax};return qo(s,"discard")&&(!d.isInRange(f)||!d.isInRange(m))?null:Ez(f,m)},mS=function(t){function e(){return UTe(this,e),GTe(this,e,arguments)}return XTe(e,t),zTe(e,[{key:"render",value:function(){var n=this.props,i=n.x1,s=n.x2,o=n.y1,a=n.y2,l=n.className,c=n.alwaysShow,u=n.clipPathId;mo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=mn(i),d=mn(s),f=mn(o),m=mn(a),g=this.props.shape;if(!h&&!d&&!f&&!m&&!g)return null;var v=JTe(h,d,f,m,this.props);if(!v&&!g)return null;var w=qo(this.props,"hidden")?"url(#".concat(u,")"):void 0;return oe.createElement(Ft,{className:xt("recharts-reference-area",l)},e.renderRect(g,k4(k4({clipPath:w},rt(this.props,!0)),v)),_n.renderCallByParent(this.props,v))}}])}(oe.Component);gS(mS,"displayName","ReferenceArea");gS(mS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});gS(mS,"renderRect",function(t,e){var r;return oe.isValidElement(t)?r=oe.cloneElement(t,e):at(t)?r=t(e):r=oe.createElement(TI,eO({},e,{className:"recharts-reference-area-rect"})),r});function Hz(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)n.push(t[i]);return n}function ZTe(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return GEe(n,r)}function QTe(t,e,r){var n=r==="width",i=t.x,s=t.y,o=t.width,a=t.height;return e===1?{start:n?i:s,end:n?i+o:s+a}:{start:n?i+o:s+a,end:n?i:s}}function i1(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-i)<=0}function e_e(t,e){return Hz(t,e+1)}function t_e(t,e,r,n,i){for(var s=(n||[]).slice(),o=e.start,a=e.end,l=0,c=1,u=o,h=function(){var m=n==null?void 0:n[l];if(m===void 0)return{v:Hz(n,c)};var g=l,v,w=function(){return v===void 0&&(v=r(m,g)),v},b=m.coordinate,x=l===0||i1(t,b,w,u,a);x||(l=0,u=o,c+=1),x&&(u=b+t*(w()/2+i),l+=c)},d;c<=s.length;)if(d=h(),d)return d.v;return[]}function Qp(t){"@babel/helpers - typeof";return Qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qp(t)}function I4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Gn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?I4(Object(r),!0).forEach(function(n){r_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function r_e(t,e,r){return e=n_e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n_e(t){var e=i_e(t,"string");return Qp(e)=="symbol"?e:e+""}function i_e(t,e){if(Qp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s_e(t,e,r,n,i){for(var s=(n||[]).slice(),o=s.length,a=e.start,l=e.end,c=function(d){var f=s[d],m,g=function(){return m===void 0&&(m=r(f,d)),m};if(d===o-1){var v=t*(f.coordinate+t*g()/2-l);s[d]=f=Gn(Gn({},f),{},{tickCoord:v>0?f.coordinate-v*t:f.coordinate})}else s[d]=f=Gn(Gn({},f),{},{tickCoord:f.coordinate});var w=i1(t,f.tickCoord,g,a,l);w&&(l=f.tickCoord-t*(g()/2+i),s[d]=Gn(Gn({},f),{},{isShow:!0}))},u=o-1;u>=0;u--)c(u);return s}function o_e(t,e,r,n,i,s){var o=(n||[]).slice(),a=o.length,l=e.start,c=e.end;if(s){var u=n[a-1],h=r(u,a-1),d=t*(u.coordinate+t*h/2-c);o[a-1]=u=Gn(Gn({},u),{},{tickCoord:d>0?u.coordinate-d*t:u.coordinate});var f=i1(t,u.tickCoord,function(){return h},l,c);f&&(c=u.tickCoord-t*(h/2+i),o[a-1]=Gn(Gn({},u),{},{isShow:!0}))}for(var m=s?a-1:a,g=function(b){var x=o[b],C,S=function(){return C===void 0&&(C=r(x,b)),C};if(b===0){var E=t*(x.coordinate-t*S()/2-l);o[b]=x=Gn(Gn({},x),{},{tickCoord:E<0?x.coordinate-E*t:x.coordinate})}else o[b]=x=Gn(Gn({},x),{},{tickCoord:x.coordinate});var T=i1(t,x.tickCoord,S,l,c);T&&(l=x.tickCoord+t*(S()/2+i),o[b]=Gn(Gn({},x),{},{isShow:!0}))},v=0;v<m;v++)g(v);return o}function MI(t,e,r){var n=t.tick,i=t.ticks,s=t.viewBox,o=t.minTickGap,a=t.orientation,l=t.interval,c=t.tickFormatter,u=t.unit,h=t.angle;if(!i||!i.length||!n)return[];if(Ue(l)||Zu.isSsr)return e_e(i,typeof l=="number"&&Ue(l)?l:0);var d=[],f=a==="top"||a==="bottom"?"width":"height",m=u&&f==="width"?Tm(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=function(x,C){var S=at(c)?c(x.value,C):x.value;return f==="width"?ZTe(Tm(S,{fontSize:e,letterSpacing:r}),m,h):Tm(S,{fontSize:e,letterSpacing:r})[f]},v=i.length>=2?mi(i[1].coordinate-i[0].coordinate):1,w=QTe(s,v,f);return l==="equidistantPreserveStart"?t_e(v,w,g,i,o):(l==="preserveStart"||l==="preserveStartEnd"?d=o_e(v,w,g,i,o,l==="preserveStartEnd"):d=s_e(v,w,g,i,o),d.filter(function(b){return b.isShow}))}var a_e=["viewBox"],l_e=["viewBox"],c_e=["ticks"];function ff(t){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ff(t)}function ud(){return ud=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ud.apply(this,arguments)}function N4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ci(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?N4(Object(r),!0).forEach(function(n){PI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OE(t,e){if(t==null)return{};var r=u_e(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function u_e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function h_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bz(n.key),n)}}function d_e(t,e,r){return e&&M4(t.prototype,e),r&&M4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f_e(t,e,r){return e=s1(e),g_e(t,jz()?Reflect.construct(e,r||[],s1(t).constructor):e.apply(t,r))}function g_e(t,e){if(e&&(ff(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m_e(t)}function m_e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jz=function(){return!!t})()}function s1(t){return s1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},s1(t)}function p_e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rO(t,e)}function rO(t,e){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rO(t,e)}function PI(t,e,r){return e=Bz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t){var e=v_e(t,"string");return ff(e)=="symbol"?e:e+""}function v_e(t,e){if(ff(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Yf=function(t){function e(r){var n;return h_e(this,e),n=f_e(this,e,[r]),n.state={fontSize:"",letterSpacing:""},n}return p_e(e,t),d_e(e,[{key:"shouldComponentUpdate",value:function(n,i){var s=n.viewBox,o=OE(n,a_e),a=this.props,l=a.viewBox,c=OE(a,l_e);return!Ed(s,l)||!Ed(o,c)||!Ed(i,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var i=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var i=this.props,s=i.x,o=i.y,a=i.width,l=i.height,c=i.orientation,u=i.tickSize,h=i.mirror,d=i.tickMargin,f,m,g,v,w,b,x=h?-1:1,C=n.tickSize||u,S=Ue(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":f=m=n.coordinate,v=o+ +!h*l,g=v-x*C,b=g-x*d,w=S;break;case"left":g=v=n.coordinate,m=s+ +!h*a,f=m-x*C,w=f-x*d,b=S;break;case"right":g=v=n.coordinate,m=s+ +h*a,f=m+x*C,w=f+x*d,b=S;break;default:f=m=n.coordinate,v=o+ +h*l,g=v+x*C,b=g+x*d,w=S;break}return{line:{x1:f,y1:g,x2:m,y2:v},tick:{x:w,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,i=n.orientation,s=n.mirror,o;switch(i){case"left":o=s?"start":"end";break;case"right":o=s?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,i=n.orientation,s=n.mirror,o="end";switch(i){case"left":case"right":o="middle";break;case"top":o=s?"start":"end";break;default:o=s?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.x,s=n.y,o=n.width,a=n.height,l=n.orientation,c=n.mirror,u=n.axisLine,h=ci(ci(ci({},rt(this.props,!1)),rt(u,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var d=+(l==="top"&&!c||l==="bottom"&&c);h=ci(ci({},h),{},{x1:i,y1:s+d*a,x2:i+o,y2:s+d*a})}else{var f=+(l==="left"&&!c||l==="right"&&c);h=ci(ci({},h),{},{x1:i+f*o,y1:s,x2:i+f*o,y2:s+a})}return oe.createElement("line",ud({},h,{className:xt("recharts-cartesian-axis-line",is(u,"className"))}))}},{key:"renderTicks",value:function(n,i,s){var o=this,a=this.props,l=a.tickLine,c=a.stroke,u=a.tick,h=a.tickFormatter,d=a.unit,f=MI(ci(ci({},this.props),{},{ticks:n}),i,s),m=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),v=rt(this.props,!1),w=rt(u,!1),b=ci(ci({},v),{},{fill:"none"},rt(l,!1)),x=f.map(function(C,S){var E=o.getTickLineCoord(C),T=E.line,I=E.tick,k=ci(ci(ci(ci({textAnchor:m,verticalAnchor:g},v),{},{stroke:"none",fill:c},w),I),{},{index:S,payload:C,visibleTicksCount:f.length,tickFormatter:h});return oe.createElement(Ft,ud({className:"recharts-cartesian-axis-tick",key:"tick-".concat(C.value,"-").concat(C.coordinate,"-").concat(C.tickCoord)},Du(o.props,C,S)),l&&oe.createElement("line",ud({},b,T,{className:xt("recharts-cartesian-axis-tick-line",is(l,"className"))})),u&&e.renderTickItem(u,k,"".concat(at(h)?h(C.value,S):C.value).concat(d||"")))});return oe.createElement("g",{className:"recharts-cartesian-axis-ticks"},x)}},{key:"render",value:function(){var n=this,i=this.props,s=i.axisLine,o=i.width,a=i.height,l=i.ticksGenerator,c=i.className,u=i.hide;if(u)return null;var h=this.props,d=h.ticks,f=OE(h,c_e),m=d;return at(l)&&(m=d&&d.length>0?l(this.props):l(f)),o<=0||a<=0||!m||!m.length?null:oe.createElement(Ft,{className:xt("recharts-cartesian-axis",c),ref:function(v){n.layerReference=v}},s&&this.renderAxisLine(),this.renderTicks(m,this.state.fontSize,this.state.letterSpacing),_n.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,i,s){var o;return oe.isValidElement(n)?o=oe.cloneElement(n,i):at(n)?o=n(i):o=oe.createElement(Lu,ud({},i,{className:"recharts-cartesian-axis-tick-value"}),s),o}}])}(G.Component);PI(Yf,"displayName","CartesianAxis");PI(Yf,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var y_e=["x1","y1","x2","y2","key"],w_e=["offset"];function Hu(t){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hu(t)}function P4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function qn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?P4(Object(r),!0).forEach(function(n){x_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function x_e(t,e,r){return e=b_e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b_e(t){var e=S_e(t,"string");return Hu(e)=="symbol"?e:e+""}function S_e(t,e){if(Hu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Hu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fu(){return fu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fu.apply(this,arguments)}function D4(t,e){if(t==null)return{};var r=C_e(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function C_e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var E_e=function(e){var r=e.fill;if(!r||r==="none")return null;var n=e.fillOpacity,i=e.x,s=e.y,o=e.width,a=e.height,l=e.ry;return oe.createElement("rect",{x:i,y:s,ry:l,width:o,height:a,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Vz(t,e){var r;if(oe.isValidElement(t))r=oe.cloneElement(t,e);else if(at(t))r=t(e);else{var n=e.x1,i=e.y1,s=e.x2,o=e.y2,a=e.key,l=D4(e,y_e),c=rt(l,!1);c.offset;var u=D4(c,w_e);r=oe.createElement("line",fu({},u,{x1:n,y1:i,x2:s,y2:o,fill:"none",key:a}))}return r}function T_e(t){var e=t.x,r=t.width,n=t.horizontal,i=n===void 0?!0:n,s=t.horizontalPoints;if(!i||!s||!s.length)return null;var o=s.map(function(a,l){var c=qn(qn({},t),{},{x1:e,y1:a,x2:e+r,y2:a,key:"line-".concat(l),index:l});return Vz(i,c)});return oe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function __e(t){var e=t.y,r=t.height,n=t.vertical,i=n===void 0?!0:n,s=t.verticalPoints;if(!i||!s||!s.length)return null;var o=s.map(function(a,l){var c=qn(qn({},t),{},{x1:a,y1:e,x2:a,y2:e+r,key:"line-".concat(l),index:l});return Vz(i,c)});return oe.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function R_e(t){var e=t.horizontalFill,r=t.fillOpacity,n=t.x,i=t.y,s=t.width,o=t.height,a=t.horizontalPoints,l=t.horizontal,c=l===void 0?!0:l;if(!c||!e||!e.length)return null;var u=a.map(function(d){return Math.round(d+i-i)}).sort(function(d,f){return d-f});i!==u[0]&&u.unshift(0);var h=u.map(function(d,f){var m=!u[f+1],g=m?i+o-d:u[f+1]-d;if(g<=0)return null;var v=f%e.length;return oe.createElement("rect",{key:"react-".concat(f),y:d,x:n,height:g,width:s,stroke:"none",fill:e[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return oe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function A_e(t){var e=t.vertical,r=e===void 0?!0:e,n=t.verticalFill,i=t.fillOpacity,s=t.x,o=t.y,a=t.width,l=t.height,c=t.verticalPoints;if(!r||!n||!n.length)return null;var u=c.map(function(d){return Math.round(d+s-s)}).sort(function(d,f){return d-f});s!==u[0]&&u.unshift(0);var h=u.map(function(d,f){var m=!u[f+1],g=m?s+a-d:u[f+1]-d;if(g<=0)return null;var v=f%n.length;return oe.createElement("rect",{key:"react-".concat(f),x:d,y:o,width:g,height:l,stroke:"none",fill:n[v],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return oe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var O_e=function(e,r){var n=e.xAxis,i=e.width,s=e.height,o=e.offset;return $7(MI(qn(qn(qn({},Yf.defaultProps),n),{},{ticks:Da(n,!0),viewBox:{x:0,y:0,width:i,height:s}})),o.left,o.left+o.width,r)},k_e=function(e,r){var n=e.yAxis,i=e.width,s=e.height,o=e.offset;return $7(MI(qn(qn(qn({},Yf.defaultProps),n),{},{ticks:Da(n,!0),viewBox:{x:0,y:0,width:i,height:s}})),o.top,o.top+o.height,r)},bh={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function DI(t){var e,r,n,i,s,o,a=OI(),l=kI(),c=vTe(),u=qn(qn({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:bh.stroke,fill:(r=t.fill)!==null&&r!==void 0?r:bh.fill,horizontal:(n=t.horizontal)!==null&&n!==void 0?n:bh.horizontal,horizontalFill:(i=t.horizontalFill)!==null&&i!==void 0?i:bh.horizontalFill,vertical:(s=t.vertical)!==null&&s!==void 0?s:bh.vertical,verticalFill:(o=t.verticalFill)!==null&&o!==void 0?o:bh.verticalFill,x:Ue(t.x)?t.x:c.left,y:Ue(t.y)?t.y:c.top,width:Ue(t.width)?t.width:c.width,height:Ue(t.height)?t.height:c.height}),h=u.x,d=u.y,f=u.width,m=u.height,g=u.syncWithTicks,v=u.horizontalValues,w=u.verticalValues,b=gTe(),x=mTe();if(!Ue(f)||f<=0||!Ue(m)||m<=0||!Ue(h)||h!==+h||!Ue(d)||d!==+d)return null;var C=u.verticalCoordinatesGenerator||O_e,S=u.horizontalCoordinatesGenerator||k_e,E=u.horizontalPoints,T=u.verticalPoints;if((!E||!E.length)&&at(S)){var I=v&&v.length,k=S({yAxis:x?qn(qn({},x),{},{ticks:I?v:x.ticks}):void 0,width:a,height:l,offset:c},I?!0:g);mo(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Hu(k),"]")),Array.isArray(k)&&(E=k)}if((!T||!T.length)&&at(C)){var M=w&&w.length,D=C({xAxis:b?qn(qn({},b),{},{ticks:M?w:b.ticks}):void 0,width:a,height:l,offset:c},M?!0:g);mo(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Hu(D),"]")),Array.isArray(D)&&(T=D)}return oe.createElement("g",{className:"recharts-cartesian-grid"},oe.createElement(E_e,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),oe.createElement(T_e,fu({},u,{offset:c,horizontalPoints:E,xAxis:b,yAxis:x})),oe.createElement(__e,fu({},u,{offset:c,verticalPoints:T,xAxis:b,yAxis:x})),oe.createElement(R_e,fu({},u,{horizontalPoints:E})),oe.createElement(A_e,fu({},u,{verticalPoints:T})))}DI.displayName="CartesianGrid";var I_e=["type","layout","connectNulls","ref"],N_e=["key"];function gf(t){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gf(t)}function L4(t,e){if(t==null)return{};var r=M_e(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function M_e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Im(){return Im=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Im.apply(this,arguments)}function F4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F4(Object(r),!0).forEach(function(n){io(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Sh(t){return F_e(t)||L_e(t)||D_e(t)||P_e()}function P_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D_e(t,e){if(t){if(typeof t=="string")return nO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nO(t,e)}}function L_e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function F_e(t){if(Array.isArray(t))return nO(t)}function nO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $4(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wz(n.key),n)}}function H_e(t,e,r){return e&&$4(t.prototype,e),r&&$4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function j_e(t,e,r){return e=o1(e),B_e(t,Uz()?Reflect.construct(e,r||[],o1(t).constructor):e.apply(t,r))}function B_e(t,e){if(e&&(gf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V_e(t)}function V_e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uz=function(){return!!t})()}function o1(t){return o1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},o1(t)}function U_e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iO(t,e)}function iO(t,e){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iO(t,e)}function io(t,e,r){return e=Wz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wz(t){var e=W_e(t,"string");return gf(e)=="symbol"?e:e+""}function W_e(t,e){if(gf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(gf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var G0=function(t){function e(){var r;$_e(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r=j_e(this,e,[].concat(i)),io(r,"state",{isAnimationFinished:!0,totalLength:0}),io(r,"generateSimpleStrokeDasharray",function(o,a){return"".concat(a,"px ").concat(o-a,"px")}),io(r,"getStrokeDasharray",function(o,a,l){var c=l.reduce(function(w,b){return w+b});if(!c)return r.generateSimpleStrokeDasharray(a,o);for(var u=Math.floor(o/c),h=o%c,d=a-o,f=[],m=0,g=0;m<l.length;g+=l[m],++m)if(g+l[m]>h){f=[].concat(Sh(l.slice(0,m)),[h-g]);break}var v=f.length%2===0?[0,d]:[d];return[].concat(Sh(e.repeat(l,u)),Sh(f),v).map(function(w){return"".concat(w,"px")}).join(", ")}),io(r,"id",jf("recharts-line-")),io(r,"pathRef",function(o){r.mainCurve=o}),io(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),io(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return U_e(e,t),H_e(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.points,a=s.xAxis,l=s.yAxis,c=s.layout,u=s.children,h=ss(u,z0);if(!h)return null;var d=function(g,v){return{x:g.x,y:g.y,value:g.value,errorVal:fn(g.payload,v)}},f={clipPath:n?"url(#clipPath-".concat(i,")"):null};return oe.createElement(Ft,f,h.map(function(m){return oe.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:o,xAxis:a,yAxis:l,layout:c,dataPointFormatter:d})}))}},{key:"renderDots",value:function(n,i,s){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var a=this.props,l=a.dot,c=a.points,u=a.dataKey,h=rt(this.props,!1),d=rt(l,!0),f=c.map(function(g,v){var w=zi(zi(zi({key:"dot-".concat(v),r:3},h),d),{},{index:v,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:c});return e.renderDotItem(l,w)}),m={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(s,")"):null};return oe.createElement(Ft,Im({className:"recharts-line-dots",key:"dots"},m),f)}},{key:"renderCurveStatically",value:function(n,i,s,o){var a=this.props,l=a.type,c=a.layout,u=a.connectNulls;a.ref;var h=L4(a,I_e),d=zi(zi(zi({},rt(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(s,")"):null,points:n},o),{},{type:l,layout:c,connectNulls:u});return oe.createElement(jx,Im({},d,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var s=this,o=this.props,a=o.points,l=o.strokeDasharray,c=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,d=o.animationEasing,f=o.animationId,m=o.animateNewValues,g=o.width,v=o.height,w=this.state,b=w.prevPoints,x=w.totalLength;return oe.createElement(Qo,{begin:u,duration:h,isActive:c,easing:d,from:{t:0},to:{t:1},key:"line-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(C){var S=C.t;if(b){var E=b.length/a.length,T=a.map(function(L,U){var J=Math.floor(U*E);if(b[J]){var X=b[J],ie=qi(X.x,L.x),se=qi(X.y,L.y);return zi(zi({},L),{},{x:ie(S),y:se(S)})}if(m){var P=qi(g*2,L.x),y=qi(v/2,L.y);return zi(zi({},L),{},{x:P(S),y:y(S)})}return zi(zi({},L),{},{x:L.x,y:L.y})});return s.renderCurveStatically(T,n,i)}var I=qi(0,x),k=I(S),M;if(l){var D="".concat(l).split(/[,\s]+/gim).map(function(L){return parseFloat(L)});M=s.getStrokeDasharray(k,x,D)}else M=s.generateSimpleStrokeDasharray(x,k);return s.renderCurveStatically(a,n,i,{strokeDasharray:M})})}},{key:"renderCurve",value:function(n,i){var s=this.props,o=s.points,a=s.isAnimationActive,l=this.state,c=l.prevPoints,u=l.totalLength;return a&&o&&o.length&&(!c&&u>0||!W0(c,o))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(o,n,i)}},{key:"render",value:function(){var n,i=this.props,s=i.hide,o=i.dot,a=i.points,l=i.className,c=i.xAxis,u=i.yAxis,h=i.top,d=i.left,f=i.width,m=i.height,g=i.isAnimationActive,v=i.id;if(s||!a||!a.length)return null;var w=this.state.isAnimationFinished,b=a.length===1,x=xt("recharts-line",l),C=c&&c.allowDataOverflow,S=u&&u.allowDataOverflow,E=C||S,T=dt(v)?this.id:v,I=(n=rt(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=I.r,M=k===void 0?3:k,D=I.strokeWidth,L=D===void 0?2:D,U=hse(o)?o:{},J=U.clipDot,X=J===void 0?!0:J,ie=M*2+L;return oe.createElement(Ft,{className:x},C||S?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(T)},oe.createElement("rect",{x:C?d:d-f/2,y:S?h:h-m/2,width:C?f:f*2,height:S?m:m*2})),!X&&oe.createElement("clipPath",{id:"clipPath-dots-".concat(T)},oe.createElement("rect",{x:d-ie/2,y:h-ie/2,width:f+ie,height:m+ie}))):null,!b&&this.renderCurve(E,T),this.renderErrorBar(E,T),(b||o)&&this.renderDots(E,X,T),(!g||w)&&Ua.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var s=n.length%2!==0?[].concat(Sh(n),[0]):n,o=[],a=0;a<i;++a)o=[].concat(Sh(o),Sh(s));return o}},{key:"renderDotItem",value:function(n,i){var s;if(oe.isValidElement(n))s=oe.cloneElement(n,i);else if(at(n))s=n(i);else{var o=i.key,a=L4(i,N_e),l=xt("recharts-line-dot",typeof n!="boolean"?n.className:"");s=oe.createElement(iS,Im({key:o},a,{className:l}))}return s}}])}(G.PureComponent);io(G0,"displayName","Line");io(G0,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Zu.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});io(G0,"getComposedData",function(t){var e=t.props,r=t.xAxis,n=t.yAxis,i=t.xAxisTicks,s=t.yAxisTicks,o=t.dataKey,a=t.bandSize,l=t.displayedData,c=t.offset,u=e.layout,h=l.map(function(d,f){var m=fn(d,o);return u==="horizontal"?{x:uH({axis:r,ticks:i,bandSize:a,entry:d,index:f}),y:dt(m)?null:n.scale(m),value:m,payload:d}:{x:dt(m)?null:r.scale(m),y:uH({axis:n,ticks:s,bandSize:a,entry:d,index:f}),value:m,payload:d}});return zi({points:h,layout:u},c)});function mf(t){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mf(t)}function z_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G_e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yz(n.key),n)}}function Y_e(t,e,r){return e&&G_e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function K_e(t,e,r){return e=a1(e),X_e(t,zz()?Reflect.construct(e,r||[],a1(t).constructor):e.apply(t,r))}function X_e(t,e){if(e&&(mf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q_e(t)}function q_e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zz=function(){return!!t})()}function a1(t){return a1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},a1(t)}function J_e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sO(t,e)}function sO(t,e){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sO(t,e)}function Gz(t,e,r){return e=Yz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yz(t){var e=Z_e(t,"string");return mf(e)=="symbol"?e:e+""}function Z_e(t,e){if(mf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function oO(){return oO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},oO.apply(this,arguments)}function Q_e(t){var e=t.xAxisId,r=OI(),n=kI(),i=Iz(e);return i==null?null:oe.createElement(Yf,oO({},i,{className:xt("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return Da(o,!0)}}))}var Kf=function(t){function e(){return z_e(this,e),K_e(this,e,arguments)}return J_e(e,t),Y_e(e,[{key:"render",value:function(){return oe.createElement(Q_e,this.props)}}])}(oe.Component);Gz(Kf,"displayName","XAxis");Gz(Kf,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function pf(t){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pf(t)}function eRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qz(n.key),n)}}function rRe(t,e,r){return e&&tRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function nRe(t,e,r){return e=l1(e),iRe(t,Kz()?Reflect.construct(e,r||[],l1(t).constructor):e.apply(t,r))}function iRe(t,e){if(e&&(pf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sRe(t)}function sRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kz=function(){return!!t})()}function l1(t){return l1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l1(t)}function oRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aO(t,e)}function aO(t,e){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aO(t,e)}function Xz(t,e,r){return e=qz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qz(t){var e=aRe(t,"string");return pf(e)=="symbol"?e:e+""}function aRe(t,e){if(pf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function lO(){return lO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lO.apply(this,arguments)}var lRe=function(e){var r=e.yAxisId,n=OI(),i=kI(),s=Nz(r);return s==null?null:oe.createElement(Yf,lO({},s,{className:xt("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(a){return Da(a,!0)}}))},Xf=function(t){function e(){return eRe(this,e),nRe(this,e,arguments)}return oRe(e,t),rRe(e,[{key:"render",value:function(){return oe.createElement(lRe,this.props)}}])}(oe.Component);Xz(Xf,"displayName","YAxis");Xz(Xf,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function H4(t){return dRe(t)||hRe(t)||uRe(t)||cRe()}function cRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uRe(t,e){if(t){if(typeof t=="string")return cO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cO(t,e)}}function hRe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dRe(t){if(Array.isArray(t))return cO(t)}function cO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var uO=function(e,r,n,i,s){var o=ss(e,NI),a=ss(e,fS),l=[].concat(H4(o),H4(a)),c=ss(e,mS),u="".concat(i,"Id"),h=i[0],d=r;if(l.length&&(d=l.reduce(function(g,v){if(v.props[u]===n&&qo(v.props,"extendDomain")&&Ue(v.props[h])){var w=v.props[h];return[Math.min(g[0],w),Math.max(g[1],w)]}return g},d)),c.length){var f="".concat(h,"1"),m="".concat(h,"2");d=c.reduce(function(g,v){if(v.props[u]===n&&qo(v.props,"extendDomain")&&Ue(v.props[f])&&Ue(v.props[m])){var w=v.props[f],b=v.props[m];return[Math.min(g[0],w,b),Math.max(g[1],w,b)]}return g},d)}return s&&s.length&&(d=s.reduce(function(g,v){return Ue(v)?[Math.min(g[0],v),Math.max(g[1],v)]:g},d)),d},Jz={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,h||l,d),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,m=new Array(f);d<f;d++)m[d]=h[d].fn;return m},a.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,m){var g=r?r+c:c;if(!this._events[g])return!1;var v=this._events[g],w=arguments.length,b,x;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),w){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,d),!0;case 5:return v.fn.call(v.context,u,h,d,f),!0;case 6:return v.fn.call(v.context,u,h,d,f,m),!0}for(x=1,b=new Array(w-1);x<w;x++)b[x-1]=arguments[x];v.fn.apply(v.context,b)}else{var C=v.length,S;for(x=0;x<C;x++)switch(v[x].once&&this.removeListener(c,v[x].fn,void 0,!0),w){case 1:v[x].fn.call(v[x].context);break;case 2:v[x].fn.call(v[x].context,u);break;case 3:v[x].fn.call(v[x].context,u,h);break;case 4:v[x].fn.call(v[x].context,u,h,d);break;default:if(!b)for(S=1,b=new Array(w-1);S<w;S++)b[S-1]=arguments[S];v[x].fn.apply(v[x].context,b)}}return!0},a.prototype.on=function(c,u,h){return s(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return s(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=r?r+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!d||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var g=0,v=[],w=m.length;g<w;g++)(m[g].fn!==u||d&&!m[g].once||h&&m[g].context!==h)&&v.push(m[g]);v.length?this._events[f]=v.length===1?v[0]:v:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(Jz);var fRe=Jz.exports;const gRe=jt(fRe);var kE=new gRe,IE="recharts.syncMouseEvents";function e0(t){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e0(t)}function mRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zz(n.key),n)}}function vRe(t,e,r){return e&&pRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function NE(t,e,r){return e=Zz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zz(t){var e=yRe(t,"string");return e0(e)=="symbol"?e:e+""}function yRe(t,e){if(e0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(e0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var wRe=function(){function t(){mRe(this,t),NE(this,"activeIndex",0),NE(this,"coordinateList",[]),NE(this,"layout","horizontal")}return vRe(t,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,s=i===void 0?null:i,o=r.container,a=o===void 0?null:o,l=r.layout,c=l===void 0?null:l,u=r.offset,h=u===void 0?null:u,d=r.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=s??this.coordinateList)!==null&&n!==void 0?n:[],this.container=a??this.container,this.layout=c??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),s=i.x,o=i.y,a=i.height,l=this.coordinateList[this.activeIndex].coordinate,c=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=s+l+c,d=o+this.offset.top+a/2+u;this.mouseHandlerCallback({pageX:h,pageY:d})}}}])}();function xRe(t,e,r){if(r==="number"&&e===!0&&Array.isArray(t)){var n=t==null?void 0:t[0],i=t==null?void 0:t[1];if(n&&i&&Ue(n)&&Ue(i))return!0}return!1}function bRe(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Qz(t){var e=t.cx,r=t.cy,n=t.radius,i=t.startAngle,s=t.endAngle,o=hr(e,r,n,i),a=hr(e,r,n,s);return{points:[o,a],cx:e,cy:r,radius:n,startAngle:i,endAngle:s}}function SRe(t,e,r){var n,i,s,o;if(t==="horizontal")n=e.x,s=n,i=r.top,o=r.top+r.height;else if(t==="vertical")i=e.y,o=i,n=r.left,s=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var a=e.cx,l=e.cy,c=e.innerRadius,u=e.outerRadius,h=e.angle,d=hr(a,l,c,h),f=hr(a,l,u,h);n=d.x,i=d.y,s=f.x,o=f.y}else return Qz(e);return[{x:n,y:i},{x:s,y:o}]}function t0(t){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t0(t)}function j4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?j4(Object(r),!0).forEach(function(n){CRe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CRe(t,e,r){return e=ERe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ERe(t){var e=TRe(t,"string");return t0(e)=="symbol"?e:e+""}function TRe(t,e){if(t0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(t0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _Re(t){var e,r,n=t.element,i=t.tooltipEventType,s=t.isActive,o=t.activeCoordinate,a=t.activePayload,l=t.offset,c=t.activeTooltipIndex,u=t.tooltipAxisBandSize,h=t.layout,d=t.chartName,f=(e=n.props.cursor)!==null&&e!==void 0?e:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!f||!s||!o||d!=="ScatterChart"&&i!=="axis")return null;var m,g=jx;if(d==="ScatterChart")m=o,g=Vbe;else if(d==="BarChart")m=bRe(h,o,l,u),g=TI;else if(h==="radial"){var v=Qz(o),w=v.cx,b=v.cy,x=v.radius,C=v.startAngle,S=v.endAngle;m={cx:w,cy:b,startAngle:C,endAngle:S,innerRadius:x,outerRadius:x},g=X7}else m={points:SRe(h,o,l)},g=jx;var E=Jv(Jv(Jv(Jv({stroke:"#ccc",pointerEvents:"none"},l),m),rt(f,!1)),{},{payload:a,payloadIndex:c,className:xt("recharts-tooltip-cursor",f.className)});return G.isValidElement(f)?G.cloneElement(f,E):G.createElement(g,E)}var RRe=["item"],ARe=["children","className","width","height","style","compact","title","desc"];function vf(t){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vf(t)}function hd(){return hd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hd.apply(this,arguments)}function B4(t,e){return IRe(t)||kRe(t,e)||t9(t,e)||ORe()}function ORe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kRe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,s,o,a=[],l=!0,c=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(l=(n=s.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}function IRe(t){if(Array.isArray(t))return t}function V4(t,e){if(t==null)return{};var r=NRe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function NRe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function MRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r9(n.key),n)}}function DRe(t,e,r){return e&&PRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function LRe(t,e,r){return e=c1(e),FRe(t,e9()?Reflect.construct(e,r||[],c1(t).constructor):e.apply(t,r))}function FRe(t,e){if(e&&(vf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Re(t)}function $Re(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(e9=function(){return!!t})()}function c1(t){return c1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c1(t)}function HRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hO(t,e)}function hO(t,e){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hO(t,e)}function yf(t){return VRe(t)||BRe(t)||t9(t)||jRe()}function jRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t9(t,e){if(t){if(typeof t=="string")return dO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dO(t,e)}}function BRe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function VRe(t){if(Array.isArray(t))return dO(t)}function dO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function U4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Oe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?U4(Object(r),!0).forEach(function(n){nt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U4(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nt(t,e,r){return e=r9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r9(t){var e=URe(t,"string");return vf(e)=="symbol"?e:e+""}function URe(t,e){if(vf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WRe={xAxis:["bottom","top"],yAxis:["left","right"]},zRe={width:"100%",height:"100%"},n9={x:0,y:0};function Zv(t){return t}var GRe=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},YRe=function(e,r,n,i){var s=r.find(function(u){return u&&u.index===n});if(s){if(e==="horizontal")return{x:s.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:s.coordinate};if(e==="centric"){var o=s.coordinate,a=i.radius;return Oe(Oe(Oe({},i),hr(i.cx,i.cy,a,o)),{},{angle:o,radius:a})}var l=s.coordinate,c=i.angle;return Oe(Oe(Oe({},i),hr(i.cx,i.cy,l,c)),{},{angle:c,radius:l})}return n9},pS=function(e,r){var n=r.graphicalItems,i=r.dataStartIndex,s=r.dataEndIndex,o=(n??[]).reduce(function(a,l){var c=l.props.data;return c&&c.length?[].concat(yf(a),yf(c)):a},[]);return o.length>0?o:e&&e.length&&Ue(i)&&Ue(s)?e.slice(i,s+1):[]};function i9(t){return t==="number"?[0,"auto"]:void 0}var fO=function(e,r,n,i){var s=e.graphicalItems,o=e.tooltipAxis,a=pS(r,e);return n<0||!s||!s.length||n>=a.length?null:s.reduce(function(l,c){var u,h=(u=c.props.data)!==null&&u!==void 0?u:r;h&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(h=h.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var f=h===void 0?a:h;d=cx(f,o.dataKey,i)}else d=h&&h[n]||a[n];return d?[].concat(yf(l),[U7(c,d)]):l},[])},W4=function(e,r,n,i){var s=i||{x:e.chartX,y:e.chartY},o=GRe(s,n),a=e.orderedTooltipTicks,l=e.tooltipAxis,c=e.tooltipTicks,u=dwe(o,a,c,l);if(u>=0&&c){var h=c[u]&&c[u].value,d=fO(e,r,u,h),f=YRe(n,a,u,s);return{activeTooltipIndex:u,activeLabel:h,activePayload:d,activeCoordinate:f}}return null},KRe=function(e,r){var n=r.axes,i=r.graphicalItems,s=r.axisType,o=r.axisIdKey,a=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,u=e.layout,h=e.children,d=e.stackOffset,f=F7(u,s);return n.reduce(function(m,g){var v,w=g.type.defaultProps!==void 0?Oe(Oe({},g.type.defaultProps),g.props):g.props,b=w.type,x=w.dataKey,C=w.allowDataOverflow,S=w.allowDuplicatedCategory,E=w.scale,T=w.ticks,I=w.includeHidden,k=w[o];if(m[k])return m;var M=pS(e.data,{graphicalItems:i.filter(function(A){var O,N=o in A.props?A.props[o]:(O=A.type.defaultProps)===null||O===void 0?void 0:O[o];return N===k}),dataStartIndex:l,dataEndIndex:c}),D=M.length,L,U,J;xRe(w.domain,C,b)&&(L=RA(w.domain,null,C),f&&(b==="number"||E!=="auto")&&(J=Rm(M,x,"category")));var X=i9(b);if(!L||L.length===0){var ie,se=(ie=w.domain)!==null&&ie!==void 0?ie:X;if(x){if(L=Rm(M,x,b),b==="category"&&f){var P=rse(L);S&&P?(U=L,L=qx(0,D)):S||(L=gH(se,L,g).reduce(function(A,O){return A.indexOf(O)>=0?A:[].concat(yf(A),[O])},[]))}else if(b==="category")S?L=L.filter(function(A){return A!==""&&!dt(A)}):L=gH(se,L,g).reduce(function(A,O){return A.indexOf(O)>=0||O===""||dt(O)?A:[].concat(yf(A),[O])},[]);else if(b==="number"){var y=vwe(M,i.filter(function(A){var O,N,F=o in A.props?A.props[o]:(O=A.type.defaultProps)===null||O===void 0?void 0:O[o],j="hide"in A.props?A.props.hide:(N=A.type.defaultProps)===null||N===void 0?void 0:N.hide;return F===k&&(I||!j)}),x,s,u);y&&(L=y)}f&&(b==="number"||E!=="auto")&&(J=Rm(M,x,"category"))}else f?L=qx(0,D):a&&a[k]&&a[k].hasStack&&b==="number"?L=d==="expand"?[0,1]:V7(a[k].stackGroups,l,c):L=L7(M,i.filter(function(A){var O=o in A.props?A.props[o]:A.type.defaultProps[o],N="hide"in A.props?A.props.hide:A.type.defaultProps.hide;return O===k&&(I||!N)}),b,u,!0);if(b==="number")L=uO(h,L,k,s,T),se&&(L=RA(se,L,C));else if(b==="category"&&se){var _=se,R=L.every(function(A){return _.indexOf(A)>=0});R&&(L=_)}}return Oe(Oe({},m),{},nt({},k,Oe(Oe({},w),{},{axisType:s,domain:L,categoricalDomain:J,duplicateDomain:U,originalDomain:(v=w.domain)!==null&&v!==void 0?v:X,isCategorical:f,layout:u})))},{})},XRe=function(e,r){var n=r.graphicalItems,i=r.Axis,s=r.axisType,o=r.axisIdKey,a=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,u=e.layout,h=e.children,d=pS(e.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:c}),f=d.length,m=F7(u,s),g=-1;return n.reduce(function(v,w){var b=w.type.defaultProps!==void 0?Oe(Oe({},w.type.defaultProps),w.props):w.props,x=b[o],C=i9("number");if(!v[x]){g++;var S;return m?S=qx(0,f):a&&a[x]&&a[x].hasStack?(S=V7(a[x].stackGroups,l,c),S=uO(h,S,x,s)):(S=RA(C,L7(d,n.filter(function(E){var T,I,k=o in E.props?E.props[o]:(T=E.type.defaultProps)===null||T===void 0?void 0:T[o],M="hide"in E.props?E.props.hide:(I=E.type.defaultProps)===null||I===void 0?void 0:I.hide;return k===x&&!M}),"number",u),i.defaultProps.allowDataOverflow),S=uO(h,S,x,s)),Oe(Oe({},v),{},nt({},x,Oe(Oe({axisType:s},i.defaultProps),{},{hide:!0,orientation:is(WRe,"".concat(s,".").concat(g%2),null),domain:S,originalDomain:C,isCategorical:m,layout:u})))}return v},{})},qRe=function(e,r){var n=r.axisType,i=n===void 0?"xAxis":n,s=r.AxisComp,o=r.graphicalItems,a=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,u=e.children,h="".concat(i,"Id"),d=ss(u,s),f={};return d&&d.length?f=KRe(e,{axes:d,graphicalItems:o,axisType:i,axisIdKey:h,stackGroups:a,dataStartIndex:l,dataEndIndex:c}):o&&o.length&&(f=XRe(e,{Axis:s,graphicalItems:o,axisType:i,axisIdKey:h,stackGroups:a,dataStartIndex:l,dataEndIndex:c})),f},JRe=function(e){var r=$l(e),n=Da(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:J2(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Fx(r,n)}},z4=function(e){var r=e.children,n=e.defaultShowTooltip,i=Xi(r,lf),s=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(s=i.props.startIndex),i.props.endIndex>=0&&(o=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},ZRe=function(e){return!e||!e.length?!1:e.some(function(r){var n=Ba(r&&r.type);return n&&n.indexOf("Bar")>=0})},G4=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},QRe=function(e,r){var n=e.props,i=e.graphicalItems,s=e.xAxisMap,o=s===void 0?{}:s,a=e.yAxisMap,l=a===void 0?{}:a,c=n.width,u=n.height,h=n.children,d=n.margin||{},f=Xi(h,lf),m=Xi(h,sc),g=Object.keys(l).reduce(function(S,E){var T=l[E],I=T.orientation;return!T.mirror&&!T.hide?Oe(Oe({},S),{},nt({},I,S[I]+T.width)):S},{left:d.left||0,right:d.right||0}),v=Object.keys(o).reduce(function(S,E){var T=o[E],I=T.orientation;return!T.mirror&&!T.hide?Oe(Oe({},S),{},nt({},I,is(S,"".concat(I))+T.height)):S},{top:d.top||0,bottom:d.bottom||0}),w=Oe(Oe({},v),g),b=w.bottom;f&&(w.bottom+=f.props.height||lf.defaultProps.height),m&&r&&(w=mwe(w,i,n,r));var x=c-w.left-w.right,C=u-w.top-w.bottom;return Oe(Oe({brushBottom:b},w),{},{width:Math.max(x,0),height:Math.max(C,0)})},eAe=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},LI=function(e){var r=e.chartName,n=e.GraphicalChild,i=e.defaultTooltipEventType,s=i===void 0?"axis":i,o=e.validateTooltipEventTypes,a=o===void 0?["axis"]:o,l=e.axisComponents,c=e.legendContent,u=e.formatAxisMap,h=e.defaultProps,d=function(w,b){var x=b.graphicalItems,C=b.stackGroups,S=b.offset,E=b.updateId,T=b.dataStartIndex,I=b.dataEndIndex,k=w.barSize,M=w.layout,D=w.barGap,L=w.barCategoryGap,U=w.maxBarSize,J=G4(M),X=J.numericAxisName,ie=J.cateAxisName,se=ZRe(x),P=[];return x.forEach(function(y,_){var R=pS(w.data,{graphicalItems:[y],dataStartIndex:T,dataEndIndex:I}),A=y.type.defaultProps!==void 0?Oe(Oe({},y.type.defaultProps),y.props):y.props,O=A.dataKey,N=A.maxBarSize,F=A["".concat(X,"Id")],j=A["".concat(ie,"Id")],z={},Q=l.reduce(function(K,te){var ve=b["".concat(te.axisType,"Map")],le=A["".concat(te.axisType,"Id")];ve&&ve[le]||te.axisType==="zAxis"||$u();var ce=ve[le];return Oe(Oe({},K),{},nt(nt({},te.axisType,ce),"".concat(te.axisType,"Ticks"),Da(ce)))},z),W=Q[ie],ae=Q["".concat(ie,"Ticks")],ye=C&&C[F]&&C[F].hasStack&&_we(y,C[F].stackGroups),H=Ba(y.type).indexOf("Bar")>=0,Re=Fx(W,ae),ue=[],Pe=se&&fwe({barSize:k,stackGroups:C,totalSize:eAe(Q,ie)});if(H){var ke,be,Fe=dt(N)?U:N,He=(ke=(be=Fx(W,ae,!0))!==null&&be!==void 0?be:Fe)!==null&&ke!==void 0?ke:0;ue=gwe({barGap:D,barCategoryGap:L,bandSize:He!==Re?He:Re,sizeList:Pe[j],maxBarSize:Fe}),He!==Re&&(ue=ue.map(function(K){return Oe(Oe({},K),{},{position:Oe(Oe({},K.position),{},{offset:K.position.offset-He/2})})}))}var V=y&&y.type&&y.type.getComposedData;V&&P.push({props:Oe(Oe({},V(Oe(Oe({},Q),{},{displayedData:R,props:w,dataKey:O,item:y,bandSize:Re,barPosition:ue,offset:S,stackedData:ye,layout:M,dataStartIndex:T,dataEndIndex:I}))),{},nt(nt(nt({key:y.key||"item-".concat(_)},X,Q[X]),ie,Q[ie]),"animationId",E)),childIndex:gse(y,w.children),item:y})}),P},f=function(w,b){var x=w.props,C=w.dataStartIndex,S=w.dataEndIndex,E=w.updateId;if(!aF({props:x}))return null;var T=x.children,I=x.layout,k=x.stackOffset,M=x.data,D=x.reverseStackOrder,L=G4(I),U=L.numericAxisName,J=L.cateAxisName,X=ss(T,n),ie=Ewe(M,X,"".concat(U,"Id"),"".concat(J,"Id"),k,D),se=l.reduce(function(A,O){var N="".concat(O.axisType,"Map");return Oe(Oe({},A),{},nt({},N,qRe(x,Oe(Oe({},O),{},{graphicalItems:X,stackGroups:O.axisType===U&&ie,dataStartIndex:C,dataEndIndex:S}))))},{}),P=QRe(Oe(Oe({},se),{},{props:x,graphicalItems:X}),b==null?void 0:b.legendBBox);Object.keys(se).forEach(function(A){se[A]=u(x,se[A],P,A.replace("Map",""),r)});var y=se["".concat(J,"Map")],_=JRe(y),R=d(x,Oe(Oe({},se),{},{dataStartIndex:C,dataEndIndex:S,updateId:E,graphicalItems:X,stackGroups:ie,offset:P}));return Oe(Oe({formattedGraphicalItems:R,graphicalItems:X,offset:P,stackGroups:ie},_),se)},m=function(v){function w(b){var x,C,S;return MRe(this,w),S=LRe(this,w,[b]),nt(S,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),nt(S,"accessibilityManager",new wRe),nt(S,"handleLegendBBoxUpdate",function(E){if(E){var T=S.state,I=T.dataStartIndex,k=T.dataEndIndex,M=T.updateId;S.setState(Oe({legendBBox:E},f({props:S.props,dataStartIndex:I,dataEndIndex:k,updateId:M},Oe(Oe({},S.state),{},{legendBBox:E}))))}}),nt(S,"handleReceiveSyncEvent",function(E,T,I){if(S.props.syncId===E){if(I===S.eventEmitterSymbol&&typeof S.props.syncMethod!="function")return;S.applySyncEvent(T)}}),nt(S,"handleBrushChange",function(E){var T=E.startIndex,I=E.endIndex;if(T!==S.state.dataStartIndex||I!==S.state.dataEndIndex){var k=S.state.updateId;S.setState(function(){return Oe({dataStartIndex:T,dataEndIndex:I},f({props:S.props,dataStartIndex:T,dataEndIndex:I,updateId:k},S.state))}),S.triggerSyncEvent({dataStartIndex:T,dataEndIndex:I})}}),nt(S,"handleMouseEnter",function(E){var T=S.getMouseInfo(E);if(T){var I=Oe(Oe({},T),{},{isTooltipActive:!0});S.setState(I),S.triggerSyncEvent(I);var k=S.props.onMouseEnter;at(k)&&k(I,E)}}),nt(S,"triggeredAfterMouseMove",function(E){var T=S.getMouseInfo(E),I=T?Oe(Oe({},T),{},{isTooltipActive:!0}):{isTooltipActive:!1};S.setState(I),S.triggerSyncEvent(I);var k=S.props.onMouseMove;at(k)&&k(I,E)}),nt(S,"handleItemMouseEnter",function(E){S.setState(function(){return{isTooltipActive:!0,activeItem:E,activePayload:E.tooltipPayload,activeCoordinate:E.tooltipPosition||{x:E.cx,y:E.cy}}})}),nt(S,"handleItemMouseLeave",function(){S.setState(function(){return{isTooltipActive:!1}})}),nt(S,"handleMouseMove",function(E){E.persist(),S.throttleTriggeredAfterMouseMove(E)}),nt(S,"handleMouseLeave",function(E){S.throttleTriggeredAfterMouseMove.cancel();var T={isTooltipActive:!1};S.setState(T),S.triggerSyncEvent(T);var I=S.props.onMouseLeave;at(I)&&I(T,E)}),nt(S,"handleOuterEvent",function(E){var T=fse(E),I=is(S.props,"".concat(T));if(T&&at(I)){var k,M;/.*touch.*/i.test(T)?M=S.getMouseInfo(E.changedTouches[0]):M=S.getMouseInfo(E),I((k=M)!==null&&k!==void 0?k:{},E)}}),nt(S,"handleClick",function(E){var T=S.getMouseInfo(E);if(T){var I=Oe(Oe({},T),{},{isTooltipActive:!0});S.setState(I),S.triggerSyncEvent(I);var k=S.props.onClick;at(k)&&k(I,E)}}),nt(S,"handleMouseDown",function(E){var T=S.props.onMouseDown;if(at(T)){var I=S.getMouseInfo(E);T(I,E)}}),nt(S,"handleMouseUp",function(E){var T=S.props.onMouseUp;if(at(T)){var I=S.getMouseInfo(E);T(I,E)}}),nt(S,"handleTouchMove",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&S.throttleTriggeredAfterMouseMove(E.changedTouches[0])}),nt(S,"handleTouchStart",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&S.handleMouseDown(E.changedTouches[0])}),nt(S,"handleTouchEnd",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&S.handleMouseUp(E.changedTouches[0])}),nt(S,"handleDoubleClick",function(E){var T=S.props.onDoubleClick;if(at(T)){var I=S.getMouseInfo(E);T(I,E)}}),nt(S,"handleContextMenu",function(E){var T=S.props.onContextMenu;if(at(T)){var I=S.getMouseInfo(E);T(I,E)}}),nt(S,"triggerSyncEvent",function(E){S.props.syncId!==void 0&&kE.emit(IE,S.props.syncId,E,S.eventEmitterSymbol)}),nt(S,"applySyncEvent",function(E){var T=S.props,I=T.layout,k=T.syncMethod,M=S.state.updateId,D=E.dataStartIndex,L=E.dataEndIndex;if(E.dataStartIndex!==void 0||E.dataEndIndex!==void 0)S.setState(Oe({dataStartIndex:D,dataEndIndex:L},f({props:S.props,dataStartIndex:D,dataEndIndex:L,updateId:M},S.state)));else if(E.activeTooltipIndex!==void 0){var U=E.chartX,J=E.chartY,X=E.activeTooltipIndex,ie=S.state,se=ie.offset,P=ie.tooltipTicks;if(!se)return;if(typeof k=="function")X=k(P,E);else if(k==="value"){X=-1;for(var y=0;y<P.length;y++)if(P[y].value===E.activeLabel){X=y;break}}var _=Oe(Oe({},se),{},{x:se.left,y:se.top}),R=Math.min(U,_.x+_.width),A=Math.min(J,_.y+_.height),O=P[X]&&P[X].value,N=fO(S.state,S.props.data,X),F=P[X]?{x:I==="horizontal"?P[X].coordinate:R,y:I==="horizontal"?A:P[X].coordinate}:n9;S.setState(Oe(Oe({},E),{},{activeLabel:O,activeCoordinate:F,activePayload:N,activeTooltipIndex:X}))}else S.setState(E)}),nt(S,"renderCursor",function(E){var T,I=S.state,k=I.isTooltipActive,M=I.activeCoordinate,D=I.activePayload,L=I.offset,U=I.activeTooltipIndex,J=I.tooltipAxisBandSize,X=S.getTooltipEventType(),ie=(T=E.props.active)!==null&&T!==void 0?T:k,se=S.props.layout,P=E.key||"_recharts-cursor";return oe.createElement(_Re,{key:P,activeCoordinate:M,activePayload:D,activeTooltipIndex:U,chartName:r,element:E,isActive:ie,layout:se,offset:L,tooltipAxisBandSize:J,tooltipEventType:X})}),nt(S,"renderPolarAxis",function(E,T,I){var k=is(E,"type.axisType"),M=is(S.state,"".concat(k,"Map")),D=E.type.defaultProps,L=D!==void 0?Oe(Oe({},D),E.props):E.props,U=M&&M[L["".concat(k,"Id")]];return G.cloneElement(E,Oe(Oe({},U),{},{className:xt(k,U.className),key:E.key||"".concat(T,"-").concat(I),ticks:Da(U,!0)}))}),nt(S,"renderPolarGrid",function(E){var T=E.props,I=T.radialLines,k=T.polarAngles,M=T.polarRadius,D=S.state,L=D.radiusAxisMap,U=D.angleAxisMap,J=$l(L),X=$l(U),ie=X.cx,se=X.cy,P=X.innerRadius,y=X.outerRadius;return G.cloneElement(E,{polarAngles:Array.isArray(k)?k:Da(X,!0).map(function(_){return _.coordinate}),polarRadius:Array.isArray(M)?M:Da(J,!0).map(function(_){return _.coordinate}),cx:ie,cy:se,innerRadius:P,outerRadius:y,key:E.key||"polar-grid",radialLines:I})}),nt(S,"renderLegend",function(){var E=S.state.formattedGraphicalItems,T=S.props,I=T.children,k=T.width,M=T.height,D=S.props.margin||{},L=k-(D.left||0)-(D.right||0),U=P7({children:I,formattedGraphicalItems:E,legendWidth:L,legendContent:c});if(!U)return null;var J=U.item,X=V4(U,RRe);return G.cloneElement(J,Oe(Oe({},X),{},{chartWidth:k,chartHeight:M,margin:D,onBBoxUpdate:S.handleLegendBBoxUpdate}))}),nt(S,"renderTooltip",function(){var E,T=S.props,I=T.children,k=T.accessibilityLayer,M=Xi(I,Es);if(!M)return null;var D=S.state,L=D.isTooltipActive,U=D.activeCoordinate,J=D.activePayload,X=D.activeLabel,ie=D.offset,se=(E=M.props.active)!==null&&E!==void 0?E:L;return G.cloneElement(M,{viewBox:Oe(Oe({},ie),{},{x:ie.left,y:ie.top}),active:se,label:X,payload:se?J:[],coordinate:U,accessibilityLayer:k})}),nt(S,"renderBrush",function(E){var T=S.props,I=T.margin,k=T.data,M=S.state,D=M.offset,L=M.dataStartIndex,U=M.dataEndIndex,J=M.updateId;return G.cloneElement(E,{key:E.key||"_recharts-brush",onChange:Yv(S.handleBrushChange,E.props.onChange),data:k,x:Ue(E.props.x)?E.props.x:D.left,y:Ue(E.props.y)?E.props.y:D.top+D.height+D.brushBottom-(I.bottom||0),width:Ue(E.props.width)?E.props.width:D.width,startIndex:L,endIndex:U,updateId:"brush-".concat(J)})}),nt(S,"renderReferenceElement",function(E,T,I){if(!E)return null;var k=S,M=k.clipPathId,D=S.state,L=D.xAxisMap,U=D.yAxisMap,J=D.offset,X=E.type.defaultProps||{},ie=E.props,se=ie.xAxisId,P=se===void 0?X.xAxisId:se,y=ie.yAxisId,_=y===void 0?X.yAxisId:y;return G.cloneElement(E,{key:E.key||"".concat(T,"-").concat(I),xAxis:L[P],yAxis:U[_],viewBox:{x:J.left,y:J.top,width:J.width,height:J.height},clipPathId:M})}),nt(S,"renderActivePoints",function(E){var T=E.item,I=E.activePoint,k=E.basePoint,M=E.childIndex,D=E.isRange,L=[],U=T.props.key,J=T.item.type.defaultProps!==void 0?Oe(Oe({},T.item.type.defaultProps),T.item.props):T.item.props,X=J.activeDot,ie=J.dataKey,se=Oe(Oe({index:M,dataKey:ie,cx:I.x,cy:I.y,r:4,fill:EI(T.item),strokeWidth:2,stroke:"#fff",payload:I.payload,value:I.value},rt(X,!1)),ux(X));return L.push(w.renderActiveDot(X,se,"".concat(U,"-activePoint-").concat(M))),k?L.push(w.renderActiveDot(X,Oe(Oe({},se),{},{cx:k.x,cy:k.y}),"".concat(U,"-basePoint-").concat(M))):D&&L.push(null),L}),nt(S,"renderGraphicChild",function(E,T,I){var k=S.filterFormatItem(E,T,I);if(!k)return null;var M=S.getTooltipEventType(),D=S.state,L=D.isTooltipActive,U=D.tooltipAxis,J=D.activeTooltipIndex,X=D.activeLabel,ie=S.props.children,se=Xi(ie,Es),P=k.props,y=P.points,_=P.isRange,R=P.baseLine,A=k.item.type.defaultProps!==void 0?Oe(Oe({},k.item.type.defaultProps),k.item.props):k.item.props,O=A.activeDot,N=A.hide,F=A.activeBar,j=A.activeShape,z=!!(!N&&L&&se&&(O||F||j)),Q={};M!=="axis"&&se&&se.props.trigger==="click"?Q={onClick:Yv(S.handleItemMouseEnter,E.props.onClick)}:M!=="axis"&&(Q={onMouseLeave:Yv(S.handleItemMouseLeave,E.props.onMouseLeave),onMouseEnter:Yv(S.handleItemMouseEnter,E.props.onMouseEnter)});var W=G.cloneElement(E,Oe(Oe({},k.props),Q));function ae(te){return typeof U.dataKey=="function"?U.dataKey(te.payload):null}if(z)if(J>=0){var ye,H;if(U.dataKey&&!U.allowDuplicatedCategory){var Re=typeof U.dataKey=="function"?ae:"payload.".concat(U.dataKey.toString());ye=cx(y,Re,X),H=_&&R&&cx(R,Re,X)}else ye=y==null?void 0:y[J],H=_&&R&&R[J];if(j||F){var ue=E.props.activeIndex!==void 0?E.props.activeIndex:J;return[G.cloneElement(E,Oe(Oe(Oe({},k.props),Q),{},{activeIndex:ue})),null,null]}if(!dt(ye))return[W].concat(yf(S.renderActivePoints({item:k,activePoint:ye,basePoint:H,childIndex:J,isRange:_})))}else{var Pe,ke=(Pe=S.getItemByXY(S.state.activeCoordinate))!==null&&Pe!==void 0?Pe:{graphicalItem:W},be=ke.graphicalItem,Fe=be.item,He=Fe===void 0?E:Fe,V=be.childIndex,K=Oe(Oe(Oe({},k.props),Q),{},{activeIndex:V});return[G.cloneElement(He,K),null,null]}return _?[W,null,null]:[W,null]}),nt(S,"renderCustomized",function(E,T,I){return G.cloneElement(E,Oe(Oe({key:"recharts-customized-".concat(I)},S.props),S.state))}),nt(S,"renderMap",{CartesianGrid:{handler:Zv,once:!0},ReferenceArea:{handler:S.renderReferenceElement},ReferenceLine:{handler:Zv},ReferenceDot:{handler:S.renderReferenceElement},XAxis:{handler:Zv},YAxis:{handler:Zv},Brush:{handler:S.renderBrush,once:!0},Bar:{handler:S.renderGraphicChild},Line:{handler:S.renderGraphicChild},Area:{handler:S.renderGraphicChild},Radar:{handler:S.renderGraphicChild},RadialBar:{handler:S.renderGraphicChild},Scatter:{handler:S.renderGraphicChild},Pie:{handler:S.renderGraphicChild},Funnel:{handler:S.renderGraphicChild},Tooltip:{handler:S.renderCursor,once:!0},PolarGrid:{handler:S.renderPolarGrid,once:!0},PolarAngleAxis:{handler:S.renderPolarAxis},PolarRadiusAxis:{handler:S.renderPolarAxis},Customized:{handler:S.renderCustomized}}),S.clipPathId="".concat((x=b.id)!==null&&x!==void 0?x:jf("recharts"),"-clip"),S.throttleTriggeredAfterMouseMove=MW(S.triggeredAfterMouseMove,(C=b.throttleDelay)!==null&&C!==void 0?C:1e3/60),S.state={},S}return HRe(w,v),DRe(w,[{key:"componentDidMount",value:function(){var x,C;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(x=this.props.margin.left)!==null&&x!==void 0?x:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var x=this.props,C=x.children,S=x.data,E=x.height,T=x.layout,I=Xi(C,Es);if(I){var k=I.props.defaultIndex;if(!(typeof k!="number"||k<0||k>this.state.tooltipTicks.length-1)){var M=this.state.tooltipTicks[k]&&this.state.tooltipTicks[k].value,D=fO(this.state,S,k,M),L=this.state.tooltipTicks[k].coordinate,U=(this.state.offset.top+E)/2,J=T==="horizontal",X=J?{x:L,y:U}:{y:L,x:U},ie=this.state.formattedGraphicalItems.find(function(P){var y=P.item;return y.type.name==="Scatter"});ie&&(X=Oe(Oe({},X),ie.props.points[k].tooltipPosition),D=ie.props.points[k].tooltipPayload);var se={activeTooltipIndex:k,isTooltipActive:!0,activeLabel:M,activePayload:D,activeCoordinate:X};this.setState(se),this.renderCursor(I),this.accessibilityManager.setIndex(k)}}}},{key:"getSnapshotBeforeUpdate",value:function(x,C){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==C.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==x.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==x.margin){var S,E;this.accessibilityManager.setDetails({offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(E=this.props.margin.top)!==null&&E!==void 0?E:0}})}return null}},{key:"componentDidUpdate",value:function(x){VR([Xi(x.children,Es)],[Xi(this.props.children,Es)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var x=Xi(this.props.children,Es);if(x&&typeof x.props.shared=="boolean"){var C=x.props.shared?"axis":"item";return a.indexOf(C)>=0?C:s}return s}},{key:"getMouseInfo",value:function(x){if(!this.container)return null;var C=this.container,S=C.getBoundingClientRect(),E=jme(S),T={chartX:Math.round(x.pageX-E.left),chartY:Math.round(x.pageY-E.top)},I=S.width/C.offsetWidth||1,k=this.inRange(T.chartX,T.chartY,I);if(!k)return null;var M=this.state,D=M.xAxisMap,L=M.yAxisMap,U=this.getTooltipEventType(),J=W4(this.state,this.props.data,this.props.layout,k);if(U!=="axis"&&D&&L){var X=$l(D).scale,ie=$l(L).scale,se=X&&X.invert?X.invert(T.chartX):null,P=ie&&ie.invert?ie.invert(T.chartY):null;return Oe(Oe({},T),{},{xValue:se,yValue:P},J)}return J?Oe(Oe({},T),J):null}},{key:"inRange",value:function(x,C){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=this.props.layout,T=x/S,I=C/S;if(E==="horizontal"||E==="vertical"){var k=this.state.offset,M=T>=k.left&&T<=k.left+k.width&&I>=k.top&&I<=k.top+k.height;return M?{x:T,y:I}:null}var D=this.state,L=D.angleAxisMap,U=D.radiusAxisMap;if(L&&U){var J=$l(L);return vH({x:T,y:I},J)}return null}},{key:"parseEventsOfWrapper",value:function(){var x=this.props.children,C=this.getTooltipEventType(),S=Xi(x,Es),E={};S&&C==="axis"&&(S.props.trigger==="click"?E={onClick:this.handleClick}:E={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var T=ux(this.props,this.handleOuterEvent);return Oe(Oe({},T),E)}},{key:"addListener",value:function(){kE.on(IE,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){kE.removeListener(IE,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(x,C,S){for(var E=this.state.formattedGraphicalItems,T=0,I=E.length;T<I;T++){var k=E[T];if(k.item===x||k.props.key===x.key||C===Ba(k.item.type)&&S===k.childIndex)return k}return null}},{key:"renderClipPath",value:function(){var x=this.clipPathId,C=this.state.offset,S=C.left,E=C.top,T=C.height,I=C.width;return oe.createElement("defs",null,oe.createElement("clipPath",{id:x},oe.createElement("rect",{x:S,y:E,height:T,width:I})))}},{key:"getXScales",value:function(){var x=this.state.xAxisMap;return x?Object.entries(x).reduce(function(C,S){var E=B4(S,2),T=E[0],I=E[1];return Oe(Oe({},C),{},nt({},T,I.scale))},{}):null}},{key:"getYScales",value:function(){var x=this.state.yAxisMap;return x?Object.entries(x).reduce(function(C,S){var E=B4(S,2),T=E[0],I=E[1];return Oe(Oe({},C),{},nt({},T,I.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(x){var C;return(C=this.state.xAxisMap)===null||C===void 0||(C=C[x])===null||C===void 0?void 0:C.scale}},{key:"getYScaleByAxisId",value:function(x){var C;return(C=this.state.yAxisMap)===null||C===void 0||(C=C[x])===null||C===void 0?void 0:C.scale}},{key:"getItemByXY",value:function(x){var C=this.state,S=C.formattedGraphicalItems,E=C.activeItem;if(S&&S.length)for(var T=0,I=S.length;T<I;T++){var k=S[T],M=k.props,D=k.item,L=D.type.defaultProps!==void 0?Oe(Oe({},D.type.defaultProps),D.props):D.props,U=Ba(D.type);if(U==="Bar"){var J=(M.data||[]).find(function(P){return Sbe(x,P)});if(J)return{graphicalItem:k,payload:J}}else if(U==="RadialBar"){var X=(M.data||[]).find(function(P){return vH(x,P)});if(X)return{graphicalItem:k,payload:X}}else if(cS(k,E)||uS(k,E)||Xp(k,E)){var ie=hCe({graphicalItem:k,activeTooltipItem:E,itemData:L.data}),se=L.activeIndex===void 0?ie:L.activeIndex;return{graphicalItem:Oe(Oe({},k),{},{childIndex:se}),payload:Xp(k,E)?L.data[ie]:k.props.data[ie]}}}return null}},{key:"render",value:function(){var x=this;if(!aF(this))return null;var C=this.props,S=C.children,E=C.className,T=C.width,I=C.height,k=C.style,M=C.compact,D=C.title,L=C.desc,U=V4(C,ARe),J=rt(U,!1);if(M)return oe.createElement(C4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},oe.createElement(WR,hd({},J,{width:T,height:I,title:D,desc:L}),this.renderClipPath(),cF(S,this.renderMap)));if(this.props.accessibilityLayer){var X,ie;J.tabIndex=(X=this.props.tabIndex)!==null&&X!==void 0?X:0,J.role=(ie=this.props.role)!==null&&ie!==void 0?ie:"application",J.onKeyDown=function(P){x.accessibilityManager.keyboardEvent(P)},J.onFocus=function(){x.accessibilityManager.focus()}}var se=this.parseEventsOfWrapper();return oe.createElement(C4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},oe.createElement("div",hd({className:xt("recharts-wrapper",E),style:Oe({position:"relative",cursor:"default",width:T,height:I},k)},se,{ref:function(y){x.container=y}}),oe.createElement(WR,hd({},J,{width:T,height:I,title:D,desc:L,style:zRe}),this.renderClipPath(),cF(S,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(G.Component);nt(m,"displayName",r),nt(m,"defaultProps",Oe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),nt(m,"getDerivedStateFromProps",function(v,w){var b=v.dataKey,x=v.data,C=v.children,S=v.width,E=v.height,T=v.layout,I=v.stackOffset,k=v.margin,M=w.dataStartIndex,D=w.dataEndIndex;if(w.updateId===void 0){var L=z4(v);return Oe(Oe(Oe({},L),{},{updateId:0},f(Oe(Oe({props:v},L),{},{updateId:0}),w)),{},{prevDataKey:b,prevData:x,prevWidth:S,prevHeight:E,prevLayout:T,prevStackOffset:I,prevMargin:k,prevChildren:C})}if(b!==w.prevDataKey||x!==w.prevData||S!==w.prevWidth||E!==w.prevHeight||T!==w.prevLayout||I!==w.prevStackOffset||!Ed(k,w.prevMargin)){var U=z4(v),J={chartX:w.chartX,chartY:w.chartY,isTooltipActive:w.isTooltipActive},X=Oe(Oe({},W4(w,x,T)),{},{updateId:w.updateId+1}),ie=Oe(Oe(Oe({},U),J),X);return Oe(Oe(Oe({},ie),f(Oe({props:v},ie),w)),{},{prevDataKey:b,prevData:x,prevWidth:S,prevHeight:E,prevLayout:T,prevStackOffset:I,prevMargin:k,prevChildren:C})}if(!VR(C,w.prevChildren)){var se,P,y,_,R=Xi(C,lf),A=R&&(se=(P=R.props)===null||P===void 0?void 0:P.startIndex)!==null&&se!==void 0?se:M,O=R&&(y=(_=R.props)===null||_===void 0?void 0:_.endIndex)!==null&&y!==void 0?y:D,N=A!==M||O!==D,F=!dt(x),j=F&&!N?w.updateId:w.updateId+1;return Oe(Oe({updateId:j},f(Oe(Oe({props:v},w),{},{updateId:j,dataStartIndex:A,dataEndIndex:O}),w)),{},{prevChildren:C,dataStartIndex:A,dataEndIndex:O})}return null}),nt(m,"renderActiveDot",function(v,w,b){var x;return G.isValidElement(v)?x=G.cloneElement(v,w):at(v)?x=v(w):x=oe.createElement(iS,w),oe.createElement(Ft,{className:"recharts-active-dot",key:b},x)});var g=G.forwardRef(function(w,b){return oe.createElement(m,hd({},w,{ref:b}))});return g.displayName=m.displayName,g},tAe=LI({chartName:"LineChart",GraphicalChild:G0,axisComponents:[{axisType:"xAxis",AxisComp:Kf},{axisType:"yAxis",AxisComp:Xf}],formatAxisMap:Cz}),rAe=LI({chartName:"BarChart",GraphicalChild:rh,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Kf},{axisType:"yAxis",AxisComp:Xf}],formatAxisMap:Cz}),nAe=LI({chartName:"PieChart",GraphicalChild:ul,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:lS},{axisType:"radiusAxis",AxisComp:oS}],formatAxisMap:Lwe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const iAe=[{value:"ACCOUNT_TRANSFER",label:"Account Transfer"},{value:"CASH",label:"Cash"},{value:"CHEQUE",label:"Cheque"},{value:"CREDIT_CARD",label:"Credit Card"},{value:"DEBIT_CARD",label:"Debit Card"},{value:"DD",label:"Demand Draft"},{value:"UPI",label:"UPI"}],ME=t=>{if(!t)return"";try{const e=new Date(t);if(!isNaN(e.getTime())){const r=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),i=e.getFullYear();return`${r}/${n}/${i}`}}catch(e){console.error("Error formatting date:",e)}return t},Y4=t=>{if(!t)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[e,r,n]=t.split("/").map(Number);if(!isNaN(e)&&!isNaN(r)&&!isNaN(n))return`${n}-${String(r).padStart(2,"0")}-${String(e).padStart(2,"0")}`}try{const e=new Date(t);if(!isNaN(e.getTime()))return e.toISOString().split("T")[0]}catch(e){console.error("Error parsing date:",e)}return""};function FI({isOpen:t,onClose:e,onSubmit:r,invoiceAmount:n,invoiceId:i,customerName:s,isSubmitting:o,paymentDate:a}){const[l,c]=G.useState({tds:0,transactionCharge:0,amount:n,paymentDate:new Date().toISOString().split("T")[0],paymentMethod:"ACCOUNT_TRANSFER",notes:"",refId:""}),[u,h]=G.useState("");G.useEffect(()=>{if(a)c(m=>({...m,paymentDate:a})),h(ME(a));else{const m=new Date().toISOString().split("T")[0];c(g=>({...g,paymentDate:m})),h(ME(m))}},[a]);const d=m=>{const{name:g,value:v}=m.target;let w=v;if(["amount","tds","transactionCharge"].includes(g)&&(w=parseFloat(v)||0),g==="displayDate"){h(v);const b=Y4(v);b&&c(x=>({...x,paymentDate:b}));return}g==="paymentDate"&&h(ME(v)),c(b=>({...b,[g]:w}))},f=m=>{m.preventDefault();const g={...l,paymentDate:Y4(u)||l.paymentDate};r(g)};return t?p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg mx-4 shadow-xl overflow-hidden",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Cd,{className:"w-5 h-5 text-blue-600"}),p.jsx("h3",{className:"font-medium text-gray-900",children:"Add Payment"})]}),p.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",disabled:o,children:p.jsx(D0,{className:"w-5 h-5 text-gray-500"})})]}),p.jsxs("form",{onSubmit:f,children:[p.jsxs("div",{className:"p-4",children:[p.jsxs("div",{className:"mb-4 bg-blue-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-sm text-blue-700 font-medium",children:s}),p.jsxs("p",{className:"text-sm text-blue-600",children:["Invoice #",i]}),p.jsxs("p",{className:"text-sm text-blue-600 font-medium mt-1",children:["Total: ",n.toLocaleString()]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount*"}),p.jsxs("div",{className:"relative",children:[p.jsx(Cd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),p.jsx("input",{type:"number",name:"amount",value:l.amount,onChange:d,required:!0,min:"0",step:"0.01",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:["Payment Date*",p.jsxs("div",{className:"relative group ml-1",children:[p.jsx(T2,{className:"w-4 h-4 text-gray-400"}),p.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 hidden group-hover:block bg-gray-800 text-white text-xs rounded p-2 w-48",children:"Enter date as DD/MM/YYYY or use the calendar picker"})]})]}),p.jsxs("div",{className:"relative flex",children:[p.jsx(lx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),p.jsx("input",{type:"text",name:"displayDate",value:u,onChange:d,placeholder:"DD/MM/YYYY",pattern:"^(\\d{2}\\/\\d{2}\\/\\d{4}|\\d{4}-\\d{2}-\\d{2})$",required:!0,className:"w-full pl-10 pr-12 py-2 border rounded-lg"}),p.jsx("input",{type:"date",name:"paymentDate",value:l.paymentDate,onChange:d,className:"absolute inset-0 opacity-0 cursor-pointer",required:!0}),p.jsx("button",{type:"button",onClick:()=>{var m;return(m=document.querySelector('input[name="paymentDate"]'))==null?void 0:m.showPicker()},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:p.jsx(lx,{className:"w-5 h-5"})})]})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method*"}),p.jsxs("div",{className:"relative",children:[p.jsx(cte,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),p.jsx("select",{name:"paymentMethod",value:l.paymentMethod,onChange:d,required:!0,className:"w-full pl-10 pr-4 py-2 border rounded-lg appearance-none bg-white",children:iAe.map(m=>p.jsx("option",{value:m.value,children:m.label},m.value))})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TDS Amount"}),p.jsx("input",{type:"number",name:"tds",value:l.tds,onChange:d,min:"0",step:"0.01",className:"w-full px-3 py-2 border rounded-lg"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Charge"}),p.jsx("input",{type:"number",name:"transactionCharge",value:l.transactionCharge,onChange:d,min:"0",step:"0.01",className:"w-full px-3 py-2 border rounded-lg"})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference ID"}),p.jsxs("div",{className:"relative",children:[p.jsx(bb,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),p.jsx("input",{type:"text",name:"refId",value:l.refId,onChange:d,placeholder:"Transaction reference number",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),p.jsx("textarea",{name:"notes",value:l.notes,onChange:d,rows:3,placeholder:"Any additional information about this payment",className:"w-full px-3 py-2 border rounded-lg resize-none"})]})]}),p.jsxs("div",{className:"border-t p-4 flex justify-end gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:o,children:"Cancel"}),p.jsx("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",disabled:o,children:o?p.jsxs(p.Fragment,{children:[p.jsx(Qa,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Cd,{className:"w-4 h-4"}),"Add Payment"]})})]})]})]})}):null}const K4="dashboard_stats_cache",sAe=5,X4=["#3B82F6","#10B981","#F59E0B","#6366F1","#8B5CF6"],s9=t=>X4[t%X4.length],oAe=({data:t})=>p.jsx(Q2,{width:"100%",height:"100%",children:p.jsxs(tAe,{data:t,children:[p.jsx(DI,{strokeDasharray:"3 3"}),p.jsx(Kf,{dataKey:"name"}),p.jsx(Xf,{}),p.jsx(Es,{}),p.jsx(sc,{}),p.jsx(G0,{type:"monotone",dataKey:"amount",stroke:"#3B82F6",strokeWidth:2})]})}),aAe=({data:t})=>p.jsx(Q2,{width:"100%",height:"100%",children:p.jsxs(rAe,{data:t,children:[p.jsx(DI,{strokeDasharray:"3 3"}),p.jsx(Kf,{dataKey:"name"}),p.jsx(Xf,{}),p.jsx(Es,{}),p.jsx(sc,{}),p.jsx(rh,{dataKey:"amount",fill:"#3B82F6"})]})}),lAe=({data:t})=>p.jsx(Q2,{width:"100%",height:"100%",children:p.jsxs(nAe,{children:[p.jsx(ul,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"amount",children:t.map((e,r)=>p.jsx(Gb,{fill:s9(r)},`cell-${r}`))}),p.jsx(Es,{})]})});function cAe(){const t=Pf(),[e,r]=G.useState({totalInvoices:0,paidInvoices:0,pendingInvoices:{count:0,amount:0},completedPayments:{count:0,amount:0},totalAmount:0,paidAmount:0,pendingAmount:0,customers:0,uniqueCustomers:0,averageInvoiceAmount:0,recentInvoices:[],paymentMethods:[],revenueData:[],paymentRatio:0,topCustomers:[],avgDaysToPay:0,repeatCustomers:0,lastUpdated:new Date}),[n,i]=G.useState(!0),[s,o]=G.useState(!1),[a,l]=G.useState(null),[c,u]=G.useState(!1),[h,d]=G.useState(!1),[f,m]=G.useState(""),[g,v]=G.useState(""),[w,b]=G.useState("today"),[x,C]=G.useState("line");G.useEffect(()=>(E(!1),window.addEventListener("storage",S),()=>{window.removeEventListener("storage",S)}),[t]);const S=k=>{(k.key&&k.key.startsWith("invoices_")||k.key==="invoices_updated")&&(console.log("Invoice data changed, refreshing dashboard"),o(!0),E(!0))},E=(k=!1)=>{if(i(!0),!k&&!s){const _=sessionStorage.getItem(K4);if(_)try{const R=JSON.parse(_),A=uAe(R.lastUpdated);R.lastUpdated=A;const N=(new Date().getTime()-A.getTime())/(1e3*60);if(N<sAe){console.log(`Using cached dashboard data (${N.toFixed(1)} minutes old)`),r(R),i(!1),o(!1);return}else console.log("Cache expired, refreshing data")}catch(R){console.error("Error parsing cache:",R)}}m(""),v(""),console.log("Fetching fresh dashboard data");const M=Cb();console.log("Found invoice keys:",M);let D=0,L=0,U=0,J=0,X=0,ie=0;const se=[];M.forEach(_=>{const R=_.replace("invoices_","");vU(R).forEach(O=>{D++;const N=O.amount||0;J+=N,O.isPaid?(L++,X+=N):(U++,ie+=N),se.push({id:O.id,customerName:O.customerName||"Unknown Customer",date:O.date||new Date().toISOString(),amount:N,isPaid:!!O.isPaid,invoiceNumber:O.invoiceNumber||"Unknown",link:O.link||"",customerId:R})})});const P=se.sort((_,R)=>new Date(R.date).getTime()-new Date(_.date).getTime()).slice(0,5),y={totalInvoices:D,paidInvoices:L,pendingInvoices:{count:U,amount:ie},completedPayments:{count:L,amount:X},totalAmount:J,paidAmount:X,pendingAmount:ie,customers:M.length,uniqueCustomers:M.length,averageInvoiceAmount:D>0?Math.round(J/D):0,recentInvoices:P,paymentMethods:[{method:"UPI",amount:X*.7},{method:"Cash",amount:X*.2},{method:"Card",amount:X*.1}],revenueData:[],paymentRatio:D>0?L/D:0,topCustomers:[],avgDaysToPay:3,repeatCustomers:Math.floor(M.length/2),lastUpdated:new Date};r(y),i(!1),o(!1);try{const _={...y,lastUpdated:typeof y.lastUpdated=="string"?y.lastUpdated:y.lastUpdated.toISOString()};sessionStorage.setItem(K4,JSON.stringify(_))}catch(_){console.error("Error caching dashboard data:",_)}},T=()=>{o(!0),E(!0)},I=async k=>{if(a){d(!0),v("");try{if(console.log("Processing payment for",a.invoiceNumber,k),a.customerId){const D=`invoices_${a.customerId}`,U=JSON.parse(localStorage.getItem(D)||"[]").map(J=>J.id===a.id?{...J,isPaid:!0,paymentDate:k.paymentDate,paymentMethod:k.paymentMethod,paymentAmount:k.amount,paymentRef:k.refId}:J);localStorage.setItem(D,JSON.stringify(U))}const M=e.recentInvoices.map(D=>D.id===a.id?{...D,isPaid:!0}:D);r(D=>({...D,paidInvoices:D.paidInvoices+1,pendingInvoices:{count:D.pendingInvoices.count-1,amount:D.pendingInvoices.amount-a.amount},completedPayments:{count:D.completedPayments.count+1,amount:D.completedPayments.amount+a.amount},paidAmount:D.paidAmount+a.amount,pendingAmount:D.pendingAmount-a.amount,recentInvoices:M,paymentRatio:(D.paidInvoices+1)/D.totalInvoices})),m(`Payment of ${k.amount.toLocaleString()} successfully recorded for invoice ${a.invoiceNumber}`),window.dispatchEvent(new StorageEvent("storage",{key:"invoices_updated",newValue:new Date().toISOString()})),u(!1),l(null)}catch(M){console.error("Error processing payment:",M),v(M.message||"Failed to process payment")}finally{d(!1)}}};return p.jsxs("div",{className:"space-y-8",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),p.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-start sm:justify-end",children:[p.jsxs("div",{className:"relative",children:[p.jsxs("select",{value:w,onChange:k=>b(k.target.value),className:"px-3 py-1.5 pr-8 text-sm border border-gray-300 rounded-lg appearance-none bg-white",children:[p.jsx("option",{value:"today",children:"Today"}),p.jsx("option",{value:"week",children:"This Week"}),p.jsx("option",{value:"month",children:"This Month"}),p.jsx("option",{value:"year",children:"This Year"}),p.jsx("option",{value:"all",children:"All Time"})]}),p.jsx(aU,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500 pointer-events-none"})]}),p.jsxs("button",{onClick:T,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[p.jsx(Gd,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[p.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Pending Invoices"}),p.jsx(bb,{className:"w-6 h-6 text-orange-500"})]}),p.jsxs("div",{className:"flex items-baseline gap-2",children:[p.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.pendingInvoices.count}),p.jsxs("p",{className:"text-sm text-gray-600",children:["",e.pendingInvoices.amount.toLocaleString()]})]})]}),p.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Completed Payments"}),p.jsx(oU,{className:"w-6 h-6 text-green-500"})]}),p.jsxs("div",{className:"flex items-baseline gap-2",children:[p.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.completedPayments.count}),p.jsxs("p",{className:"text-sm text-gray-600",children:["",e.completedPayments.amount.toLocaleString()]})]})]}),p.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Active Customers"}),p.jsx(xte,{className:"w-6 h-6 text-blue-500"})]}),p.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.uniqueCustomers})]}),p.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Avg. Invoice"}),p.jsx(ite,{className:"w-6 h-6 text-indigo-500"})]}),p.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",e.averageInvoiceAmount.toLocaleString()]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[p.jsxs("div",{className:"lg:col-span-2 bg-white p-4 md:p-6 rounded-xl shadow-sm",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6",children:[p.jsx("h2",{className:"text-lg font-medium text-gray-800",children:"Revenue Overview"}),p.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[p.jsx("button",{onClick:()=>C("line"),className:`px-3 py-1 text-xs rounded-lg ${x==="line"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Line"}),p.jsx("button",{onClick:()=>C("bar"),className:`px-3 py-1 text-xs rounded-lg ${x==="bar"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Bar"})]})]}),p.jsx("div",{className:"h-64",children:p.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-50 rounded-lg",children:e.revenueData.length>0?p.jsx("div",{className:"w-full h-full p-4",children:x==="line"?p.jsx(oAe,{data:e.revenueData}):p.jsx(aAe,{data:e.revenueData})}):p.jsx("p",{className:"text-gray-500",children:"No revenue data available"})})})]}),p.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm",children:[p.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:"Recent Invoices"}),p.jsx("div",{className:"space-y-4",children:e.recentInvoices.length>0?e.recentInvoices.map(k=>p.jsxs("div",{className:"p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-sm text-gray-900",children:k.customerName}),p.jsx("p",{className:"text-xs text-gray-500",children:new Date(k.date).toLocaleDateString()})]}),p.jsxs("div",{className:"text-right",children:[p.jsxs("p",{className:"font-medium text-sm",children:["",k.amount.toLocaleString()]}),p.jsx("p",{className:"text-xs",children:p.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${k.isPaid?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:k.isPaid?"Paid":"Pending"})})]})]}),p.jsx("div",{className:"mt-2 flex justify-end items-center gap-3",children:k.link&&p.jsxs("a",{href:k.link,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 inline-flex items-center",children:["View ",p.jsx(lU,{className:"w-3 h-3 ml-1"})]})})]},k.id)):p.jsxs("div",{className:"p-6 text-center text-gray-500",children:[p.jsx("p",{children:"No invoices found"}),p.jsx(Wd,{to:"/generate",className:"inline-block mt-2 text-sm text-blue-600 hover:text-blue-800",children:"Generate your first invoice"})]})})]})]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm",children:[p.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:"Payment Methods"}),p.jsx("div",{className:"h-64",children:e.paymentMethods.length>0?p.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[p.jsx("div",{className:"w-full md:w-1/2 h-full p-2",children:p.jsx(lAe,{data:e.paymentMethods})}),p.jsx("div",{className:"w-full md:w-1/2 p-2",children:p.jsx("ul",{className:"space-y-2 text-sm",children:e.paymentMethods.map((k,M)=>p.jsxs("li",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"block w-3 h-3 rounded-full",style:{backgroundColor:s9(M)}}),p.jsx("span",{children:k.method||"Unknown"})]}),p.jsxs("span",{className:"font-medium",children:["",k.amount.toLocaleString()]})]},M))})})]}):p.jsx("div",{className:"h-full flex items-center justify-center",children:p.jsx("p",{className:"text-gray-500",children:"No payment data available"})})})]}),p.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm",children:[p.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:"Customer Analytics"}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Top Customers"}),e.topCustomers.length>0?p.jsx("ul",{className:"space-y-2",children:e.topCustomers.map((k,M)=>p.jsxs("li",{className:"flex justify-between items-baseline",children:[p.jsx("span",{className:"text-sm truncate max-w-[150px]",children:k.name}),p.jsxs("span",{className:"text-xs font-medium",children:["",k.total.toLocaleString()]})]},M))}):p.jsx("p",{className:"text-sm text-gray-500",children:"No customer data"})]}),p.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Payment Status"}),p.jsxs("div",{className:"mt-4",children:[p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:p.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${Math.round(e.paymentRatio*100)}%`}})}),p.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-600",children:[p.jsxs("span",{children:[Math.round(e.paymentRatio*100),"% Paid"]}),p.jsxs("span",{children:[Math.round((1-e.paymentRatio)*100),"% Pending"]})]})]}),p.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-2 text-center",children:[p.jsxs("div",{className:"bg-white p-2 rounded-lg",children:[p.jsx("p",{className:"text-xs text-gray-500",children:"Avg. Time to Pay"}),p.jsxs("p",{className:"font-medium",children:[e.avgDaysToPay," days"]})]}),p.jsxs("div",{className:"bg-white p-2 rounded-lg",children:[p.jsx("p",{className:"text-xs text-gray-500",children:"Repeat Customers"}),p.jsx("p",{className:"font-medium",children:e.repeatCustomers})]})]})]})]})]})]}),a&&p.jsx(FI,{isOpen:c,onClose:()=>u(!1),onSubmit:I,invoiceAmount:a.amount,invoiceId:a.invoiceNumber,customerName:a.customerName,isSubmitting:h})]})}function uAe(t){if(!t)return new Date;try{const e=typeof t=="string"?new Date(t):t;return isNaN(e.getTime())?new Date:e}catch(e){return console.error("Error converting to date:",e),new Date}}const o9=[{sourceIndex:0,targetField:"invoiceDate",label:"Date"},{sourceIndex:1,targetField:"email",label:"Email Address"},{sourceIndex:2,targetField:"name",label:"Name"},{sourceIndex:3,targetField:"idType",label:"ID Type"},{sourceIndex:4,targetField:"idNumber",label:"ID Number"},{sourceIndex:5,targetField:"state",label:"State"},{sourceIndex:6,targetField:"pincode",label:"Pincode"},{sourceIndex:7,targetField:"phone",label:"Phone"},{sourceIndex:8,targetField:"amount",label:"Amount"},{sourceIndex:9,targetField:"cardPayment",label:"Card Payment"},{sourceIndex:14,targetField:"pattern",label:"Pattern"},{sourceIndex:16,targetField:"invoiceNumber",label:"Invoice Number"},{sourceIndex:12,targetField:"paymentDate",label:"Payment Date"},{sourceIndex:18,targetField:"gstRemoved",label:"GST Removed"},{sourceIndex:20,targetField:"ewayBill",label:"E-way Bill"}],Mn=[];for(let t=0;t<256;++t)Mn.push((t+256).toString(16).slice(1));function hAe(t,e=0){return(Mn[t[e+0]]+Mn[t[e+1]]+Mn[t[e+2]]+Mn[t[e+3]]+"-"+Mn[t[e+4]]+Mn[t[e+5]]+"-"+Mn[t[e+6]]+Mn[t[e+7]]+"-"+Mn[t[e+8]]+Mn[t[e+9]]+"-"+Mn[t[e+10]]+Mn[t[e+11]]+Mn[t[e+12]]+Mn[t[e+13]]+Mn[t[e+14]]+Mn[t[e+15]]).toLowerCase()}let PE;const dAe=new Uint8Array(16);function fAe(){if(!PE){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");PE=crypto.getRandomValues.bind(crypto)}return PE(dAe)}const gAe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),q4={randomUUID:gAe};function J4(t,e,r){var i;if(q4.randomUUID&&!t)return q4.randomUUID();t=t||{};const n=t.random??((i=t.rng)==null?void 0:i.call(t))??fAe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,hAe(n)}const mAe=async t=>{var e,r,n,i,s,o,a,l;try{console.log("[GSTIN API] Fetching GSTIN data from server-side API");const c=localStorage.getItem("gstin_api_url")||"https://cleartax.in/f/compliance-report/";console.log(`[GSTIN API] Using API URL: ${c}`);let u;if(c.includes("cleartax.in/f/compliance-report"))u=c.endsWith("/")?`${c}${t}`:`${c}/${t}`;else{const m=c.includes("?")?"&":"?";u=`${c}${m}gstin=${t}`}console.log(`[GSTIN API] Fetching from: ${u}`);const h=`${u}&_nocache=${Date.now()}`,d=await fetch(h,{headers:{Accept:"application/json, text/plain, */*","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!d.ok)throw console.error(`[GSTIN API] API error: ${d.status}`),new Error(`API returned status ${d.status}`);const f=await d.json();if(console.log("[GSTIN API] Response:",f),f.taxpayerInfo){const m=f.taxpayerInfo.lgnm||null,g=f.taxpayerInfo.tradeNam||null,v=((r=(e=f.taxpayerInfo.pradr)==null?void 0:e.addr)==null?void 0:r.stcd)||null,w=((i=(n=f.taxpayerInfo.pradr)==null?void 0:n.addr)==null?void 0:i.pncd)||null,b=((o=(s=f.taxpayerInfo.pradr)==null?void 0:s.addr)==null?void 0:o.loc)||null,x=((l=(a=f.taxpayerInfo.pradr)==null?void 0:a.addr)==null?void 0:l.st)||null;let C=[];x&&C.push(x),b&&C.push(b),v&&C.push(v),w&&C.push(w);const S=C.length>0?C.join(", "):null,E=f.taxpayerInfo.sts||"Unknown";return{legalName:m,tradeName:g,address:S,gstinStatus:E}}return{legalName:f.legalName||f.legal_name||f.legal_business_name||f.name||null,tradeName:f.tradeName||f.trade_name||null,address:f.address||f.principal_place_of_business||null,gstinStatus:f.gstinStatus||f.status||f.gstin_status||"Unknown"}}catch(c){throw console.error("[GSTIN API] Error:",c),c}},vS={"Andhra Pradesh":"37","Arunachal Pradesh":"12",Assam:"18",Bihar:"10",Chhattisgarh:"22",Goa:"30",Gujarat:"24",Haryana:"06","Himachal Pradesh":"02",Jharkhand:"20",Karnataka:"29",Delhi:"07",Kerala:"32","Madhya Pradesh":"23",Maharashtra:"27",Manipur:"14",Meghalaya:"17",Mizoram:"15",Nagaland:"13",Odisha:"21",Punjab:"03",Rajasthan:"08",Sikkim:"11","Tamil Nadu":"33",Telangana:"36",Tripura:"16","Uttar Pradesh":"09",Uttarakhand:"05","West Bengal":"19"},DE=38e3,Z4=47572,a9=96999,pAe=1.0506,vAe=1.03,l9="split_bill_";function yAe(t,e,r){if(r||e==="Delhi"&&t>a9)return[t];const n=[];if(t<=DE)return[t];for(;t>0;){let i;t<=Z4?i=t:i=Math.floor(Math.random()*(Z4-DE+1))+DE,i>t&&(i=t),n.push(i),t-=i}return n}function wAe(t){try{const e=localStorage.getItem(`${l9}${t}`);return e?JSON.parse(e):null}catch{return null}}function xAe(t,e){localStorage.setItem(`${l9}${t}`,JSON.stringify(e))}function ww(t){const e=[2e3,1500,1e3,500,450,400,350,300,250,240,200,150,100,50,40,30,25,15];let r=Math.round(t);const n={pattern:[],breakdown:{}},i=[...e].sort(()=>Math.random()-.5);for(const s of i){const o=Math.floor(r/s);if(o>0){const a=Math.max(1,Math.floor(o*.3)),l=Math.floor(Math.random()*(o-a+1))+a;if(l>0&&(n.pattern.push(`${l} x ${s}`),n.breakdown[`qty${s}`]=l,n.breakdown[`rate${s}`]=s,r-=l*s),n.pattern.length>=3)break}}if(r>0){const s=e.filter(l=>l<=r).sort((l,c)=>c-l)[0]||r,o=Math.floor(r/s),a=r-o*s;o>0&&(n.pattern.push(`${o} x ${s}`),n.breakdown[`qty${s}`]=o,n.breakdown[`rate${s}`]=s),a>0&&(n.pattern.push(`1 x ${a}`),n.breakdown.qtyRest=1,n.breakdown.rateRest=a)}return n}function bAe(t,e,r){let n=t;return r&&(n=Math.round(n/pAe)),e||(n=Math.round(n/vAe)),n}const gO=(t,e)=>{var h,d,f;const r=[];if(!e)return r;const n=((h=e[18])==null?void 0:h.toLowerCase())==="yes",i=((d=e[9])==null?void 0:d.toLowerCase())==="yes",s=e[5]||"",o=((f=e[20])==null?void 0:f.toLowerCase())==="yes",a=e[8]!=null?String(e[8]).replace(/,/g,""):"0";let l=(t||e[13]||"").trim(),c=parseFloat(a.replace(/[^0-9.]/g,""));if(isNaN(c)||!isFinite(c))return console.warn("Invalid total amount:",a),r;if(c<=0)return console.warn("Total amount must be greater than 0"),r;if(!l||l===""){c=bAe(c,n,i);const{pattern:m}=ww(c);l=m.join(" + ")}const u=l.match(/(\d+)\/(\d+)/);if(u){const m=parseInt(u[1]),g=parseInt(u[2]);if(isNaN(m)||isNaN(g)||m<=0||g<=0)return console.warn("Invalid split pattern:",l),r;let v=wAe(e[16])||{totalAmount:m,totalSplits:g,remainingSplits:g,currentSplitNumber:0,pattern:l};const w=Math.ceil(m/g);return v.currentSplitNumber++,v.remainingSplits--,xAe(e[16],v),r.push({name:`Imitation Jewellery (Split ${v.currentSplitNumber}/${v.totalSplits})`,rate:w,quantity:1,amount:w,gstRate:3,taxAmount:parseFloat((w*.03).toFixed(2)),total:parseFloat((w*1.03).toFixed(2)),hsn:"7117"}),r}if(l.includes("x")||l.includes("")||l.includes("+"))return l.split("+").map(g=>g.trim()).forEach(g=>{const v=g.match(/^(\d+)\s*[x]\s*(\d+)$/);if(v&&v[1]&&v[2]){const w=parseInt(v[1],10),b=parseInt(v[2]);if(isNaN(w)||isNaN(b)||w<=0||b<=0){console.warn("Invalid pattern part:",g);return}const x=b*w,C=3,S=x*(C/100),E=x*(1+C/100);r.push({name:"Imitation Jewellery",hsn:"7117",quantity:w,rate:b,amount:x,gstRate:C,taxAmount:parseFloat(S.toFixed(2)),total:parseFloat(E.toFixed(2))})}else if(/^\d+$/.test(g.trim())){const w=parseInt(g.trim(),10);isNaN(w)||r.push({name:"Imitation Jewellery",rate:w,quantity:1,amount:w,gstRate:3,taxAmount:parseFloat((w*.03).toFixed(2)),total:parseFloat((w*1.03).toFixed(2)),hsn:"7117"})}}),r;if(c>47572&&!o&&!(s==="Delhi"&&c>a9))yAe(c,s,o).forEach(g=>{const{pattern:v}=ww(g);v.forEach(w=>{const b=w.match(/^(\d+)\s*[x]\s*(\d+)$/);if(b&&b[1]&&b[2]){const x=parseInt(b[1]),C=parseInt(b[2]);if(isNaN(x)||isNaN(C)||x<=0||C<=0){console.warn("Invalid pattern part:",w);return}const S=C*x,E=3,T=S*(E/100),I=S*(1+E/100);r.push({name:"Imitation Jewellery",hsn:"7117",quantity:x,rate:C,amount:S,gstRate:E,taxAmount:parseFloat(T.toFixed(2)),total:parseFloat(I.toFixed(2))})}})});else{const{pattern:m}=ww(c);m.forEach(g=>{const v=g.match(/(\d+)\s*[x]\s*(\d+)/);if(v&&v[1]&&v[2]){const w=parseInt(v[1]),b=parseInt(v[2]),x=b*w,C=3,S=x*(C/100),E=x*(1+C/100);r.push({name:"Imitation Jewellery",hsn:"7117",quantity:w,rate:b,amount:x,gstRate:C,taxAmount:parseFloat(S.toFixed(2)),total:parseFloat(E.toFixed(2))})}})}return r},Q4=t=>{const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},ej=t=>{if(!t)return new Date;if(typeof t=="string"&&t.includes("-")){const[e,r,n]=t.split("-").map(Number);if(!isNaN(e)&&!isNaN(r)&&!isNaN(n)){const i=new Date(e,r-1,n);if(!isNaN(i.getTime()))return i}}if(typeof t=="string"){const[e,r]=t.split(" ");if(e){const[n,i,s]=e.split("/").map(Number);if(!isNaN(n)&&!isNaN(i)&&!isNaN(s))try{const o=new Date(s,i-1,n);if(r){const[a,l,c]=r.split(":").map(Number);!isNaN(a)&&!isNaN(l)&&!isNaN(c)&&o.setHours(a,l,c)}else o.setHours(12,0,0,0);if(!isNaN(o.getTime()))return o}catch(o){console.warn("Error parsing date:",t,o)}}}return new Date},LE=t=>isNaN(t.getTime())?Q4(new Date):Q4(t),SAe=(t,e)=>{const r=(t==null?void 0:t.trim().toLowerCase())||"",n=(e==null?void 0:e.trim())||"";if(!r||!n)return{gstin:"",panNumber:"",customFields:[],phoneShowInInvoice:!0};switch(r){case"gstin":return{gstin:n,panNumber:n.slice(2,12),customFields:[],phoneShowInInvoice:!0};case"pan card":case"pan":return{panNumber:n,gstin:"",customFields:[],phoneShowInInvoice:!0};case"aadhar card":case"aadhar":return{gstin:"",panNumber:"",customFields:[{dataType:"TEXT",hideFlagEmoji:!0,isArchived:!1,isDefault:!0,isHidden:!1,isRequired:!1,key:"slws155mu3m",label:"Aadhar",value:n,params:{showInInvoice:!0}}]};case"passport":return{gstin:"",panNumber:"",customFields:[{dataType:"TEXT",hideFlagEmoji:!0,isArchived:!1,isDefault:!0,isHidden:!1,isRequired:!1,key:"slws155mu3m",label:"Passport",value:n,params:{showInInvoice:!0}}]};default:return{gstin:"",panNumber:"",customFields:[],phoneShowInInvoice:!0}}},CAe=async(t,e)=>{var r,n,i;try{const s=Array.isArray(t)?t:typeof t=="string"?t.split(/\t/).map(k=>k.trim()):[];if(!s.some(k=>k!==""))return console.log("[BillUtils] Empty row detected, returning empty bill"),{};const o=s[11]||"";let a="",l=!1;if(o&&o.trim()){console.log("Raw payment date from column 11:",o);try{const k=ej(o);isNaN(k.getTime())||(a=LE(k),l=!0,console.log(`Parsed payment date to: ${a}`))}catch(k){console.error("Error parsing payment date:",k)}}const c=k=>{var M;return e!=null&&e.enabled,s[((M=o9.find(D=>D.targetField===k))==null?void 0:M.sourceIndex)||0]||""},u=((r=s[7])==null?void 0:r.replace(/[^0-9]/g,""))||"",h=s[13]||"",d=gO(h,s),f=new Date,m=((n=s[15])==null?void 0:n.trim())||"",g=s[16]||"",v=c("email")||s[1]||"",w=c("name")||s[2]||"",b=s[0]||"";let x=b?ej(b):f;const C=LE(x),S=c("idType")||s[3]||"",E=c("idNumber")||s[4]||"",T=SAe(S,E);let I={invoiceTitle:"VM Jewellers",invoiceSubTitle:"Tax Invoice",invoiceNumber:m,invoiceId:g,invoiceLink:s[14]||"",invoiceDate:C,paymentDate:a,isPaid:l,dueDate:LE(new Date(x.getTime()+7*24*60*60*1e3)),invoiceType:"INVOICE",currency:"INR",billedTo:{name:w,pincode:c("pincode")||s[6]||"",gstState:vS[c("state")||s[5]||""]||"32",country:"IN",...T,phone:u?`+91${u}`:"",phoneShowInInvoice:!0,customFields:T.customFields||[]},billedBy:{name:"V.M Jewellers",street:"5121/A, Ground Floor, Near Hanuman Mandir, Rui Mandi, Sadar Bazar,, Delhi,",pincode:"110006",gstState:"07",state:"Delhi",country:"IN",panNumber:"NDBPS0625E",gstin:"07NDBPS0625E2ZJ",phone:"+918587891402",email:"vmjeweller750@gmail.com",phoneShowInInvoice:!0,customFields:[]},items:d||[],email:{to:{name:w,email:v||""},cc:[{name:"VM",email:"vm@gmail.com"},{name:"CC Recipient 2",email:"cc2@example.com"}]}};return a&&console.log(`Final bill for ${(i=I.billedTo)==null?void 0:i.name} with payment date: ${a}, isPaid: ${l}`),I}catch(s){return console.error("[BillUtils] Error in parseExcelRow:",s),{}}},EAe=t=>{const e=t.reduce((n,i)=>n+i.rate*i.quantity,0),r=t.reduce((n,i)=>n+i.rate*i.quantity*(i.gstRate/100),0);return{subtotal:e,tax:r,total:e+r}},FE=t=>{if(!t)return"";try{const e=/\/invoices\/([a-zA-Z0-9]+)/,r=t.match(e);if(r&&r[1])return r[1];const i=new URL(t).pathname.split("/"),s=i[i.length-1];if(s&&/^[a-zA-Z0-9]+$/.test(s)&&s.length>5)return s;console.warn("Could not extract invoice ID from URL:",t)}catch(e){console.error("Error extracting invoice ID from URL:",e)}return""},Rd=async t=>{var r,n,i;if(!((r=t.billedTo)!=null&&r.gstin))return console.log("[BillUtils] No GSTIN found in bill, skipping verification"),{...t};if(localStorage.getItem("gstin_verification_enabled")==="false")return console.log("[BillUtils] GSTIN verification is disabled in settings, skipping"),{...t};try{console.log(`[BillUtils] Starting GSTIN verification for: ${t.billedTo.gstin}`),console.log(`[BillUtils] Current bill name: ${t.billedTo.name}`);const s=await mO(t.billedTo.gstin);console.log("[BillUtils] Verification result:",s);const o=JSON.parse(JSON.stringify(t));if(s.status==="success"&&s.legalName){console.log(`[BillUtils] GSTIN verified successfully. Legal Name: ${s.legalName}, Trade Name: ${s.tradeName}`),o.billedTo||(o.billedTo={});const a=((n=t.billedTo)==null?void 0:n.name)||"";if(a&&!a.includes("")){o.billedTo.customFields||(o.billedTo.customFields=[]);const u=o.billedTo.customFields.findIndex(h=>h.label==="Original Name");u>=0?o.billedTo.customFields[u].value=a:o.billedTo.customFields.push({dataType:"TEXT",hideFlagEmoji:!0,isArchived:!1,isDefault:!0,isHidden:!1,isRequired:!1,key:J4(),label:"Original Name",value:a,params:{showInInvoice:!1}}),console.log(`[BillUtils] Stored original name: ${a}`)}let l=s.legalName;s.tradeName&&(s.tradeName!==s.legalName?l=`${s.tradeName} (${s.legalName})`:l=s.tradeName,console.log(`[BillUtils] Using combined name: ${l}`));const c=`${l} `;return console.log(`[BillUtils] Setting final verified name: ${c}`),o.billedTo.name=c,o.billedTo.customFields.some(u=>u.label==="GSTIN Status")||o.billedTo.customFields.push({dataType:"TEXT",hideFlagEmoji:!0,isArchived:!1,isDefault:!0,isHidden:!1,isRequired:!1,key:J4(),label:"GSTIN Status",value:s.gstinStatus||"Unknown",params:{showInInvoice:!1}}),window.dispatchEvent(new CustomEvent("bill_gstin_verified",{detail:{gstin:t.billedTo.gstin,billId:t.invoiceId||t.invoiceNumber,success:!0,result:s}})),{...o,status:"success",message:"GSTIN verified successfully",legalName:s.legalName,tradeName:s.tradeName,gstinStatus:s.gstinStatus}}else return console.warn(`[BillUtils] GSTIN verification failed: ${s.message}`),window.dispatchEvent(new CustomEvent("bill_gstin_verified",{detail:{gstin:t.billedTo.gstin,billId:t.invoiceId||t.invoiceNumber,success:!1,error:s.message}})),{...t,status:"error",message:s.message||"Verification failed"}}catch(s){return console.error("[BillUtils] Error during GSTIN verification:",s),window.dispatchEvent(new CustomEvent("bill_gstin_verified",{detail:{gstin:(i=t.billedTo)==null?void 0:i.gstin,billId:t.invoiceId||t.invoiceNumber,success:!1,error:s.message}})),{...t,status:"error",message:`Error during verification: ${s.message}`}}},Qv=new Set,ey={},mO=async t=>{if(t=t.toUpperCase(),Qv.has(t)){console.log(`[GSTIN API] GSTIN ${t} already verified in this session, skipping verification`);const r=rj(t);if(r&&r.legalName)return{...r,status:"success",message:"GSTIN verified successfully (from session cache)"}}if(localStorage.getItem("gstin_verification_enabled")==="false")return console.log("[GSTIN API] Verification is disabled in settings"),{legalName:null,address:null,tradeName:null,gstinStatus:null,status:"error",message:"GSTIN verification is disabled in settings"};try{if(console.log(`[GSTIN API] Verification called with GSTIN: ${t}`),!t||!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i.test(t))return console.log("[GSTIN API] Format validation failed"),{legalName:null,address:null,tradeName:null,gstinStatus:null,status:"error",message:"Invalid GSTIN format"};if(ey[t])return console.log(`[GSTIN API] Verification already in progress for ${t}, reusing existing request`),ey[t]||{legalName:null,address:null,tradeName:null,gstinStatus:null,status:"error",message:"Verification failed due to internal error"};const r=rj(t);if(r&&r.legalName)return console.log("[GSTIN API] Using cached verification data"),Qv.add(t),window.dispatchEvent(new CustomEvent("gstin_verification_completed",{detail:{gstin:t,source:"cache",data:r}})),{...r,status:"success",message:"GSTIN verified successfully (from cache)"};const n=(async()=>{var i,s,o,a,l,c,u,h;try{const d=JSON.parse(localStorage.getItem("gstin_pending_requests")||"{}"),f=Date.now();if(d[t]&&f-d[t]<5e3){const g=5e3-(f-d[t]);console.log(`[GSTIN API] Waiting ${g}ms before making request for GSTIN: ${t}`),await new Promise(v=>setTimeout(v,g))}d[t]=f,localStorage.setItem("gstin_pending_requests",JSON.stringify(d));const m=TAe(t);if(m)return console.log("[GSTIN API] Using hardcoded test data for GSTIN:",t),tj(t,{...m,timestamp:Date.now()}),Qv.add(t),window.dispatchEvent(new CustomEvent("gstin_verification_completed",{detail:{gstin:t,source:"hardcoded",data:m}})),{...m,status:"success",message:"GSTIN verified successfully (from hardcoded data)"};try{const g=localStorage.getItem("gstin_api_url")||"";console.log("[GSTIN API] Trying server-side API endpoint:",g);let v;try{v=await mAe(t)}catch(w){console.log("[GSTIN API] Direct fetch failed, trying CORS proxies:",w);let b=localStorage.getItem("gstin_api_url")||"https://cleartax.in/f/compliance-report/",x;if(b.includes("cleartax.in/f/compliance-report"))x=b.endsWith("/")?`${b}${t}`:`${b}/${t}`;else{const E=b.includes("?")?"&":"?";x=`${b}${E}gstin=${t}`}const S=await(await _Ae(x,{Accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},1e4)).json();if(console.log("[GSTIN API] CORS proxy successful, data:",S),S.taxpayerInfo){const E=S.taxpayerInfo.lgnm||null,T=S.taxpayerInfo.tradeNam||null,I=((s=(i=S.taxpayerInfo.pradr)==null?void 0:i.addr)==null?void 0:s.stcd)||null,k=((a=(o=S.taxpayerInfo.pradr)==null?void 0:o.addr)==null?void 0:a.pncd)||null,M=((c=(l=S.taxpayerInfo.pradr)==null?void 0:l.addr)==null?void 0:c.loc)||null,D=((h=(u=S.taxpayerInfo.pradr)==null?void 0:u.addr)==null?void 0:h.st)||null;let L=[];D&&L.push(D),M&&L.push(M),I&&L.push(I),k&&L.push(k);const U=L.length>0?L.join(", "):null,J=S.taxpayerInfo.sts||"Unknown";v={legalName:E,tradeName:T,address:U,gstinStatus:J}}else v={legalName:S.legalName||S.legal_name||S.legal_business_name||S.name||null,tradeName:S.tradeName||S.trade_name||null,address:S.address||S.principal_place_of_business||null,gstinStatus:S.gstinStatus||S.status||S.gstin_status||"Unknown"}}if(v&&v.legalName)return console.log("[GSTIN API] Successfully fetched data from server API:",v),tj(t,{legalName:v.legalName,tradeName:v.tradeName||null,address:v.address||null,gstinStatus:v.gstinStatus||"Active",timestamp:Date.now()}),Qv.add(t),window.dispatchEvent(new CustomEvent("gstin_verification_completed",{detail:{gstin:t,source:"api",data:v}})),{legalName:v.legalName,tradeName:v.tradeName||null,address:v.address||null,gstinStatus:v.gstinStatus||"Active",status:"success",message:"GSTIN verified successfully (via server API)"};throw new Error("GSTIN API returned no data for this GSTIN")}catch(g){return console.error("[GSTIN API] Server API failed:",g),{legalName:null,address:null,tradeName:null,gstinStatus:null,status:"error",message:`API verification failed: ${g.message}. GSTIN verification requires direct access to cleartax.in - please check your network configuration.`}}}finally{delete ey[t]}})();return ey[t]=n,n}catch(r){return console.error("[GSTIN API] Verification error:",r),{legalName:null,address:null,tradeName:null,gstinStatus:null,status:"error",message:r.message||"GSTIN verification failed"}}};function TAe(t){return{"29BLOPP5558G1ZD":{legalName:"PADU SOORYA ANWAR ALI",tradeName:"SHE FASHION STORE",address:"G.T Road, Bangalore, Karnataka, 560001",gstinStatus:"Active"},"07NDBPS0625E2ZJ":{legalName:"V.M Jewellers",tradeName:null,address:"Shop No. 45, Main Market, Delhi, 110001",gstinStatus:"Active"},"03AOSPK2578K1ZG":{legalName:"PANKAJ KUMAR",tradeName:"LAXMI JEWELLERS",address:"G.T Road Dhariwal, Dhariwal, Punjab, 143519",gstinStatus:"Active"}}[t]||null}const c9=async(t,e)=>{var s,o;const r=Array.isArray(t)?t:t.split(/\t/).map(a=>a.trim());if(!r.some(a=>a!==""))return[];const n=await CAe(r,e);if(!((s=n.billedTo)!=null&&s.name)||!((o=n.billedTo)!=null&&o.phone))return[n];const i=[n];if(r[24]&&r[24].trim()!=="")try{const a={...JSON.parse(JSON.stringify(n)),items:[]},l=parseFloat(r[24].replace(/[^0-9.]/g,"")),c=r[25]||"";!isNaN(l)&&l>0&&(a.items=gO(c,[...r.slice(0,8),r[24],...r.slice(9,13),r[25],"","","",...r.slice(17)]),a.invoiceNumber=`${n.invoiceNumber||""}-2`,i.push(a))}catch(a){console.error("Error creating second bill:",a)}if(r[31]&&r[31].trim()!=="")try{const a={...JSON.parse(JSON.stringify(n)),items:[]},l=parseFloat(r[31].replace(/[^0-9.]/g,"")),c=r[32]||"";!isNaN(l)&&l>0&&(a.items=gO(c,[...r.slice(0,8),r[31],...r.slice(9,13),r[32],"","","",...r.slice(17)]),a.invoiceNumber=`${n.invoiceNumber||""}-3`,i.push(a))}catch(a){console.error("Error creating third bill:",a)}return i},tj=(t,e)=>{try{const r=localStorage.getItem("gstin_verification_cache")||"{}",n=JSON.parse(r);n[t]={...e,timestamp:Date.now()},localStorage.setItem("gstin_verification_cache",JSON.stringify(n)),console.log(`[GSTIN API] Cached data for GSTIN: ${t}`),window.dispatchEvent(new CustomEvent("gstin_cache_updated",{detail:{gstin:t,cacheUpdated:!0,newEntry:e}}))}catch(r){console.error("[GSTIN API] Error saving to cache:",r)}},rj=(t,e=30*24*60*60*1e3)=>{try{const r=localStorage.getItem("gstin_verification_cache");if(!r)return null;const i=JSON.parse(r)[t];if(i&&i.timestamp){const s=Date.now()-i.timestamp;if(s<=e)return console.log(`[GSTIN API] Using cached data for GSTIN: ${t}, age: ${Math.round(s/864e5)} days`),{legalName:i.legalName,tradeName:i.tradeName,address:i.address,gstinStatus:i.gstinStatus};console.log(`[GSTIN API] Cached data expired for GSTIN: ${t}, age: ${Math.round(s/864e5)} days`)}return null}catch(r){return console.error("[GSTIN API] Error reading from cache:",r),null}},_Ae=async(t,e,r)=>{const n=[s=>`https://corsproxy.io/?${encodeURIComponent(s)}`,s=>`https://api.allorigins.win/raw?url=${encodeURIComponent(s)}`,s=>`https://cors-proxy.taskcluster.net/${s}`,s=>`https://proxy.cors.sh/${s}`,s=>`https://thingproxy.freeboard.io/fetch/${s}`,s=>{const o=localStorage.getItem("ngrok_tunnel_url");return o?`${o}/proxy?url=${encodeURIComponent(s)}`:s}];let i=null;for(const s of n){const o=s(t);console.log(`[GSTIN API] Trying CORS proxy: ${o}`);try{const a=new AbortController,l=setTimeout(()=>a.abort(),r),c=await fetch(o,{method:"GET",headers:{...e,"X-Requested-With":"XMLHttpRequest",Origin:window.location.origin},signal:a.signal,cache:"no-store"});if(clearTimeout(l),c.ok)return console.log(`[GSTIN API] Successfully used proxy: ${o}`),c;console.log(`[GSTIN API] Proxy ${o} returned status ${c.status}`)}catch(a){console.error(`[GSTIN API] Proxy ${o} failed:`,a),i=a}}throw i||new Error("All CORS proxies failed")},u9="bill_generator_token",$I=t=>{const e=t.trim().replace(/^Bearer\s+/i,"");return e?`Bearer ${e}`:""},Ad=t=>t.trim().replace(/^Bearer\s+/i,""),nj=t=>{const e=Ad(t),r=$I(e);localStorage.setItem(u9,r)},Cu=()=>{const t=localStorage.getItem(u9);if(!t||!t.trim())return null;const e=Ad(t);return $I(e)},Eu=t=>!t||!t.trim()?!1:Ad(t).length>0;function RAe({isOpen:t,onClose:e,requestData:r,responseData:n}){if(!t)return null;const i=o=>o>=200&&o<300?"text-green-600":o>=400&&o<500?"text-red-600":"text-yellow-600",s=o=>o>=200&&o<300?p.jsx(C2,{className:"w-5 h-5 text-green-600"}):o>=400&&o<500?p.jsx(R2,{className:"w-5 h-5 text-red-600"}):p.jsx(zd,{className:"w-5 h-5 text-yellow-600"});return p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl mx-4 shadow-xl",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(S2,{className:"w-5 h-5 text-blue-600"}),p.jsx("h3",{className:"font-medium text-gray-900",children:"API Debug Information"})]}),p.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:p.jsx(D0,{className:"w-5 h-5 text-gray-500"})})]}),p.jsxs("div",{className:"p-6 space-y-6 max-h-[80vh] overflow-y-auto",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Request"}),p.jsxs("div",{className:"space-y-2 text-sm",children:[p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[p.jsx("span",{className:"font-mono text-blue-600",children:r.method}),p.jsx("span",{className:"ml-2 font-mono text-gray-600",children:r.url})]}),p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[p.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Headers"}),p.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:JSON.stringify(r.headers,null,2)})]}),p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[p.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Body"}),p.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:JSON.stringify(r.body,null,2)})]})]})]}),n&&p.jsxs("div",{children:[p.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Response"}),p.jsxs("div",{className:"space-y-2 text-sm",children:[p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg flex items-center gap-2",children:[s(n.status),p.jsxs("span",{className:`font-mono ${i(n.status)}`,children:[n.status," ",n.statusText]})]}),n.error?p.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[p.jsx("h5",{className:"font-medium text-red-700 mb-2",children:"Error"}),p.jsx("p",{className:"text-red-600",children:n.error})]}):p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[p.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Data"}),p.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:JSON.stringify(n.data,null,2)})]})]})]})]}),p.jsx("div",{className:"border-t p-4 flex justify-end",children:p.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})})]})})}const AAe=[{data:"0",title:"Timestamp",type:"text",width:150},{data:"1",title:"Email address",type:"text",validator:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,width:200},{data:"2",title:"Name",type:"text",required:!0,width:150},{data:"3",title:"ID Proof",type:"dropdown",source:["GSTIN","PAN Card","Aadhar Card"]},{data:"4",title:"ID Proof Details",type:"text"},{data:"5",title:"State",type:"dropdown",source:Object.keys(vS)},{data:"6",title:"State Pin Code",type:"text",validator:/^\d{6}$/},{data:"7",title:"Phone Number",type:"text",validator:/^\d{10}$/,required:!0,width:120},{data:"8",title:"Total Amount Paid",type:"numeric",required:!0,width:100,numericFormat:{pattern:"0,0.00",culture:"en-IN"}},{data:"9",title:"Paid Via Card",type:"checkbox"},{data:"10",title:"Other",type:"text"},{data:"11",title:"Payment Paid On",type:"text"},{data:"12",title:"BILL SENT",type:"checkbox"},{data:"13",title:"Pattern",type:"text"},{data:"14",title:"Invoice link",type:"text",readOnly:!0},{data:"15",title:"Invoice Number",type:"text",readOnly:!0},{data:"16",title:"Invoice ID",type:"text",readOnly:!0},{data:"17",title:"Is paid",type:"checkbox"},{data:"18",title:"Is gst removed",type:"checkbox"},{data:"19",title:"Payment Screenshot",type:"text"},{data:"20",title:"EWAY BILL",type:"checkbox"}];function OAe({config:t,onConfigChange:e,onSave:r}){const n=(o,a)=>{const l=[...t.mappings];l[o]={...l[o],sourceIndex:parseInt(a)},e({...t,mappings:l})},i=()=>{e({...t,enabled:!t.enabled})},s=AAe.map((o,a)=>({index:a,label:o.title}));return t.enabled?p.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-4",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(GL,{className:"w-5 h-5 text-gray-600"}),p.jsx("h3",{className:"font-medium",children:"Column Mapping"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:i,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),p.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[p.jsx(P0,{className:"w-4 h-4"}),"Save Mapping"]})]})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.mappings.map((o,a)=>p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o.label}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs("select",{className:"flex-1 px-3 py-2 border rounded-lg text-sm",value:o.sourceIndex,onChange:l=>n(a,l.target.value),children:[p.jsx("option",{value:"",children:"Select Column"}),s.map(l=>p.jsx("option",{value:l.index,children:l.label},l.index))]})})]},a))})]}):p.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border mb-4",children:p.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[p.jsx(GL,{className:"w-4 h-4"}),"Configure Column Mapping"]})})}function $E({bill:t,isAuthenticated:e,onPaymentMarked:r}){var ae,ye,H,Re,ue,Pe,ke,be,Fe,He,V,K,te,ve,le,ce,me,de,fe,ge,pe,Ie,je,Be,Je,it,Rt,ot,Et,rr,ds,Vn,Co,en,Wt,Cr,jr;const n=EAe(t.items||[]),[i,s]=G.useState(!1),[o,a]=G.useState(null),[l,c]=G.useState(!1),[u,h]=G.useState([]),[d,f]=G.useState(""),[m,g]=G.useState(1),[v,w]=G.useState(!1),[b,x]=G.useState(""),[C,S]=G.useState(!1),[E,T]=G.useState(!1),[I,k]=G.useState(null),[M,D]=G.useState(()=>{const Ve=localStorage.getItem("column_mapping");return Ve?JSON.parse(Ve):{enabled:!1,mappings:o9}}),[L,U]=G.useState(!1),[J,X]=G.useState(!1),[ie,se]=G.useState(!1),[P,y]=G.useState(!1),[_,R]=G.useState(null),A=Ve=>{D(Ve)},O=()=>{localStorage.setItem("column_mapping",JSON.stringify(M))},N=async Ve=>{var nr;if(!t.invoiceId){f("Invoice ID not found");return}c(!0),f("");const Ot=Cu();if(!Ot||!Eu(Ot)){f("Please generate a valid authentication token in Settings"),c(!1);return}try{const kr=await fetch(`https://api.refrens.com/businesses/vm-jewellers/invoices/${t.invoiceId}/payments`,{method:"POST",headers:{Authorization:Ot,"Content-Type":"application/json"},body:JSON.stringify(Ve)});if(!kr.ok){const ir=await kr.json();throw new Error(((nr=ir.error)==null?void 0:nr.message)||`Failed to add payment (${kr.status})`)}const fr=await kr.json();if(t.customerId){const ir=`invoices_${t.customerId}`,Oi=JSON.parse(localStorage.getItem(ir)||"[]").map(Kt=>Kt.id===t.invoiceId?{...Kt,isPaid:!0}:Kt);localStorage.setItem(ir,JSON.stringify(Oi))}r&&r(!0),U(!1)}catch(kr){console.error("Error adding payment:",kr),f(kr.message),r&&r(!1)}finally{c(!1)}};oe.useEffect(()=>{var Ve,Ot;if((Ot=(Ve=t.items)==null?void 0:Ve[0])!=null&&Ot.name){const nr=t.items[0].name.match(/Split (\d+)\/(\d+)/);a(nr?{current:parseInt(nr[1]),total:parseInt(nr[2])}:null)}else a(null)},[t.items]),G.useEffect(()=>{var Ot,nr;if(!((Ot=t.billedTo)!=null&&Ot.gstin)){y(!1),se(!1),R(null);return}if((nr=t.billedTo.name)!=null&&nr.includes("")){se(!0);return}(async()=>{var fr,ir;if(localStorage.getItem("gstin_verification_enabled")==="false"){console.log("[BillPreview] GSTIN verification is disabled in settings, skipping"),y(!1);return}try{if(y(!0),console.log("[BillPreview] Verifying GSTIN:",(fr=t.billedTo)==null?void 0:fr.gstin),(ir=t.billedTo)!=null&&ir.gstin){const Er=await Rd(t);console.log("[BillPreview] Verification result:",JSON.stringify(Er)),Er.status==="success"?(se(!0),R(Er.gstinStatus||"Unknown"),console.log("[BillPreview] GSTIN verified successfully"),Er.billedTo&&Er.billedTo.name&&(t.billedTo=Er.billedTo,se(!1),setTimeout(()=>se(!0),10))):(console.warn("[BillPreview] GSTIN verification failed:",Er.message),se(!1),R(null))}}catch(Er){console.error("[BillPreview] Error verifying GSTIN:",Er),se(!1),R(null)}finally{y(!1)}})()},[(ae=t.billedTo)==null?void 0:ae.gstin]);const F=async Ve=>{var Y,q,re,ne,Ce,Ae,Se,Ee,_e,Te,ee,xe,we,Ne;const Ot=Cu();if(!Ot||!Eu(Ot))throw new Error("Please generate a valid authentication token in Settings");const nr="https://api.refrens.com/businesses/vm-jewellers/invoices",kr={Authorization:Ot,"Content-Type":"application/json"};if(!((Y=t.billedTo)!=null&&Y.name)||!((q=t.billedTo)!=null&&q.phone))throw new Error("Customer name and phone number are required. Please ensure these fields are filled in.");const ir=[{field:(re=t.billedTo)==null?void 0:re.name,name:"Customer Name"},{field:(ne=t.billedTo)==null?void 0:ne.phone,name:"Phone Number"},{field:(Ce=t.billedTo)==null?void 0:Ce.gstState,name:"GST State"},{field:(Ae=t.billedTo)==null?void 0:Ae.pincode,name:"Pincode"}].filter(({field:We})=>!We).map(({name:We})=>We);if(ir.length>0)throw new Error(`Required fields missing: ${ir.join(", ")}`);if(!t.items||t.items.length===0)throw new Error("No items found. Please set a valid amount or pattern");const Oi={invoiceTitle:"VM Jewellers",invoiceSubTitle:"Tax Invoice",invoiceNumber:t.invoiceNumber||`INV${Date.now()}${Math.floor(Math.random()*1e3)}`,contact:{phone:t.billedTo.phone,email:((Se=t.billedTo)==null?void 0:Se.email)||"contact@example.com"},invoiceDate:t.invoiceDate||new Date().toISOString().split("T")[0],dueDate:t.dueDate||new Date(Date.now()+7*24*60*60*1e3).toISOString().split("T")[0],invoiceType:"INVOICE",currency:"INR",billedTo:{name:t.billedTo.name,pincode:t.billedTo.pincode,gstState:t.billedTo.gstState,country:"IN",gstin:((Ee=t.billedTo)==null?void 0:Ee.gstin)||void 0,panNumber:((_e=t.billedTo)==null?void 0:_e.panNumber)||void 0,phone:t.billedTo.phone,phoneShowInInvoice:!0,customFields:((Te=t.billedTo)==null?void 0:Te.customFields)||[]},billedBy:{name:"V.M Jewellers",street:"5121/A, Ground Floor, Near Hanuman Mandir, Rui Mandi, Sadar Bazar,, Delhi,",pincode:"110006",gstState:"07",state:"Delhi",country:"IN",panNumber:"NDBPS0625E",gstin:"07NDBPS0625E2ZJ",phone:"+918587891402",email:"vmjeweller750@gmail.com"},items:((ee=t.items)==null?void 0:ee.map(We=>({name:We.name||"Imitation Jewellery",hsn:We.hsn||"7117",quantity:We.quantity,rate:We.rate,amount:We.rate*We.quantity,gstRate:We.gstRate,taxAmount:We.rate*We.quantity*(We.gstRate/100),total:We.rate*We.quantity*(1+We.gstRate/100)})))||[],email:{to:{name:t.billedTo.name,email:((xe=t.billedTo)==null?void 0:xe.email)||"vs5581764@gmail.com"},cc:[{name:"VM",email:"vm@gmail.com"},{name:"CC Recipient 2",email:"cc2@example.com"}]}},Kt={request:{url:nr,method:"POST",headers:kr,body:Oi},response:null},B=await fetch(nr,{method:"POST",headers:kr,body:JSON.stringify(Oi)});let Z;try{if(Z=await B.json(),Kt.response={status:B.status,statusText:B.statusText,data:Z},!B.ok)throw B.status===401?new Error("Authentication failed. Please generate a new token in Settings."):B.status===400?new Error(((we=Z.error)==null?void 0:we.message)||"Invalid bill data. Please check all required fields."):new Error(((Ne=Z.error)==null?void 0:Ne.message)||`API Error (${B.status}). Please try again.`);if(Z.error)throw new Error(Z.error.message||"Failed to generate bill. Please check your data.")}catch(We){throw We instanceof SyntaxError?new Error("Invalid response from server. Please try again."):(Kt.response={status:B.status,statusText:B.statusText,data:null,error:We.message},We)}finally{k(Kt)}return Z},j=async()=>{s(!0),f(""),h([]);const Ve=Cu();if(!Ve||!Eu(Ve)){f("Please generate a valid authentication token in Settings before generating bills."),s(!1);return}h(Array(m).fill(null).map(()=>{var nr;return{id:"",invoiceNumber:"",link:"",name:((nr=t.billedTo)==null?void 0:nr.name)||"",status:"pending"}}));const Ot=Array(m).fill(null).map((nr,kr)=>F().then(fr=>{h(ir=>{var Oi,Kt,B,Z;const Er=[...ir];if(Er[kr]={id:fr._id,invoiceNumber:fr.invoiceNumber,link:((Oi=fr.share)==null?void 0:Oi.link)||"",name:((Kt=t.billedTo)==null?void 0:Kt.name)||"",status:"success"},t.customerId&&((B=fr.share)!=null&&B.link)){const Y=`invoices_${t.customerId}`,q=JSON.parse(localStorage.getItem(Y)||"[]");q.push({id:fr._id,invoiceNumber:fr.invoiceNumber,link:fr.share.link,date:new Date().toISOString(),customerName:(Z=t.billedTo)==null?void 0:Z.name,amount:n.total,isPaid:!1}),localStorage.setItem(Y,JSON.stringify(q))}return Er})}).catch(fr=>{h(ir=>{const Er=[...ir];return Er[kr]={id:"",invoiceNumber:"",link:"",name:"",status:"error",error:fr.message||"Failed to generate bill"},Er})}));try{await Promise.all(Ot)}catch(nr){console.error("Bill generation error:",nr),f(nr.message||"Failed to generate bills. Please check the console for details."),h(kr=>kr.map(fr=>fr.status==="pending"?{...fr,status:"error",error:"Generation failed"}:fr))}finally{s(!1)}},z=()=>{S(!0);try{let Ve=n.subtotal;const{pattern:Ot,breakdown:nr}=ww(Math.round(Ve)),kr=Ot.map(fr=>{const ir=fr.match(/(\d+)\s*[x]\s*(\d+)/);if(ir){const[Er,Oi,Kt]=ir,B=parseInt(Oi)*parseInt(Kt);return`${Oi}  ${Kt} = ${B}`}return fr}).join(" + ");x(kr),w(!0)}catch(Ve){f(Ve.message)}finally{S(!1)}},Q=()=>{const Ve=u.filter(Ot=>Ot.status==="success").map(Ot=>`${Ot.name}
${Ot.link}`).join(`

`);navigator.clipboard.writeText(Ve)},W=Ve=>{switch(Ve){case"pending":return"bg-yellow-50 text-yellow-800";case"success":return"bg-green-50 text-green-800";case"error":return"bg-red-50 text-red-800";default:return""}};return p.jsxs("div",{className:"bg-white rounded-2xl shadow-lg w-full overflow-hidden",children:[p.jsx(OAe,{config:M,onConfigChange:A,onSave:O}),p.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 p-4 sm:p-8 text-white",children:p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:t.invoiceTitle||"Invoice"}),p.jsx("p",{className:"text-blue-100 mt-1",children:t.invoiceSubTitle})]}),p.jsxs("div",{className:"text-right",children:[p.jsxs("p",{className:"text-xl sm:text-2xl font-semibold text-white",children:["Invoice #",t.invoiceNumber||"Not Generated"]}),p.jsxs("p",{className:"text-blue-100 mt-1",children:["Date: ",t.invoiceDate||new Date().toISOString().split("T")[0]]}),p.jsxs("p",{className:"text-blue-100",children:["Due: ",t.dueDate||new Date(Date.now()+7*24*60*60*1e3).toISOString().split("T")[0]]})]})]})}),p.jsxs("div",{className:"p-4 sm:p-8",children:[p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 sm:gap-12 mb-8 sm:mb-12",children:[o!==null&&p.jsxs("div",{className:"col-span-2 bg-blue-50 p-4 rounded-xl mb-4",children:[p.jsx("h3",{className:"font-medium text-blue-800",children:"Split Bill Information"}),p.jsxs("p",{className:"text-blue-600",children:["This is split ",o.current," of ",o.total,p.jsxs("span",{className:"ml-2 text-sm text-blue-500",children:["(",Math.ceil(n.total/o.total).toLocaleString()," per split)"]})]})]}),p.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl",children:[p.jsxs("h2",{className:"font-semibold text-gray-800 mb-4 text-lg flex items-center gap-2",children:[p.jsx(xp,{className:"w-5 h-5 text-blue-600"}),"Billed From"]}),p.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[p.jsx("p",{children:(ye=t.billedBy)==null?void 0:ye.name}),p.jsx("p",{children:(H=t.billedBy)==null?void 0:H.street}),p.jsxs("p",{children:["Pincode: ",(Re=t.billedBy)==null?void 0:Re.pincode]}),p.jsxs("p",{children:["GST State: ",(ue=t.billedBy)==null?void 0:ue.gstState]}),p.jsxs("p",{children:["GSTIN: ",(Pe=t.billedBy)==null?void 0:Pe.gstin]}),p.jsxs("p",{children:["PAN: ",(ke=t.billedBy)==null?void 0:ke.panNumber]})]})]}),p.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl",children:[p.jsxs("h2",{className:"font-semibold text-gray-800 mb-4 text-lg flex items-center gap-2",children:[p.jsx(xp,{className:"w-5 h-5 text-blue-600"}),"Billed To"]}),p.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[p.jsx("p",{children:(be=t.billedTo)==null?void 0:be.name}),p.jsxs("p",{children:["Phone: ",(Fe=t.billedTo)==null?void 0:Fe.phone]}),p.jsxs("p",{children:["GST State: ",(He=t.billedTo)==null?void 0:He.gstState]}),p.jsxs("p",{children:["Pincode: ",(V=t.billedTo)==null?void 0:V.pincode]}),((K=t.billedTo)==null?void 0:K.gstin)&&p.jsxs("div",{children:[p.jsxs("p",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"font-medium",children:"GSTIN:"})," ",(te=t.billedTo)==null?void 0:te.gstin,(le=(ve=t.billedTo)==null?void 0:ve.name)!=null&&le.includes("")?p.jsx(oU,{className:"w-4 h-4 text-green-600","aria-label":"GSTIN Verified"}):(me=(ce=t.billedTo)==null?void 0:ce.name)!=null&&me.includes("")?p.jsx(zd,{className:"w-4 h-4 text-red-600","aria-label":"GSTIN Invalid or Inactive"}):null]}),((fe=(de=t.billedTo)==null?void 0:de.customFields)==null?void 0:fe.find(Ve=>Ve.label==="GSTIN Status"))&&p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx("span",{className:"text-xs mr-1",children:"Status:"}),p.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${((Ie=(pe=(ge=t.billedTo)==null?void 0:ge.customFields)==null?void 0:pe.find(Ve=>Ve.label==="GSTIN Status"))==null?void 0:Ie.value)==="Active"?"bg-green-100 text-green-800":((Je=(Be=(je=t.billedTo)==null?void 0:je.customFields)==null?void 0:Be.find(Ve=>Ve.label==="GSTIN Status"))==null?void 0:Je.value)==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:((ot=(Rt=(it=t.billedTo)==null?void 0:it.customFields)==null?void 0:Rt.find(Ve=>Ve.label==="GSTIN Status"))==null?void 0:ot.value)||"Unknown"})]})]}),((Et=t.billedTo)==null?void 0:Et.panNumber)&&p.jsxs("p",{children:["PAN: ",(rr=t.billedTo)==null?void 0:rr.panNumber]}),(Vn=(ds=t.billedTo)==null?void 0:ds.customFields)==null?void 0:Vn.map((Ve,Ot)=>p.jsxs("p",{children:[Ve.label,": ",Ve.value]},Ot))]})]})]}),p.jsxs("div",{className:"overflow-x-auto mb-8 sm:mb-12 rounded-xl border border-gray-200",children:[p.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[p.jsx("h3",{className:"font-medium text-gray-800",children:"Items"}),(!t.items||t.items.length===0)&&p.jsxs("button",{onClick:z,disabled:C,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",children:[p.jsx(bte,{className:"w-4 h-4"}),"Generate Pattern"]})]}),p.jsxs("table",{className:"w-full min-w-[800px]",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-gray-50",children:[p.jsx("th",{className:"py-4 px-6 text-left font-semibold text-gray-700 rounded-tl-xl",children:"Item Description"}),p.jsx("th",{className:"py-4 px-6 text-right font-semibold text-gray-700",children:"Rate"}),p.jsx("th",{className:"py-4 px-6 text-right font-semibold text-gray-700",children:"Quantity"}),p.jsx("th",{className:"py-4 px-6 text-right font-semibold text-gray-700",children:"GST Rate"}),p.jsx("th",{className:"py-4 px-6 text-right font-semibold text-gray-700",children:"Amount"})]})}),p.jsx("tbody",{children:(t.items||[]).map((Ve,Ot,nr)=>p.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[p.jsx("td",{className:"py-4 px-6",children:Ve.name}),p.jsxs("td",{className:"py-4 px-6 text-right",children:["",Ve.rate.toLocaleString()]}),p.jsx("td",{className:"py-4 px-6 text-right",children:Ve.quantity.toLocaleString()}),p.jsxs("td",{className:"py-4 px-6 text-right",children:[Ve.gstRate,"%"]}),p.jsxs("td",{className:"py-4 px-6 text-right font-medium",children:["",(Ve.rate*Ve.quantity).toLocaleString()]})]},Ot))})]})]}),v&&p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full mx-4 shadow-xl",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Generated Pattern"}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:"bg-gray-50 p-4 rounded-lg font-mono text-sm",children:b}),p.jsxs("div",{className:"text-sm text-gray-600",children:[p.jsx("p",{children:"Each item will be created with:"}),p.jsxs("ul",{className:"list-disc pl-4 space-y-1 mt-2",children:[p.jsx("li",{children:"Description: Imitation Jewellery"}),p.jsx("li",{children:"HSN Code: 7117"}),p.jsxs("li",{children:["GST Rate: ",((en=(Co=t.items)==null?void 0:Co[0])==null?void 0:en.gstRate)||3,"%"]})]})]})]}),p.jsxs("div",{className:"flex justify-end gap-3",children:[p.jsx("button",{onClick:()=>{navigator.clipboard.writeText(b)},className:"px-4 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:"Copy"}),p.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})]})}),p.jsx("div",{className:"flex justify-end w-full",children:p.jsxs("div",{className:"w-full sm:w-72",children:[p.jsxs("div",{className:"flex justify-between py-2",children:[p.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),p.jsxs("span",{className:"font-medium",children:["",n.subtotal.toLocaleString()]})]}),p.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[p.jsxs("span",{className:"text-gray-600",children:["GST (",((Cr=(Wt=t.items)==null?void 0:Wt[0])==null?void 0:Cr.gstRate)||3,"%):"]}),p.jsxs("span",{className:"font-medium",children:["",n.tax.toLocaleString()]})]}),p.jsxs("div",{className:"flex justify-between py-4 text-xl font-bold text-blue-600",children:[p.jsx("span",{children:"Total:"}),p.jsxs("span",{children:["",n.total.toLocaleString()]})]}),t.invoiceId&&p.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:p.jsx("button",{onClick:()=>U(!0),disabled:l,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:l?p.jsxs(p.Fragment,{children:[p.jsx(Qa,{className:"w-4 h-4 animate-spin"}),"Processing Payment..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Cd,{className:"w-4 h-4"}),"Add Payment"]})})}),u.length>0&&p.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h3",{className:"font-medium text-gray-900",children:"Generated Invoices"}),u.some(Ve=>Ve.status==="success")&&p.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",children:[p.jsx($R,{className:"w-4 h-4"}),"Copy All"]})]}),p.jsx("div",{className:"space-y-3",children:u.map((Ve,Ot)=>p.jsxs("div",{className:`p-4 rounded-xl ${W(Ve.status)}`,children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsxs("span",{className:"font-medium",children:["Invoice #",Ot+1]}),Ve.status==="pending"?p.jsx(Qa,{className:"w-4 h-4 animate-spin"}):Ve.status==="success"?p.jsx("button",{onClick:()=>navigator.clipboard.writeText(`${Ve.name}
${Ve.link}`),className:"p-1.5 hover:bg-blue-100/50 rounded-lg transition-colors",title:"Copy invoice details",children:p.jsx($R,{className:"w-4 h-4"})}):null]}),Ve.status==="success"&&p.jsxs(p.Fragment,{children:[p.jsxs("p",{className:"text-sm mb-1",children:["Name: ",Ve.name]}),p.jsxs("p",{className:"text-sm mb-1",children:["Number: ",Ve.invoiceNumber]}),p.jsxs("p",{className:"text-sm",children:["URL: ",Ve.link]})]}),Ve.status==="error"&&p.jsx("p",{className:"text-sm",children:Ve.error})]},Ot))})]})]})}),e&&p.jsxs("div",{className:"mt-8 pt-4 border-t space-y-4",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[p.jsxs("div",{className:"flex-1 max-w-[120px]",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Count"}),p.jsx("input",{type:"number",min:"1",max:"10",value:m,onChange:Ve=>g(Math.min(10,Math.max(1,parseInt(Ve.target.value)||1))),className:"w-full px-3 py-2 border rounded-lg text-sm"})]}),p.jsxs("button",{onClick:j,disabled:i,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all disabled:opacity-50 font-medium shadow-sm",children:[p.jsx(gU,{className:"w-4 h-4"}),i?"Generating...":`Generate ${m} ${m===1?"Bill":"Bills"}`]}),I&&p.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[p.jsx(S2,{className:"w-4 h-4"}),"Debug"]})]}),d&&p.jsxs("div",{className:"bg-red-50 p-4 rounded-xl mb-4",children:[p.jsx("h4",{className:"text-red-800 font-medium mb-2",children:"Error"}),p.jsx("p",{className:"text-red-600 text-sm",children:d})]})]})]}),L&&p.jsx(FI,{isOpen:L,onClose:()=>U(!1),onSubmit:N,invoiceAmount:n.total,invoiceId:t.invoiceNumber||"",customerName:((jr=t.billedTo)==null?void 0:jr.name)||"Customer",isSubmitting:l}),I&&p.jsx(RAe,{isOpen:E,onClose:()=>T(!1),requestData:I.request,responseData:I.response})]})}const h9="local_sheets_data",HI="google_sheets_credentials";function kAe(t){localStorage.setItem(HI,JSON.stringify(t))}function qf(){try{const t=localStorage.getItem(HI);return t?JSON.parse(t):null}catch{return null}}function IAe(){localStorage.removeItem(HI)}async function jI(){var e;const t=qf();if(!t)throw new Error("Google Sheets credentials not found");if(typeof gapi>"u"||typeof((e=google==null?void 0:google.accounts)==null?void 0:e.oauth2)>"u")throw new Error("Google API client not loaded");try{await new Promise((r,n)=>{gapi.load("client:auth2",async()=>{try{await gapi.client.init({apiKey:t.apiKey,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]}),google.accounts.oauth2.initTokenClient({client_id:t.clientId,scope:"https://www.googleapis.com/auth/spreadsheets.readonly",ux_mode:"popup",access_type:"offline",prompt:"consent",callback:s=>{s.error?n(new Error(s.error)):r(!0)}}).requestAccessToken()}catch(i){n(i)}})})}catch(r){const n=r.message;throw console.error("Google Sheets initialization error:",r),new Error(`Failed to initialize Google Sheets: ${n}`)}}async function NAe(){const t=qf();if(!t)throw new Error("Google Sheets credentials not found");try{return await jI(),(await gapi.client.sheets.spreadsheets.get({spreadsheetId:t.spreadsheetId})).result.sheets.map(r=>({title:r.properties.title,gid:r.properties.sheetId.toString()}))}catch(e){throw console.error("Error fetching sheets:",e),new Error(`Failed to fetch sheets: ${e.message}`)}}async function d9(t){const e=qf();if(!e)throw new Error("Google Sheets credentials not found");if(typeof gapi>"u")throw new Error("Google API not loaded");try{await jI();let r="Sheet1";if(t){const o=(await gapi.client.sheets.spreadsheets.get({spreadsheetId:e.spreadsheetId})).result.sheets.find(a=>a.properties.sheetId.toString()===t);o&&(r=o.properties.title)}const n=await gapi.client.sheets.spreadsheets.values.get({spreadsheetId:e.spreadsheetId,range:`${r}!A1:Z1000`});if(!n.result.values)throw new Error("No data found in spreadsheet");const i=n.result.values.filter((s,o)=>{var a;return o===0||!Array.isArray(s)?!0:!s[14]||((a=s[14])==null?void 0:a.trim())===""});if(i.length<=1)throw new Error("No new records found to import. All entries already have invoices generated.");return i}catch(r){throw console.error("Error fetching Google Sheets data:",r),new Error(`Failed to fetch Google Sheets data: ${r.message}`)}}function Dc(t){localStorage.setItem(h9,JSON.stringify(t))}function MAe(){try{const t=localStorage.getItem(h9);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading local sheet data:",t),[]}}const BI=t=>typeof t=="number"&&!isNaN(t),Nm=t=>typeof t=="string",f9=t=>typeof t=="function",PAe=t=>G.isValidElement(t)||Nm(t)||f9(t)||BI(t);function DAe(t,e,r){r===void 0&&(r=300);const{scrollHeight:n,style:i}=t;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,r)})})}function yS(t){let{enter:e,exit:r,appendPosition:n=!1,collapse:i=!0,collapseDuration:s=300}=t;return function(o){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:d,playToast:f}=o;const m=n?`${e}--${l}`:e,g=n?`${r}--${l}`:r,v=G.useRef(0);return G.useLayoutEffect(()=>{const w=h.current,b=m.split(" "),x=C=>{C.target===h.current&&(f(),w.removeEventListener("animationend",x),w.removeEventListener("animationcancel",x),v.current===0&&C.type!=="animationcancel"&&w.classList.remove(...b))};w.classList.add(...b),w.addEventListener("animationend",x),w.addEventListener("animationcancel",x)},[]),G.useEffect(()=>{const w=h.current,b=()=>{w.removeEventListener("animationend",b),i?DAe(w,u,s):u()};d||(c?b():(v.current=1,w.className+=` ${g}`,w.addEventListener("animationend",b)))},[d]),oe.createElement(oe.Fragment,null,a)}}const Vo=new Map;let pO=[];const ij=new Set,g9=()=>Vo.size>0;function LAe(t,e){var r;if(e)return!((r=Vo.get(e))==null||!r.isToastActive(t));let n=!1;return Vo.forEach(i=>{i.isToastActive(t)&&(n=!0)}),n}function FAe(t,e){PAe(t)&&(g9()||pO.push({content:t,options:e}),Vo.forEach(r=>{r.buildToast(t,e)}))}function sj(t,e){Vo.forEach(r=>{e!=null&&e!=null&&e.containerId?(e==null?void 0:e.containerId)===r.id&&r.toggle(t,e==null?void 0:e.id):r.toggle(t,e==null?void 0:e.id)})}let $Ae=1;const m9=()=>""+$Ae++;function HAe(t){return t&&(Nm(t.toastId)||BI(t.toastId))?t.toastId:m9()}function Mm(t,e){return FAe(t,e),e.toastId}function u1(t,e){return{...e,type:e&&e.type||t,toastId:HAe(e)}}function ty(t){return(e,r)=>Mm(e,u1(t,r))}function zt(t,e){return Mm(t,u1("default",e))}zt.loading=(t,e)=>Mm(t,u1("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),zt.promise=function(t,e,r){let n,{pending:i,error:s,success:o}=e;i&&(n=Nm(i)?zt.loading(i,r):zt.loading(i.render,{...r,...i}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,h,d)=>{if(h==null)return void zt.dismiss(n);const f={type:u,...a,...r,data:d},m=Nm(h)?{render:h}:h;return n?zt.update(n,{...f,...m}):zt(m.render,{...f,...m}),d},c=f9(t)?t():t;return c.then(u=>l("success",o,u)).catch(u=>l("error",s,u)),c},zt.success=ty("success"),zt.info=ty("info"),zt.error=ty("error"),zt.warning=ty("warning"),zt.warn=zt.warning,zt.dark=(t,e)=>Mm(t,u1("default",{theme:"dark",...e})),zt.dismiss=function(t){(function(e){var r;if(g9()){if(e==null||Nm(r=e)||BI(r))Vo.forEach(n=>{n.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const n=Vo.get(e.containerId);n?n.removeToast(e.id):Vo.forEach(i=>{i.removeToast(e.id)})}}else pO=pO.filter(n=>e!=null&&n.options.toastId!==e)})(t)},zt.clearWaitingQueue=function(t){t===void 0&&(t={}),Vo.forEach(e=>{!e.props.limit||t.containerId&&e.id!==t.containerId||e.clearQueue()})},zt.isActive=LAe,zt.update=function(t,e){e===void 0&&(e={});const r=((n,i)=>{var s;let{containerId:o}=i;return(s=Vo.get(o||1))==null?void 0:s.toasts.get(n)})(t,e);if(r){const{props:n,content:i}=r,s={delay:100,...n,...e,toastId:e.toastId||t,updateId:m9()};s.toastId!==t&&(s.staleId=t);const o=s.render||i;delete s.render,Mm(o,s)}},zt.done=t=>{zt.update(t,{progress:1})},zt.onChange=function(t){return ij.add(t),()=>{ij.delete(t)}},zt.play=t=>sj(!0,t),zt.pause=t=>sj(!1,t);const wS=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}};yS(wS("bounce",!0));yS(wS("slide",!0));yS(wS("zoom"));yS(wS("flip"));const oj={VIEW_PREFERENCE:"bill_generator_view"},aj=[{id:"list",label:"List View",icon:fte},{id:"grid",label:"Grid View",icon:hU},{id:"compact",label:"Compact",icon:pte},{id:"detailed",label:"Detailed",icon:lte},{id:"print",label:"Print View",icon:dU}];function jAe(){const[t,e]=G.useState([]),[r,n]=G.useState(""),[i,s]=G.useState(new Set),[o,a]=G.useState(!1),[l,c]=G.useState({current:0,total:0,success:0,failed:0}),[u,h]=G.useState(()=>localStorage.getItem(oj.VIEW_PREFERENCE)||"list"),[d,f]=G.useState(!1),[m,g]=G.useState(null),[v,w]=G.useState(new Set),[b,x]=G.useState(new Set),[C,S]=G.useState(!1),[E,T]=G.useState(!1),[I,k]=G.useState(null),[M,D]=G.useState({isVerifying:!1,progress:0,total:0,success:0,failed:0});G.useEffect(()=>{localStorage.setItem(oj.VIEW_PREFERENCE,u)},[u]),G.useEffect(()=>{const R=MAe();console.log("Loading data from local storage for bill generation, rows:",R.length),R.length>0?(async()=>{try{const O=R.filter(j=>j.some(z=>z!=="")).map(async j=>(await c9(j)).map(Q=>{var W,ae;return!Q.customerId&&Q.billedTo&&(j[22]&&j[22].trim()?Q.customerId=j[22].trim():Q.billedTo.phone?Q.customerId=`customer_${Q.billedTo.phone}`:Q.billedTo.name&&(Q.customerId=`customer_${Q.billedTo.name.replace(/\s+/g,"").toLowerCase()}`)),(W=Q.invoiceNumber)!=null&&W.endsWith("-2")?Q.billIndex=2:(ae=Q.invoiceNumber)!=null&&ae.endsWith("-3")?Q.billIndex=3:Q.billIndex=1,Q})),F=(await Promise.all(O)).flat().filter(j=>{var z;return(z=j.billedTo)==null?void 0:z.name});console.log("Total parsed bills:",F.length),e(F)}catch(O){console.error("Error processing bills:",O)}})():console.log("No data found in local storage")},[]);const L=(R,A)=>{A&&e(O=>{const N=[...O];return N[R]={...N[R],isPaid:!0},N})},U=()=>{u==="print"?h("list"):(h("print"),setTimeout(()=>{window.print()},500))},J=R=>{console.log("Toggling bill selection for index:",R);const A=new Set(i);A.has(R)?(console.log("Removing bill from selection"),A.delete(R)):(console.log("Adding bill to selection"),A.add(R)),console.log("New selection size:",A.size),s(A),c(O=>({...O}))},X=()=>{i.size===t.length?s(new Set):s(new Set(t.map((R,A)=>A)))},ie=()=>{if(i.size===0){alert("Please select bills to reset first");return}window.confirm(`Reset the generated status of ${i.size} selected bills? This will allow you to regenerate these bills.`)&&(e(A=>{const O=[...A];return i.forEach(N=>{O[N]={...O[N],invoiceId:void 0,invoiceLink:void 0}}),O}),alert(`Reset ${i.size} bills. You can now regenerate them.`))},se=async()=>{var O,N,F,j,z,Q,W,ae,ye,H,Re,ue,Pe,ke,be,Fe,He,V,K;console.log("generateSelectedBills called"),console.log("selectedBills:",i),console.log("selectedBills size:",i.size),console.log("Bills array length:",t.length),console.log("Selected bills:",Array.from(i).map(te=>{var ve;return{index:te,invoiceId:t[te].invoiceId,name:(ve=t[te].billedTo)==null?void 0:ve.name,isPending:!t[te].invoiceId}}));const R=Array.from(i).filter(te=>{var ce;const ve=t[te],le=!ve.invoiceId||ve.invoiceId==="";return console.log(`Bill ${te} (${(ce=ve.billedTo)==null?void 0:ce.name}) - invoiceId: ${ve.invoiceId} - needs generation: ${le}`),le}).map(te=>({index:te,bill:t[te]}));if(console.log(`Found ${R.length} bills that need generation out of ${i.size} selected`),R.length===0){window.confirm("All selected bills have already been generated. Would you like to reset their status and regenerate them?")&&ie();return}if(window.confirm(`You are about to generate ${R.length} bills. Continue?`))try{a(!0),c({current:0,total:R.length,success:0,failed:0});const te=Cu();if(!te||!Eu(te)){alert("Authentication token not found or invalid. Please generate a valid token in Settings."),a(!1);return}const ve={success:0,failed:0,errors:[]};for(const{index:le,bill:ce}of R)try{if(c(fe=>({...fe,current:fe.current+1})),(O=ce.billedTo)!=null&&O.gstin&&ce.billedTo.name&&!ce.billedTo.name.includes("")&&window.confirm(`Bill for ${ce.billedTo.name} has an unverified GSTIN (${ce.billedTo.gstin}). Do you want to verify it before generating the bill?`))try{const ge=await Rd(ce);if(ge.status==="error"){if(console.warn(`GSTIN verification failed: ${ge.message}`),!window.confirm(`GSTIN verification failed: ${ge.message}. Do you want to proceed with bill generation anyway?`))throw new Error(`GSTIN verification failed: ${ge.message}`)}else if(ge.gstinStatus&&ge.gstinStatus!=="Active"&&!window.confirm(`GSTIN has inactive status: ${ge.gstinStatus}. Do you want to proceed with bill generation anyway?`))throw new Error(`Cannot generate bill with inactive GSTIN (Status: ${ge.gstinStatus})`);ge.billedTo&&(t[le].billedTo=ge.billedTo,ce.billedTo=ge.billedTo)}catch(ge){throw ge}const me=await fetch("https://api.refrens.com/businesses/vm-jewellers/invoices",{method:"POST",headers:{Authorization:te,"Content-Type":"application/json"},body:JSON.stringify({invoiceTitle:ce.invoiceTitle||"VM Jewellers",invoiceSubTitle:ce.invoiceSubTitle||"Tax Invoice",invoiceNumber:ce.invoiceNumber||`INV${Date.now()}${Math.floor(Math.random()*1e3)}`,contact:{phone:((N=ce.billedTo)==null?void 0:N.phone)||"",email:((F=ce.billedTo)==null?void 0:F.email)||"contact@example.com"},invoiceDate:ce.invoiceDate||new Date().toISOString().split("T")[0],dueDate:ce.dueDate||new Date(Date.now()+7*24*60*60*1e3).toISOString().split("T")[0],invoiceType:ce.invoiceType||"INVOICE",currency:ce.currency||"INR",billedTo:{name:((j=ce.billedTo)==null?void 0:j.name)||"",pincode:((z=ce.billedTo)==null?void 0:z.pincode)||"",gstState:((Q=ce.billedTo)==null?void 0:Q.gstState)||"",country:"IN",gstin:((W=ce.billedTo)==null?void 0:W.gstin)||void 0,panNumber:((ae=ce.billedTo)==null?void 0:ae.panNumber)||void 0,phone:((ye=ce.billedTo)==null?void 0:ye.phone)||"",phoneShowInInvoice:!0,customFields:((H=ce.billedTo)==null?void 0:H.customFields)||[]},billedBy:{name:"V.M Jewellers",street:"5121/A, Ground Floor, Near Hanuman Mandir, Rui Mandi, Sadar Bazar,, Delhi,",pincode:"110006",gstState:"07",state:"Delhi",country:"IN",panNumber:"NDBPS0625E",gstin:"07NDBPS0625E2ZJ",phone:"+918587891402",email:"vmjeweller750@gmail.com"},items:((Re=ce.items)==null?void 0:Re.map(fe=>({name:fe.name||"Imitation Jewellery",hsn:fe.hsn||"7117",quantity:fe.quantity,rate:fe.rate,amount:fe.rate*fe.quantity,gstRate:fe.gstRate,taxAmount:fe.rate*fe.quantity*(fe.gstRate/100),total:fe.rate*fe.quantity*(1+fe.gstRate/100)})))||[],email:{to:{name:((ue=ce.billedTo)==null?void 0:ue.name)||"",email:((Pe=ce.billedTo)==null?void 0:Pe.email)||"vs5581764@gmail.com"},cc:[{name:"VM",email:"vm@gmail.com"},{name:"CC Recipient 2",email:"cc2@example.com"}]}})});if(!me.ok){const fe=await me.json();throw new Error(((ke=fe.error)==null?void 0:ke.message)||`API Error (${me.status})`)}const de=await me.json();if(e(fe=>{var pe;const ge=[...fe];return ge[le]={...ge[le],invoiceId:de._id,invoiceNumber:de.invoiceNumber,invoiceLink:(pe=de.share)==null?void 0:pe.link},ge}),(be=ce.billedTo)!=null&&be.name){const fe=`customer_${ce.billedTo.name.replace(/\s+/g,"_").toLowerCase()}`,ge=`invoices_${fe}`,pe=localStorage.getItem(ge);let Ie=pe?JSON.parse(pe):[];const je={id:de._id,invoiceNumber:de.invoiceNumber,link:((Fe=de.share)==null?void 0:Fe.link)||"",customerName:ce.billedTo.name,date:ce.invoiceDate||new Date().toISOString().split("T")[0],amount:ce.items?ce.items.reduce((Je,it)=>Je+(it.total||0),0):0,paymentDate:ce.paymentDate||null,paymentMethod:ce.paymentMethod||null,isPaid:!!ce.paymentDate,apiSynced:!1,customerId:fe},Be=Ie.findIndex(Je=>Je.id&&Je.id===de._id||Je.invoiceNumber&&Je.invoiceNumber===de.invoiceNumber);Be>=0?Ie[Be]={...Ie[Be],...je}:Ie.push(je),localStorage.setItem(ge,JSON.stringify(Ie))}ve.success++,c(fe=>({...fe,success:fe.success+1}))}catch(me){console.error(`Error processing bill for ${(He=ce.billedTo)==null?void 0:He.name}:`,me),ve.failed++,ve.errors.push({customerName:((V=ce.billedTo)==null?void 0:V.name)||"Unknown",error:me.message}),c(de=>({...de,failed:de.failed+1})),me.message.includes("inactive GSTIN")&&zt.error(`Cannot generate bill for ${(K=ce.billedTo)==null?void 0:K.name}: GSTIN is inactive`)}ve.success>0&&alert(`Successfully generated ${ve.success} bills`),ve.failed>0&&(alert(`Failed to generate ${ve.failed} bills. Check the console for details.`),console.error("Errors:",ve.errors))}catch(te){console.error("Error during bill generation:",te),alert(`An error occurred: ${te.message}`)}finally{a(!1)}};i.size>0;const P=()=>{if(t.length===0)return p.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-gray-100 text-center",children:[p.jsx(Za,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),p.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Data Available"}),p.jsx("p",{className:"text-gray-500 mb-4",children:"Import data from Google Sheets or Excel to generate bills"}),p.jsx(Wd,{to:"/bulk-import",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Import Data"})]});switch(u){case"grid":return p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map((A,O)=>{var F;const N=i.has(O);return p.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden relative ${N?"border-blue-500 ring-2 ring-blue-200":"border-gray-100"}`,children:[p.jsx("div",{className:"absolute top-2 left-2 z-10",children:p.jsx("button",{onClick:()=>J(O),className:`p-1 rounded ${N?"bg-blue-500 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:p.jsx(Fl,{className:"w-4 h-4"})})}),p.jsx("div",{className:"border-b border-gray-100 bg-gray-50 px-4 py-2 flex justify-between items-center",children:p.jsxs("h3",{className:"font-medium text-gray-900 text-sm",children:[(F=A.billedTo)==null?void 0:F.name,A.billIndex&&A.billIndex>1&&p.jsxs("span",{className:"ml-2 text-blue-600 text-xs font-normal",children:["(Bill ",A.billIndex,")"]})]})}),p.jsx("div",{className:"p-3",children:p.jsx($E,{bill:A,isAuthenticated:!0,onPaymentMarked:j=>L(O,j)})})]},O)})});case"compact":return p.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-gray-50 text-left",children:[p.jsx("th",{className:"px-2 py-2",children:p.jsx("button",{onClick:X,className:`p-1 rounded ${i.size===t.length?"bg-blue-500 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:p.jsx(Fl,{className:"w-4 h-4"})})}),p.jsx("th",{className:"px-4 py-2 font-medium text-gray-700",children:"#"}),p.jsx("th",{className:"px-4 py-2 font-medium text-gray-700",children:"Customer"}),p.jsx("th",{className:"px-4 py-2 font-medium text-gray-700",children:"Phone"}),p.jsx("th",{className:"px-4 py-2 font-medium text-gray-700",children:"Amount"}),p.jsx("th",{className:"px-4 py-2 font-medium text-gray-700",children:"Status"}),p.jsx("th",{className:"px-4 py-2 font-medium text-gray-700",children:"Actions"})]})}),p.jsx("tbody",{children:t.map((A,O)=>{var j,z,Q;const N=((j=A.items)==null?void 0:j.reduce((W,ae)=>W+(ae.total||0),0))||0,F=i.has(O);return p.jsxs("tr",{className:`border-t hover:bg-gray-50 ${F?"bg-blue-50":"border-gray-100"}`,children:[p.jsx("td",{className:"px-2 py-3",children:p.jsx("button",{onClick:()=>J(O),className:`p-1 rounded ${F?"bg-blue-500 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:p.jsx(Fl,{className:"w-4 h-4"})})}),p.jsx("td",{className:"px-4 py-3 text-gray-600",children:O+1}),p.jsxs("td",{className:"px-4 py-3 font-medium",children:[(z=A.billedTo)==null?void 0:z.name,A.billIndex&&A.billIndex>1&&p.jsxs("span",{className:"ml-2 text-blue-600 text-xs font-normal",children:["(Bill ",A.billIndex,")"]})]}),p.jsx("td",{className:"px-4 py-3 text-gray-600",children:(Q=A.billedTo)==null?void 0:Q.phone}),p.jsxs("td",{className:"px-4 py-3 font-medium",children:["",N.toLocaleString()]}),p.jsx("td",{className:"px-4 py-3",children:A.isPaid?p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Paid"}):A.invoiceId?p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Generated"}):p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Pending"})}),p.jsx("td",{className:"px-4 py-3",children:p.jsx("button",{onClick:()=>h("detailed"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View Details"})})]},O)})})]})})});case"detailed":case"print":const R=u==="print"?"print:block":"";return p.jsx("div",{className:`space-y-8 ${R}`,children:t.map((A,O)=>{var F;const N=i.has(O);return p.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden print:mb-8 print:page-break-after-always relative ${N&&u!=="print"?"border-blue-500 ring-2 ring-blue-200":"border-gray-100"}`,children:[u!=="print"&&p.jsx("div",{className:"absolute top-3 left-3 z-10",children:p.jsx("button",{onClick:()=>J(O),className:`p-1 rounded ${N?"bg-blue-500 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:p.jsx(Fl,{className:"w-4 h-4"})})}),p.jsx("div",{className:"border-b border-gray-100 bg-gray-50 px-6 py-3 flex justify-between items-center print:bg-white",children:p.jsxs("h3",{className:"font-medium text-gray-900",children:["Bill ",O+1," - ",(F=A.billedTo)==null?void 0:F.name,A.billIndex&&A.billIndex>1&&p.jsxs("span",{className:"ml-2 text-blue-600 text-sm font-normal",children:["(Bill ",A.billIndex," from row)"]})]})}),p.jsx("div",{className:"p-4",children:p.jsx($E,{bill:A,isAuthenticated:u!=="print",onPaymentMarked:j=>L(O,j)})})]},O)})});case"list":default:return p.jsx("div",{className:"grid grid-cols-1 gap-8",children:t.map((A,O)=>{var F;const N=i.has(O);return p.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden relative ${N?"border-blue-500 ring-2 ring-blue-200":"border-gray-100"}`,children:[p.jsx("div",{className:"absolute top-3 left-3 z-10",children:p.jsx("button",{onClick:()=>J(O),className:`p-1 rounded ${N?"bg-blue-500 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:p.jsx(Fl,{className:"w-4 h-4"})})}),p.jsx("div",{className:"border-b border-gray-100 bg-gray-50 px-6 py-3 flex justify-between items-center",children:p.jsxs("h3",{className:"font-medium text-gray-900",children:["Bill ",O+1," - ",(F=A.billedTo)==null?void 0:F.name,A.billIndex&&A.billIndex>1&&p.jsxs("span",{className:"ml-2 text-blue-600 text-sm font-normal",children:["(Bill ",A.billIndex," from row)"]})]})}),p.jsx("div",{className:"p-4",children:p.jsx($E,{bill:A,isAuthenticated:!0,onPaymentMarked:j=>L(O,j)})})]},O)})})}};G.useEffect(()=>{const R=A=>{const{enabled:O}=A.detail;console.log(`[BillGenerator] GSTIN verification setting changed: ${O?"enabled":"disabled"}`),t.length>0&&Promise.all(t.map(async(N,F)=>{var j,z;return(j=N.billedTo)!=null&&j.gstin&&!((z=N.billedTo.name)!=null&&z.includes(""))?(console.log(`[BillGenerator] Re-verifying bill ${F} after settings change`),await Rd(N)):N})).then(N=>{e(N)})};return window.addEventListener("gstinVerificationUpdated",R),()=>{window.removeEventListener("gstinVerificationUpdated",R)}},[t]);const y=async()=>{var N;if(t.length===0){zt.error("No bills found for GSTIN verification");return}const A=(i.size>0?Array.from(i).map(F=>t[F]):t).filter(F=>{var j;return(j=F.billedTo)==null?void 0:j.gstin});if(A.length===0){zt.error("No GST numbers found in selected bills");return}if(window.confirm(`Verify ${A.length} GSTIN numbers? This will update the legal names on your bills.`)){D({isVerifying:!0,progress:0,total:A.length,success:0,failed:0});try{for(let F=0;F<A.length;F++){const j=A[F];if(D(z=>({...z,progress:F})),!!((N=j.billedTo)!=null&&N.gstin)){try{const z=await Rd(j);e(Q=>{const W=[...Q],ae=Q.findIndex(ye=>{var H,Re;return((H=ye.billedTo)==null?void 0:H.gstin)===((Re=j.billedTo)==null?void 0:Re.gstin)&&ye.billIndex===j.billIndex});return ae!==-1&&(W[ae]=z),W}),D(Q=>({...Q,success:Q.success+1})),(F%5===0||F===A.length-1)&&zt.success(`Verified ${F+1} of ${A.length} GST numbers`)}catch(z){console.error("Error verifying GSTIN:",z),D(Q=>({...Q,failed:Q.failed+1}))}F<A.length-1&&await new Promise(z=>setTimeout(z,2e3))}}zt.success(`GSTIN verification complete: ${M.success} successful, ${M.failed} failed`)}catch(F){console.error("Error in bulk GSTIN verification:",F),zt.error("An error occurred during GSTIN verification")}finally{D(F=>({...F,isVerifying:!1,progress:F.total}))}}},_=()=>p.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[p.jsxs("button",{onClick:X,className:"px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm bg-white hover:bg-gray-50 flex items-center gap-1.5",children:[p.jsx(VL,{className:"w-4 h-4"}),i.size===t.length?"Deselect All":"Select All"]}),i.size>0&&p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:se,disabled:o,className:"px-3 py-1.5 border border-blue-600 bg-blue-600 text-white rounded-md shadow-sm text-sm hover:bg-blue-700 flex items-center gap-1.5 disabled:opacity-50",children:o?p.jsxs(p.Fragment,{children:[p.jsx(Qa,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):p.jsxs(p.Fragment,{children:[p.jsx(WL,{className:"w-4 h-4"}),"Generate ",i.size," Bill",i.size!==1?"s":""]})}),p.jsxs("button",{onClick:ie,className:"px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm bg-white hover:bg-gray-50 flex items-center gap-1.5",children:[p.jsx(pU,{className:"w-4 h-4"}),"Reset Selected"]})]}),p.jsx("button",{onClick:y,disabled:M.isVerifying||o,className:"px-3 py-1.5 border border-green-600 text-green-600 rounded-md shadow-sm text-sm bg-white hover:bg-green-50 flex items-center gap-1.5 disabled:opacity-50",children:M.isVerifying?p.jsxs(p.Fragment,{children:[p.jsx(Qa,{className:"w-4 h-4 animate-spin"}),"Verifying GST... ",M.progress,"/",M.total]}):p.jsxs(p.Fragment,{children:[p.jsx(bb,{className:"w-4 h-4"}),"Verify GSTIN ",i.size>0?`(${i.size})`:""]})}),p.jsx(Wd,{to:"/settings",className:"ml-auto px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm bg-white hover:bg-gray-50 flex items-center gap-1.5",children:"Settings"}),p.jsx("div",{className:"flex border border-gray-300 rounded-md overflow-hidden",children:aj.map(R=>p.jsxs("button",{onClick:()=>R.id==="print"?U():h(R.id),className:`px-3 py-1.5 text-sm ${u===R.id?"bg-blue-50 text-blue-600":"bg-white text-gray-700 hover:bg-gray-50"} flex items-center gap-1.5`,title:R.label,children:[p.jsx(R.icon,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:R.label})]},R.id))})]});return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bill Generator"}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsxs("button",{onClick:U,className:`flex items-center gap-2 px-3 py-1.5 text-sm ${u==="print"?"bg-blue-100 text-blue-700":"bg-blue-50 text-blue-600 hover:bg-blue-100"} rounded-lg transition-colors`,children:[p.jsx(dU,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Print View"}),p.jsx("span",{className:"sm:hidden",children:"Print"})]}),i.size>0&&p.jsxs("button",{onClick:se,disabled:o,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors disabled:opacity-50",children:[p.jsx(gU,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Generate Selected"}),p.jsx("span",{className:"sm:hidden",children:"Generate"})]}),i.size>0&&p.jsxs("button",{onClick:ie,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-amber-50 text-amber-600 rounded-lg hover:bg-amber-100 transition-colors",children:[p.jsx(WL,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Reset Status"}),p.jsx("span",{className:"sm:hidden",children:"Reset"})]})]})]}),p.jsx("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm mb-6",children:p.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:X,className:"p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors mr-2",title:i.size===t.length?"Deselect All":"Select All",children:p.jsx(VL,{className:`w-5 h-5 ${i.size===t.length?"text-blue-600":"text-gray-400"}`})}),p.jsxs("span",{className:"text-sm text-gray-500",children:[i.size," of ",t.length," selected"]})]}),p.jsx("div",{className:"ml-auto flex gap-2 flex-wrap",children:aj.map(R=>p.jsx("button",{onClick:()=>h(R.id),className:`p-2 rounded-lg transition-colors ${u===R.id?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-500 hover:bg-gray-100"}`,title:R.label,children:p.jsx(R.icon,{className:"w-5 h-5"})},R.id))})]})}),r&&p.jsx("div",{className:"p-4 bg-red-50 rounded-lg mb-4",children:p.jsxs("p",{className:"text-red-700 flex items-center",children:[p.jsx(zd,{className:"w-5 h-5 mr-2"}),r]})}),_(),P(),p.jsx("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:page-break-after-always {
            page-break-after: always;
          }
          .print\\:mb-8 {
            margin-bottom: 2rem;
          }
          .print\\:bg-white {
            background-color: white !important;
          }
          @page {
            size: A4;
            margin: 1cm;
          }
          html, body {
            width: 210mm;
            height: 297mm;
          }
        }
      `})]})}const VI="-",BAe=t=>{const e=UAe(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const a=o.split(VI);return a[0]===""&&a.length!==1&&a.shift(),p9(a,e)||VAe(o)},getConflictingClassGroupIds:(o,a)=>{const l=r[o]||[];return a&&n[o]?[...l,...n[o]]:l}}},p9=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?p9(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(VI);return(o=e.validators.find(({validator:a})=>a(s)))==null?void 0:o.classGroupId},lj=/^\[(.+)\]$/,VAe=t=>{if(lj.test(t)){const e=lj.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},UAe=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return zAe(Object.entries(t.classGroups),r).forEach(([s,o])=>{vO(o,n,s,e)}),n},vO=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:cj(e,i);s.classGroupId=r;return}if(typeof i=="function"){if(WAe(i)){vO(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([s,o])=>{vO(o,cj(e,s),r,n)})})},cj=(t,e)=>{let r=t;return e.split(VI).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},WAe=t=>t.isThemeGetter,zAe=(t,e)=>e?t.map(([r,n])=>{const i=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,a])=>[e+o,a])):s);return[r,i]}):t,GAe=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(s,o)=>{r.set(s,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(s){let o=r.get(s);if(o!==void 0)return o;if((o=n.get(s))!==void 0)return i(s,o),o},set(s,o){r.has(s)?r.set(s,o):i(s,o)}}},v9="!",YAe=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],s=e.length,o=a=>{const l=[];let c=0,u=0,h;for(let v=0;v<a.length;v++){let w=a[v];if(c===0){if(w===i&&(n||a.slice(v,v+s)===e)){l.push(a.slice(u,v)),u=v+s;continue}if(w==="/"){h=v;continue}}w==="["?c++:w==="]"&&c--}const d=l.length===0?a:a.substring(u),f=d.startsWith(v9),m=f?d.substring(1):d,g=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:g}};return r?a=>r({className:a,parseClassName:o}):o},KAe=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},XAe=t=>({cache:GAe(t.cacheSize),parseClassName:YAe(t),...BAe(t)}),qAe=/\s+/,JAe=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,s=[],o=t.trim().split(qAe);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}=r(c);let m=!!f,g=n(m?d.substring(0,f):d);if(!g){if(!m){a=c+(a.length>0?" "+a:a);continue}if(g=n(d),!g){a=c+(a.length>0?" "+a:a);continue}m=!1}const v=KAe(u).join(":"),w=h?v+v9:v,b=w+g;if(s.includes(b))continue;s.push(b);const x=i(g,m);for(let C=0;C<x.length;++C){const S=x[C];s.push(w+S)}a=c+(a.length>0?" "+a:a)}return a};function ZAe(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=y9(e))&&(n&&(n+=" "),n+=r);return n}const y9=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=y9(t[n]))&&(r&&(r+=" "),r+=e);return r};function QAe(t,...e){let r,n,i,s=o;function o(l){const c=e.reduce((u,h)=>h(u),t());return r=XAe(c),n=r.cache.get,i=r.cache.set,s=a,a(l)}function a(l){const c=n(l);if(c)return c;const u=JAe(l,r);return i(l,u),u}return function(){return s(ZAe.apply(null,arguments))}}const mr=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},w9=/^\[(?:([a-z-]+):)?(.+)\]$/i,eOe=/^\d+\/\d+$/,tOe=new Set(["px","full","screen"]),rOe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nOe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iOe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,sOe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oOe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ma=t=>Od(t)||tOe.has(t)||eOe.test(t),wl=t=>Jf(t,"length",gOe),Od=t=>!!t&&!Number.isNaN(Number(t)),HE=t=>Jf(t,"number",Od),kg=t=>!!t&&Number.isInteger(Number(t)),aOe=t=>t.endsWith("%")&&Od(t.slice(0,-1)),mt=t=>w9.test(t),xl=t=>rOe.test(t),lOe=new Set(["length","size","percentage"]),cOe=t=>Jf(t,lOe,x9),uOe=t=>Jf(t,"position",x9),hOe=new Set(["image","url"]),dOe=t=>Jf(t,hOe,pOe),fOe=t=>Jf(t,"",mOe),Ig=()=>!0,Jf=(t,e,r)=>{const n=w9.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},gOe=t=>nOe.test(t)&&!iOe.test(t),x9=()=>!1,mOe=t=>sOe.test(t),pOe=t=>oOe.test(t),vOe=()=>{const t=mr("colors"),e=mr("spacing"),r=mr("blur"),n=mr("brightness"),i=mr("borderColor"),s=mr("borderRadius"),o=mr("borderSpacing"),a=mr("borderWidth"),l=mr("contrast"),c=mr("grayscale"),u=mr("hueRotate"),h=mr("invert"),d=mr("gap"),f=mr("gradientColorStops"),m=mr("gradientColorStopPositions"),g=mr("inset"),v=mr("margin"),w=mr("opacity"),b=mr("padding"),x=mr("saturate"),C=mr("scale"),S=mr("sepia"),E=mr("skew"),T=mr("space"),I=mr("translate"),k=()=>["auto","contain","none"],M=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",mt,e],L=()=>[mt,e],U=()=>["",ma,wl],J=()=>["auto",Od,mt],X=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ie=()=>["solid","dashed","dotted","double","none"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],P=()=>["start","end","center","between","around","evenly","stretch"],y=()=>["","0",mt],_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],R=()=>[Od,mt];return{cacheSize:500,separator:":",theme:{colors:[Ig],spacing:[ma,wl],blur:["none","",xl,mt],brightness:R(),borderColor:[t],borderRadius:["none","","full",xl,mt],borderSpacing:L(),borderWidth:U(),contrast:R(),grayscale:y(),hueRotate:R(),invert:y(),gap:L(),gradientColorStops:[t],gradientColorStopPositions:[aOe,wl],inset:D(),margin:D(),opacity:R(),padding:L(),saturate:R(),scale:R(),sepia:y(),skew:R(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",mt]}],container:["container"],columns:[{columns:[xl]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...X(),mt]}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",kg,mt]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",mt]}],grow:[{grow:y()}],shrink:[{shrink:y()}],order:[{order:["first","last","none",kg,mt]}],"grid-cols":[{"grid-cols":[Ig]}],"col-start-end":[{col:["auto",{span:["full",kg,mt]},mt]}],"col-start":[{"col-start":J()}],"col-end":[{"col-end":J()}],"grid-rows":[{"grid-rows":[Ig]}],"row-start-end":[{row:["auto",{span:[kg,mt]},mt]}],"row-start":[{"row-start":J()}],"row-end":[{"row-end":J()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",mt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",mt]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...P()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...P(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...P(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",mt,e]}],"min-w":[{"min-w":[mt,e,"min","max","fit"]}],"max-w":[{"max-w":[mt,e,"none","full","min","max","fit","prose",{screen:[xl]},xl]}],h:[{h:[mt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[mt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[mt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[mt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",xl,wl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",HE]}],"font-family":[{font:[Ig]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",mt]}],"line-clamp":[{"line-clamp":["none",Od,HE]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ma,mt]}],"list-image":[{"list-image":["none",mt]}],"list-style-type":[{list:["none","disc","decimal",mt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ie(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ma,wl]}],"underline-offset":[{"underline-offset":["auto",ma,mt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",mt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",mt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...X(),uOe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",cOe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},dOe]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...ie(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:ie()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...ie()]}],"outline-offset":[{"outline-offset":[ma,mt]}],"outline-w":[{outline:[ma,wl]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:U()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[ma,wl]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",xl,fOe]}],"shadow-color":[{shadow:[Ig]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":se()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",xl,mt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[x]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",mt]}],duration:[{duration:R()}],ease:[{ease:["linear","in","out","in-out",mt]}],delay:[{delay:R()}],animate:[{animate:["none","spin","ping","pulse","bounce",mt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[kg,mt]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",mt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",mt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",mt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ma,wl,HE]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},yOe=QAe(vOe);function nh(...t){return yOe(xt(t))}const im=G.forwardRef(({className:t,...e},r)=>p.jsx("div",{ref:r,className:nh("rounded-xl border border-gray-200 bg-white text-gray-950 shadow-sm",t),...e}));im.displayName="Card";const sm=G.forwardRef(({className:t,...e},r)=>p.jsx("div",{ref:r,className:nh("flex flex-col space-y-1.5 p-6",t),...e}));sm.displayName="CardHeader";const om=G.forwardRef(({className:t,...e},r)=>p.jsx("h3",{ref:r,className:nh("text-2xl font-semibold leading-none tracking-tight",t),...e}));om.displayName="CardTitle";const wOe=G.forwardRef(({className:t,...e},r)=>p.jsx("p",{ref:r,className:nh("text-sm text-gray-500",t),...e}));wOe.displayName="CardDescription";const am=G.forwardRef(({className:t,...e},r)=>p.jsx("div",{ref:r,className:nh("p-6 pt-0",t),...e}));am.displayName="CardContent";const xOe=G.forwardRef(({className:t,...e},r)=>p.jsx("div",{ref:r,className:nh("flex items-center p-6 pt-0",t),...e}));xOe.displayName="CardFooter";const yO=G.forwardRef(({className:t,variant:e="default",size:r="default",loading:n,icon:i,children:s,disabled:o,...a},l)=>{const c="inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",u={default:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-500",outline:"border border-gray-200 bg-white hover:bg-gray-100 hover:text-gray-900 focus-visible:ring-gray-500",ghost:"hover:bg-gray-100 hover:text-gray-900 focus-visible:ring-gray-500",link:"text-blue-600 underline-offset-4 hover:underline focus-visible:ring-blue-500"},h={default:"h-10 px-4 py-2",sm:"h-9 px-3 text-sm",lg:"h-11 px-8",icon:"h-10 w-10"};return p.jsxs("button",{ref:l,disabled:o||n,className:nh(c,u[e],h[r],t),...a,children:[n?p.jsx(Qa,{className:"mr-2 h-4 w-4 animate-spin"}):i?p.jsx("span",{className:"mr-2",children:i}):null,s]})});yO.displayName="Button";var Ng=function(t){return t&&t.Math===Math&&t},Bn=Ng(typeof globalThis=="object"&&globalThis)||Ng(typeof window=="object"&&window)||Ng(typeof self=="object"&&self)||Ng(typeof ka=="object"&&ka)||Ng(typeof ka=="object"&&ka)||function(){return this}()||Function("return this")(),UI={},Bs=function(t){try{return!!t()}catch{return!0}},bOe=Bs,oa=!bOe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),SOe=Bs,xS=!SOe(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),COe=xS,ry=Function.prototype.call,bS=COe?ry.bind(ry):function(){return ry.apply(ry,arguments)},b9={},S9={}.propertyIsEnumerable,C9=Object.getOwnPropertyDescriptor,EOe=C9&&!S9.call({1:2},1);b9.f=EOe?function(e){var r=C9(this,e);return!!r&&r.enumerable}:S9;var WI=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},E9=xS,T9=Function.prototype,wO=T9.call,TOe=E9&&T9.bind.bind(wO,wO),_i=E9?TOe:function(t){return function(){return wO.apply(t,arguments)}},_9=_i,_Oe=_9({}.toString),ROe=_9("".slice),Zf=function(t){return ROe(_Oe(t),8,-1)},AOe=_i,OOe=Bs,kOe=Zf,jE=Object,IOe=AOe("".split),NOe=OOe(function(){return!jE("z").propertyIsEnumerable(0)})?function(t){return kOe(t)==="String"?IOe(t,""):jE(t)}:jE,R9=function(t){return t==null},MOe=R9,POe=TypeError,zI=function(t){if(MOe(t))throw new POe("Can't call method on "+t);return t},DOe=NOe,LOe=zI,SS=function(t){return DOe(LOe(t))},BE=typeof document=="object"&&document.all,ii=typeof BE>"u"&&BE!==void 0?function(t){return typeof t=="function"||t===BE}:function(t){return typeof t=="function"},FOe=ii,Rc=function(t){return typeof t=="object"?t!==null:FOe(t)},VE=Bn,$Oe=ii,HOe=function(t){return $Oe(t)?t:void 0},Y0=function(t,e){return arguments.length<2?HOe(VE[t]):VE[t]&&VE[t][e]},jOe=_i,A9=jOe({}.isPrototypeOf),BOe=Bn,uj=BOe.navigator,hj=uj&&uj.userAgent,CS=hj?String(hj):"",O9=Bn,UE=CS,dj=O9.process,fj=O9.Deno,gj=dj&&dj.versions||fj&&fj.version,mj=gj&&gj.v8,oo,h1;mj&&(oo=mj.split("."),h1=oo[0]>0&&oo[0]<4?1:+(oo[0]+oo[1]));!h1&&UE&&(oo=UE.match(/Edge\/(\d+)/),(!oo||oo[1]>=74)&&(oo=UE.match(/Chrome\/(\d+)/),oo&&(h1=+oo[1])));var VOe=h1,pj=VOe,UOe=Bs,WOe=Bn,zOe=WOe.String,GI=!!Object.getOwnPropertySymbols&&!UOe(function(){var t=Symbol("symbol detection");return!zOe(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&pj&&pj<41}),GOe=GI,k9=GOe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",YOe=Y0,KOe=ii,XOe=A9,qOe=k9,JOe=Object,YI=qOe?function(t){return typeof t=="symbol"}:function(t){var e=YOe("Symbol");return KOe(e)&&XOe(e.prototype,JOe(t))},ZOe=String,I9=function(t){try{return ZOe(t)}catch{return"Object"}},QOe=ii,eke=I9,tke=TypeError,KI=function(t){if(QOe(t))return t;throw new tke(eke(t)+" is not a function")},rke=KI,nke=R9,ike=function(t,e){var r=t[e];return nke(r)?void 0:rke(r)},WE=bS,zE=ii,GE=Rc,ske=TypeError,oke=function(t,e){var r,n;if(e==="string"&&zE(r=t.toString)&&!GE(n=WE(r,t))||zE(r=t.valueOf)&&!GE(n=WE(r,t))||e!=="string"&&zE(r=t.toString)&&!GE(n=WE(r,t)))return n;throw new ske("Can't convert object to primitive value")},N9={exports:{}},vj=Bn,ake=Object.defineProperty,XI=function(t,e){try{ake(vj,t,{value:e,configurable:!0,writable:!0})}catch{vj[t]=e}return e},lke=Bn,cke=XI,yj="__core-js_shared__",wj=N9.exports=lke[yj]||cke(yj,{});(wj.versions||(wj.versions=[])).push({version:"3.41.0",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var qI=N9.exports,xj=qI,M9=function(t,e){return xj[t]||(xj[t]=e||{})},uke=zI,hke=Object,ES=function(t){return hke(uke(t))},dke=_i,fke=ES,gke=dke({}.hasOwnProperty),hl=Object.hasOwn||function(e,r){return gke(fke(e),r)},mke=_i,pke=0,vke=Math.random(),yke=mke(1 .toString),P9=function(t){return"Symbol("+(t===void 0?"":t)+")_"+yke(++pke+vke,36)},wke=Bn,xke=M9,bj=hl,bke=P9,Ske=GI,Cke=k9,dd=wke.Symbol,YE=xke("wks"),Eke=Cke?dd.for||dd:dd&&dd.withoutSetter||bke,TS=function(t){return bj(YE,t)||(YE[t]=Ske&&bj(dd,t)?dd[t]:Eke("Symbol."+t)),YE[t]},Tke=bS,Sj=Rc,Cj=YI,_ke=ike,Rke=oke,Ake=TS,Oke=TypeError,kke=Ake("toPrimitive"),Ike=function(t,e){if(!Sj(t)||Cj(t))return t;var r=_ke(t,kke),n;if(r){if(e===void 0&&(e="default"),n=Tke(r,t,e),!Sj(n)||Cj(n))return n;throw new Oke("Can't convert object to primitive value")}return e===void 0&&(e="number"),Rke(t,e)},Nke=Ike,Mke=YI,D9=function(t){var e=Nke(t,"string");return Mke(e)?e:e+""},Pke=Bn,Ej=Rc,xO=Pke.document,Dke=Ej(xO)&&Ej(xO.createElement),JI=function(t){return Dke?xO.createElement(t):{}},Lke=oa,Fke=Bs,$ke=JI,L9=!Lke&&!Fke(function(){return Object.defineProperty($ke("div"),"a",{get:function(){return 7}}).a!==7}),Hke=oa,jke=bS,Bke=b9,Vke=WI,Uke=SS,Wke=D9,zke=hl,Gke=L9,Tj=Object.getOwnPropertyDescriptor;UI.f=Hke?Tj:function(e,r){if(e=Uke(e),r=Wke(r),Gke)try{return Tj(e,r)}catch{}if(zke(e,r))return Vke(!jke(Bke.f,e,r),e[r])};var ih={},Yke=oa,Kke=Bs,F9=Yke&&Kke(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Xke=Rc,qke=String,Jke=TypeError,_S=function(t){if(Xke(t))return t;throw new Jke(qke(t)+" is not an object")},Zke=oa,Qke=L9,e2e=F9,ny=_S,_j=D9,t2e=TypeError,KE=Object.defineProperty,r2e=Object.getOwnPropertyDescriptor,XE="enumerable",qE="configurable",JE="writable";ih.f=Zke?e2e?function(e,r,n){if(ny(e),r=_j(r),ny(n),typeof e=="function"&&r==="prototype"&&"value"in n&&JE in n&&!n[JE]){var i=r2e(e,r);i&&i[JE]&&(e[r]=n.value,n={configurable:qE in n?n[qE]:i[qE],enumerable:XE in n?n[XE]:i[XE],writable:!1})}return KE(e,r,n)}:KE:function(e,r,n){if(ny(e),r=_j(r),ny(n),Qke)try{return KE(e,r,n)}catch{}if("get"in n||"set"in n)throw new t2e("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var n2e=oa,i2e=ih,s2e=WI,K0=n2e?function(t,e,r){return i2e.f(t,e,s2e(1,r))}:function(t,e,r){return t[e]=r,t},$9={exports:{}},bO=oa,o2e=hl,H9=Function.prototype,a2e=bO&&Object.getOwnPropertyDescriptor,l2e=o2e(H9,"name"),c2e=l2e&&(!bO||bO&&a2e(H9,"name").configurable),u2e={CONFIGURABLE:c2e},h2e=_i,d2e=ii,SO=qI,f2e=h2e(Function.toString);d2e(SO.inspectSource)||(SO.inspectSource=function(t){return f2e(t)});var g2e=SO.inspectSource,m2e=Bn,p2e=ii,Rj=m2e.WeakMap,v2e=p2e(Rj)&&/native code/.test(String(Rj)),y2e=M9,w2e=P9,Aj=y2e("keys"),j9=function(t){return Aj[t]||(Aj[t]=w2e(t))},ZI={},x2e=v2e,B9=Bn,b2e=K0,ZE=hl,QE=qI,S2e=j9,C2e=ZI,Oj="Object already initialized",kj=B9.TypeError,E2e=B9.WeakMap,CO,d1,EO,T2e=function(t){return EO(t)?d1(t):CO(t,{})};if(x2e||QE.state){var To=QE.state||(QE.state=new E2e);To.get=To.get,To.has=To.has,To.set=To.set,CO=function(t,e){if(To.has(t))throw new kj(Oj);return e.facade=t,To.set(t,e),e},d1=function(t){return To.get(t)||{}},EO=function(t){return To.has(t)}}else{var Ch=S2e("state");C2e[Ch]=!0,CO=function(t,e){if(ZE(t,Ch))throw new kj(Oj);return e.facade=t,b2e(t,Ch,e),e},d1=function(t){return ZE(t,Ch)?t[Ch]:{}},EO=function(t){return ZE(t,Ch)}}var _2e={get:d1,enforce:T2e},QI=_i,R2e=Bs,A2e=ii,iy=hl,TO=oa,O2e=u2e.CONFIGURABLE,k2e=g2e,V9=_2e,I2e=V9.enforce,N2e=V9.get,Ij=String,xw=Object.defineProperty,M2e=QI("".slice),P2e=QI("".replace),D2e=QI([].join),L2e=TO&&!R2e(function(){return xw(function(){},"length",{value:8}).length!==8}),F2e=String(String).split("String"),$2e=$9.exports=function(t,e,r){M2e(Ij(e),0,7)==="Symbol("&&(e="["+P2e(Ij(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!iy(t,"name")||O2e&&t.name!==e)&&(TO?xw(t,"name",{value:e,configurable:!0}):t.name=e),L2e&&r&&iy(r,"arity")&&t.length!==r.arity&&xw(t,"length",{value:r.arity});try{r&&iy(r,"constructor")&&r.constructor?TO&&xw(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=I2e(t);return iy(n,"source")||(n.source=D2e(F2e,typeof e=="string"?e:"")),t};Function.prototype.toString=$2e(function(){return A2e(this)&&N2e(this).source||k2e(this)},"toString");var H2e=$9.exports,j2e=ii,B2e=ih,V2e=H2e,U2e=XI,W2e=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(j2e(r)&&V2e(r,s,n),n.global)i?t[e]=r:U2e(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:B2e.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},U9={},z2e=Math.ceil,G2e=Math.floor,Y2e=Math.trunc||function(e){var r=+e;return(r>0?G2e:z2e)(r)},K2e=Y2e,eN=function(t){var e=+t;return e!==e||e===0?0:K2e(e)},X2e=eN,q2e=Math.max,J2e=Math.min,Z2e=function(t,e){var r=X2e(t);return r<0?q2e(r+e,0):J2e(r,e)},Q2e=eN,eIe=Math.min,tIe=function(t){var e=Q2e(t);return e>0?eIe(e,9007199254740991):0},rIe=tIe,RS=function(t){return rIe(t.length)},nIe=SS,iIe=Z2e,sIe=RS,oIe=function(t){return function(e,r,n){var i=nIe(e),s=sIe(i);if(s===0)return!t&&-1;var o=iIe(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},aIe={indexOf:oIe(!1)},lIe=_i,eT=hl,cIe=SS,uIe=aIe.indexOf,hIe=ZI,Nj=lIe([].push),W9=function(t,e){var r=cIe(t),n=0,i=[],s;for(s in r)!eT(hIe,s)&&eT(r,s)&&Nj(i,s);for(;e.length>n;)eT(r,s=e[n++])&&(~uIe(i,s)||Nj(i,s));return i},tN=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dIe=W9,fIe=tN,gIe=fIe.concat("length","prototype");U9.f=Object.getOwnPropertyNames||function(e){return dIe(e,gIe)};var z9={};z9.f=Object.getOwnPropertySymbols;var mIe=Y0,pIe=_i,vIe=U9,yIe=z9,wIe=_S,xIe=pIe([].concat),bIe=mIe("Reflect","ownKeys")||function(e){var r=vIe.f(wIe(e)),n=yIe.f;return n?xIe(r,n(e)):r},Mj=hl,SIe=bIe,CIe=UI,EIe=ih,G9=function(t,e,r){for(var n=SIe(e),i=EIe.f,s=CIe.f,o=0;o<n.length;o++){var a=n[o];!Mj(t,a)&&!(r&&Mj(r,a))&&i(t,a,s(e,a))}},TIe=Bs,_Ie=ii,RIe=/#|\.prototype\./,X0=function(t,e){var r=OIe[AIe(t)];return r===IIe?!0:r===kIe?!1:_Ie(e)?TIe(e):!!e},AIe=X0.normalize=function(t){return String(t).replace(RIe,".").toLowerCase()},OIe=X0.data={},kIe=X0.NATIVE="N",IIe=X0.POLYFILL="P",NIe=X0,sy=Bn,MIe=UI.f,PIe=K0,DIe=W2e,LIe=XI,FIe=G9,$Ie=NIe,sh=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,l,c,u;if(n?o=sy:i?o=sy[r]||LIe(r,{}):o=sy[r]&&sy[r].prototype,o)for(a in e){if(c=e[a],t.dontCallGetSet?(u=MIe(o,a),l=u&&u.value):l=o[a],s=$Ie(n?a:r+(i?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof c==typeof l)continue;FIe(c,l)}(t.sham||l&&l.sham)&&PIe(c,"sham",!0),DIe(o,a,c,t)}},HIe=Zf,Y9=Array.isArray||function(e){return HIe(e)==="Array"},jIe=oa,BIe=Y9,VIe=TypeError,UIe=Object.getOwnPropertyDescriptor,WIe=jIe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),K9=WIe?function(t,e){if(BIe(t)&&!UIe(t,"length").writable)throw new VIe("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},zIe=TypeError,GIe=9007199254740991,X9=function(t){if(t>GIe)throw zIe("Maximum allowed index exceeded");return t},YIe=sh,KIe=ES,XIe=RS,qIe=K9,JIe=X9,ZIe=Bs,QIe=ZIe(function(){return[].push.call({length:4294967296},1)!==4294967297}),eNe=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},tNe=QIe||!eNe();YIe({target:"Array",proto:!0,arity:1,forced:tNe},{push:function(e){var r=KIe(this),n=XIe(r),i=arguments.length;JIe(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return qIe(r,n),n}});var rNe=xS,q9=Function.prototype,Pj=q9.apply,Dj=q9.call,AS=typeof Reflect=="object"&&Reflect.apply||(rNe?Dj.bind(Pj):function(){return Dj.apply(Pj,arguments)}),nNe=_i,iNe=KI,sNe=function(t,e,r){try{return nNe(iNe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},oNe=Rc,aNe=function(t){return oNe(t)||t===null},lNe=aNe,cNe=String,uNe=TypeError,hNe=function(t){if(lNe(t))return t;throw new uNe("Can't set "+cNe(t)+" as a prototype")},dNe=sNe,fNe=Rc,gNe=zI,mNe=hNe,J9=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=dNe(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return gNe(i),mNe(s),fNe(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),pNe=ih.f,vNe=function(t,e,r){r in t||pNe(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},yNe=ii,wNe=Rc,Lj=J9,xNe=function(t,e,r){var n,i;return Lj&&yNe(n=e.constructor)&&n!==r&&wNe(i=n.prototype)&&i!==r.prototype&&Lj(t,i),t},bNe=TS,SNe=bNe("toStringTag"),Z9={};Z9[SNe]="z";var CNe=String(Z9)==="[object z]",ENe=CNe,TNe=ii,bw=Zf,_Ne=TS,RNe=_Ne("toStringTag"),ANe=Object,ONe=bw(function(){return arguments}())==="Arguments",kNe=function(t,e){try{return t[e]}catch{}},INe=ENe?bw:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=kNe(e=ANe(t),RNe))=="string"?r:ONe?bw(e):(n=bw(e))==="Object"&&TNe(e.callee)?"Arguments":n},NNe=INe,MNe=String,Q9=function(t){if(NNe(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return MNe(t)},PNe=Q9,DNe=function(t,e){return t===void 0?arguments.length<2?"":e:PNe(t)},LNe=Rc,FNe=K0,$Ne=function(t,e){LNe(e)&&"cause"in e&&FNe(t,"cause",e.cause)},HNe=_i,eG=Error,jNe=HNe("".replace),BNe=function(t){return String(new eG(t).stack)}("zxcasd"),tG=/\n\s*at [^:]*:[^\n]*/,VNe=tG.test(BNe),UNe=function(t,e){if(VNe&&typeof t=="string"&&!eG.prepareStackTrace)for(;e--;)t=jNe(t,tG,"");return t},WNe=Bs,zNe=WI,GNe=!WNe(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",zNe(1,7)),t.stack!==7):!0}),YNe=K0,KNe=UNe,XNe=GNe,Fj=Error.captureStackTrace,qNe=function(t,e,r,n){XNe&&(Fj?Fj(t,e):YNe(t,"stack",KNe(r,n)))},$j=Y0,JNe=hl,Hj=K0,ZNe=A9,jj=J9,Bj=G9,Vj=vNe,QNe=xNe,eMe=DNe,tMe=$Ne,rMe=qNe,nMe=oa,iMe=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],l=$j.apply(null,o);if(l){var c=l.prototype;if(JNe(c,"cause")&&delete c.cause,!r)return l;var u=$j("Error"),h=e(function(d,f){var m=eMe(n?f:d,void 0),g=n?new l(d):new l;return m!==void 0&&Hj(g,"message",m),rMe(g,h,g.stack,2),this&&ZNe(c,this)&&QNe(g,this,h),arguments.length>s&&tMe(g,arguments[s]),g});h.prototype=c,a!=="Error"?jj?jj(h,u):Bj(h,u,{name:!0}):nMe&&i in l&&(Vj(h,l,i),Vj(h,l,"prepareStackTrace")),Bj(h,l);try{c.name!==a&&Hj(c,"name",a),c.constructor=h}catch{}return h}},rG=sh,sMe=Bn,aa=AS,nG=iMe,_O="WebAssembly",Uj=sMe[_O],f1=new Error("e",{cause:7}).cause!==7,oh=function(t,e){var r={};r[t]=nG(t,e,f1),rG({global:!0,constructor:!0,arity:1,forced:f1},r)},rN=function(t,e){if(Uj&&Uj[t]){var r={};r[t]=nG(_O+"."+t,e,f1),rG({target:_O,stat:!0,constructor:!0,arity:1,forced:f1},r)}};oh("Error",function(t){return function(r){return aa(t,this,arguments)}});oh("EvalError",function(t){return function(r){return aa(t,this,arguments)}});oh("RangeError",function(t){return function(r){return aa(t,this,arguments)}});oh("ReferenceError",function(t){return function(r){return aa(t,this,arguments)}});oh("SyntaxError",function(t){return function(r){return aa(t,this,arguments)}});oh("TypeError",function(t){return function(r){return aa(t,this,arguments)}});oh("URIError",function(t){return function(r){return aa(t,this,arguments)}});rN("CompileError",function(t){return function(r){return aa(t,this,arguments)}});rN("LinkError",function(t){return function(r){return aa(t,this,arguments)}});rN("RuntimeError",function(t){return function(r){return aa(t,this,arguments)}});var oMe=Zf,aMe=_i,lMe=function(t){if(oMe(t)==="Function")return aMe(t)},Wj=lMe,cMe=KI,uMe=xS,hMe=Wj(Wj.bind),dMe=function(t,e){return cMe(t),e===void 0?t:uMe?hMe(t,e):function(){return t.apply(e,arguments)}},fMe=Y0,iG=fMe("document","documentElement"),gMe=_i,nN=gMe([].slice),mMe=TypeError,sG=function(t,e){if(t<e)throw new mMe("Not enough arguments");return t},pMe=CS,vMe=/(?:ipad|iphone|ipod).*applewebkit/i.test(pMe),Mg=Bn,yMe=CS,wMe=Zf,oy=function(t){return yMe.slice(0,t.length)===t},oG=function(){return oy("Bun/")?"BUN":oy("Cloudflare-Workers")?"CLOUDFLARE":oy("Deno/")?"DENO":oy("Node.js/")?"NODE":Mg.Bun&&typeof Bun.version=="string"?"BUN":Mg.Deno&&typeof Deno.version=="object"?"DENO":wMe(Mg.process)==="process"?"NODE":Mg.window&&Mg.document?"BROWSER":"REST"}(),xMe=oG,bMe=xMe==="NODE",rs=Bn,SMe=AS,CMe=dMe,zj=ii,EMe=hl,aG=Bs,Gj=iG,TMe=nN,Yj=JI,_Me=sG,RMe=vMe,AMe=bMe,RO=rs.setImmediate,AO=rs.clearImmediate,OMe=rs.process,tT=rs.Dispatch,kMe=rs.Function,Kj=rs.MessageChannel,IMe=rs.String,rT=0,Pm={},Xj="onreadystatechange",r0,Lc,nT,iT;aG(function(){r0=rs.location});var iN=function(t){if(EMe(Pm,t)){var e=Pm[t];delete Pm[t],e()}},sT=function(t){return function(){iN(t)}},qj=function(t){iN(t.data)},Jj=function(t){rs.postMessage(IMe(t),r0.protocol+"//"+r0.host)};(!RO||!AO)&&(RO=function(e){_Me(arguments.length,1);var r=zj(e)?e:kMe(e),n=TMe(arguments,1);return Pm[++rT]=function(){SMe(r,void 0,n)},Lc(rT),rT},AO=function(e){delete Pm[e]},AMe?Lc=function(t){OMe.nextTick(sT(t))}:tT&&tT.now?Lc=function(t){tT.now(sT(t))}:Kj&&!RMe?(nT=new Kj,iT=nT.port2,nT.port1.onmessage=qj,Lc=CMe(iT.postMessage,iT)):rs.addEventListener&&zj(rs.postMessage)&&!rs.importScripts&&r0&&r0.protocol!=="file:"&&!aG(Jj)?(Lc=Jj,rs.addEventListener("message",qj,!1)):Xj in Yj("script")?Lc=function(t){Gj.appendChild(Yj("script"))[Xj]=function(){Gj.removeChild(this),iN(t)}}:Lc=function(t){setTimeout(sT(t),0)});var lG={set:RO,clear:AO},NMe=sh,MMe=Bn,Zj=lG.clear;NMe({global:!0,bind:!0,enumerable:!0,forced:MMe.clearImmediate!==Zj},{clearImmediate:Zj});var cG=Bn,PMe=AS,DMe=ii,LMe=oG,FMe=CS,$Me=nN,HMe=sG,jMe=cG.Function,BMe=/MSIE .\./.test(FMe)||LMe==="BUN"&&function(){var t=cG.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),VMe=function(t,e){var r=e?2:1;return BMe?function(n,i){var s=HMe(arguments.length,1)>r,o=DMe(n)?n:jMe(n),a=s?$Me(arguments,r):[],l=s?function(){PMe(o,this,a)}:o;return e?t(l,i):t(l)}:t},UMe=sh,uG=Bn,Qj=lG.set,WMe=VMe,e3=uG.setImmediate?WMe(Qj,!1):Qj;UMe({global:!0,bind:!0,enumerable:!0,forced:uG.setImmediate!==e3},{setImmediate:e3});/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */function Hl(t){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hl(t)}function OO(t,e){return OO=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},OO(t,e)}function zMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sw(t,e,r){return zMe()?Sw=Reflect.construct:Sw=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),c=new l;return o&&OO(c,o.prototype),c},Sw.apply(null,arguments)}function eo(t){return GMe(t)||YMe(t)||KMe(t)||XMe()}function GMe(t){if(Array.isArray(t))return kO(t)}function YMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function KMe(t,e){if(t){if(typeof t=="string")return kO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kO(t,e)}}function kO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function XMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var qMe=Object.hasOwnProperty,t3=Object.setPrototypeOf,JMe=Object.isFrozen,ZMe=Object.getPrototypeOf,QMe=Object.getOwnPropertyDescriptor,bi=Object.freeze,Ds=Object.seal,ePe=Object.create,hG=typeof Reflect<"u"&&Reflect,g1=hG.apply,IO=hG.construct;g1||(g1=function(e,r,n){return e.apply(r,n)});bi||(bi=function(e){return e});Ds||(Ds=function(e){return e});IO||(IO=function(e,r){return Sw(e,eo(r))});var tPe=Ls(Array.prototype.forEach),r3=Ls(Array.prototype.pop),Pg=Ls(Array.prototype.push),Cw=Ls(String.prototype.toLowerCase),oT=Ls(String.prototype.toString),n3=Ls(String.prototype.match),Xs=Ls(String.prototype.replace),rPe=Ls(String.prototype.indexOf),nPe=Ls(String.prototype.trim),Nn=Ls(RegExp.prototype.test),aT=iPe(TypeError);function Ls(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return g1(t,e,n)}}function iPe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return IO(t,r)}}function Ct(t,e,r){var n;r=(n=r)!==null&&n!==void 0?n:Cw,t3&&t3(t,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var o=r(s);o!==s&&(JMe(e)||(e[i]=o),s=o)}t[s]=!0}return t}function Fc(t){var e=ePe(null),r;for(r in t)g1(qMe,t,[r])===!0&&(e[r]=t[r]);return e}function ay(t,e){for(;t!==null;){var r=QMe(t,e);if(r){if(r.get)return Ls(r.get);if(typeof r.value=="function")return Ls(r.value)}t=ZMe(t)}function n(i){return console.warn("fallback value for",i),null}return n}var i3=bi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lT=bi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),cT=bi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),sPe=bi(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uT=bi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),oPe=bi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),s3=bi(["#text"]),o3=bi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),hT=bi(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),a3=bi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ly=bi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),aPe=Ds(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lPe=Ds(/<%[\w\W]*|[\w\W]*%>/gm),cPe=Ds(/\${[\w\W]*}/gm),uPe=Ds(/^data-[\-\w.\u00B7-\uFFFF]+$/),hPe=Ds(/^aria-[\-\w]+$/),dPe=Ds(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fPe=Ds(/^(?:\w+script|data):/i),gPe=Ds(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mPe=Ds(/^html$/i),pPe=Ds(/^[a-z][.\w]*(-[.\w]+)+$/i),vPe=function(){return typeof window>"u"?null:window},yPe=function(e,r){if(Hl(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function dG(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vPe(),e=function(ee){return dG(ee)};if(e.version="2.5.8",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,s=t.HTMLTemplateElement,o=t.Node,a=t.Element,l=t.NodeFilter,c=t.NamedNodeMap,u=c===void 0?t.NamedNodeMap||t.MozNamedAttrMap:c,h=t.HTMLFormElement,d=t.DOMParser,f=t.trustedTypes,m=a.prototype,g=ay(m,"cloneNode"),v=ay(m,"nextSibling"),w=ay(m,"childNodes"),b=ay(m,"parentNode");if(typeof s=="function"){var x=n.createElement("template");x.content&&x.content.ownerDocument&&(n=x.content.ownerDocument)}var C=yPe(f,r),S=C?C.createHTML(""):"",E=n,T=E.implementation,I=E.createNodeIterator,k=E.createDocumentFragment,M=E.getElementsByTagName,D=r.importNode,L={};try{L=Fc(n).documentMode?n.documentMode:{}}catch{}var U={};e.isSupported=typeof b=="function"&&T&&T.createHTMLDocument!==void 0&&L!==9;var J=aPe,X=lPe,ie=cPe,se=uPe,P=hPe,y=fPe,_=gPe,R=pPe,A=dPe,O=null,N=Ct({},[].concat(eo(i3),eo(lT),eo(cT),eo(uT),eo(s3))),F=null,j=Ct({},[].concat(eo(o3),eo(hT),eo(a3),eo(ly))),z=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,W=null,ae=!0,ye=!0,H=!1,Re=!0,ue=!1,Pe=!0,ke=!1,be=!1,Fe=!1,He=!1,V=!1,K=!1,te=!0,ve=!1,le="user-content-",ce=!0,me=!1,de={},fe=null,ge=Ct({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),pe=null,Ie=Ct({},["audio","video","img","source","image","track"]),je=null,Be=Ct({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Je="http://www.w3.org/1998/Math/MathML",it="http://www.w3.org/2000/svg",Rt="http://www.w3.org/1999/xhtml",ot=Rt,Et=!1,rr=null,ds=Ct({},[Je,it,Rt],oT),Vn,Co=["application/xhtml+xml","text/html"],en="text/html",Wt,Cr=null,jr=n.createElement("form"),Ve=function(ee){return ee instanceof RegExp||ee instanceof Function},Ot=function(ee){Cr&&Cr===ee||((!ee||Hl(ee)!=="object")&&(ee={}),ee=Fc(ee),Vn=Co.indexOf(ee.PARSER_MEDIA_TYPE)===-1?Vn=en:Vn=ee.PARSER_MEDIA_TYPE,Wt=Vn==="application/xhtml+xml"?oT:Cw,O="ALLOWED_TAGS"in ee?Ct({},ee.ALLOWED_TAGS,Wt):N,F="ALLOWED_ATTR"in ee?Ct({},ee.ALLOWED_ATTR,Wt):j,rr="ALLOWED_NAMESPACES"in ee?Ct({},ee.ALLOWED_NAMESPACES,oT):ds,je="ADD_URI_SAFE_ATTR"in ee?Ct(Fc(Be),ee.ADD_URI_SAFE_ATTR,Wt):Be,pe="ADD_DATA_URI_TAGS"in ee?Ct(Fc(Ie),ee.ADD_DATA_URI_TAGS,Wt):Ie,fe="FORBID_CONTENTS"in ee?Ct({},ee.FORBID_CONTENTS,Wt):ge,Q="FORBID_TAGS"in ee?Ct({},ee.FORBID_TAGS,Wt):{},W="FORBID_ATTR"in ee?Ct({},ee.FORBID_ATTR,Wt):{},de="USE_PROFILES"in ee?ee.USE_PROFILES:!1,ae=ee.ALLOW_ARIA_ATTR!==!1,ye=ee.ALLOW_DATA_ATTR!==!1,H=ee.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=ee.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ue=ee.SAFE_FOR_TEMPLATES||!1,Pe=ee.SAFE_FOR_XML!==!1,ke=ee.WHOLE_DOCUMENT||!1,He=ee.RETURN_DOM||!1,V=ee.RETURN_DOM_FRAGMENT||!1,K=ee.RETURN_TRUSTED_TYPE||!1,Fe=ee.FORCE_BODY||!1,te=ee.SANITIZE_DOM!==!1,ve=ee.SANITIZE_NAMED_PROPS||!1,ce=ee.KEEP_CONTENT!==!1,me=ee.IN_PLACE||!1,A=ee.ALLOWED_URI_REGEXP||A,ot=ee.NAMESPACE||Rt,z=ee.CUSTOM_ELEMENT_HANDLING||{},ee.CUSTOM_ELEMENT_HANDLING&&Ve(ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(z.tagNameCheck=ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ee.CUSTOM_ELEMENT_HANDLING&&Ve(ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(z.attributeNameCheck=ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ee.CUSTOM_ELEMENT_HANDLING&&typeof ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(z.allowCustomizedBuiltInElements=ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ue&&(ye=!1),V&&(He=!0),de&&(O=Ct({},eo(s3)),F=[],de.html===!0&&(Ct(O,i3),Ct(F,o3)),de.svg===!0&&(Ct(O,lT),Ct(F,hT),Ct(F,ly)),de.svgFilters===!0&&(Ct(O,cT),Ct(F,hT),Ct(F,ly)),de.mathMl===!0&&(Ct(O,uT),Ct(F,a3),Ct(F,ly))),ee.ADD_TAGS&&(O===N&&(O=Fc(O)),Ct(O,ee.ADD_TAGS,Wt)),ee.ADD_ATTR&&(F===j&&(F=Fc(F)),Ct(F,ee.ADD_ATTR,Wt)),ee.ADD_URI_SAFE_ATTR&&Ct(je,ee.ADD_URI_SAFE_ATTR,Wt),ee.FORBID_CONTENTS&&(fe===ge&&(fe=Fc(fe)),Ct(fe,ee.FORBID_CONTENTS,Wt)),ce&&(O["#text"]=!0),ke&&Ct(O,["html","head","body"]),O.table&&(Ct(O,["tbody"]),delete Q.tbody),bi&&bi(ee),Cr=ee)},nr=Ct({},["mi","mo","mn","ms","mtext"]),kr=Ct({},["annotation-xml"]),fr=Ct({},["title","style","font","a","script"]),ir=Ct({},lT);Ct(ir,cT),Ct(ir,sPe);var Er=Ct({},uT);Ct(Er,oPe);var Oi=function(ee){var xe=b(ee);(!xe||!xe.tagName)&&(xe={namespaceURI:ot,tagName:"template"});var we=Cw(ee.tagName),Ne=Cw(xe.tagName);return rr[ee.namespaceURI]?ee.namespaceURI===it?xe.namespaceURI===Rt?we==="svg":xe.namespaceURI===Je?we==="svg"&&(Ne==="annotation-xml"||nr[Ne]):!!ir[we]:ee.namespaceURI===Je?xe.namespaceURI===Rt?we==="math":xe.namespaceURI===it?we==="math"&&kr[Ne]:!!Er[we]:ee.namespaceURI===Rt?xe.namespaceURI===it&&!kr[Ne]||xe.namespaceURI===Je&&!nr[Ne]?!1:!Er[we]&&(fr[we]||!ir[we]):!!(Vn==="application/xhtml+xml"&&rr[ee.namespaceURI]):!1},Kt=function(ee){Pg(e.removed,{element:ee});try{ee.parentNode.removeChild(ee)}catch{try{ee.outerHTML=S}catch{ee.remove()}}},B=function(ee,xe){try{Pg(e.removed,{attribute:xe.getAttributeNode(ee),from:xe})}catch{Pg(e.removed,{attribute:null,from:xe})}if(xe.removeAttribute(ee),ee==="is"&&!F[ee])if(He||V)try{Kt(xe)}catch{}else try{xe.setAttribute(ee,"")}catch{}},Z=function(ee){var xe,we;if(Fe)ee="<remove></remove>"+ee;else{var Ne=n3(ee,/^[\r\n\t ]+/);we=Ne&&Ne[0]}Vn==="application/xhtml+xml"&&ot===Rt&&(ee='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ee+"</body></html>");var We=C?C.createHTML(ee):ee;if(ot===Rt)try{xe=new d().parseFromString(We,Vn)}catch{}if(!xe||!xe.documentElement){xe=T.createDocument(ot,"template",null);try{xe.documentElement.innerHTML=Et?S:We}catch{}}var St=xe.body||xe.documentElement;return ee&&we&&St.insertBefore(n.createTextNode(we),St.childNodes[0]||null),ot===Rt?M.call(xe,ke?"html":"body")[0]:ke?xe.documentElement:St},Y=function(ee){return I.call(ee.ownerDocument||ee,ee,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},q=function(ee){return ee instanceof h&&(typeof ee.nodeName!="string"||typeof ee.textContent!="string"||typeof ee.removeChild!="function"||!(ee.attributes instanceof u)||typeof ee.removeAttribute!="function"||typeof ee.setAttribute!="function"||typeof ee.namespaceURI!="string"||typeof ee.insertBefore!="function"||typeof ee.hasChildNodes!="function")},re=function(ee){return Hl(o)==="object"?ee instanceof o:ee&&Hl(ee)==="object"&&typeof ee.nodeType=="number"&&typeof ee.nodeName=="string"},ne=function(ee,xe,we){U[ee]&&tPe(U[ee],function(Ne){Ne.call(e,xe,we,Cr)})},Ce=function(ee){var xe;if(ne("beforeSanitizeElements",ee,null),q(ee)||Nn(/[\u0080-\uFFFF]/,ee.nodeName))return Kt(ee),!0;var we=Wt(ee.nodeName);if(ne("uponSanitizeElement",ee,{tagName:we,allowedTags:O}),ee.hasChildNodes()&&!re(ee.firstElementChild)&&(!re(ee.content)||!re(ee.content.firstElementChild))&&Nn(/<[/\w]/g,ee.innerHTML)&&Nn(/<[/\w]/g,ee.textContent)||we==="select"&&Nn(/<template/i,ee.innerHTML)||ee.nodeType===7||Pe&&ee.nodeType===8&&Nn(/<[/\w]/g,ee.data))return Kt(ee),!0;if(!O[we]||Q[we]){if(!Q[we]&&Se(we)&&(z.tagNameCheck instanceof RegExp&&Nn(z.tagNameCheck,we)||z.tagNameCheck instanceof Function&&z.tagNameCheck(we)))return!1;if(ce&&!fe[we]){var Ne=b(ee)||ee.parentNode,We=w(ee)||ee.childNodes;if(We&&Ne)for(var St=We.length,gt=St-1;gt>=0;--gt){var Tr=g(We[gt],!0);Tr.__removalCount=(ee.__removalCount||0)+1,Ne.insertBefore(Tr,v(ee))}}return Kt(ee),!0}return ee instanceof a&&!Oi(ee)||(we==="noscript"||we==="noembed"||we==="noframes")&&Nn(/<\/no(script|embed|frames)/i,ee.innerHTML)?(Kt(ee),!0):(ue&&ee.nodeType===3&&(xe=ee.textContent,xe=Xs(xe,J," "),xe=Xs(xe,X," "),xe=Xs(xe,ie," "),ee.textContent!==xe&&(Pg(e.removed,{element:ee.cloneNode()}),ee.textContent=xe)),ne("afterSanitizeElements",ee,null),!1)},Ae=function(ee,xe,we){if(te&&(xe==="id"||xe==="name")&&(we in n||we in jr))return!1;if(!(ye&&!W[xe]&&Nn(se,xe))){if(!(ae&&Nn(P,xe))){if(!F[xe]||W[xe]){if(!(Se(ee)&&(z.tagNameCheck instanceof RegExp&&Nn(z.tagNameCheck,ee)||z.tagNameCheck instanceof Function&&z.tagNameCheck(ee))&&(z.attributeNameCheck instanceof RegExp&&Nn(z.attributeNameCheck,xe)||z.attributeNameCheck instanceof Function&&z.attributeNameCheck(xe))||xe==="is"&&z.allowCustomizedBuiltInElements&&(z.tagNameCheck instanceof RegExp&&Nn(z.tagNameCheck,we)||z.tagNameCheck instanceof Function&&z.tagNameCheck(we))))return!1}else if(!je[xe]){if(!Nn(A,Xs(we,_,""))){if(!((xe==="src"||xe==="xlink:href"||xe==="href")&&ee!=="script"&&rPe(we,"data:")===0&&pe[ee])){if(!(H&&!Nn(y,Xs(we,_,"")))){if(we)return!1}}}}}}return!0},Se=function(ee){return ee!=="annotation-xml"&&n3(ee,R)},Ee=function(ee){var xe,we,Ne,We;ne("beforeSanitizeAttributes",ee,null);var St=ee.attributes;if(!(!St||q(ee))){var gt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F};for(We=St.length;We--;){xe=St[We];var Tr=xe,gr=Tr.name,da=Tr.namespaceURI;if(we=gr==="value"?xe.value:nPe(xe.value),Ne=Wt(gr),gt.attrName=Ne,gt.attrValue=we,gt.keepAttr=!0,gt.forceKeepAttr=void 0,ne("uponSanitizeAttribute",ee,gt),we=gt.attrValue,!gt.forceKeepAttr&&(B(gr,ee),!!gt.keepAttr)){if(!Re&&Nn(/\/>/i,we)){B(gr,ee);continue}ue&&(we=Xs(we,J," "),we=Xs(we,X," "),we=Xs(we,ie," "));var pl=Wt(ee.nodeName);if(Ae(pl,Ne,we)){if(ve&&(Ne==="id"||Ne==="name")&&(B(gr,ee),we=le+we),Pe&&Nn(/((--!?|])>)|<\/(style|title)/i,we)){B(gr,ee);continue}if(C&&Hl(f)==="object"&&typeof f.getAttributeType=="function"&&!da)switch(f.getAttributeType(pl,Ne)){case"TrustedHTML":{we=C.createHTML(we);break}case"TrustedScriptURL":{we=C.createScriptURL(we);break}}try{da?ee.setAttributeNS(da,gr,we):ee.setAttribute(gr,we),q(ee)?Kt(ee):r3(e.removed)}catch{}}}}ne("afterSanitizeAttributes",ee,null)}},_e=function Te(ee){var xe,we=Y(ee);for(ne("beforeSanitizeShadowDOM",ee,null);xe=we.nextNode();)ne("uponSanitizeShadowNode",xe,null),Ce(xe),Ee(xe),xe.content instanceof i&&Te(xe.content);ne("afterSanitizeShadowDOM",ee,null)};return e.sanitize=function(Te){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},xe,we,Ne,We,St;if(Et=!Te,Et&&(Te="<!-->"),typeof Te!="string"&&!re(Te))if(typeof Te.toString=="function"){if(Te=Te.toString(),typeof Te!="string")throw aT("dirty is not a string, aborting")}else throw aT("toString is not a function");if(!e.isSupported){if(Hl(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Te=="string")return t.toStaticHTML(Te);if(re(Te))return t.toStaticHTML(Te.outerHTML)}return Te}if(be||Ot(ee),e.removed=[],typeof Te=="string"&&(me=!1),me){if(Te.nodeName){var gt=Wt(Te.nodeName);if(!O[gt]||Q[gt])throw aT("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof o)xe=Z("<!---->"),we=xe.ownerDocument.importNode(Te,!0),we.nodeType===1&&we.nodeName==="BODY"||we.nodeName==="HTML"?xe=we:xe.appendChild(we);else{if(!He&&!ue&&!ke&&Te.indexOf("<")===-1)return C&&K?C.createHTML(Te):Te;if(xe=Z(Te),!xe)return He?null:K?S:""}xe&&Fe&&Kt(xe.firstChild);for(var Tr=Y(me?Te:xe);Ne=Tr.nextNode();)Ne.nodeType===3&&Ne===We||(Ce(Ne),Ee(Ne),Ne.content instanceof i&&_e(Ne.content),We=Ne);if(We=null,me)return Te;if(He){if(V)for(St=k.call(xe.ownerDocument);xe.firstChild;)St.appendChild(xe.firstChild);else St=xe;return(F.shadowroot||F.shadowrootmod)&&(St=D.call(r,St,!0)),St}var gr=ke?xe.outerHTML:xe.innerHTML;return ke&&O["!doctype"]&&xe.ownerDocument&&xe.ownerDocument.doctype&&xe.ownerDocument.doctype.name&&Nn(mPe,xe.ownerDocument.doctype.name)&&(gr="<!DOCTYPE "+xe.ownerDocument.doctype.name+`>
`+gr),ue&&(gr=Xs(gr,J," "),gr=Xs(gr,X," "),gr=Xs(gr,ie," ")),C&&K?C.createHTML(gr):gr},e.setConfig=function(Te){Ot(Te),be=!0},e.clearConfig=function(){Cr=null,be=!1},e.isValidAttribute=function(Te,ee,xe){Cr||Ot({});var we=Wt(Te),Ne=Wt(ee);return Ae(we,Ne,xe)},e.addHook=function(Te,ee){typeof ee=="function"&&(U[Te]=U[Te]||[],Pg(U[Te],ee))},e.removeHook=function(Te){if(U[Te])return r3(U[Te])},e.removeHooks=function(Te){U[Te]&&(U[Te]=[])},e.removeAllHooks=function(){U={}},e}var wPe=dG();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var fG;function Me(){return fG.apply(null,arguments)}function xPe(t){fG=t}function wo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Tu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function $t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function sN(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if($t(t,e))return!1;return!0}function ki(t){return t===void 0}function nl(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function q0(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function gG(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function zl(t,e){for(var r in e)$t(e,r)&&(t[r]=e[r]);return $t(e,"toString")&&(t.toString=e.toString),$t(e,"valueOf")&&(t.valueOf=e.valueOf),t}function la(t,e,r,n){return $G(t,e,r,n,!0).utc()}function bPe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function pt(t){return t._pf==null&&(t._pf=bPe()),t._pf}var NO;Array.prototype.some?NO=Array.prototype.some:NO=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function oN(t){if(t._isValid==null){var e=pt(t),r=NO.call(e.parsedDateParts,function(i){return i!=null}),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n}return t._isValid}function OS(t){var e=la(NaN);return t!=null?zl(pt(e),t):pt(e).userInvalidated=!0,e}var l3=Me.momentProperties=[],dT=!1;function aN(t,e){var r,n,i,s=l3.length;if(ki(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ki(e._i)||(t._i=e._i),ki(e._f)||(t._f=e._f),ki(e._l)||(t._l=e._l),ki(e._strict)||(t._strict=e._strict),ki(e._tzm)||(t._tzm=e._tzm),ki(e._isUTC)||(t._isUTC=e._isUTC),ki(e._offset)||(t._offset=e._offset),ki(e._pf)||(t._pf=pt(e)),ki(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=l3[r],i=e[n],ki(i)||(t[n]=i);return t}function J0(t){aN(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),dT===!1&&(dT=!0,Me.updateOffset(this),dT=!1)}function xo(t){return t instanceof J0||t!=null&&t._isAMomentObject!=null}function mG(t){Me.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Vs(t,e){var r=!0;return zl(function(){if(Me.deprecationHandler!=null&&Me.deprecationHandler(null,t),r){var n=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])$t(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}mG(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var c3={};function pG(t,e){Me.deprecationHandler!=null&&Me.deprecationHandler(t,e),c3[t]||(mG(e),c3[t]=!0)}Me.suppressDeprecationWarnings=!1;Me.deprecationHandler=null;function ca(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function SPe(t){var e,r;for(r in t)$t(t,r)&&(e=t[r],ca(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function MO(t,e){var r=zl({},t),n;for(n in e)$t(e,n)&&(Tu(t[n])&&Tu(e[n])?(r[n]={},zl(r[n],t[n]),zl(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)$t(t,n)&&!$t(e,n)&&Tu(t[n])&&(r[n]=zl({},r[n]));return r}function lN(t){t!=null&&this.set(t)}var PO;Object.keys?PO=Object.keys:PO=function(t){var e,r=[];for(e in t)$t(t,e)&&r.push(e);return r};var CPe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function EPe(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return ca(n)?n.call(e,r):n}function ea(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var cN=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,cy=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,fT={},kd={};function tt(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(kd[t]=i),e&&(kd[e[0]]=function(){return ea(i.apply(this,arguments),e[1],e[2])}),r&&(kd[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function TPe(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function _Pe(t){var e=t.match(cN),r,n;for(r=0,n=e.length;r<n;r++)kd[e[r]]?e[r]=kd[e[r]]:e[r]=TPe(e[r]);return function(i){var s="",o;for(o=0;o<n;o++)s+=ca(e[o])?e[o].call(i,t):e[o];return s}}function Ew(t,e){return t.isValid()?(e=vG(e,t.localeData()),fT[e]=fT[e]||_Pe(e),fT[e](t)):t.localeData().invalidDate()}function vG(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(cy.lastIndex=0;r>=0&&cy.test(t);)t=t.replace(cy,n),cy.lastIndex=0,r-=1;return t}var RPe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function APe(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(cN).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var OPe="Invalid date";function kPe(){return this._invalidDate}var IPe="%d",NPe=/\d{1,2}/;function MPe(t){return this._ordinal.replace("%d",t)}var PPe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function DPe(t,e,r,n){var i=this._relativeTime[r];return ca(i)?i(t,e,r,n):i.replace(/%d/i,t)}function LPe(t,e){var r=this._relativeTime[t>0?"future":"past"];return ca(r)?r(e):r.replace(/%s/i,e)}var Dm={};function si(t,e){var r=t.toLowerCase();Dm[r]=Dm[r+"s"]=Dm[e]=t}function Us(t){return typeof t=="string"?Dm[t]||Dm[t.toLowerCase()]:void 0}function uN(t){var e={},r,n;for(n in t)$t(t,n)&&(r=Us(n),r&&(e[r]=t[n]));return e}var yG={};function oi(t,e){yG[t]=e}function FPe(t){var e=[],r;for(r in t)$t(t,r)&&e.push({unit:r,priority:yG[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}function kS(t){return t%4===0&&t%100!==0||t%400===0}function Rs(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function _t(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Rs(e)),r}function Qf(t,e){return function(r){return r!=null?(wG(this,t,r),Me.updateOffset(this,e),this):m1(this,t)}}function m1(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function wG(t,e,r){t.isValid()&&!isNaN(r)&&(e==="FullYear"&&kS(t.year())&&t.month()===1&&t.date()===29?(r=_t(r),t._d["set"+(t._isUTC?"UTC":"")+e](r,t.month(),LS(r,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](r))}function $Pe(t){return t=Us(t),ca(this[t])?this[t]():this}function HPe(t,e){if(typeof t=="object"){t=uN(t);var r=FPe(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Us(t),ca(this[t]))return this[t](e);return this}var xG=/\d/,us=/\d\d/,bG=/\d{3}/,hN=/\d{4}/,IS=/[+-]?\d{6}/,Sr=/\d\d?/,SG=/\d\d\d\d?/,CG=/\d\d\d\d\d\d?/,NS=/\d{1,3}/,dN=/\d{1,4}/,MS=/[+-]?\d{1,6}/,eg=/\d+/,PS=/[+-]?\d+/,jPe=/Z|[+-]\d\d:?\d\d/gi,DS=/Z|[+-]\d\d(?::?\d\d)?/gi,BPe=/[+-]?\d+(\.\d{1,3})?/,Z0=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,p1;p1={};function Ke(t,e,r){p1[t]=ca(e)?e:function(n,i){return n&&r?r:e}}function VPe(t,e){return $t(p1,t)?p1[t](e._strict,e._locale):new RegExp(UPe(t))}function UPe(t){return Ji(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function Ji(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var DO={};function Zt(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),nl(e)&&(n=function(s,o){o[e]=_t(s)}),i=t.length,r=0;r<i;r++)DO[t[r]]=n}function Q0(t,e){Zt(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function WPe(t,e,r){e!=null&&$t(DO,t)&&DO[t](e,r._a,r,t)}var ei=0,La=1,Uo=2,pn=3,co=4,Fa=5,gu=6,zPe=7,GPe=8;function YPe(t,e){return(t%e+e)%e}var qr;Array.prototype.indexOf?qr=Array.prototype.indexOf:qr=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function LS(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=YPe(e,12);return t+=(e-r)/12,r===1?kS(t)?29:28:31-r%7%2}tt("M",["MM",2],"Mo",function(){return this.month()+1});tt("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});tt("MMMM",0,0,function(t){return this.localeData().months(this,t)});si("month","M");oi("month",8);Ke("M",Sr);Ke("MM",Sr,us);Ke("MMM",function(t,e){return e.monthsShortRegex(t)});Ke("MMMM",function(t,e){return e.monthsRegex(t)});Zt(["M","MM"],function(t,e){e[La]=_t(t)-1});Zt(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[La]=i:pt(r).invalidMonth=t});var KPe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),EG="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),TG=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,XPe=Z0,qPe=Z0;function JPe(t,e){return t?wo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||TG).test(e)?"format":"standalone"][t.month()]:wo(this._months)?this._months:this._months.standalone}function ZPe(t,e){return t?wo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[TG.test(e)?"format":"standalone"][t.month()]:wo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function QPe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=la([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=qr.call(this._shortMonthsParse,o),i!==-1?i:null):(i=qr.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=qr.call(this._shortMonthsParse,o),i!==-1?i:(i=qr.call(this._longMonthsParse,o),i!==-1?i:null)):(i=qr.call(this._longMonthsParse,o),i!==-1?i:(i=qr.call(this._shortMonthsParse,o),i!==-1?i:null))}function eDe(t,e,r){var n,i,s;if(this._monthsParseExact)return QPe.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=la([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function _G(t,e){var r;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=_t(e);else if(e=t.localeData().monthsParse(e),!nl(e))return t}return r=Math.min(t.date(),LS(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,r),t}function RG(t){return t!=null?(_G(this,t),Me.updateOffset(this,!0),this):m1(this,"Month")}function tDe(){return LS(this.year(),this.month())}function rDe(t){return this._monthsParseExact?($t(this,"_monthsRegex")||AG.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):($t(this,"_monthsShortRegex")||(this._monthsShortRegex=XPe),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function nDe(t){return this._monthsParseExact?($t(this,"_monthsRegex")||AG.call(this),t?this._monthsStrictRegex:this._monthsRegex):($t(this,"_monthsRegex")||(this._monthsRegex=qPe),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function AG(){function t(o,a){return a.length-o.length}var e=[],r=[],n=[],i,s;for(i=0;i<12;i++)s=la([2e3,i]),e.push(this.monthsShort(s,"")),r.push(this.months(s,"")),n.push(this.months(s,"")),n.push(this.monthsShort(s,""));for(e.sort(t),r.sort(t),n.sort(t),i=0;i<12;i++)e[i]=Ji(e[i]),r[i]=Ji(r[i]);for(i=0;i<24;i++)n[i]=Ji(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}tt("Y",0,0,function(){var t=this.year();return t<=9999?ea(t,4):"+"+t});tt(0,["YY",2],0,function(){return this.year()%100});tt(0,["YYYY",4],0,"year");tt(0,["YYYYY",5],0,"year");tt(0,["YYYYYY",6,!0],0,"year");si("year","y");oi("year",1);Ke("Y",PS);Ke("YY",Sr,us);Ke("YYYY",dN,hN);Ke("YYYYY",MS,IS);Ke("YYYYYY",MS,IS);Zt(["YYYYY","YYYYYY"],ei);Zt("YYYY",function(t,e){e[ei]=t.length===2?Me.parseTwoDigitYear(t):_t(t)});Zt("YY",function(t,e){e[ei]=Me.parseTwoDigitYear(t)});Zt("Y",function(t,e){e[ei]=parseInt(t,10)});function Lm(t){return kS(t)?366:365}Me.parseTwoDigitYear=function(t){return _t(t)+(_t(t)>68?1900:2e3)};var OG=Qf("FullYear",!0);function iDe(){return kS(this.year())}function sDe(t,e,r,n,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,s,o),a}function n0(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function v1(t,e,r){var n=7+e-r,i=(7+n0(t,0,n).getUTCDay()-e)%7;return-i+n-1}function kG(t,e,r,n,i){var s=(7+r-n)%7,o=v1(t,n,i),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=t-1,c=Lm(l)+a):a>Lm(t)?(l=t+1,c=a-Lm(t)):(l=t,c=a),{year:l,dayOfYear:c}}function i0(t,e,r){var n=v1(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+Wa(o,e,r)):i>Wa(t.year(),e,r)?(s=i-Wa(t.year(),e,r),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function Wa(t,e,r){var n=v1(t,e,r),i=v1(t+1,e,r);return(Lm(t)-n+i)/7}tt("w",["ww",2],"wo","week");tt("W",["WW",2],"Wo","isoWeek");si("week","w");si("isoWeek","W");oi("week",5);oi("isoWeek",5);Ke("w",Sr);Ke("ww",Sr,us);Ke("W",Sr);Ke("WW",Sr,us);Q0(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=_t(t)});function oDe(t){return i0(t,this._week.dow,this._week.doy).week}var aDe={dow:0,doy:6};function lDe(){return this._week.dow}function cDe(){return this._week.doy}function uDe(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function hDe(t){var e=i0(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}tt("d",0,"do","day");tt("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});tt("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});tt("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});tt("e",0,0,"weekday");tt("E",0,0,"isoWeekday");si("day","d");si("weekday","e");si("isoWeekday","E");oi("day",11);oi("weekday",11);oi("isoWeekday",11);Ke("d",Sr);Ke("e",Sr);Ke("E",Sr);Ke("dd",function(t,e){return e.weekdaysMinRegex(t)});Ke("ddd",function(t,e){return e.weekdaysShortRegex(t)});Ke("dddd",function(t,e){return e.weekdaysRegex(t)});Q0(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:pt(r).invalidWeekday=t});Q0(["d","e","E"],function(t,e,r,n){e[n]=_t(t)});function dDe(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function fDe(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function fN(t,e){return t.slice(e,7).concat(t.slice(0,e))}var gDe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),IG="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mDe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),pDe=Z0,vDe=Z0,yDe=Z0;function wDe(t,e){var r=wo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?fN(r,this._week.dow):t?r[t.day()]:r}function xDe(t){return t===!0?fN(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function bDe(t){return t===!0?fN(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function SDe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=la([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=qr.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=qr.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=qr.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=qr.call(this._weekdaysParse,o),i!==-1||(i=qr.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=qr.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=qr.call(this._shortWeekdaysParse,o),i!==-1||(i=qr.call(this._weekdaysParse,o),i!==-1)?i:(i=qr.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=qr.call(this._minWeekdaysParse,o),i!==-1||(i=qr.call(this._weekdaysParse,o),i!==-1)?i:(i=qr.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function CDe(t,e,r){var n,i,s;if(this._weekdaysParseExact)return SDe.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=la([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function EDe(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=dDe(t,this.localeData()),this.add(t-e,"d")):e}function TDe(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function _De(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=fDe(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function RDe(t){return this._weekdaysParseExact?($t(this,"_weekdaysRegex")||gN.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):($t(this,"_weekdaysRegex")||(this._weekdaysRegex=pDe),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function ADe(t){return this._weekdaysParseExact?($t(this,"_weekdaysRegex")||gN.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):($t(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=vDe),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ODe(t){return this._weekdaysParseExact?($t(this,"_weekdaysRegex")||gN.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):($t(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=yDe),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function gN(){function t(u,h){return h.length-u.length}var e=[],r=[],n=[],i=[],s,o,a,l,c;for(s=0;s<7;s++)o=la([2e3,1]).day(s),a=Ji(this.weekdaysMin(o,"")),l=Ji(this.weekdaysShort(o,"")),c=Ji(this.weekdays(o,"")),e.push(a),r.push(l),n.push(c),i.push(a),i.push(l),i.push(c);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function mN(){return this.hours()%12||12}function kDe(){return this.hours()||24}tt("H",["HH",2],0,"hour");tt("h",["hh",2],0,mN);tt("k",["kk",2],0,kDe);tt("hmm",0,0,function(){return""+mN.apply(this)+ea(this.minutes(),2)});tt("hmmss",0,0,function(){return""+mN.apply(this)+ea(this.minutes(),2)+ea(this.seconds(),2)});tt("Hmm",0,0,function(){return""+this.hours()+ea(this.minutes(),2)});tt("Hmmss",0,0,function(){return""+this.hours()+ea(this.minutes(),2)+ea(this.seconds(),2)});function NG(t,e){tt(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}NG("a",!0);NG("A",!1);si("hour","h");oi("hour",13);function MG(t,e){return e._meridiemParse}Ke("a",MG);Ke("A",MG);Ke("H",Sr);Ke("h",Sr);Ke("k",Sr);Ke("HH",Sr,us);Ke("hh",Sr,us);Ke("kk",Sr,us);Ke("hmm",SG);Ke("hmmss",CG);Ke("Hmm",SG);Ke("Hmmss",CG);Zt(["H","HH"],pn);Zt(["k","kk"],function(t,e,r){var n=_t(t);e[pn]=n===24?0:n});Zt(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Zt(["h","hh"],function(t,e,r){e[pn]=_t(t),pt(r).bigHour=!0});Zt("hmm",function(t,e,r){var n=t.length-2;e[pn]=_t(t.substr(0,n)),e[co]=_t(t.substr(n)),pt(r).bigHour=!0});Zt("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[pn]=_t(t.substr(0,n)),e[co]=_t(t.substr(n,2)),e[Fa]=_t(t.substr(i)),pt(r).bigHour=!0});Zt("Hmm",function(t,e,r){var n=t.length-2;e[pn]=_t(t.substr(0,n)),e[co]=_t(t.substr(n))});Zt("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[pn]=_t(t.substr(0,n)),e[co]=_t(t.substr(n,2)),e[Fa]=_t(t.substr(i))});function IDe(t){return(t+"").toLowerCase().charAt(0)==="p"}var NDe=/[ap]\.?m?\.?/i,MDe=Qf("Hours",!0);function PDe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var PG={calendar:CPe,longDateFormat:RPe,invalidDate:OPe,ordinal:IPe,dayOfMonthOrdinalParse:NPe,relativeTime:PPe,months:KPe,monthsShort:EG,week:aDe,weekdays:gDe,weekdaysMin:mDe,weekdaysShort:IG,meridiemParse:NDe},_r={},Dg={},s0;function DDe(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function u3(t){return t&&t.toLowerCase().replace("_","-")}function LDe(t){for(var e=0,r,n,i,s;e<t.length;){for(s=u3(t[e]).split("-"),r=s.length,n=u3(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=FS(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&DDe(s,n)>=r-1)break;r--}e++}return s0}function FDe(t){return t.match("^[^/\\\\]*$")!=null}function FS(t){var e=null,r;if(_r[t]===void 0&&typeof Pw<"u"&&Pw&&Pw.exports&&FDe(t))try{e=s0._abbr,r=require,r("./locale/"+t),ac(e)}catch{_r[t]=null}return _r[t]}function ac(t,e){var r;return t&&(ki(e)?r=dl(t):r=pN(t,e),r?s0=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),s0._abbr}function pN(t,e){if(e!==null){var r,n=PG;if(e.abbr=t,_r[t]!=null)pG("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=_r[t]._config;else if(e.parentLocale!=null)if(_r[e.parentLocale]!=null)n=_r[e.parentLocale]._config;else if(r=FS(e.parentLocale),r!=null)n=r._config;else return Dg[e.parentLocale]||(Dg[e.parentLocale]=[]),Dg[e.parentLocale].push({name:t,config:e}),null;return _r[t]=new lN(MO(n,e)),Dg[t]&&Dg[t].forEach(function(i){pN(i.name,i.config)}),ac(t),_r[t]}else return delete _r[t],null}function $De(t,e){if(e!=null){var r,n,i=PG;_r[t]!=null&&_r[t].parentLocale!=null?_r[t].set(MO(_r[t]._config,e)):(n=FS(t),n!=null&&(i=n._config),e=MO(i,e),n==null&&(e.abbr=t),r=new lN(e),r.parentLocale=_r[t],_r[t]=r),ac(t)}else _r[t]!=null&&(_r[t].parentLocale!=null?(_r[t]=_r[t].parentLocale,t===ac()&&ac(t)):_r[t]!=null&&delete _r[t]);return _r[t]}function dl(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return s0;if(!wo(t)){if(e=FS(t),e)return e;t=[t]}return LDe(t)}function HDe(){return PO(_r)}function vN(t){var e,r=t._a;return r&&pt(t).overflow===-2&&(e=r[La]<0||r[La]>11?La:r[Uo]<1||r[Uo]>LS(r[ei],r[La])?Uo:r[pn]<0||r[pn]>24||r[pn]===24&&(r[co]!==0||r[Fa]!==0||r[gu]!==0)?pn:r[co]<0||r[co]>59?co:r[Fa]<0||r[Fa]>59?Fa:r[gu]<0||r[gu]>999?gu:-1,pt(t)._overflowDayOfYear&&(e<ei||e>Uo)&&(e=Uo),pt(t)._overflowWeeks&&e===-1&&(e=zPe),pt(t)._overflowWeekday&&e===-1&&(e=GPe),pt(t).overflow=e),t}var jDe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,BDe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,VDe=/Z|[+-]\d\d(?::?\d\d)?/,uy=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],gT=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],UDe=/^\/?Date\((-?\d+)/i,WDe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,zDe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function DG(t){var e,r,n=t._i,i=jDe.exec(n)||BDe.exec(n),s,o,a,l,c=uy.length,u=gT.length;if(i){for(pt(t).iso=!0,e=0,r=c;e<r;e++)if(uy[e][1].exec(i[1])){o=uy[e][0],s=uy[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,r=u;e<r;e++)if(gT[e][1].exec(i[3])){a=(i[2]||" ")+gT[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(VDe.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),wN(t)}else t._isValid=!1}function GDe(t,e,r,n,i,s){var o=[YDe(t),EG.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function YDe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function KDe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function XDe(t,e,r){if(t){var n=IG.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return pt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function qDe(t,e,r){if(t)return zDe[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function LG(t){var e=WDe.exec(KDe(t._i)),r;if(e){if(r=GDe(e[4],e[3],e[2],e[5],e[6],e[7]),!XDe(e[1],r,t))return;t._a=r,t._tzm=qDe(e[8],e[9],e[10]),t._d=n0.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),pt(t).rfc2822=!0}else t._isValid=!1}function JDe(t){var e=UDe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(DG(t),t._isValid===!1)delete t._isValid;else return;if(LG(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Me.createFromInputFallback(t)}Me.createFromInputFallback=Vs("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Gh(t,e,r){return t??e??r}function ZDe(t){var e=new Date(Me.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function yN(t){var e,r,n=[],i,s,o;if(!t._d){for(i=ZDe(t),t._w&&t._a[Uo]==null&&t._a[La]==null&&QDe(t),t._dayOfYear!=null&&(o=Gh(t._a[ei],i[ei]),(t._dayOfYear>Lm(o)||t._dayOfYear===0)&&(pt(t)._overflowDayOfYear=!0),r=n0(o,0,t._dayOfYear),t._a[La]=r.getUTCMonth(),t._a[Uo]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[pn]===24&&t._a[co]===0&&t._a[Fa]===0&&t._a[gu]===0&&(t._nextDay=!0,t._a[pn]=0),t._d=(t._useUTC?n0:sDe).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[pn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(pt(t).weekdayMismatch=!0)}}function QDe(t){var e,r,n,i,s,o,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=Gh(e.GG,t._a[ei],i0(br(),1,4).year),n=Gh(e.W,1),i=Gh(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,c=i0(br(),s,o),r=Gh(e.gg,t._a[ei],c.year),n=Gh(e.w,c.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),n<1||n>Wa(r,s,o)?pt(t)._overflowWeeks=!0:l!=null?pt(t)._overflowWeekday=!0:(a=kG(r,n,i,s,o),t._a[ei]=a.year,t._dayOfYear=a.dayOfYear)}Me.ISO_8601=function(){};Me.RFC_2822=function(){};function wN(t){if(t._f===Me.ISO_8601){DG(t);return}if(t._f===Me.RFC_2822){LG(t);return}t._a=[],pt(t).empty=!0;var e=""+t._i,r,n,i,s,o,a=e.length,l=0,c,u;for(i=vG(t._f,t._locale).match(cN)||[],u=i.length,r=0;r<u;r++)s=i[r],n=(e.match(VPe(s,t))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&pt(t).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),l+=n.length),kd[s]?(n?pt(t).empty=!1:pt(t).unusedTokens.push(s),WPe(s,n,t)):t._strict&&!n&&pt(t).unusedTokens.push(s);pt(t).charsLeftOver=a-l,e.length>0&&pt(t).unusedInput.push(e),t._a[pn]<=12&&pt(t).bigHour===!0&&t._a[pn]>0&&(pt(t).bigHour=void 0),pt(t).parsedDateParts=t._a.slice(0),pt(t).meridiem=t._meridiem,t._a[pn]=eLe(t._locale,t._a[pn],t._meridiem),c=pt(t).era,c!==null&&(t._a[ei]=t._locale.erasConvertYear(c,t._a[ei])),yN(t),vN(t)}function eLe(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function tLe(t){var e,r,n,i,s,o,a=!1,l=t._f.length;if(l===0){pt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=aN({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],wN(e),oN(e)&&(o=!0),s+=pt(e).charsLeftOver,s+=pt(e).unusedTokens.length*10,pt(e).score=s,a?s<n&&(n=s,r=e):(n==null||s<n||o)&&(n=s,r=e,o&&(a=!0));zl(t,r||e)}function rLe(t){if(!t._d){var e=uN(t._i),r=e.day===void 0?e.date:e.day;t._a=gG([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),yN(t)}}function nLe(t){var e=new J0(vN(FG(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function FG(t){var e=t._i,r=t._f;return t._locale=t._locale||dl(t._l),e===null||r===void 0&&e===""?OS({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),xo(e)?new J0(vN(e)):(q0(e)?t._d=e:wo(r)?tLe(t):r?wN(t):iLe(t),oN(t)||(t._d=null),t))}function iLe(t){var e=t._i;ki(e)?t._d=new Date(Me.now()):q0(e)?t._d=new Date(e.valueOf()):typeof e=="string"?JDe(t):wo(e)?(t._a=gG(e.slice(0),function(r){return parseInt(r,10)}),yN(t)):Tu(e)?rLe(t):nl(e)?t._d=new Date(e):Me.createFromInputFallback(t)}function $G(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Tu(t)&&sN(t)||wo(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,nLe(s)}function br(t,e,r,n){return $G(t,e,r,n,!1)}var sLe=Vs("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=br.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:OS()}),oLe=Vs("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=br.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:OS()});function HG(t,e){var r,n;if(e.length===1&&wo(e[0])&&(e=e[0]),!e.length)return br();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function aLe(){var t=[].slice.call(arguments,0);return HG("isBefore",t)}function lLe(){var t=[].slice.call(arguments,0);return HG("isAfter",t)}var cLe=function(){return Date.now?Date.now():+new Date},Lg=["year","quarter","month","week","day","hour","minute","second","millisecond"];function uLe(t){var e,r=!1,n,i=Lg.length;for(e in t)if($t(t,e)&&!(qr.call(Lg,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Lg[n]]){if(r)return!1;parseFloat(t[Lg[n]])!==_t(t[Lg[n]])&&(r=!0)}return!0}function hLe(){return this._isValid}function dLe(){return So(NaN)}function $S(t){var e=uN(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._isValid=uLe(e),this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=dl(),this._bubble()}function Tw(t){return t instanceof $S}function LO(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function fLe(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<n;o++)_t(t[o])!==_t(e[o])&&s++;return s+i}function jG(t,e){tt(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+ea(~~(r/60),2)+e+ea(~~r%60,2)})}jG("Z",":");jG("ZZ","");Ke("Z",DS);Ke("ZZ",DS);Zt(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=xN(DS,t)});var gLe=/([\+\-]|\d\d)/gi;function xN(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(gLe)||["-",0,0],s=+(i[1]*60)+_t(i[2]),s===0?0:i[0]==="+"?s:-s)}function bN(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(xo(t)||q0(t)?t.valueOf():br(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Me.updateOffset(r,!1),r):br(t).local()}function FO(t){return-Math.round(t._d.getTimezoneOffset())}Me.updateOffset=function(){};function mLe(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=xN(DS,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=FO(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?UG(this,So(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Me.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:FO(this)}function pLe(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function vLe(t){return this.utcOffset(0,t)}function yLe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(FO(this),"m")),this}function wLe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=xN(jPe,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function xLe(t){return this.isValid()?(t=t?br(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function bLe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function SLe(){if(!ki(this._isDSTShifted))return this._isDSTShifted;var t={},e;return aN(t,this),t=FG(t),t._a?(e=t._isUTC?la(t._a):br(t._a),this._isDSTShifted=this.isValid()&&fLe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function CLe(){return this.isValid()?!this._isUTC:!1}function ELe(){return this.isValid()?this._isUTC:!1}function BG(){return this.isValid()?this._isUTC&&this._offset===0:!1}var TLe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,_Le=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function So(t,e){var r=t,n=null,i,s,o;return Tw(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:nl(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=TLe.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:_t(n[Uo])*i,h:_t(n[pn])*i,m:_t(n[co])*i,s:_t(n[Fa])*i,ms:_t(LO(n[gu]*1e3))*i}):(n=_Le.exec(t))?(i=n[1]==="-"?-1:1,r={y:$c(n[2],i),M:$c(n[3],i),w:$c(n[4],i),d:$c(n[5],i),h:$c(n[6],i),m:$c(n[7],i),s:$c(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=RLe(br(r.from),br(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new $S(r),Tw(t)&&$t(t,"_locale")&&(s._locale=t._locale),Tw(t)&&$t(t,"_isValid")&&(s._isValid=t._isValid),s}So.fn=$S.prototype;So.invalid=dLe;function $c(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function h3(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function RLe(t,e){var r;return t.isValid()&&e.isValid()?(e=bN(e,t),t.isBefore(e)?r=h3(t,e):(r=h3(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function VG(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(pG(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=So(r,n),UG(this,i,t),this}}function UG(t,e,r,n){var i=e._milliseconds,s=LO(e._days),o=LO(e._months);t.isValid()&&(n=n??!0,o&&_G(t,m1(t,"Month")+o*r),s&&wG(t,"Date",m1(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&Me.updateOffset(t,s||o))}var ALe=VG(1,"add"),OLe=VG(-1,"subtract");function WG(t){return typeof t=="string"||t instanceof String}function kLe(t){return xo(t)||q0(t)||WG(t)||nl(t)||NLe(t)||ILe(t)||t===null||t===void 0}function ILe(t){var e=Tu(t)&&!sN(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=n.length;for(i=0;i<o;i+=1)s=n[i],r=r||$t(t,s);return e&&r}function NLe(t){var e=wo(t),r=!1;return e&&(r=t.filter(function(n){return!nl(n)&&WG(t)}).length===0),e&&r}function MLe(t){var e=Tu(t)&&!sN(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||$t(t,s);return e&&r}function PLe(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function DLe(t,e){arguments.length===1&&(arguments[0]?kLe(arguments[0])?(t=arguments[0],e=void 0):MLe(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||br(),n=bN(r,this).startOf("day"),i=Me.calendarFormat(this,n)||"sameElse",s=e&&(ca(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,br(r)))}function LLe(){return new J0(this)}function FLe(t,e){var r=xo(t)?t:br(t);return this.isValid()&&r.isValid()?(e=Us(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function $Le(t,e){var r=xo(t)?t:br(t);return this.isValid()&&r.isValid()?(e=Us(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function HLe(t,e,r,n){var i=xo(t)?t:br(t),s=xo(e)?e:br(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function jLe(t,e){var r=xo(t)?t:br(t),n;return this.isValid()&&r.isValid()?(e=Us(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function BLe(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function VLe(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function ULe(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=bN(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Us(e),e){case"year":s=_w(this,n)/12;break;case"month":s=_w(this,n);break;case"quarter":s=_w(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Rs(s)}function _w(t,e){if(t.date()<e.date())return-_w(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}Me.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Me.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function WLe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function zLe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Ew(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ca(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ew(r,"Z")):Ew(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function GLe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function YLe(t){t||(t=this.isUtc()?Me.defaultFormatUtc:Me.defaultFormat);var e=Ew(this,t);return this.localeData().postformat(e)}function KLe(t,e){return this.isValid()&&(xo(t)&&t.isValid()||br(t).isValid())?So({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function XLe(t){return this.from(br(),t)}function qLe(t,e){return this.isValid()&&(xo(t)&&t.isValid()||br(t).isValid())?So({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function JLe(t){return this.to(br(),t)}function zG(t){var e;return t===void 0?this._locale._abbr:(e=dl(t),e!=null&&(this._locale=e),this)}var GG=Vs("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function YG(){return this._locale}var y1=1e3,Id=60*y1,w1=60*Id,KG=(365*400+97)*24*w1;function Nd(t,e){return(t%e+e)%e}function XG(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-KG:new Date(t,e,r).valueOf()}function qG(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-KG:Date.UTC(t,e,r)}function ZLe(t){var e,r;if(t=Us(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?qG:XG,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Nd(e+(this._isUTC?0:this.utcOffset()*Id),w1);break;case"minute":e=this._d.valueOf(),e-=Nd(e,Id);break;case"second":e=this._d.valueOf(),e-=Nd(e,y1);break}return this._d.setTime(e),Me.updateOffset(this,!0),this}function QLe(t){var e,r;if(t=Us(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?qG:XG,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=w1-Nd(e+(this._isUTC?0:this.utcOffset()*Id),w1)-1;break;case"minute":e=this._d.valueOf(),e+=Id-Nd(e,Id)-1;break;case"second":e=this._d.valueOf(),e+=y1-Nd(e,y1)-1;break}return this._d.setTime(e),Me.updateOffset(this,!0),this}function eFe(){return this._d.valueOf()-(this._offset||0)*6e4}function tFe(){return Math.floor(this.valueOf()/1e3)}function rFe(){return new Date(this.valueOf())}function nFe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function iFe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function sFe(){return this.isValid()?this.toISOString():null}function oFe(){return oN(this)}function aFe(){return zl({},pt(this))}function lFe(){return pt(this).overflow}function cFe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}tt("N",0,0,"eraAbbr");tt("NN",0,0,"eraAbbr");tt("NNN",0,0,"eraAbbr");tt("NNNN",0,0,"eraName");tt("NNNNN",0,0,"eraNarrow");tt("y",["y",1],"yo","eraYear");tt("y",["yy",2],0,"eraYear");tt("y",["yyy",3],0,"eraYear");tt("y",["yyyy",4],0,"eraYear");Ke("N",SN);Ke("NN",SN);Ke("NNN",SN);Ke("NNNN",xFe);Ke("NNNNN",bFe);Zt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?pt(r).era=i:pt(r).invalidEra=t});Ke("y",eg);Ke("yy",eg);Ke("yyy",eg);Ke("yyyy",eg);Ke("yo",SFe);Zt(["y","yy","yyy","yyyy"],ei);Zt(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[ei]=r._locale.eraYearOrdinalParse(t,i):e[ei]=parseInt(t,10)});function uFe(t,e){var r,n,i,s=this._eras||dl("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=Me(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=Me(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function hFe(t,e,r){var n,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(o=s[n].name.toUpperCase(),a=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[n];break;case"NNNN":if(o===t)return s[n];break;case"NNNNN":if(l===t)return s[n];break}else if([o,a,l].indexOf(t)>=0)return s[n]}function dFe(t,e){var r=t.since<=t.until?1:-1;return e===void 0?Me(t.since).year():Me(t.since).year()+(e-t.offset)*r}function fFe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function gFe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function mFe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function pFe(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-Me(i[t].since).year())*r+i[t].offset;return this.year()}function vFe(t){return $t(this,"_erasNameRegex")||CN.call(this),t?this._erasNameRegex:this._erasRegex}function yFe(t){return $t(this,"_erasAbbrRegex")||CN.call(this),t?this._erasAbbrRegex:this._erasRegex}function wFe(t){return $t(this,"_erasNarrowRegex")||CN.call(this),t?this._erasNarrowRegex:this._erasRegex}function SN(t,e){return e.erasAbbrRegex(t)}function xFe(t,e){return e.erasNameRegex(t)}function bFe(t,e){return e.erasNarrowRegex(t)}function SFe(t,e){return e._eraYearOrdinalRegex||eg}function CN(){var t=[],e=[],r=[],n=[],i,s,o=this.eras();for(i=0,s=o.length;i<s;++i)e.push(Ji(o[i].name)),t.push(Ji(o[i].abbr)),r.push(Ji(o[i].narrow)),n.push(Ji(o[i].name)),n.push(Ji(o[i].abbr)),n.push(Ji(o[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}tt(0,["gg",2],0,function(){return this.weekYear()%100});tt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function HS(t,e){tt(0,[t,t.length],0,e)}HS("gggg","weekYear");HS("ggggg","weekYear");HS("GGGG","isoWeekYear");HS("GGGGG","isoWeekYear");si("weekYear","gg");si("isoWeekYear","GG");oi("weekYear",1);oi("isoWeekYear",1);Ke("G",PS);Ke("g",PS);Ke("GG",Sr,us);Ke("gg",Sr,us);Ke("GGGG",dN,hN);Ke("gggg",dN,hN);Ke("GGGGG",MS,IS);Ke("ggggg",MS,IS);Q0(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=_t(t)});Q0(["gg","GG"],function(t,e,r,n){e[n]=Me.parseTwoDigitYear(t)});function CFe(t){return JG.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function EFe(t){return JG.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function TFe(){return Wa(this.year(),1,4)}function _Fe(){return Wa(this.isoWeekYear(),1,4)}function RFe(){var t=this.localeData()._week;return Wa(this.year(),t.dow,t.doy)}function AFe(){var t=this.localeData()._week;return Wa(this.weekYear(),t.dow,t.doy)}function JG(t,e,r,n,i){var s;return t==null?i0(this,n,i).year:(s=Wa(t,n,i),e>s&&(e=s),OFe.call(this,t,e,r,n,i))}function OFe(t,e,r,n,i){var s=kG(t,e,r,n,i),o=n0(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}tt("Q",0,"Qo","quarter");si("quarter","Q");oi("quarter",7);Ke("Q",xG);Zt("Q",function(t,e){e[La]=(_t(t)-1)*3});function kFe(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}tt("D",["DD",2],"Do","date");si("date","D");oi("date",9);Ke("D",Sr);Ke("DD",Sr,us);Ke("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Zt(["D","DD"],Uo);Zt("Do",function(t,e){e[Uo]=_t(t.match(Sr)[0])});var ZG=Qf("Date",!0);tt("DDD",["DDDD",3],"DDDo","dayOfYear");si("dayOfYear","DDD");oi("dayOfYear",4);Ke("DDD",NS);Ke("DDDD",bG);Zt(["DDD","DDDD"],function(t,e,r){r._dayOfYear=_t(t)});function IFe(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}tt("m",["mm",2],0,"minute");si("minute","m");oi("minute",14);Ke("m",Sr);Ke("mm",Sr,us);Zt(["m","mm"],co);var NFe=Qf("Minutes",!1);tt("s",["ss",2],0,"second");si("second","s");oi("second",15);Ke("s",Sr);Ke("ss",Sr,us);Zt(["s","ss"],Fa);var MFe=Qf("Seconds",!1);tt("S",0,0,function(){return~~(this.millisecond()/100)});tt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});tt(0,["SSS",3],0,"millisecond");tt(0,["SSSS",4],0,function(){return this.millisecond()*10});tt(0,["SSSSS",5],0,function(){return this.millisecond()*100});tt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});tt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});tt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});tt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});si("millisecond","ms");oi("millisecond",16);Ke("S",NS,xG);Ke("SS",NS,us);Ke("SSS",NS,bG);var Gl,QG;for(Gl="SSSS";Gl.length<=9;Gl+="S")Ke(Gl,eg);function PFe(t,e){e[gu]=_t(("0."+t)*1e3)}for(Gl="S";Gl.length<=9;Gl+="S")Zt(Gl,PFe);QG=Qf("Milliseconds",!1);tt("z",0,0,"zoneAbbr");tt("zz",0,0,"zoneName");function DFe(){return this._isUTC?"UTC":""}function LFe(){return this._isUTC?"Coordinated Universal Time":""}var $e=J0.prototype;$e.add=ALe;$e.calendar=DLe;$e.clone=LLe;$e.diff=ULe;$e.endOf=QLe;$e.format=YLe;$e.from=KLe;$e.fromNow=XLe;$e.to=qLe;$e.toNow=JLe;$e.get=$Pe;$e.invalidAt=lFe;$e.isAfter=FLe;$e.isBefore=$Le;$e.isBetween=HLe;$e.isSame=jLe;$e.isSameOrAfter=BLe;$e.isSameOrBefore=VLe;$e.isValid=oFe;$e.lang=GG;$e.locale=zG;$e.localeData=YG;$e.max=oLe;$e.min=sLe;$e.parsingFlags=aFe;$e.set=HPe;$e.startOf=ZLe;$e.subtract=OLe;$e.toArray=nFe;$e.toObject=iFe;$e.toDate=rFe;$e.toISOString=zLe;$e.inspect=GLe;typeof Symbol<"u"&&Symbol.for!=null&&($e[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});$e.toJSON=sFe;$e.toString=WLe;$e.unix=tFe;$e.valueOf=eFe;$e.creationData=cFe;$e.eraName=fFe;$e.eraNarrow=gFe;$e.eraAbbr=mFe;$e.eraYear=pFe;$e.year=OG;$e.isLeapYear=iDe;$e.weekYear=CFe;$e.isoWeekYear=EFe;$e.quarter=$e.quarters=kFe;$e.month=RG;$e.daysInMonth=tDe;$e.week=$e.weeks=uDe;$e.isoWeek=$e.isoWeeks=hDe;$e.weeksInYear=RFe;$e.weeksInWeekYear=AFe;$e.isoWeeksInYear=TFe;$e.isoWeeksInISOWeekYear=_Fe;$e.date=ZG;$e.day=$e.days=EDe;$e.weekday=TDe;$e.isoWeekday=_De;$e.dayOfYear=IFe;$e.hour=$e.hours=MDe;$e.minute=$e.minutes=NFe;$e.second=$e.seconds=MFe;$e.millisecond=$e.milliseconds=QG;$e.utcOffset=mLe;$e.utc=vLe;$e.local=yLe;$e.parseZone=wLe;$e.hasAlignedHourOffset=xLe;$e.isDST=bLe;$e.isLocal=CLe;$e.isUtcOffset=ELe;$e.isUtc=BG;$e.isUTC=BG;$e.zoneAbbr=DFe;$e.zoneName=LFe;$e.dates=Vs("dates accessor is deprecated. Use date instead.",ZG);$e.months=Vs("months accessor is deprecated. Use month instead",RG);$e.years=Vs("years accessor is deprecated. Use year instead",OG);$e.zone=Vs("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pLe);$e.isDSTShifted=Vs("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",SLe);function FFe(t){return br(t*1e3)}function $Fe(){return br.apply(null,arguments).parseZone()}function eY(t){return t}var Bt=lN.prototype;Bt.calendar=EPe;Bt.longDateFormat=APe;Bt.invalidDate=kPe;Bt.ordinal=MPe;Bt.preparse=eY;Bt.postformat=eY;Bt.relativeTime=DPe;Bt.pastFuture=LPe;Bt.set=SPe;Bt.eras=uFe;Bt.erasParse=hFe;Bt.erasConvertYear=dFe;Bt.erasAbbrRegex=yFe;Bt.erasNameRegex=vFe;Bt.erasNarrowRegex=wFe;Bt.months=JPe;Bt.monthsShort=ZPe;Bt.monthsParse=eDe;Bt.monthsRegex=nDe;Bt.monthsShortRegex=rDe;Bt.week=oDe;Bt.firstDayOfYear=cDe;Bt.firstDayOfWeek=lDe;Bt.weekdays=wDe;Bt.weekdaysMin=bDe;Bt.weekdaysShort=xDe;Bt.weekdaysParse=CDe;Bt.weekdaysRegex=RDe;Bt.weekdaysShortRegex=ADe;Bt.weekdaysMinRegex=ODe;Bt.isPM=IDe;Bt.meridiem=PDe;function x1(t,e,r,n){var i=dl(),s=la().set(n,e);return i[r](s,t)}function tY(t,e,r){if(nl(t)&&(e=t,t=void 0),t=t||"",e!=null)return x1(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=x1(t,n,r,"month");return i}function EN(t,e,r,n){typeof t=="boolean"?(nl(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,nl(e)&&(r=e,e=void 0),e=e||"");var i=dl(),s=t?i._week.dow:0,o,a=[];if(r!=null)return x1(e,(r+s)%7,n,"day");for(o=0;o<7;o++)a[o]=x1(e,(o+s)%7,n,"day");return a}function HFe(t,e){return tY(t,e,"months")}function jFe(t,e){return tY(t,e,"monthsShort")}function BFe(t,e,r){return EN(t,e,r,"weekdays")}function VFe(t,e,r){return EN(t,e,r,"weekdaysShort")}function UFe(t,e,r){return EN(t,e,r,"weekdaysMin")}ac("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=_t(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});Me.lang=Vs("moment.lang is deprecated. Use moment.locale instead.",ac);Me.langData=Vs("moment.langData is deprecated. Use moment.localeData instead.",dl);var pa=Math.abs;function WFe(){var t=this._data;return this._milliseconds=pa(this._milliseconds),this._days=pa(this._days),this._months=pa(this._months),t.milliseconds=pa(t.milliseconds),t.seconds=pa(t.seconds),t.minutes=pa(t.minutes),t.hours=pa(t.hours),t.months=pa(t.months),t.years=pa(t.years),this}function rY(t,e,r,n){var i=So(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function zFe(t,e){return rY(this,t,e,1)}function GFe(t,e){return rY(this,t,e,-1)}function d3(t){return t<0?Math.floor(t):Math.ceil(t)}function YFe(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,o,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=d3($O(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Rs(t/1e3),n.seconds=i%60,s=Rs(i/60),n.minutes=s%60,o=Rs(s/60),n.hours=o%24,e+=Rs(o/24),l=Rs(nY(e)),r+=l,e-=d3($O(l)),a=Rs(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function nY(t){return t*4800/146097}function $O(t){return t*146097/4800}function KFe(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Us(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+nY(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round($O(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function XFe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+_t(this._months/12)*31536e6:NaN}function fl(t){return function(){return this.as(t)}}var qFe=fl("ms"),JFe=fl("s"),ZFe=fl("m"),QFe=fl("h"),e$e=fl("d"),t$e=fl("w"),r$e=fl("M"),n$e=fl("Q"),i$e=fl("y");function s$e(){return So(this)}function o$e(t){return t=Us(t),this.isValid()?this[t+"s"]():NaN}function ah(t){return function(){return this.isValid()?this._data[t]:NaN}}var a$e=ah("milliseconds"),l$e=ah("seconds"),c$e=ah("minutes"),u$e=ah("hours"),h$e=ah("days"),d$e=ah("months"),f$e=ah("years");function g$e(){return Rs(this.days()/7)}var Ra=Math.round,fd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function m$e(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function p$e(t,e,r,n){var i=So(t).abs(),s=Ra(i.as("s")),o=Ra(i.as("m")),a=Ra(i.as("h")),l=Ra(i.as("d")),c=Ra(i.as("M")),u=Ra(i.as("w")),h=Ra(i.as("y")),d=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||u<=1&&["w"]||u<r.w&&["ww",u]),d=d||c<=1&&["M"]||c<r.M&&["MM",c]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,m$e.apply(null,d)}function v$e(t){return t===void 0?Ra:typeof t=="function"?(Ra=t,!0):!1}function y$e(t,e){return fd[t]===void 0?!1:e===void 0?fd[t]:(fd[t]=e,t==="s"&&(fd.ss=e-1),!0)}function w$e(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=fd,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},fd,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=p$e(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var mT=Math.abs;function Eh(t){return(t>0)-(t<0)||+t}function jS(){if(!this.isValid())return this.localeData().invalidDate();var t=mT(this._milliseconds)/1e3,e=mT(this._days),r=mT(this._months),n,i,s,o,a=this.asSeconds(),l,c,u,h;return a?(n=Rs(t/60),i=Rs(n/60),t%=60,n%=60,s=Rs(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=Eh(this._months)!==Eh(a)?"-":"",u=Eh(this._days)!==Eh(a)?"-":"",h=Eh(this._milliseconds)!==Eh(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(e?u+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+o+"S":"")):"P0D"}var Mt=$S.prototype;Mt.isValid=hLe;Mt.abs=WFe;Mt.add=zFe;Mt.subtract=GFe;Mt.as=KFe;Mt.asMilliseconds=qFe;Mt.asSeconds=JFe;Mt.asMinutes=ZFe;Mt.asHours=QFe;Mt.asDays=e$e;Mt.asWeeks=t$e;Mt.asMonths=r$e;Mt.asQuarters=n$e;Mt.asYears=i$e;Mt.valueOf=XFe;Mt._bubble=YFe;Mt.clone=s$e;Mt.get=o$e;Mt.milliseconds=a$e;Mt.seconds=l$e;Mt.minutes=c$e;Mt.hours=u$e;Mt.days=h$e;Mt.weeks=g$e;Mt.months=d$e;Mt.years=f$e;Mt.humanize=w$e;Mt.toISOString=jS;Mt.toString=jS;Mt.toJSON=jS;Mt.locale=zG;Mt.localeData=YG;Mt.toIsoString=Vs("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",jS);Mt.lang=GG;tt("X",0,0,"unix");tt("x",0,0,"valueOf");Ke("x",PS);Ke("X",BPe);Zt("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Zt("x",function(t,e,r){r._d=new Date(_t(t))});//! moment.js
Me.version="2.29.4";xPe(br);Me.fn=$e;Me.min=aLe;Me.max=lLe;Me.now=cLe;Me.utc=la;Me.unix=FFe;Me.months=HFe;Me.isDate=q0;Me.locale=ac;Me.invalid=OS;Me.duration=So;Me.isMoment=xo;Me.weekdays=BFe;Me.parseZone=$Fe;Me.localeData=dl;Me.isDuration=Tw;Me.monthsShort=jFe;Me.weekdaysMin=UFe;Me.defineLocale=pN;Me.updateLocale=$De;Me.locales=HDe;Me.weekdaysShort=VFe;Me.normalizeUnits=Us;Me.relativeTimeRounding=v$e;Me.relativeTimeThreshold=y$e;Me.calendarFormat=PLe;Me.prototype=$e;Me.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const x$e=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"}));function b$e(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function f3(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Rw(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function ai(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Fs(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function yt(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function he(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function iY(t){const e=[];return he(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function g3(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return he(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function m3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Jt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return ai(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),c=r[a]?r[a]:"";return s+l+c},"").trim()}function Zr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ze(t){return typeof t<"u"}function ur(t){return typeof t>"u"}function yn(t){return t===null||t===""||ur(t)}function S$e(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const lm="length",Fm=t=>parseInt(t,16),p3=t=>parseInt(t,10),b1=(t,e,r)=>t.substr(e,r),$m=t=>t.codePointAt(0)-65,HO=t=>`${t}`.replace(/\-/g,""),C$e=t=>Fm(b1(HO(t),Fm("12"),$m("F")))/(Fm(b1(HO(t),$m("B"),~~![][lm]))||9),E$e=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let v3=!1;const y3={invalid:()=>Jt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Jt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Jt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},w3={invalid:()=>Jt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Jt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Jt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function T$e(t,e){const r=!yn(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="13.1.0";let s,o="invalid",a="invalid";t=HO(t||"");const l=_$e(t);if(r||n||l)if(l){const c=Me("31/08/2023","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),h=C$e(t);s=Me((h+1)*864e5,"x").format("MMMM DD, YYYY"),u>h?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(E$e()&&(o="valid",a="valid"),!v3&&o!=="valid"&&(y3[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](y3[o]({keyValidityDate:s,hotVersion:i})),v3=!0),a!=="valid"&&e.parentNode&&w3[a]({keyValidityDate:s,hotVersion:i})){const u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=w3[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(u,e.nextSibling)}}function _$e(t){let e=[][lm],r=e;if(t[lm]!==$m("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=$m(i.shift());s;s=$m(i.shift()||"A"))--s<""[lm]?r=r|(p3(`${p3(Fm(n)+(Fm(b1(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=b1(t,s,s?i[lm]===1?9:8:6);return r===e}function po(t){return t[0].toUpperCase()+t.substr(1)}function sY(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function oY(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function aY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function x3(t){return TN(`${t}`,{ALLOWED_TAGS:[]})}function TN(t,e){return wPe.sanitize(t,e)}function R$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function A$e(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function S1(t){return A$e(t)&&t.parent}function _u(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function hy(t,e,r){const n=[];let i=t;for(;i&&(i=_u(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function Ru(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function O$e(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Hc(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function lY(t){return!t||!t.length?[]:t.filter(e=>!!e)}function lt(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function De(t,e){typeof e=="string"&&(e=e.split(" ")),e=lY(e),e.length>0&&t.classList.add(...e)}function ct(t,e){typeof e=="string"&&(e=e.split(" ")),e=lY(e),e.length>0&&t.classList.remove(...e)}function cY(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)cY(e[r])}}function ta(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const k$e=/(<(.*)>|&(.*);)/;function tg(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;k$e.test(e)?t.innerHTML=r?TN(e):e:ju(t,e)}function ju(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(ta(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function o0(t){const e=t.ownerDocument.documentElement;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return o0(r.host.impl);if(r.host)return o0(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function an(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&i!==e.body;)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function a0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function wf(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function C1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?a0(e):t.scrollTop}function jO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?wf(e):t.scrollLeft}function E1(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function xf(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=Bu(n,r),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function l0(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=Bu(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Bu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function qt(t){return t.offsetWidth}function Lr(t){return t.offsetHeight}function Yl(t){return t.clientHeight||t.innerHeight}function Aw(t){return t.clientWidth||t.innerWidth}function uY(t){return t.selectionStart?t.selectionStart:0}function I$e(t){return t.selectionEnd?t.selectionEnd:0}function N$e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function b3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function BS(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let pT;function M$e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function An(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return pT===void 0&&(pT=M$e(t)),pT}function P$e(t){return t.offsetWidth!==t.clientWidth}function D$e(t){return t.offsetHeight!==t.clientHeight}function _N(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function VS(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function T1(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function RN(t){return T1(t)&&t.hasAttribute("data-hot-input")===!1}function L$e(t){const e=t.ownerDocument.activeElement;RN(e)||t.select()}function hY(t){return!t.parentNode}function F$e(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function ar(t){return typeof t=="function"}function dY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function fY(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function $$e(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=n.concat(o);let c;return l.length>=e?c=t.apply(this,l):c=r(l),c}}return r([])}function BO(t,e,r,n,i,s,o,a){return ze(a)?t.call(e,r,n,i,s,o,a):ze(o)?t.call(e,r,n,i,s,o):ze(s)?t.call(e,r,n,i,s):ze(i)?t.call(e,r,n,i):ze(n)?t.call(e,r,n):ze(r)?t.call(e,r):t.call(e)}var H$e=_i,S3=Y9,j$e=ii,C3=Zf,B$e=Q9,E3=H$e([].push),V$e=function(t){if(j$e(t))return t;if(S3(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?E3(r,i):(typeof i=="number"||C3(i)==="Number"||C3(i)==="String")&&E3(r,B$e(i))}var s=r.length,o=!0;return function(a,l){if(o)return o=!1,l;if(S3(this))return l;for(var c=0;c<s;c++)if(r[c]===a)return l}}},U$e=sh,gY=Y0,mY=AS,W$e=bS,ev=_i,pY=Bs,T3=ii,_3=YI,vY=nN,z$e=V$e,G$e=GI,Y$e=String,lc=gY("JSON","stringify"),dy=ev(/./.exec),R3=ev("".charAt),K$e=ev("".charCodeAt),X$e=ev("".replace),q$e=ev(1 .toString),J$e=/[\uD800-\uDFFF]/g,A3=/^[\uD800-\uDBFF]$/,O3=/^[\uDC00-\uDFFF]$/,k3=!G$e||pY(function(){var t=gY("Symbol")("stringify detection");return lc([t])!=="[null]"||lc({a:t})!=="{}"||lc(Object(t))!=="{}"}),I3=pY(function(){return lc("\uDF06\uD834")!=='"\\udf06\\ud834"'||lc("\uDEAD")!=='"\\udead"'}),Z$e=function(t,e){var r=vY(arguments),n=z$e(e);if(!(!T3(n)&&(t===void 0||_3(t))))return r[1]=function(i,s){if(T3(n)&&(s=W$e(n,this,Y$e(i),s)),!_3(s))return s},mY(lc,null,r)},Q$e=function(t,e,r){var n=R3(r,e-1),i=R3(r,e+1);return dy(A3,t)&&!dy(O3,i)||dy(O3,t)&&!dy(A3,n)?"\\u"+q$e(K$e(t,0),16):t};lc&&U$e({target:"JSON",stat:!0,arity:3,forced:k3||I3},{stringify:function(e,r,n){var i=vY(arguments),s=mY(k3?Z$e:lc,null,i);return I3&&typeof s=="string"?X$e(s,J$e,Q$e):s}});function c0(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},bt(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=c0(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[c0(r[0])]:e[n]=[]:e[n]=null)})),e}function Ac(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function cn(t,e,r){const n=Array.isArray(r);return bt(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function US(t,e){bt(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),US(t[n],e[n])):t[n]=e[n]})}function Si(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Li(t){const e={};return bt(t,(r,n)=>{e[n]=r}),e}function tr(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return he(r,i=>{t.MIXINS.push(i.MIXIN_NAME),bt(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(u,h){const d=`_${u}`,f=m=>{let g=m;return(Array.isArray(g)||wt(g))&&(g=Si(g)),g};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(u){const h=`_${u}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function AN(t,e){return JSON.stringify(t)===JSON.stringify(e)}function wt(t){return Object.prototype.toString.call(t)==="[object Object]"}function gl(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function bt(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function eHe(t,e){const r=e.split(".");let n=t;return bt(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function vT(t,e,r){const n=e.split(".");let i=t;n.forEach((s,o)=>{o!==n.length-1?(zr(i,s)||(i[s]={}),i=i[s]):i[s]=r})}function ON(t){if(!wt(t))return 0;const e=function(r){let n=0;return wt(r)?bt(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function bf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function zr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Ss=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},lh={chrome:Ss((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Ss(t=>/CriOS/.test(t)),edge:Ss(t=>/Edge/.test(t)),edgeWebKit:Ss(t=>/EdgiOS/.test(t)),firefox:Ss(t=>/Firefox/.test(t)),firefoxWebKit:Ss(t=>/FxiOS/.test(t)),mobile:Ss(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Ss((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},tv={mac:Ss(t=>/^Mac/.test(t)),win:Ss(t=>/^Win/.test(t)),linux:Ss(t=>/^Linux/.test(t)),ios:Ss(t=>/iPhone|iPad|iPod/i.test(t))};function tHe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bt(lh,r=>{let{test:n}=r;return void n(t,e)})}function rHe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bt(tv,e=>{let{test:r}=e;return void r(t)})}tHe();rHe();function yY(){return lh.chrome.value}function nHe(){return lh.chromeWebKit.value}function yT(){return lh.firefox.value}function iHe(){return lh.firefoxWebKit.value}function sHe(){return lh.edge.value}function Go(){return lh.mobile.value}function wY(){return tv.ios.value}function xY(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&tv.mac.value}function N3(){return tv.win.value}function M3(){return tv.mac.value}const Ze={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:yT()?182:174,AUDIO_MUTE:yT()?181:173,AUDIO_UP:yT()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},oHe=[Ze.ALT,Ze.ARROW_DOWN,Ze.ARROW_LEFT,Ze.ARROW_RIGHT,Ze.ARROW_UP,Ze.AUDIO_DOWN,Ze.AUDIO_MUTE,Ze.AUDIO_UP,Ze.BACKSPACE,Ze.CAPS_LOCK,Ze.DELETE,Ze.END,Ze.ENTER,Ze.ESCAPE,Ze.F1,Ze.F2,Ze.F3,Ze.F4,Ze.F5,Ze.F6,Ze.F7,Ze.F8,Ze.F9,Ze.F10,Ze.F11,Ze.F12,Ze.F13,Ze.F14,Ze.F15,Ze.F16,Ze.F17,Ze.F18,Ze.F19,Ze.HOME,Ze.INSERT,Ze.MEDIA_NEXT,Ze.MEDIA_PLAY_PAUSE,Ze.MEDIA_PREV,Ze.MEDIA_STOP,Ze.NULL,Ze.NUM_LOCK,Ze.PAGE_DOWN,Ze.PAGE_UP,Ze.PAUSE,Ze.SCROLL_LOCK,Ze.SHIFT,Ze.TAB];function aHe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function bY(t){return oHe.includes(t)}function lHe(t){return[Ze.CONTROL,Ze.COMMAND_LEFT,Ze.COMMAND_RIGHT,Ze.COMMAND_FIREFOX].includes(t)}function u0(t,e){const r=e.split("|");let n=!1;return he(r,i=>{if(t===Ze[i])return n=!0,!1}),n}function ra(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Yh(t){return t.isImmediatePropagationEnabled===!1}function Vu(t){return t.button===2}function kN(t){return t.button===0}function lr(){ze(console)&&console.warn(...arguments)}function IN(){ze(console)&&console.error(...arguments)}const Th=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cHe=Jt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,wT=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),xT=new Map([]);class Ye{static getSingleton(){return hHe()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return he(Th,r=>e[r]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(r))he(r,i=>this.add(e,i,n));else{wT.has(e)&&lr(aY(cHe,{hookName:e,removedInVersion:wT.get(e)})),xT.has(e)&&lr(xT.get(e));const i=this.getBucket(n);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),r.skip=!1,i[e].indexOf(r)===-1){let s=!1;r.initialHook&&he(i[e],(o,a)=>{if(o.initialHook)return i[e][a]=r,s=!0,!1}),s||i[e].push(r)}}return this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(r)?he(r,i=>this.once(e,i,n)):(r.runOnce=!0,this.add(e,r,n))}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(n);return typeof i[e]<"u"&&i[e].indexOf(r)>=0?(r.skip=!0,!0):!1}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const n=this.getBucket(r);return!!(n[e]!==void 0&&n[e].length)}run(e,r,n,i,s,o,a,l){{const c=this.globalBucket[r],u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const d=BO(c[h],e,n,i,s,o,a,l);d!==void 0&&(n=d),c[h]&&c[h].runOnce&&this.remove(r,c[h]),h+=1}}{const c=this.getBucket(e)[r],u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const d=BO(c[h],e,n,i,s,o,a,l);d!==void 0&&(n=d),c[h]&&c[h].runOnce&&this.remove(r,c[h],e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;bt(this.getBucket(e),(r,n,i)=>i[n].length=0)}register(e){this.isRegistered(e)||Th.push(e)}deregister(e){this.isRegistered(e)&&Th.splice(Th.indexOf(e),1)}isDeprecated(e){return xT.has(e)||wT.has(e)}isRegistered(e){return Th.indexOf(e)>=0}getRegistered(){return Th}}const uHe=new Ye;function hHe(){return uHe}const bT=new Map;function Ws(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";bT.has(t)||bT.set(t,new Map);const e=bT.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o}}const VO=new WeakMap,{register:dHe,getItem:SY,hasItem:CY,getNames:iet,getValues:set}=Ws("editors");function fHe(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Ye.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function EY(t,e){let r;if(typeof t=="function")VO.get(t)||Gi(null,t),r=VO.get(t);else if(typeof t=="string")r=SY(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function P3(t){if(typeof t=="function")return t;if(!CY(t))throw Error(`No registered editor found under "${t}" name`);return SY(t).getConstructor()}function Gi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new fHe(e);typeof t=="string"&&dHe(t,r),VO.set(e,r)}class $r{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,gHe(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function gHe(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ra(this)},t}const WS="editorManager.navigation",Hm="editorManager.handlingEditor";class UO{constructor(e,r,n){this.instance=e,this.tableMeta=r,this.selection=n,this.eventManager=new $r(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",s=>this.onAfterDocumentKeyDown(s)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",s)}),this.instance.view._wt.update("onCellDblClick",(s,o,a)=>this.onCellDblClick(s,o,a))}registerShortcuts(){const e=this.instance.getShortcutManager(),r=e.getContext("grid"),n=e.getContext("editor"),i={group:Hm};n.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(s,o)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(o.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],i),r.addShortcuts([{keys:[["F2"]],callback:s=>{this.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,s,!0):this.moveSelectionAfterEnter(o.includes("shift")),ra(s)}}],{...i,runOnlyIf:()=>ze(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{row:e,col:r}=this.instance.getSelectedRangeLast().highlight,n=this.instance.runHooks("modifyGetCellCoords",e,r);let i=e,s=r;Array.isArray(n)&&([i,s]=n),this.cellProperties=this.instance.getCellMeta(i,s);const{activeElement:o}=this.instance.rootDocument;if(o&&RN(o)&&o.blur(),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.instance.getCell(e,r,!0);if(a){const l=this.instance.getCellEditor(this.cellProperties),c=this.instance.colToProp(s),u=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),s);this.activeEditor=EY(l,this.instance),this.activeEditor.prepare(e,r,c,a,u,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){const{row:i,col:s}=this.instance.getSelectedRangeLast().highlight,o=this.instance.rowIndexMapper.getRenderableFromVisualIndex(i),a=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(o,a)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getCellEditor(this.cellProperties),{row:r,col:n}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:i,columnIndexMapper:s}=this.instance,o=i.isHidden(this.instance.toPhysicalRow(r))||s.isHidden(this.instance.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||o)}moveSelectionAfterEnter(e){const r=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-r.row,-r.col):this.selection.transformStart(r.row,r.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;const{keyCode:r}=e;if(!this.selection.isSelected())return;const n=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!bY(r)&&!lHe(r)&&!n&&!this.isEditorOpened()){const s=this.instance.getShortcutManager().getContext("editor"),o={runOnlyIf:()=>ze(this.instance.getSelected()),group:WS};s.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],o),this.openEditor("",e)}}onCellDblClick(e,r,n){n.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const D3=new WeakMap;UO.getInstance=function(t,e,r){let n=D3.get(t);return n||(n=new UO(t,e,r),D3.set(t,n)),n};const TY={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},mHe=new RegExp(Object.keys(TY).map(t=>`(${t})`).join("|"),"gi");function pHe(t){return(t&&t.nodeName||"")==="TABLE"}function L3(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=r?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let v=0;v<o;v+=1){const w=!f&&r&&v===0;let b="";if(f)b=`<th>${t.getColHeader(v-u)}</th>`;else if(w)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const x=i[d][v],{hidden:C,rowspan:S,colspan:E}=t.getCellMeta(d-h,v-u);if(!C){const T=[];if(S&&T.push(`rowspan="${S}"`),E&&T.push(`colspan="${E}"`),yn(x))b=`<td ${T.join(" ")}></td>`;else{const I=x.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${T.join(" ")}>${I}</td>`}}}m.push(b)}const g=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,g):c.splice(-1,0,g)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function F3(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,o=[];n===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],c=yn(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${c}</td>`)}r.push("<tr>",...o,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function vHe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const x=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,C=>{const S=C.match(/<td\b[^>]*?>/g)[0],E=C.substring(S.length,C.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${S}${E}</td>`});i.insertAdjacentHTML("afterbegin",`${x}`),s=i.querySelector("table")}if(!s||!pHe(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),c=l?Array.from(l.cells).reduce((x,C)=>x+C.colSpan,0)-(a?1:0):0,u=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const x=Array.from(s.tHead.rows).filter(C=>{const S=C.querySelector("td")!==null;return S&&h.push(C),!S});f=x.length,d=f>0,f>1?r.nestedHeaders=Array.from(x).reduce((C,S)=>{const E=Array.from(S.cells).reduce((T,I,k)=>{if(a&&k===0)return T;const{colSpan:M,innerHTML:D}=I,L=M>1?{label:D,colspan:M}:D;return T.push(L),T},[]);return C.push(E),C},[]):d&&(r.colHeaders=Array.from(x[0].children).reduce((C,S,E)=>(a&&E===0||C.push(S.innerHTML),C),[]))}h.length&&(r.fixedRowsTop=h.length),u.length&&(r.fixedRowsBottom=u.length);const g=[...h,...Array.from(s.tBodies).reduce((x,C)=>(x.push(...Array.from(C.rows)),x),[]),...u];m=g.length;const v=new Array(m);for(let x=0;x<m;x++)v[x]=new Array(c);const w=[],b=[];for(let x=0;x<m;x++){const C=g[x],S=Array.from(C.cells),E=S.length;for(let T=0;T<E;T++){const I=S[T],{nodeName:k,innerHTML:M,rowSpan:D,colSpan:L}=I,U=v[x].findIndex(J=>J===void 0);if(k==="TD"){if(D>1||L>1){for(let se=x;se<x+D;se++)if(se<m)for(let P=U;P<U+L;P++)v[se][P]=null;const X=I.getAttribute("style");X&&X.includes("mso-ignore:colspan")||w.push({col:U,row:x,rowspan:D,colspan:L})}let J="";o&&/excel/gi.test(o.content)?J=M.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):J=M.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),v[x][U]=J.replace(mHe,X=>TY[X])}else b.push(M)}}return w.length&&(r.mergeCells=w),b.length&&(r.rowHeaders=b),v.length&&(r.data=v),r}function Mi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function yHe(t){return Mi(t,[","])}function Qe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function WO(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function _Y(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}const zO="asc",wHe="desc",$3=new Map([[zO,[-1,1]],[wHe,[1,-1]]]),xHe=t=>`The priority '${t}' is already declared in a map.`,bHe=t=>`The priority '${t}' is not a number.`;function SHe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=ar(t)?t:xHe,e=ar(e)?e:bHe;function n(s,o){if(!Mi(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zO;const[o,a]=$3.get(s)||$3.get(zO);return[...r].sort((l,c)=>l[0]<c[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}const CHe=t=>`The id '${t}' is already declared in a map.`;function zS(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ar(t)?t:CHe;function r(c,u){if(l(c))throw new Error(t(c));e.set(c,u)}function n(c){return e.delete(c)}function i(){e.clear()}function s(c){const[u]=a().find(h=>{let[d,f]=h;return c===f?d:!1})||[null];return u}function o(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:n}}const EHe=t=>`'${t}' value is already declared in a unique set.`;function THe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ar(t)?t:EHe;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const NN=t=>`There is already registered "${t}" plugin.`,_He=t=>`There is already registered plugin on priority "${t}".`,RHe=t=>`The priority "${t}" is not a number.`,RY=SHe({errorPriorityExists:_He,errorPriorityNaN:RHe}),AY=THe({errorItemExists:NN}),GO=zS({errorIdExists:NN});function OY(){return[...RY.getItems(),...AY.getItems()]}function MN(t){const e=po(t);return GO.getItem(e)}function AHe(t){return!!MN(t)}function Pt(t,e,r){[t,e,r]=kHe(t,e,r),MN(t)===void 0&&OHe(t,e,r)}function OHe(t,e,r){const n=po(t);if(GO.hasItem(n))throw new Error(NN(n));r===void 0?AY.addItem(n):RY.addItem(r,n),GO.addItem(n,e)}function kHe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:IHe,getItem:NHe,hasItem:kY,getNames:oet,getValues:aet}=Ws("renderers");function H3(t){if(typeof t=="function")return t;if(!kY(t))throw Error(`No registered renderer found under "${t}" name`);return NHe(t)}function Ea(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),IHe(t,e)}const{register:MHe,getItem:PHe,hasItem:IY,getNames:cet,getValues:uet}=Ws("validators");function DHe(t){if(typeof t=="function")return t;if(!IY(t))throw Error(`No registered validator found under "${t}" name`);return PHe(t)}function cm(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),MHe(t,e)}var NY={},LHe=W9,FHe=tN,$He=Object.keys||function(e){return LHe(e,FHe)},HHe=oa,jHe=F9,BHe=ih,VHe=_S,UHe=SS,WHe=$He;NY.f=HHe&&!jHe?Object.defineProperties:function(e,r){VHe(e);for(var n=UHe(r),i=WHe(r),s=i.length,o=0,a;s>o;)BHe.f(e,a=i[o++],n[a]);return e};var zHe=_S,GHe=NY,j3=tN,YHe=ZI,KHe=iG,XHe=JI,qHe=j9,B3=">",V3="<",YO="prototype",KO="script",MY=qHe("IE_PROTO"),ST=function(){},PY=function(t){return V3+KO+B3+t+V3+"/"+KO+B3},U3=function(t){t.write(PY("")),t.close();var e=t.parentWindow.Object;return t=null,e},JHe=function(){var t=XHe("iframe"),e="java"+KO+":",r;return t.style.display="none",KHe.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(PY("document.F=Object")),r.close(),r.F},fy,Ow=function(){try{fy=new ActiveXObject("htmlfile")}catch{}Ow=typeof document<"u"?document.domain&&fy?U3(fy):JHe():U3(fy);for(var t=j3.length;t--;)delete Ow[YO][j3[t]];return Ow()};YHe[MY]=!0;var ZHe=Object.create||function(e,r){var n;return e!==null?(ST[YO]=zHe(e),n=new ST,ST[YO]=null,n[MY]=e):n=Ow(),r===void 0?n:GHe.f(n,r)},QHe=TS,e4e=ZHe,t4e=ih.f,XO=QHe("unscopables"),qO=Array.prototype;qO[XO]===void 0&&t4e(qO,XO,{configurable:!0,value:e4e(null)});var r4e=function(t){qO[XO][t]=!0},n4e=sh,i4e=ES,s4e=RS,o4e=eN,a4e=r4e;n4e({target:"Array",proto:!0},{at:function(e){var r=i4e(this),n=s4e(r),i=o4e(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});a4e("at");const su=1,Jn=2,_h=new WeakMap;class rv{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:r,totalItems:n,itemSizeFn:i,overrideFn:s,calculationType:o,stretchMode:a,stretchingItemWidthFn:l=u=>u,inlineStartOffset:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_h.set(this,{viewportWidth:e,scrollOffset:r,totalColumns:n,columnWidthFn:i,overrideFn:s,calculationType:o,stretchingColumnWidthFn:l,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,r=!0;const n=[];let i,s=0,o=0;const a=_h.get(this),l=a.calculationType,c=a.overrideFn,u=a.scrollOffset,h=Math.max(a.scrollOffset,0),d=a.totalColumns,f=a.viewportWidth,m=h>0?f+1:f;for(let b=0;b<d;b++)if(i=this._getColumnWidth(b),e<=h&&l!==Jn&&(this.startColumn=b,s=i),e>=h&&e+(l===Jn?i:0)<=h+m&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,s=i),this.endColumn=b),n.push(e),e+=i,o=i,l!==Jn&&(this.endColumn=b),e>=h+f){r=!1;break}const g=u+f-m,v=l===Jn?0:o,w=l===Jn?s:0;if(g<-1*a.inlineStartOffset||u>n.at(-1)+v||-1*a.scrollOffset-a.viewportWidth>-1*w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&r)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=n[this.endColumn]+i-n[this.startColumn-1];if((b<=f||l!==Jn)&&(this.startColumn-=1),b>f)break}l===su&&this.startColumn!==null&&c&&c(this),this.startPosition=n[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let r=e;this.totalTargetWidth=r;const n=_h.get(this),i=n.totalColumns;let s=0;for(let a=0;a<i;a++){const l=this._getColumnWidth(a),c=n.stretchingColumnWidthFn(void 0,a);typeof c=="number"?r-=c:s+=l}const o=r-s;if(this.stretch==="all"&&o>0)this.stretchAllRatio=r/s,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&r!==1/0){const a=this._getColumnWidth(i-1),l=o+a;this.stretchLastWidth=l>=0?l:a}}getStretchedColumnWidth(e,r){let n=null;return this.stretch==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,r):this.stretch==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,r){let n=0;const i=_h.get(this),s=i.totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(r*this.stretchAllRatio),a=i.stretchingColumnWidthFn(o,e);a===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)n+=this.stretchAllColumnsWidth[o];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=_h.get(this).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let r=_h.get(this).columnWidthFn(e);return isNaN(r)&&(r=rv.DEFAULT_WIDTH),r}}const W3=new WeakMap;class GS{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:r,totalItems:n,itemSizeFn:i,overrideFn:s,calculationType:o,scrollbarHeight:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W3.set(this,{viewportHeight:e,scrollOffset:r,totalRows:n,rowHeightFn:i,overrideFn:s,calculationType:o,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=W3.get(this),r=e.calculationType,n=e.overrideFn,i=e.rowHeightFn,s=e.scrollOffset,o=Math.max(e.scrollOffset,0),a=e.totalRows,l=e.viewportHeight,c=e.horizontalScrollbarHeight||0;let u=0,h=!0;const d=[];let f,m=0,g=0;for(let x=0;x<a;x++)if(f=i(x),isNaN(f)&&(f=GS.DEFAULT_HEIGHT),u<=o&&r!==Jn&&(this.startRow=x,m=f),u>=o&&u+(r===Jn?f:0)<=o+l-c&&(this.startRow===null&&(this.startRow=x,m=f),this.endRow=x),d.push(u),u+=f,g=f,r!==Jn&&(this.endRow=x),u>=o+l-c){h=!1;break}const v=s+l-c,w=r===Jn?m:0,b=r===Jn?0:g;if(v<w||s>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===a-1&&h)for(this.startRow=this.endRow;this.startRow>0;){const x=d[this.endRow]+f-d[this.startRow-1];if((x<=l-c||r!==Jn)&&(this.startRow-=1),x>=l-c)break}r===su&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function l4e(t,e,r){c4e(t,e),e.set(t,r)}function c4e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z3(t,e,r){return e=u4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u4e(t){var e=h4e(t,"string");return typeof e=="symbol"?e:String(e)}function h4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fg(t,e){var r=DY(t,e,"get");return d4e(t,r)}function d4e(t,e){return e.get?e.get.call(t):e.value}function f4e(t,e,r){var n=DY(t,e,"set");return g4e(t,n,r),r}function DY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function g4e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var jc=new WeakMap;class Sf{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;z3(this,"row",null),z3(this,"col",null),l4e(this,jc,{writable:!0,value:!1}),f4e(this,jc,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(Fg(this,jc)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Fg(this,jc)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Fg(this,jc)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Fg(this,jc)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new Sf(this.row,this.col,Fg(this,jc))}toObject(){return{row:this.row,col:this.col}}}function m4e(t,e,r){p4e(t,e),e.set(t,r)}function p4e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CT(t,e,r){return e=v4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v4e(t){var e=y4e(t,"string");return typeof e=="symbol"?e:String(e)}function y4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _o(t,e){var r=LY(t,e,"get");return w4e(t,r)}function w4e(t,e){return e.get?e.get.call(t):e.value}function x4e(t,e,r){var n=LY(t,e,"set");return b4e(t,n,r),r}function LY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function b4e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var ms=new WeakMap;class nv{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;CT(this,"highlight",null),CT(this,"from",null),CT(this,"to",null),m4e(this,ms,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=r.clone(),this.to=n.clone(),x4e(this,ms,i)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=this.getDirection(),s=e.getOuterTopStartCorner(),o=e.getOuterBottomEndCorner(),a=Math.min(r.row,s.row),l=Math.min(r.col,s.col),c=Math.max(n.row,o.row),u=Math.max(n.col,o.col),h=this._createCellCoords(a,l),d=this._createCellCoords(c,u);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _o(this,ms)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _o(this,ms)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _o(this,ms)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _o(this,ms)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _o(this,ms)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _o(this,ms)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _o(this,ms)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _o(this,ms)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,r){return r&&r.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(r.from.row,r.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(r.from.row,r.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(r.to.row,r.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(r.to.row,r.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,r){if(!(e instanceof Sf))return!1;if(r){const{from:n,to:i}=r;if(r.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push("right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new nv(this.highlight,this.from,this.to,_o(this,ms))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Sf(e,r,_o(this,ms))}}function PN(t){return window.requestAnimationFrame(t)}function _1(t){window.cancelAnimationFrame(t)}function FY(){return"ontouchstart"in window}let Rh;function S4e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Rh||(typeof Intl=="object"?Rh=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Rh=(r,n)=>`${r}`.localeCompare(n):Rh=(r,n)=>r===n?0:r>n?-1:1,Rh)}const Ah=new WeakMap;let $Y=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=n,this.domBindings=r,this.wtTable=s,this.selections=o,this.parent=a,this.eventManager=i,this.facadeGetter=e,Ah.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",n=>this.onContextMenu(n)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",n=>this.onMouseOver(n)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",n=>this.onTouchStart(n)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},r=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",n=>this.onMouseUp(n)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",n=>this.onMouseDown(n))};Go()?e():(FY()&&e(),r())}selectedCellWasTouched(e){const r=Ah.get(this),i=this.parentCell(e).coords;if(r.selectedCellBeforeTouchEnd&&i){const[s,o]=[i.row,r.selectedCellBeforeTouchEnd.from.row],[a,l]=[i.col,r.selectedCellBeforeTouchEnd.from.col];return s===o&&a===l}return!1}parentCell(e){const r={},n=this.wtTable.TABLE,i=hy(e,["TD","TH"],n);return i?(r.coords=this.wtTable.getCoords(i),r.TD=i):lt(e,"wtBorder")&&lt(e,"current")?(r.coords=this.selections.getCell().cellRange.highlight,r.TD=this.wtTable.getCell(r.coords)):lt(e,"wtBorder")&&lt(e,"area")&&this.selections.createOrGetArea().cellRange&&(r.coords=this.selections.createOrGetArea().cellRange.to,r.TD=this.wtTable.getCell(r.coords)),r}onMouseDown(e){const r=Ah.get(this),n=this.domBindings.rootDocument.activeElement,i=fY(R$e,e.target),s=e.target;if(s===n||i(0)===n||i(1)===n)return;const o=this.parentCell(s);lt(s,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,s):o.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(r.dblClickOrigin[0]=o.TD,clearTimeout(r.dblClickTimeout[0]),r.dblClickTimeout[0]=setTimeout(()=>{r.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const r=this.wtTable.TABLE,n=hy(e.target,["TD","TH"],r),i=this.parent||this;n&&n!==i.lastMouseOver&&Ru(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const r=this.wtTable.TABLE,n=hy(e.target,["TD","TH"],r),i=hy(e.relatedTarget,["TD","TH"],r),s=this.parent||this;n&&n!==i&&Ru(n,r)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=Ah.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===r.dblClickOrigin[0]&&n.TD===r.dblClickOrigin[1]?(lt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),r.dblClickOrigin[0]=null,r.dblClickOrigin[1]=null):n.TD===r.dblClickOrigin[0]&&(r.dblClickOrigin[1]=n.TD,clearTimeout(r.dblClickTimeout[1]),r.dblClickTimeout[1]=setTimeout(()=>{r.dblClickOrigin[1]=null},500)))}onTouchStart(e){const r=Ah.get(this);r.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=ze(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&this.wtSettings.getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];wY()&&(nHe()||iHe())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=this.wtSettings.getSettingPure(e);s&&s(r,n,i,this.facadeGetter())}destroy(){const e=Ah.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};class C4e{constructor(e,r,n){this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}class E4e{constructor(e,r,n){this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const T4e=0,R1=1,A1=2;class G3{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class _4e{constructor(){this.size=new G3,this.workingSpace=T4e,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof G3}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=R1,e.workingSpace=A1,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=A1,e.workingSpace=R1,this.sharedSize=e.getViewSize()}}class HY{constructor(e,r,n){this.rootNode=e,this.nodesPool=r,this.sizeSet=new _4e,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let n=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(R1))break;i=i.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,n=this.isSharedViewSet(),{nextSize:i}=r.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!n||n&&r.isPlaceOn(A1)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=n&&r.isPlaceOn(R1);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:r}=this;let n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(A1)&&(n+=r.sharedSize.nextSize);let i=e.childNodes[n];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class jY extends HY{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class R4e{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class iv{constructor(e,r){this.nodesPool=typeof e=="string"?new R4e(e):null,this.nodeType=e,this.rootNode=r,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class A4e extends iv{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new jY(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const c=this.obtainOrderView(l),u=s.obtainOrderView(l);c.appendView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<n;h++){c.render();const d=c.getCurrentNode();d.className="",d.removeAttribute("style"),r[h](a,d,h)}c.end()}}}class O4e extends iv{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&ta(n)}render(){const{columnHeadersCount:e}=this.table;for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),c=o.childNodes[a+s];c.className="",c.removeAttribute("style"),n[r](l,c,r)}}}}class k4e extends iv{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&De(n,"rowHeader")}}let Y3=!1;class I4e extends iv{constructor(e){super("TR",e),this.orderView=new HY(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!Y3&&e>1e3&&(Y3=!0,lr(Jt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++)this.orderView.render();this.orderView.end()}}class N4e extends iv{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new jY(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let s=0;s<e;s++){const o=this.table.renderedRowToSource(s),a=n.getRenderedNode(s);this.sourceRowIndex=o;const l=this.obtainOrderView(a),c=i.obtainOrderView(a);l.prependView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let u=0;u<r;u++){l.render();const h=l.getCurrentNode(),d=this.table.renderedColumnToSource(u);lt(h,"hide")||(h.className=""),h.removeAttribute("style"),h.removeAttribute("dir"),this.table.cellRenderer(o,d,h)}l.end()}}}class M4e{constructor(e){let{cellRenderer:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n);if(i.firstChild){const s=this.renderedRowToSource(n),o=this.rowUtils.getHeight(s);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class P4e{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new M4e(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new A4e,columnHeaders:new O4e(r),colGroup:new k4e(n),rows:new I4e(i),cells:new N4e}),this.renderer.setAxisUtils(s,o)}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class D4e{constructor(e,r){this.dataAccessObject=e,this.wtSettings=r,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const r=this.dataAccessObject.wtViewport.columnsRenderCalculator;let n=this.getWidth(e);if(r){const i=r.getStretchedColumnWidth(e,n);i&&(n=i)}return n}getHeaderHeight(e){let r=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:r,wtViewport:n,cloneSource:i}=this.dataAccessObject,s=i?i.wtTable.holder:r.holder,o=s.offsetHeight<s.scrollHeight?An():0;let a=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-o),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth");for(let u=0;u<l;u++){let h=Array.isArray(a)?a[u]:a;h=h??c,this.headerWidths.set(u,h)}}}}class L4e{constructor(e,r){this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}}function Ro(t,e,r){return e=F4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F4e(t){var e=$4e(t,"string");return typeof e=="symbol"?e:String(e)}function $4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rg{constructor(e,r,n,i,s){Ro(this,"wtSettings",null),Ro(this,"domBindings",void 0),Ro(this,"TBODY",null),Ro(this,"THEAD",null),Ro(this,"COLGROUP",null),Ro(this,"hasTableHeight",!0),Ro(this,"hasTableWidth",!0),Ro(this,"isTableVisible",!1),Ro(this,"tableOffset",0),Ro(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,cY(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new L4e(this.dataAccessObject,this.wtSettings),this.columnUtils=new D4e(this.dataAccessObject,this.wtSettings),this.tableRenderer=new P4e({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!lt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!lt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!lt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),n.appendChild(e)),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,c=r.getSetting("columnHeaders"),u=c.length;let h=!1,d=e;if(this.isMaster&&(this.holderOffset=an(this.holder),d=i.createRenderCalculators(d),l&&!r.getSetting("fixedColumnsStart"))){const m=n.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,g!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=n.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=an(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=s>0?this.getFirstRenderedRow():0,g=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new E4e(m,s,u),this.columnFilter=new C4e(g,o,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const w={};this.wtSettings.getSetting("beforeDraw",!0,w),v=w.skipRender!==!0}if(v){this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(Wo)||this.is(cc))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let w;if(this.isMaster&&(w=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Wo))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const b=qt(this.hider),x=qt(this.TABLE);b!==0&&x!==b&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),w!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Wo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(f=n.bottomOverlay.resetFixedPosition()||f),f=n.inlineStartOverlay.resetFixedPosition()||f,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(n.refreshAll(),n.adjustElementsSize()):this.refreshSelections(d),h&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=Yl(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Wo))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}removeClassFromCells(e){const r=this.TABLE.querySelectorAll(`.${e}`);for(let n=0,i=r.length;n<i;n++)ct(r[n],e)}refreshSelections(e){const{wtSettings:r}=this,{selections:n}=this.dataAccessObject;if(!n)return;const i=Array.from(n),s=i.length;if(e){const o=[];for(let c=0;c<s;c++){const{highlightHeaderClassName:u,highlightRowClassName:h,highlightColumnClassName:d}=i[c].settings,f=i[c].classNames,m=f.length;for(let g=0;g<m;g++)o.includes(f[g])||o.push(f[g]);u&&!o.includes(u)&&o.push(u),h&&!o.includes(h)&&o.push(h),d&&!o.includes(d)&&o.push(d)}const a=r.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(a))for(let c=0;c<a.length;c++)o.push(a[c]);const l=o.length;for(let c=0;c<l;c++)this.removeClassFromCells(o[c])}for(let o=0;o<s;o++)i[o].draw(this.facadeGetter(),e)}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return i==null?void 0:i.childNodes[r]}getRowHeaders(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=_u(r,["TD","TH"])),r===null)return null;const n=r.parentNode,i=n.parentNode;let s=O$e(n),o=r.cellIndex;return Hc(zu,r,this.wtRootElement)||Hc(Uu,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Hc(cc,r,this.wtRootElement)||Hc(Wo,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Hc(zu,r,this.wtRootElement)||Hc(Wu,r,this.wtRootElement)||Hc(cc,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.wtSettings.getSetting("defaultRowHeight"),n=Yl(this.TBODY)-1;let i,s,o,a,l;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=Yl(l):s=Yl(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return qt(this.TABLE)}getHeight(){return Lr(this.TABLE)}getTotalWidth(){const e=qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Lr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return o0(this.TABLE)}_modifyRowHeaderWidth(e){let r=ar(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const H4e="stickyRowsBottom",DN={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};gl(DN,"MIXIN_NAME",H4e,{writable:!1,enumerable:!1});const j4e="stickyColumnsStart",YS={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};gl(YS,"MIXIN_NAME",j4e,{writable:!1,enumerable:!1});class LN extends rg{constructor(e,r,n,i){super(e,r,n,i,cc)}}tr(LN,DN);tr(LN,YS);const Uu="top",Wo="bottom",Wu="inline_start",zu="top_inline_start_corner",cc="bottom_inline_start_corner",B4e=[Uu,Wo,Wu,zu,cc],V4e=new Map([[Uu,`ht_clone_${Uu}`],[Wo,`ht_clone_${Wo}`],[Wu,`ht_clone_${Wu} ht_clone_left`],[zu,`ht_clone_${zu} ht_clone_top_left_corner`],[cc,`ht_clone_${cc} ht_clone_bottom_left_corner`]]);function ET(t,e,r){return e=U4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U4e(t){var e=W4e(t,"string");return typeof e=="symbol"?e:String(e)}function W4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z4e{constructor(e){ET(this,"dataAccessObject",void 0),ET(this,"lastScrolledColumnPos",-1),ET(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,r,n,i,s){const o=this.scrollViewportHorizontally(e.col,n,s),a=this.scrollViewportVertically(e.row,r,i);return o||a}scrollViewportHorizontally(e,r,n){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=r===void 0&&n===void 0,{fixedColumnsStart:c,inlineStartOverlay:u}=this.dataAccessObject;if(l&&e<c)return!1;let h=!1;return o===-1?h=u.scrollTo(e,l?e>this.lastScrolledColumnPos:r):(l&&(e<o||e>a)||!l)&&(h=u.scrollTo(e,l?e>a:r)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,r,n){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=r===void 0&&n===void 0,{fixedRowsBottom:c,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject;if(l&&(e<u||e>s-c-1))return!1;let d=!1;return o===-1?d=h.scrollTo(e,l?e>this.lastScrolledRowPos:n):(l&&(e<o||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledRowPos=e),d}getFirstVisibleRow(){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,fixedRowsTop:s,rootWindow:o}=this.dataAccessObject;let a=r.getFirstVisibleRow();if(e.mainTableScrollableElement===o){const l=an(r.wtRootElement),c=Yl(r.hider),u=Yl(o),h=C1(o,o);if(l.top+c-u<=h){let d=n.getColumnHeaderHeight();d+=e.sumCellSizes(0,s);for(let f=i;f>0;f--)if(d+=e.sumCellSizes(f-1,f),l.top+c-d<=h){a=f;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;let o=r.getLastVisibleRow();if(e.mainTableScrollableElement===s){const a=an(r.wtRootElement),l=C1(s,s);if(a.top>l){const c=Yl(s);let u=n.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(u+=e.sumCellSizes(h-1,h),a.top+u-l>=c){o=h-2;break}}}return o}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:r,wtViewport:n,totalColumns:i,rootWindow:s}=this.dataAccessObject;let o=r.getFirstVisibleColumn();if(e.mainTableScrollableElement===s){const a=an(r.wtRootElement),l=Aw(r.hider),c=Aw(s),u=Math.abs(jO(s,s));if(a.left+l-c<=u){let h=n.getRowHeaderWidth();for(let d=i;d>0;d--)if(h+=e.sumCellSizes(d-1,d),a.left+l-h<=u){o=d;break}}}return o}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;let a=n.getLastVisibleColumn();if(r.mainTableScrollableElement===o){const l=e.getSetting("rtlMode");let c=null;if(l){const h=n.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;c=Math.abs(h.right-f)}else c=an(n.wtRootElement).left;const u=Math.abs(jO(o,o));if(c>u){const h=Aw(o);let d=i.getRowHeaderWidth();for(let f=1;f<=s;f++)if(d+=r.sumCellSizes(f-1,f),c+d-u>=h){a=f-2;break}}}return a}}function qs(t,e,r){return e=G4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G4e(t){var e=Y4e(t,"string");return typeof e=="symbol"?e:String(e)}function Y4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FN{get eventManager(){return new $r(this)}constructor(e,r){qs(this,"wtTable",void 0),qs(this,"wtScroll",void 0),qs(this,"wtViewport",void 0),qs(this,"wtOverlays",void 0),qs(this,"selections",void 0),qs(this,"wtEvent",void 0),qs(this,"guid",`wt_${sY()}`),qs(this,"drawInterrupted",!1),qs(this,"drawn",!1),qs(this,"domBindings",void 0),qs(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new z4e(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){ju(n,e[r])}])}}createCellCoords(e,r){return new Sf(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new nv(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,r,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}function K3(t,e,r){return e=K4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K4e(t){var e=X4e(t,"string");return typeof e=="symbol"?e:String(e)}function X4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q4e extends FN{constructor(e,r,n){super(e,r),K3(this,"cloneSource",void 0),K3(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selections=n.selections,this.wtEvent=new $Y(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,n.event),this.findOriginalHeaders()}}function J4e(t,e,r){return e=Z4e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z4e(t){var e=Q4e(t,"string");return typeof e=="symbol"?e:String(e)}function Q4e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sv{constructor(e,r,n,i,s){J4e(this,"wtSettings",null),gl(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=xf(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const r=e!==this.needFullRender;return r&&!this.needFullRender&&this.reset(),r}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=xf(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=E1(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){lr(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,u,c):h=this.getRelativeCellPositionWithinHolder(o,a,s,u,c),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+An())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-s.start),r){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(B4e.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=r.createElement("DIV"),s=r.createElement("TABLE"),o=e.wtRootElement.parentNode;i.className=`${V4e.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,s.className=e.TABLE.className,i.appendChild(s),o.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return a===!0||a==="horizontal"&&this.type===Uu||a==="vertical"&&this.type===Wu?this.mainTableScrollableElement=n:n.getComputedStyle(o).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=E1(e.TABLE),new q4e(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.shouldBeRendered();this.clone&&(this.needFullRender||r)&&this.clone.draw(e),this.needFullRender=r}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;he([n,i,s],o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class eje extends sv{constructor(e,r,n,i,s,o){super(e,r,cc,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new LN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else VS(r),this.repositionOverlay();let n=Lr(this.clone.wtTable.TABLE);const i=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=An(n)),i.style.bottom=`${s}px`}}const tje="calculatedColumns",KS={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};gl(KS,"MIXIN_NAME",tje,{writable:!1,enumerable:!1});class $N extends rg{constructor(e,r,n,i){super(e,r,n,i,Wo)}}tr($N,DN);tr($N,KS);function rje(t,e,r){return e=nje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nje(t){var e=ije(t,"string");return typeof e=="symbol"?e:String(e)}function ije(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sje extends sv{constructor(e,r,n,i){super(e,r,Wo,n,i),rje(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new $N(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=An(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.mainTableScrollableElement===r?(r.scrollTo(wf(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<r;){const l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=An(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let u=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=s),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=Lr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=An(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return C1(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=lt(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(De(o,"innerBorderBottom"),s=!a):(ct(o,"innerBorderBottom"),s=a)}return s}}const oje="calculatedRows",HN={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};gl(HN,"MIXIN_NAME",oje,{writable:!1,enumerable:!1});class jN extends rg{constructor(e,r,n,i){super(e,r,n,i,Wu)}}tr(jN,HN);tr(jN,YS);class aje extends sv{constructor(e,r,n,i){super(e,r,Wu,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new jN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),_N(n,`${s}px`,"0px")):(s=this.getScrollPosition(),VS(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,a0(r)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=An(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let c=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(c-=i),c=Math.min(c,e.wtRootElement.scrollHeight),o.height=`${c}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=qt(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){var e;const{holder:r}=this.clone.wtTable,{selections:n}=this.wot,i=this.facadeGetter(),s=Math.abs((e=n==null?void 0:n.getCell().getBorder(i).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,r.style.height=r.parentNode.style.height,r.style.width=`${parseInt(r.parentNode.style.width,10)+s}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;if(r){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(r=!1)}return r&&s.offsetWidth!==s.clientWidth&&(o=An(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(jO(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?ct(r,"emptyRows"):De(r,"emptyRows");let o=!1;if(i&&!n.length)De(r,"innerBorderLeft innerBorderInlineStart");else if(!i&&n.length){const a=lt(r,"innerBorderInlineStart");e?(De(r,"innerBorderLeft innerBorderInlineStart"),o=!a):(ct(r,"innerBorderLeft innerBorderInlineStart"),o=a)}return o}}const lje="stickyRowsTop",BN={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};gl(BN,"MIXIN_NAME",lje,{writable:!1,enumerable:!1});class VN extends rg{constructor(e,r,n,i){super(e,r,n,i,zu)}}tr(VN,BN);tr(VN,YS);function X3(t,e,r){return e=cje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cje(t){var e=uje(t,"string");return typeof e=="symbol"?e:String(e)}function uje(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hje extends sv{constructor(e,r,n,i,s,o){super(e,r,zu,n,i),X3(this,"topOverlay",void 0),X3(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new VN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();_N(e,`${i}px`,`${s}px`)}else VS(e);let r=Lr(this.clone.wtTable.TABLE);const n=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class UN extends rg{constructor(e,r,n,i){super(e,r,n,i,Uu)}}tr(UN,BN);tr(UN,KS);function dje(t,e,r){return e=fje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fje(t){var e=gje(t,"string");return typeof e=="symbol"?e:String(e)}function gje(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mje extends sv{constructor(e,r,n,i){super(e,r,Uu,n,i),dje(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new UN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;s=c===u,i=this.getOverlayOffset(),_N(e,"0px",`${i}px`)}else i=this.getScrollPosition(),VS(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const r=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(wf(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=An(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let c=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=Lr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){var e;const{holder:r}=this.clone.wtTable,{selections:n}=this.wot,i=this.facadeGetter(),s=Math.abs((e=n==null?void 0:n.getCell().getBorder(i).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,r.style.width=r.parentNode.style.width,r.style.height=`${parseInt(r.parentNode.style.height,10)+s}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(r){const c=this.wot.wtTable.getRowHeight(e),u=this.wot.wtViewport.getViewportHeight();c>u&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(l=An(this.domBindings.rootDocument)),r){const c=i.getSetting("fixedRowsBottom"),u=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(u-c,u),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return C1(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?ct(n,"emptyColumns"):De(n,"emptyColumns");let s=!1;if(!r){const o=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==o,l=this.wtSettings.getSetting("columnHeaders");if((a||o===0)&&l.length>0){const c=lt(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(De(n,"innerBorderTop"),s=!c):(ct(n,"innerBorderTop"),s=c)}}return s}}function va(t,e,r){return e=pje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pje(t){var e=vje(t,"string");return typeof e=="symbol"?e:String(e)}function vje(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yje{constructor(e,r,n,i,s,o){va(this,"wot",null),va(this,"topOverlay",null),va(this,"bottomOverlay",null),va(this,"inlineStartOverlay",null),va(this,"topInlineStartCornerOverlay",null),va(this,"bottomInlineStartCornerOverlay",null),va(this,"browserLineHeight",void 0),va(this,"wtSettings",null),va(this,"resizeObserver",new ResizeObserver(u=>{PN(()=>{!Array.isArray(u)||!u.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=An(a);const c=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:E1(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new mje(...e),this.bottomOverlay=new sje(...e),this.inlineStartOverlay=new aje(...e),this.topInlineStartCornerOverlay=new hje(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new eje(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!yY())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let u;this.eventManager.addEventListener(r,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l))return;const c=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=u0(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=E1(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:r}=this.wot,{wtTable:n}=this,i=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),o=r.getRowHeaderWidth(),a=r.getColumnHeaderHeight(),l=n.hider.style;if(l.width=`${o+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,s)+1}px`,this.scrollbarSize>0){const{scrollHeight:c,scrollWidth:u}=n.wtRootElement,{scrollHeight:h,scrollWidth:d}=n.holder;this.hasScrollbarRight=c<h,this.hasScrollbarBottom=u<d,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>u?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return he(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];he(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function q3(t,e,r){return e=wje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wje(t){var e=xje(t,"string");return typeof e=="symbol"?e:String(e)}function xje(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let bje=class{constructor(e){q3(this,"settings",{}),q3(this,"defaults",Object.freeze(this.getDefaults())),bt(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);ju(n,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,r){return r===void 0?bt(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};class WN extends rg{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=xf(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=l0(e,"height",r),s=l0(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let{width:c,height:u}=e.getBoundingClientRect();if(n&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const f=parseInt(Bu(d,r).height,10);n.removeChild(d),f===0&&(u=0)}u=Math.min(u,l),o.height=i==="auto"?"auto":`${u}px`,c=Math.min(c,a),o.width=`${c}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=o0(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);r.hasOversizedColumnHeadersMarked[n]=!0}}}tr(WN,HN);tr(WN,KS);class Sje{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=Lr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:r,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=r.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),u=l?c.right-s:c.left,h=s-u;let d,f;if(a)return qt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,s):d=Math.min(this.getContainerFillWidth(),h,s),i===n&&o>0&&this.sumColumnWidths(0,o-1)>d)return r.documentElement.clientWidth;if(i!==n&&(f=l0(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,qt(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,r=this.domBindings.rootDocument.createElement("div");r.style.width="100%",r.style.height="1px",e.appendChild(r);const n=r.offsetWidth;return this.containerWidth=n,e.removeChild(r),n}getWorkspaceOffset(){return an(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Lr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=qt(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:su;const{wtSettings:r,wtTable:n}=this;let i,s,o;this.rowHeaderWidth=NaN,r.getSetting("renderAllRows")&&e===su?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),c=r.getSetting("fixedRowsBottom"),u=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),c&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=An(this.domBindings.rootDocument),new GS({viewportSize:i,scrollOffset:a,totalItems:r.getSetting("totalRows"),itemSizeFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:su;const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=An(this.domBindings.rootDocument)),new rv({viewportSize:i,scrollOffset:s,totalItems:r.getSetting("totalColumns"),itemSizeFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:r.getSetting("stretchH"),stretchingItemWidthFn:(a,l)=>r.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(r){const n=this.createRowsCalculator(Jn),i=this.createColumnsCalculator(Jn);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(r=!1)}return r||(this.rowsRenderCalculator=this.createRowsCalculator(su),this.columnsRenderCalculator=this.createColumnsCalculator(su)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,r}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Jn),this.columnsVisibleCalculator=this.createColumnsCalculator(Jn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:r,endRow:n,isVisibleInTrimmingContainer:i}=e;if(r===null&&n===null)return!i;const{startRow:s,endRow:o}=this.rowsRenderCalculator;return r<s||r===s&&r>0?!1:!(n>o||n===o&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:r,endColumn:n,isVisibleInTrimmingContainer:i}=e;if(r===null&&n===null)return!i;const{startColumn:s,endColumn:o}=this.columnsRenderCalculator;return r<s||r===s&&r>0?!1:!(n>o||n===o&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){bt(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class Cje extends FN{constructor(e,r){super(e,new bje(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new WN(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Sje(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new $Y(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new yje(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];bt(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),ct(this.wtTable.wtRootElement.parentNode,r),De(this.wtTable.wtRootElement.parentNode,n)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class zN{constructor(e){e instanceof FN?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new zN(r);return()=>n},this._wot=new Cje(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n,i,s){return this._wot.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return this._wot.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wot.scrollViewportVertically(e,r,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}class Eje{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ra(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],c=r.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Go()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};bt(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};bt(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selections.createOrGetArea();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(c.borderWidth,10),m=parseInt(c.width,10),g=parseInt(u.width,10),v=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();c.top=`${parseInt(n-m-1,10)}px`,c[l]=`${parseInt(i-m-1,10)}px`,u.top=`${parseInt(n-g/4*3,10)}px`,u[l]=`${parseInt(i-g/4*3,10)}px`;const b=Math.min(parseInt(i+s,10),v-m-f*2),x=Math.min(parseInt(i+s-g/4,10),v-g-f*2);h[l]=`${b}px`,d[l]=`${x}px`;const C=Math.min(parseInt(n+o,10),w-m-f*2),S=Math.min(parseInt(n+o-g/4,10),w-g-f*2);h.top=`${C}px`,d.top=`${S}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(c.display="none",h.display="none",u.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:r,rootDocument:n,rootWindow:i}=this.wot;let s,o,a,l,c,u;const h=r.getRenderedRowsCount();for(let P=0;P<h;P+=1){const y=r.rowFilter.renderedToSource(P);if(y>=e[0]&&y<=e[2]){s=y,c=e[0];break}}for(let P=h-1;P>=0;P-=1){const y=r.rowFilter.renderedToSource(P);if(y>=e[0]&&y<=e[2]){o=y;break}}const d=r.getRenderedColumnsCount();for(let P=0;P<d;P+=1){const y=r.columnFilter.renderedToSource(P);if(y>=e[1]&&y<=e[3]){a=y,u=e[1];break}}for(let P=d-1;P>=0;P-=1){const y=r.columnFilter.renderedToSource(P);if(y>=e[1]&&y<=e[3]){l=y;break}}if(s===void 0||a===void 0){this.disappear();return}let f=r.getCell(this.wot.createCellCoords(s,a));const m=s!==o||a!==l,g=m?r.getCell(this.wot.createCellCoords(o,l)):f,v=an(f),w=m?an(g):v,b=an(r.TABLE),x=qt(r.TABLE),C=v.top,S=v.left,E=this.wot.wtSettings.getSetting("rtlMode");let T=0,I=0;if(E){const P=qt(f),y=i.innerWidth-b.left-x;I=S+P-w.left,T=i.innerWidth-S-P-y-1}else I=w.left+qt(g)-S,T=S-b.left-1;if(this.isEntireColumnSelected(s,o)){const P=this.getDimensionsFromHeader("columns",a,l,c,b);let y=null;P&&([y,T,I]=P),y&&(f=y)}let k=C-b.top-1,M=w.top+Lr(g)-C;if(this.isEntireRowSelected(a,l)){const P=this.getDimensionsFromHeader("rows",s,o,u,b);let y=null;P&&([y,k,M]=P),y&&(f=y)}const D=Bu(f,i);parseInt(D.borderTopWidth,10)>0&&(k+=1,M=M>0?M-1:0),parseInt(D[E?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,I=I>0?I-1:0);const L=E?"right":"left";this.topStyle.top=`${k}px`,this.topStyle[L]=`${T}px`,this.topStyle.width=`${I}px`,this.topStyle.display="block",this.startStyle.top=`${k}px`,this.startStyle[L]=`${T}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";const U=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${k+M-U}px`,this.bottomStyle[L]=`${T}px`,this.bottomStyle.width=`${I}px`,this.bottomStyle.display="block",this.endStyle.top=`${k}px`,this.endStyle[L]=`${T+I-U}px`,this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let J=this.settings.border.cornerVisible;J=typeof J=="function"?J(this.settings.layerLevel):J;const X=this.wot.getSetting("onModifyGetCellCoords",o,l);let[ie,se]=[o,l];if(X&&Array.isArray(X)&&([,,ie,se]=X),Go()||!J||this.isPartRange(ie,se))this.cornerStyle.display="none";else{this.cornerStyle.top=`${k+M+this.cornerCenterPointOffset-1}px`,this.cornerStyle[L]=`${T+I+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let P=xf(r.TABLE);const y=P===i;y&&(P=n.documentElement);const _=parseInt(this.cornerDefaultStyle.width,10)/2,R=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const A=y?g.getBoundingClientRect().left:g.offsetLeft;let O=!1,N=0;E?(N=A-parseInt(this.cornerDefaultStyle.width,10)/2,O=N<0):(N=A+qt(g)+parseInt(this.cornerDefaultStyle.width,10)/2,O=N>=Aw(P)),O&&(this.cornerStyle[L]=`${Math.floor(T+I+this.cornerCenterPointOffset-_)}px`,this.cornerStyle[E?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(y?g.getBoundingClientRect().top:g.offsetTop)+Lr(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=Yl(P)&&(this.cornerStyle.top=`${Math.floor(k+M+this.cornerCenterPointOffset-R)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Go()&&this.updateMultipleSelectionHandlesPosition(o,l,k,T,I,M)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,c=null,u=null,h=null,d=null,f=null,m=null,g=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},c=function(){return Lr(...arguments)},u="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},c=function(){return qt(...arguments)},u="ht__selection--columns",f="left";break}if(a.classList.contains(u)){const v=this.wot.getSetting("columnHeaders").length;if(m=l(r,v-i),g=l(n,v-i),!m||!g)return!1;const w=an(m),b=an(g);return m&&g&&(h=w[f]-s[f]-1,d=b[f]+c(g)-w[f]),[m,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?De(this[e],"hidden"):(lt(this[e],"hidden")&&ct(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?De(this[e],"hidden"):ct(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Go()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}let Tje=class{constructor(e,r){this.settings=e,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Eje(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}addClassAtCoords(e,r,n,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const o=e.wtTable.getCell(this.settings.createCellCoords(r,n));if(typeof o=="object"){let a=i;s&&(a=this.classNameGenerator(o),this.classNames.includes(a)||this.classNames.push(a)),De(o,a)}return this}linearClassNameGenerator(e,r){return function n(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(r===0||s===0)return e;let o=s>=0?s:r,a=e;o-=1;const l=o===0?e:`${e}-${o}`;if(lt(i,l)){const c=o+1;a=`${e}-${c}`}else a=n(i,o);return a}}draw(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}const r=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),i=this.getCorners(),[s,o,a,l]=i,{highlightHeaderClassName:c,highlightColumnClassName:u,highlightRowClassName:h,highlightOnlyClosestHeader:d,selectionType:f}=this.settings,m=f===void 0||["active-header","header"].includes(f);if(m&&o!==null&&l!==null){let g=0;for(let v=0;v<n;v+=1){const w=e.wtTable.columnFilter.renderedToSource(v);if(w>=o&&w<=l){let b=e.wtTable.getColumnHeaders(w);const x=b.length-1;d&&b.length>1&&(b=[b[x]]);for(let C=0;C<b.length;C+=1){const S=[];let E=b[C];c&&S.push(c),u&&S.push(u),C=d?x:C;const T=e.getSetting("onBeforeHighlightingColumnHeader",w,C,{selectionType:f,columnCursor:g,selectionWidth:l-o+1,classNames:S});T!==w&&(E=e.wtTable.getColumnHeader(T,C)),De(E,S)}g+=1}}}if(s!==null&&a!==null){let g=0;for(let v=0;v<r;v+=1){const w=e.wtTable.rowFilter.renderedToSource(v);if(m&&w>=s&&w<=a){let b=e.wtTable.getRowHeaders(w);const x=b.length-1;d&&b.length>1&&(b=[b[x]]);for(let C=0;C<b.length;C+=1){const S=[];let E=b[C];c&&S.push(c),h&&S.push(h),C=d?x:C;const T=e.getSetting("onBeforeHighlightingRowHeader",w,C,{selectionType:f,rowCursor:g,selectionHeight:a-s+1,classNames:S});T!==w&&(E=e.wtTable.getRowHeader(T,C)),De(E,S)}g+=1}if(o!==null&&l!==null)for(let b=0;b<n;b+=1){const x=e.wtTable.columnFilter.renderedToSource(b);w>=s&&w<=a&&x>=o&&x<=l?this.settings.className&&this.addClassAtCoords(e,w,x,this.settings.className,this.settings.markIntersections):w>=s&&w<=a?h&&this.addClassAtCoords(e,w,x,h):x>=o&&x<=l&&u&&this.addClassAtCoords(e,w,x,u);const C=e.getSetting("onAfterDrawSelection",w,x,this.settings.layerLevel);typeof C=="string"&&this.addClassAtCoords(e,w,x,C)}}}e.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(e).appear(i)}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}};function J3(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),u=s.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0)}}function _je(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),c=n.tableProps.countRows();a&&!i.column?n.setRangeEnd(s(c-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r)}const Rje=new Map([["mousedown",J3],["mouseover",_je],["touchstart",J3]]);function Z3(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:s}=e;Rje.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:kN(t)||t.type==="touchstart",isRightClick:Vu(t)})}const BY=new WeakMap,GN=Symbol("rootInstance");function Aje(t){BY.set(t,!0)}function Oje(t){return t===GN}function JO(t){return BY.has(t)}function Q3(t,e,r){kje(t,e),e.set(t,r)}function kje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(t,e,r){return e=Ije(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ije(t){var e=Nje(t,"string");return typeof e=="symbol"?e:String(e)}function Nje(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eB(t,e){var r=VY(t,e,"get");return Mje(t,r)}function Mje(t,e){return e.get?e.get.call(t):e.value}function tB(t,e,r){var n=VY(t,e,"set");return Pje(t,n,r),r}function VY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Pje(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}const Bc=new WeakMap;var TT=new WeakMap,_T=new WeakMap;class Dje{constructor(e){bl(this,"instance",void 0),bl(this,"eventManager",void 0),bl(this,"settings",void 0),bl(this,"THEAD",void 0),bl(this,"TBODY",void 0),bl(this,"_wt",void 0),bl(this,"activeWt",void 0),Q3(this,TT,{writable:!0,value:0}),Q3(this,_T,{writable:!0,value:0}),bl(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new $r(this.instance),this.settings=this.instance.getSettings(),Bc.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n,i,s){return this._wt.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return this._wt.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wt.scrollViewportVertically(e,r,n)}createElements(){const e=Bc.get(this),{rootElement:r,rootDocument:n}=this.instance,i=r.getAttribute("style");i&&r.setAttribute("data-originalstyle",i),De(r,"handsontable"),e.table=n.createElement("TABLE"),De(e.table,"htCore"),this.instance.getSettings().tableClassName&&De(e.table,this.instance.getSettings().tableClassName),this.THEAD=n.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=Bc.get(this),{rootElement:r,rootDocument:n,selection:i}=this.instance,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",o=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(o.target)){const{rootWindow:a}=this.instance;b3(a),o.preventDefault(),a.focus()}}),this.eventManager.addEventListener(r,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(r,"mousemove",o=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&b3(this.instance.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(s,"keyup",o=>{i.isInProgress()&&!o.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",o=>{i.isInProgress()&&kN(o)&&i.finish(),e.mouseDown=!1,(RN(n.activeElement)||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!r.contains(o.target)&&!Vu(o))&&this.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",o=>{i.isInProgress()&&Vu(o)&&(i.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",o=>{const a=o.target,l=o.x||o.clientX,c=o.y||o.clientY;let u=o.target;if(e.mouseDown||!r||!this.instance.view)return;const{holder:h}=this.instance.view._wt.wtTable;if(u===h){const f=An(n);if(n.elementFromPoint(l+f,c)!==h||n.elementFromPoint(l,c+f)!==h)return}else for(;u!==s;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===r)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",o=>{this.settings.fragmentSelection||T1(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>r}initializeWalkontable(){const e=Bc.get(this),r={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>JO(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,a)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||r.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||r.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.instance.hasRowHeaders()&&o.push((a,l)=>{const c=a>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(c,l)}),this.instance.runHooks("afterGetRowHeaderRenderers",o),tB(this,_T,o.length),o},columnHeaders:()=>{const o=[];return this.instance.hasColHeaders()&&o.push((a,l)=>{const c=a>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(c,l)}),this.instance.runHooks("afterGetColumnHeaderRenderers",o),tB(this,TT,o.length),o},columnWidth:o=>{const a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(o);return this.instance.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.instance.rowIndexMapper.getVisualFromRenderableIndex(o);return this.instance.getRowHeight(a===null?o:a)},cellRenderer:(o,a,l)=>{const[c,u]=this.translateFromRenderableToVisualIndex(o,a),h=this.instance.runHooks("modifyGetCellCoords",c,u);let d=c,f=u;Array.isArray(h)&&([d,f]=h);const m=this.instance.getCellMeta(d,f),g=this.instance.colToProp(f);let v=this.instance.getDataAtRowProp(d,g);this.instance.hasHook("beforeValueRender")&&(v=this.instance.runHooks("beforeValueRender",v,m)),this.instance.runHooks("beforeRenderer",l,c,u,g,v,m),this.instance.getCellRenderer(m)(this.instance,l,c,u,g,v,m),this.instance.runHooks("afterRenderer",l,c,u,g,v,m)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(o,a,l,c)=>{const u=this.translateFromRenderableToVisualCoords(a),h={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=c,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",o,u,l,h),!Yh(o)&&(Z3(o,{coords:u,selection:this.instance.selection,controller:h,cellCoordsFactory:(d,f)=>this.instance._createCellCoords(d,f)}),this.instance.runHooks("afterOnCellMouseDown",o,u,l),this.activeWt=this._wt)},onCellContextMenu:(o,a,l,c)=>{const u=this.translateFromRenderableToVisualCoords(a);this.activeWt=c,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",o,u,l),!Yh(o)&&(this.instance.runHooks("afterOnCellContextMenu",o,u,l),this.activeWt=this._wt)},onCellMouseOut:(o,a,l,c)=>{const u=this.translateFromRenderableToVisualCoords(a);this.activeWt=c,this.instance.runHooks("beforeOnCellMouseOut",o,u,l),!Yh(o)&&(this.instance.runHooks("afterOnCellMouseOut",o,u,l),this.activeWt=this._wt)},onCellMouseOver:(o,a,l,c)=>{const u=this.translateFromRenderableToVisualCoords(a),h={row:!1,column:!1,cell:!1};this.activeWt=c,this.instance.runHooks("beforeOnCellMouseOver",o,u,l,h),!Yh(o)&&(e.mouseDown&&Z3(o,{coords:u,selection:this.instance.selection,controller:h,cellCoordsFactory:(d,f)=>this.instance._createCellCoords(d,f)}),this.instance.runHooks("afterOnCellMouseOver",o,u,l),this.activeWt=this._wt)},onCellMouseUp:(o,a,l,c)=>{const u=this.translateFromRenderableToVisualCoords(a);this.activeWt=c,this.instance.runHooks("beforeOnCellMouseUp",o,u,l),!(Yh(o)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",o,u,l),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,l)=>{const c=this.instance.rowIndexMapper,u=c.getVisualFromRenderableIndex(o),h=this.instance.runHooks("beforeHighlightingRowHeader",u,a,l);return c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,a,l)=>{const c=this.instance.columnIndexMapper,u=c.getVisualFromRenderableIndex(o),h=this.instance.runHooks("beforeHighlightingColumnHeader",u,a,l);return c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,a,l)=>{let c;const[u,h]=this.translateFromRenderableToVisualIndex(o,a),d=this.instance.selection.getSelectedRange(),f=d.size();if(f>0){const m=(l??0)+1-f,g=d.peekByIndex(m);c=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.instance.runHooks("afterDrawSelection",u,h,c,l)},onBeforeDrawBorders:(o,a)=>{const[l,c,u,h]=o,d=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(l),this.instance.columnIndexMapper.getVisualFromRenderableIndex(c),this.instance.rowIndexMapper.getVisualFromRenderableIndex(u),this.instance.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.instance.runHooks("beforeDrawBorders",d,a)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,a)=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(a);return this.instance.runHooks("beforeStretchingColumnWidth",o,l)},onModifyRowHeaderWidth:o=>this.instance.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,l)=>{const c=this.instance.rowIndexMapper,u=this.instance.columnIndexMapper,h=a>=0?u.getVisualFromRenderableIndex(a):a,d=o>=0?c.getVisualFromRenderableIndex(o):o,f=this.instance.runHooks("modifyGetCellCoords",d,h,l);if(Array.isArray(f)){const[m,g,v,w]=f;return[m>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,1)):m,g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,-1)):v,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const l=this.countRenderableRows(),c=o.startRow,u=o.endRow;if(typeof a=="number")o.startRow=Math.max(c-a,0),o.endRow=Math.min(u+a,l-1);else if(a==="auto"){const h=Math.ceil(u/l*12);o.startRow=Math.max(c-h,0),o.endRow=Math.min(u+h,l-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const l=this.countRenderableColumns(),c=o.startColumn,u=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(c-a,0),o.endColumn=Math.min(u+a,l-1)),a==="auto"){const h=Math.ceil(u/l*6);o.startColumn=Math.max(c-h,0),o.endColumn=Math.min(u+h,l-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.instance.runHooks("beforeInitWalkontable",r),this._wt=new zN(r),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:s}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(i,s),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(T1(e))return!0;const r=Ru(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Bc.get(this).mouseDown}isSelectedOnlyCell(){var e,r;return(e=(r=this.instance.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,r)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!lt(n,"relative")){ta(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.instance,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.instance.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(r.firstChild){const s=r.firstChild;lt(s,"relative")?this.updateCellHeader(s.querySelector(".colHeader"),e,n,i):(ta(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.instance,o=s.createElement("div"),a=s.createElement("span");o.className="relative",a.className="colHeader",this.updateCellHeader(a,e,n,i),o.appendChild(a),r.appendChild(o)}this.instance.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(lt(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):lt(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?tg(e,n(r,i)):(ju(e,""),De(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){const n=Bc.get(this);[n.lastWidth,n.lastHeight]=[e,r]}getLastSize(){const e=Bc.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return eB(this,TT)}getRowHeadersCount(){return eB(this,_T)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const Lje="ABCDEFGHIJKLMNOPQRSTUVWXYZ",rB=Lje.length;function Fje(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%rB,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/rB,10);return r}function nB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{n.push([s+e,a,o])}):Object.keys(i).forEach(o=>{n.push([s+e,o,i[o]])})}),n}function UY(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&wt(t[0])&&(e=ON(t[0]))),e}function $je(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Hje(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}class jje{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=r,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return he(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0;let o=null,a=null;if(o=this.modifyRowData(e),Array.isArray(o))a=[],s?o.forEach((l,c)=>{a[c]=this.getAtPhysicalCell(e,c,o)}):Qe(r,n,l=>{a[l-r]=this.getAtPhysicalCell(e,l,o)});else if(wt(o)||ar(o))if(i?a=[]:a={},!s||i){const c=this.countFirstRowKeys()-1;Qe(0,c,u=>{const h=this.colToProp(u);if(u>=(r||0)&&u<=(n||c)&&!Number.isInteger(h)){const d=this.getAtPhysicalCell(e,h,o);i?a.push(d):vT(a,h,d)}})}else bt(o,(l,c)=>{vT(a,c,this.getAtPhysicalCell(e,c,o))});return a}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=bf(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}Number.isInteger(r)?this.data[e][r]=n:vT(this.data[e],r,n)}}getAtPhysicalCell(e,r,n){let i=null;if(n&&(typeof r=="string"?i=eHe(n,r):typeof r=="function"?i=r(n):i=n[r]),this.hot.hasHook("modifySourceData")){const s=bf(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const c=[];return Qe(s,a,u=>{c.push(i?this.getAtRow(u,void 0,void 0,n):this.getAtRow(u,o,l,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return UY(this.data)}destroy(){this.data=null,this.hot=null}}const Bje="localHooks",Ri={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)BO(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};gl(Ri,"MIXIN_NAME",Bje,{writable:!1,enumerable:!1});class ch{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ar(this.initValueOrFn)?Qe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Qe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}tr(ch,Ri);function YN(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>ar(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function KN(t,e){return Fs(t,(r,n)=>e.includes(n)===!1)}class Oc extends ch{insert(e,r){this.indexedValues=YN(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=KN(this.indexedValues,e),super.remove(e)}}class XS extends Oc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ai(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function XN(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function h0(t,e){return Fs(t,r=>e.includes(r)===!1)}function qN(t,e){return yt(t,r=>r-e.filter(n=>n<r).length)}function JN(t,e){const r=e[0],n=e.length;return yt(t,i=>i>=r?i+n:i)}function Vje(t,e,r){return e=Uje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uje(t){var e=Wje(t,"string");return typeof e=="symbol"?e:String(e)}function Wje(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qS extends ch{constructor(){super(...arguments),Vje(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=h0(this.orderOfIndexes,[e]),ar(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=YN(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=JN(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=KN(this.indexedValues,e),this.orderOfIndexes=h0(this.orderOfIndexes,e),this.orderOfIndexes=qN(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class ov extends Oc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ai(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const iB=new Map([["indexesSequence",{getListWithInsertedItems:XN,getListWithRemovedItems:h0}],["physicallyIndexed",{getListWithInsertedItems:YN,getListWithRemovedItems:KN}]]),WY=t=>{if(iB.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return iB.get(t)};class zY extends ch{constructor(){super(e=>e)}insert(e,r){const n=JN(this.indexedValues,r);this.indexedValues=XN(n,e,r),super.insert(e,r)}remove(e){const r=h0(this.indexedValues,e);this.indexedValues=qN(r,e),super.remove(e)}}const sB=new Map([["hiding",XS],["index",ch],["linkedPhysicalIndexToValue",qS],["physicalIndexToValue",Oc],["trimming",ov]]);function zje(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!sB.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(sB.get(t))(e)}class ZN{constructor(){this.collection=new Map}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);ze(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return ur(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}tr(ZN,Ri);class oB extends ZN{constructor(e,r){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=yt(this.get(),s=>s.getValues()),n=[],i=ze(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return yt(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return ze(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Gje(t,e,r){Yje(t,e),e.set(t,r)}function Yje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kje(t,e,r){var n=GY(t,e,"set");return Xje(t,n,r),r}function Xje(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function qje(t,e){var r=GY(t,e,"get");return Jje(t,r)}function GY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Jje(t,e){return e.get?e.get.call(t):e.value}var RT=new WeakMap;class YY{constructor(){Gje(this,RT,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(qje(this,RT)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Kje(this,RT,e)}}tr(YY,Ri);function aB(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function $g(t,e,r){Zje(t,e),e.set(t,r)}function Zje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ps(t,e){var r=KY(t,e,"get");return Qje(t,r)}function Qje(t,e){return e.get?e.get.call(t):e.value}function gy(t,e,r){var n=KY(t,e,"set");return e3e(t,n,r),r}function KY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function e3e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var my=new WeakMap,Hg=new WeakMap,py=new WeakMap,vy=new WeakMap,yy=new WeakMap;class t3e{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$g(this,my,{writable:!0,value:new Set}),$g(this,Hg,{writable:!0,value:[]}),$g(this,py,{writable:!0,value:[]}),$g(this,vy,{writable:!0,value:!1}),$g(this,yy,{writable:!0,value:!1}),gy(this,yy,e??!1)}createObserver(){const e=new YY;return ps(this,my).add(e),e.addLocalHook("unsubscribe",()=>{ps(this,my).delete(e)}),e._writeInitialChanges(aB(ps(this,Hg),ps(this,py))),e}emit(e){let r=ps(this,py);(!ps(this,vy)||ps(this,Hg).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(ps(this,yy)):gy(this,Hg,new Array(e.length).fill(ps(this,yy))),ps(this,vy)||(gy(this,vy,!0),r=ps(this,Hg)));const n=aB(r,e);ps(this,my).forEach(i=>i._write(n)),gy(this,py,e)}}class ZO{constructor(){this.indexesSequence=new zY,this.trimmingMapsCollection=new oB(e=>e.some(r=>r===!0),!1),this.hidingMapsCollection=new oB(e=>e.some(r=>r===!0),!1),this.variousMapsCollection=new ZN,this.hidingChangesObservable=new t3e({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,zje(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof ov?this.trimmingMapsCollection.register(e,r):r instanceof XS?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return ze(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return ze(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return ze(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return ze(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=yt(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=h0(this.getIndexesSequence(),n),a=o.filter(c=>this.isTrimmed(c)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<i){const c=a[r];l=o.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(XN(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=ze(n)?n:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=yt(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}tr(ZO,Ri);function r3e(t,e){return bt(e,(r,n)=>{ur(t[n])&&(t[n]=r)}),t}function XY(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function qY(t){ze(t)&&IN(Jt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function n3e(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:i3e,getValues:s3e}=Ws("phraseFormatters");function o3e(t,e){i3e(t,e)}function a3e(){return s3e()}o3e("pluralize",n3e);const JY="ContextMenu:items",ht=JY,QN=`${ht}.noItems`,eM=`${ht}.insertRowAbove`,tM=`${ht}.insertRowBelow`,rM=`${ht}.insertColumnOnTheLeft`,nM=`${ht}.insertColumnOnTheRight`,iM=`${ht}.removeRow`,sM=`${ht}.removeColumn`,oM=`${ht}.undo`,aM=`${ht}.redo`,lM=`${ht}.readOnly`,cM=`${ht}.clearColumn`,uM=`${ht}.copy`,hM=`${ht}.copyWithHeaders`,dM=`${ht}.copyWithGroupHeaders`,fM=`${ht}.copyHeadersOnly`,gM=`${ht}.cut`,mM=`${ht}.freezeColumn`,pM=`${ht}.unfreezeColumn`,vM=`${ht}.mergeCells`,yM=`${ht}.unmergeCells`,wM=`${ht}.addComment`,xM=`${ht}.editComment`,bM=`${ht}.removeComment`,SM=`${ht}.readOnlyComment`,CM=`${ht}.align`,EM=`${ht}.align.left`,TM=`${ht}.align.center`,_M=`${ht}.align.right`,RM=`${ht}.align.justify`,AM=`${ht}.align.top`,OM=`${ht}.align.middle`,kM=`${ht}.align.bottom`,IM=`${ht}.borders`,NM=`${ht}.borders.top`,MM=`${ht}.borders.right`,PM=`${ht}.borders.bottom`,DM=`${ht}.borders.left`,LM=`${ht}.borders.remove`,FM=`${ht}.nestedHeaders.insertChildRow`,$M=`${ht}.nestedHeaders.detachFromParent`,HM=`${ht}.hideColumn`,jM=`${ht}.showColumn`,BM=`${ht}.hideRow`,VM=`${ht}.showRow`,Ai="Filters:",Hr=`${Ai}conditions`,JS=`${Hr}.none`,UM=`${Hr}.isEmpty`,WM=`${Hr}.isNotEmpty`,zM=`${Hr}.isEqualTo`,GM=`${Hr}.isNotEqualTo`,YM=`${Hr}.beginsWith`,KM=`${Hr}.endsWith`,XM=`${Hr}.contains`,qM=`${Hr}.doesNotContain`,l3e=`${Hr}.byValue`,JM=`${Hr}.greaterThan`,ZM=`${Hr}.greaterThanOrEqualTo`,QM=`${Hr}.lessThan`,eP=`${Hr}.lessThanOrEqualTo`,tP=`${Hr}.isBetween`,rP=`${Hr}.isNotBetween`,nP=`${Hr}.after`,iP=`${Hr}.before`,sP=`${Hr}.today`,oP=`${Hr}.tomorrow`,aP=`${Hr}.yesterday`,lP=`${Ai}labels.filterByCondition`,cP=`${Ai}labels.filterByValue`,uP=`${Ai}labels.conjunction`,ZS=`${Ai}labels.disjunction`,O1=`${Ai}values.blankCells`,hP=`${Ai}buttons.selectAll`,dP=`${Ai}buttons.clear`,fP=`${Ai}buttons.ok`,gP=`${Ai}buttons.cancel`,mP=`${Ai}buttons.placeholder.search`,pP=`${Ai}buttons.placeholder.value`,vP=`${Ai}buttons.placeholder.secondValue`,c3e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:wM,CONTEXTMENU_ITEMS_ALIGNMENT:CM,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:kM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:TM,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:RM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:EM,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:OM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:_M,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:AM,CONTEXTMENU_ITEMS_BORDERS:IM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:PM,CONTEXTMENU_ITEMS_BORDERS_LEFT:DM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:MM,CONTEXTMENU_ITEMS_BORDERS_TOP:NM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:cM,CONTEXTMENU_ITEMS_COPY:uM,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:fM,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:dM,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:hM,CONTEXTMENU_ITEMS_CUT:gM,CONTEXTMENU_ITEMS_EDIT_COMMENT:xM,CONTEXTMENU_ITEMS_FREEZE_COLUMN:mM,CONTEXTMENU_ITEMS_HIDE_COLUMN:HM,CONTEXTMENU_ITEMS_HIDE_ROW:BM,CONTEXTMENU_ITEMS_INSERT_LEFT:rM,CONTEXTMENU_ITEMS_INSERT_RIGHT:nM,CONTEXTMENU_ITEMS_MERGE_CELLS:vM,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:$M,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:FM,CONTEXTMENU_ITEMS_NO_ITEMS:QN,CONTEXTMENU_ITEMS_READ_ONLY:lM,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:SM,CONTEXTMENU_ITEMS_REDO:aM,CONTEXTMENU_ITEMS_REMOVE_BORDERS:LM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:sM,CONTEXTMENU_ITEMS_REMOVE_COMMENT:bM,CONTEXTMENU_ITEMS_REMOVE_ROW:iM,CONTEXTMENU_ITEMS_ROW_ABOVE:eM,CONTEXTMENU_ITEMS_ROW_BELOW:tM,CONTEXTMENU_ITEMS_SHOW_COLUMN:jM,CONTEXTMENU_ITEMS_SHOW_ROW:VM,CONTEXTMENU_ITEMS_UNDO:oM,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:pM,CONTEXTMENU_ITEMS_UNMERGE_CELLS:yM,CONTEXT_MENU_ITEMS_NAMESPACE:JY,FILTERS_BUTTONS_CANCEL:gP,FILTERS_BUTTONS_CLEAR:dP,FILTERS_BUTTONS_OK:fP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:mP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:vP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:pP,FILTERS_BUTTONS_SELECT_ALL:hP,FILTERS_CONDITIONS_AFTER:nP,FILTERS_CONDITIONS_BEFORE:iP,FILTERS_CONDITIONS_BEGINS_WITH:YM,FILTERS_CONDITIONS_BETWEEN:tP,FILTERS_CONDITIONS_BY_VALUE:l3e,FILTERS_CONDITIONS_CONTAINS:XM,FILTERS_CONDITIONS_EMPTY:UM,FILTERS_CONDITIONS_ENDS_WITH:KM,FILTERS_CONDITIONS_EQUAL:zM,FILTERS_CONDITIONS_GREATER_THAN:JM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:ZM,FILTERS_CONDITIONS_LESS_THAN:QM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:eP,FILTERS_CONDITIONS_NAMESPACE:Hr,FILTERS_CONDITIONS_NONE:JS,FILTERS_CONDITIONS_NOT_BETWEEN:rP,FILTERS_CONDITIONS_NOT_CONTAIN:qM,FILTERS_CONDITIONS_NOT_EMPTY:WM,FILTERS_CONDITIONS_NOT_EQUAL:GM,FILTERS_CONDITIONS_TODAY:sP,FILTERS_CONDITIONS_TOMORROW:oP,FILTERS_CONDITIONS_YESTERDAY:aP,FILTERS_DIVS_FILTER_BY_CONDITION:lP,FILTERS_DIVS_FILTER_BY_VALUE:cP,FILTERS_LABELS_CONJUNCTION:uP,FILTERS_LABELS_DISJUNCTION:ZS,FILTERS_NAMESPACE:Ai,FILTERS_VALUES_BLANK_CELLS:O1},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const ZY={languageCode:"en-US",[QN]:"No available options",[eM]:"Insert row above",[tM]:"Insert row below",[rM]:"Insert column left",[nM]:"Insert column right",[iM]:["Remove row","Remove rows"],[sM]:["Remove column","Remove columns"],[oM]:"Undo",[aM]:"Redo",[lM]:"Read only",[cM]:"Clear column",[CM]:"Alignment",[EM]:"Left",[TM]:"Center",[_M]:"Right",[RM]:"Justify",[AM]:"Top",[OM]:"Middle",[kM]:"Bottom",[mM]:"Freeze column",[pM]:"Unfreeze column",[IM]:"Borders",[NM]:"Top",[MM]:"Right",[PM]:"Bottom",[DM]:"Left",[LM]:"Remove border(s)",[wM]:"Add comment",[xM]:"Edit comment",[bM]:"Delete comment",[SM]:"Read-only comment",[vM]:"Merge cells",[yM]:"Unmerge cells",[uM]:"Copy",[hM]:["Copy with header","Copy with headers"],[dM]:["Copy with group header","Copy with group headers"],[fM]:["Copy header only","Copy headers only"],[gM]:"Cut",[FM]:"Insert child row",[$M]:"Detach from parent",[HM]:["Hide column","Hide columns"],[jM]:["Show column","Show columns"],[BM]:["Hide row","Hide rows"],[VM]:["Show row","Show rows"],[JS]:"None",[UM]:"Is empty",[WM]:"Is not empty",[zM]:"Is equal to",[GM]:"Is not equal to",[YM]:"Begins with",[KM]:"Ends with",[XM]:"Contains",[qM]:"Does not contain",[JM]:"Greater than",[ZM]:"Greater than or equal to",[QM]:"Less than",[eP]:"Less than or equal to",[tP]:"Is between",[rP]:"Is not between",[nP]:"After",[iP]:"Before",[sP]:"Today",[oP]:"Tomorrow",[aP]:"Yesterday",[O1]:"Blank cells",[lP]:"Filter by condition",[cP]:"Filter by value",[uP]:"And",[ZS]:"Or",[hP]:"Select all",[dP]:"Clear",[fP]:"OK",[gP]:"Cancel",[mP]:"Search",[pP]:"Value",[vP]:"Second value"},u3e=c3e,QO=ZY.languageCode,{register:h3e,getItem:QY,hasItem:d3e,getValues:f3e}=Ws("languagesDictionaries");eK(ZY);function eK(t,e){let r=t,n=e;return wt(t)&&(n=t,r=n.languageCode),g3e(r,n),h3e(r,Si(n)),Si(n)}function g3e(t,e){t!==QO&&r3e(e,QY(QO))}function tK(t){return yP(t)?Si(QY(t)):null}function yP(t){return d3e(t)}function m3e(){return f3e()}function rK(t,e,r){const n=tK(t);if(n===null)return null;const i=n[e];if(ur(i))return null;const s=p3e(i,r);return Array.isArray(s)?s[0]:s}function p3e(t,e){let r=t;return he(a3e(),n=>{r=n(t,e)}),r}function v3e(t){let e=XY(t);return yP(e)||(e=QO,qY(t)),e}const QS="active-header",eC="area",d0="cell",wP="fill",av="header",xP="custom-selection";function y3e(t,e,r){return e=w3e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w3e(t){var e=x3e(t,"string");return typeof e=="symbol"?e:String(e)}function x3e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ng extends Tje{constructor(e,r){super(e,null),y3e(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);if(i===null||s===null)return null;if(i.row>s.row||i.col>s.col){if(!(this.settings.type==="header"||this.settings.type==="active-header"))return null;i=r,s=n}return this.settings.createCellRange(i,i,s)}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){if(r<0)return r;const i=e.getNearestNotHiddenIndex(r,n);return(this.settings.type==="header"||this.settings.type==="active-header")&&i===null?-1:i}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=this.getNearestNotHiddenCoords(e.from.clone().normalize(),r,n);if(i!==null&&e.overlaps(i)){if(this.cellRange===null){const s=this.settings.visualToRenderableCoords(i);this.cellRange=this.settings.createCellRange(s)}return e.setHighlight(i),this}return e.setHighlight(e.from),this}getCorners(){const{from:e,to:r}=this.cellRange,n=e.row===null||r.row===null,i=e.col===null||r.col===null,s=this.settings.createCellCoords(n?null:Math.min(e.row,r.row),i?null:Math.min(e.col,r.col)),o=this.settings.createCellCoords(n?null:Math.max(e.row,r.row),i?null:Math.max(e.col,r.col));return[s.row,s.col,o.row,o.col]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return this.settings.createCellRange(n,n,i)}}function b3e(t){let{activeHeaderClassName:e,...r}=t;return new ng({highlightHeaderClassName:e,...r,selectionType:QS})}function S3e(t){let{layerLevel:e,areaCornerVisible:r,...n}=t;return new ng({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:r},...n,selectionType:eC})}function C3e(t){let{cellCornerVisible:e,...r}=t;return new ng({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:d0})}function E3e(t){let{border:e,visualCellRange:r,...n}=t;return new ng({...e,...n,selectionType:xP},r)}function T3e(t){let{...e}=t;return new ng({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:wP})}function _3e(t){let{headerClassName:e,rowClassName:r,columnClassName:n,...i}=t;return new ng({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:r,highlightColumnClassName:n,...i,highlightOnlyClosestHeader:!0,selectionType:av})}const{register:ig,getItem:R3e}=Ws("highlight/types");ig(QS,b3e);ig(eC,S3e);ig(d0,C3e);ig(xP,E3e);ig(wP,T3e);ig(av,_3e);function Oh(t,e){return R3e(t)({type:t,...e})}class A3e{constructor(e){this.options=e,this.layerLevel=0,this.cell=Oh(d0,e),this.fill=Oh(wP,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,r){let n=e;e===d0&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const e=this.layerLevel;let r;return this.areas.has(e)?r=this.areas.get(e):(r=Oh(eC,{layerLevel:e,...this.options}),this.areas.set(e,r)),r}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const e=this.layerLevel;let r;return this.headers.has(e)?r=this.headers.get(e):(r=Oh(av,{...this.options}),this.headers.set(e,r)),r}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const e=this.layerLevel;let r;return this.activeHeaders.has(e)?r=this.activeHeaders.get(e):(r=Oh(QS,{...this.options}),this.activeHeaders.set(e,r)),r}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Oh(xP,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),he(this.areas.values(),e=>void e.clear()),he(this.headers.values(),e=>void e.clear()),he(this.activeHeaders.values(),e=>void e.clear())}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}class O3e{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const r=this.size()+e-1;let n;return r>=0&&(n=this.ranges[r]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}class nK{constructor(e,r){this.range=e,this.options=r}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.options.createCellCoords(e,r),s=this.range.current().highlight,{row:o,col:a}=this.options.visualToRenderableCoords(s);let l=s,c=0,u=0;if(this.runLocalHooks("beforeTransformStart",i),o!==null&&a!==null){let h=this.options.countRows(),d=this.options.countCols();const f=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),g=this.options.minSpareCols(),v=this.options.autoWrapRow(),w=this.options.autoWrapCol();o+e>h-1?n&&m>0&&!(f&&o>=h-f-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):w&&(i.row=1-h,i.col=a+i.col===d-1?1-d:1):w&&o+i.row<0&&a+i.col>=0&&(i.row=h-1,i.col=a+i.col===0?d-1:-1),a+i.col>d-1?n&&g>0?(this.runLocalHooks("insertColRequire",d),d=this.options.countCols()):v&&(i.row=o+i.row===h-1?1-h:1,i.col=1-d):v&&a+i.col<0&&o+i.row>=0&&(i.row=o+i.row===0?h-1:-1,i.col=d-1);const b=this.options.createCellCoords(o+i.row,a+i.col);c=0,u=0,b.row<0?(c=-1,b.row=0):b.row>0&&b.row>=h&&(c=1,b.row=h-1),b.col<0?(u=-1,b.col=0):b.col>0&&b.col>=d&&(u=1,b.col=d-1),l=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformStart",l,c,u),l}transformEnd(e,r){const n=this.options.createCellCoords(e,r),i=this.range.current();let s=i.to,o=0,a=0;this.runLocalHooks("beforeTransformEnd",n);const{row:l,col:c}=this.options.visualToRenderableCoords(i.highlight);if(l!==null&&c!==null){const u=this.options.countRows(),h=this.options.countCols(),{row:d,col:f}=this.options.visualToRenderableCoords(i.to),m=this.options.createCellCoords(d+n.row,f+n.col);o=0,a=0,m.row<0?(o=-1,m.row=0):m.row>0&&m.row>=u&&(o=1,m.row=u-1),m.col<0?(a=-1,m.col=0):m.col>0&&m.col>=h&&(a=1,m.col=h-1),s=this.options.renderableToVisualCoords(m)}return this.runLocalHooks("afterTransformEnd",s,o,a),s}}tr(nK,Ri);const tC=0,rC=1,iK=2,bP=3,k3e=[bP,iK],I3e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],AT=Symbol("root"),lB=Symbol("child");function Cf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AT;if(e!==AT&&e!==lB)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===AT;let i=tC;if(r){const s=t[0];t.length===0?i=rC:n&&s instanceof nv?i=bP:n&&Array.isArray(s)?i=Cf(s,lB):t.length>=2&&t.length<=4&&!t.some((a,l)=>!I3e[l].includes(typeof a))&&(i=iK)}return i}function f0(t){let{keepDirection:e=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!k3e.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const i=t===bP;let s=i?n.from.row:n[0],o=i?n.from.col:n[1],a=i?n.to.row:n[2],l=i?n.to.col:n[3];if(typeof r=="function"&&(typeof o=="string"&&(o=r(o)),typeof l=="string"&&(l=r(l))),ur(a)&&(a=s),ur(l)&&(l=o),!e){const c=s,u=o,h=a,d=l;s=Math.min(c,h),o=Math.min(u,d),a=Math.max(c,h),l=Math.max(u,d)}return[s,o,a,l]}}function N3e(t){const e=Cf(t);if(e===tC||e===rC)return[];const r=f0(e),n=new Set;he(t,o=>{const[,a,,l]=r(o),c=Math.max(a,0),u=l-c+1;he(Array.from(new Array(u),(h,d)=>c+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return ai(i,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function M3e(t){const e=Cf(t);if(e===tC||e===rC)return[];const r=f0(e),n=new Set;he(t,o=>{const[a,,l]=r(o),c=Math.max(a,0),u=l-c+1;he(Array.from(new Array(u),(h,d)=>c+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return ai(i,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Sl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof t=="number"&&t>=0&&t<e}class sK{constructor(e,r){var n=this;this.settings=e,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new O3e((i,s,o)=>this.tableProps.createCellRange(i,s,o)),this.highlight=new A3e({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new nK(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.settings.selectionMode==="multiple",s=ur(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,o=e.row<0,a=e.col<0,l=o&&a,c=e.clone();this.selectedByCorner=l,this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,c),(!i||i&&!s&&ur(r))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&o&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){this.setRangeStart(e,r,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone();this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const n=this.selectedRange.current();this.settings.selectionMode!=="single"&&n.setTo(this.tableProps.createCellCoords(r.row,r.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(d0,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);const i=this.getLayerLevel();i<this.highlight.layerLevel&&(he(this.highlight.getAreas(),l=>void l.clear()),he(this.highlight.getHeaders(),l=>void l.clear()),he(this.highlight.getActiveHeaders(),l=>void l.clear())),this.highlight.useLayerLevel(i);const s=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(s.clear(),o.clear(),a.clear(),this.highlight.isEnabledFor(eC,n.highlight)&&(this.isMultiple()||i>=1)&&(s.add(n.from).add(n.to).commit(),i===1)){const l=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(av,n.highlight)){const l=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0;let u=n;(l||c)&&(u=n.clone()),l&&(u.from.row=-1),c&&(u.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&u.from.normalize(),o.add(u.from).commit()):o.add(u.from).add(u.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&a.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&a.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=bf(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,r,n))}transformEnd(e,r){this.setRangeEnd(this.transformation.transformEnd(e,r))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.tableProps.countRows(),i=this.tableProps.countCols();if(!e&&!r&&(n===0||i===0))return;const s=this.tableProps.createCellCoords(r?-1:0,e?-1:0),o=this.tableProps.createCellCoords(n-1,i-1);this.clear(),this.setRangeStartOnly(s),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(o),this.finish()}selectCells(e){const r=Cf(e);if(r===rC)return!1;if(r===tC)throw new Error(Jt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=f0(r,{propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=!e.some(a=>{const[l,c,u,h]=n(a);return!(Sl(l,i)&&Sl(c,s)&&Sl(u,i)&&Sl(h,s))});return o&&(this.clear(),he(e,a=>{const[l,c,u,h]=n(a);this.setRangeStartOnly(this.tableProps.createCellCoords(l,c),!1),this.setRangeEnd(this.tableProps.createCellCoords(u,h)),this.finish()})),o}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countCols(),a=this.tableProps.countRows(),l=Sl(i,o)&&Sl(s,o);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,i)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,s)),this.finish()),l}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=Sl(e,i)&&Sl(r,i);return o&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(r,s-1)),this.finish()),o}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.highlight.getCell(),n=this.getLayerLevel();r.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();s.commit(),o.commit(),a.commit()}this.highlight.useLayerLevel(n)}}tr(sK,Ri);const cB=/^(\r\n|\n\r|\r|\n)/,P3e=/^[^\t\r\n]+/,uB=/^\t/;function D3e(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(uB))t=t.replace(uB,""),r+=1,e[n][r]="";else if(t.match(cB))t=t.replace(cB,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(P3e);s=o?o[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function jm(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}class gd{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=ON(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(wt(a)){if(typeof a.data<"u"){const l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return UY(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&bt(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.instance.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&ze(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(ze(r))return this.instance.toVisualColumn(r);const n=this.instance.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?c0(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.instance.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.instance.countRows()&&(o=this.instance.toPhysicalRow(l)),this.instance.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};const u=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&s+a<u;){let m=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?m=Si(this.getSchema()):(m=[],Qe(h-1,()=>m.push(null))):this.instance.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},US(m,this.getSchema())),d.push(m),a+=1}this.instance.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.instance.toVisualRow(o);return this.instance.countSourceRows()===d.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.instance.runHooks("afterCreateRow",f,a,n),this.instance.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.instance.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.instance.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let u=a;l<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(l));const h=this.instance.countSourceRows();let d=this.instance.countCols(),f=0,m=u;i==="end"&&(m=Math.min(m+1,a));const g=m;for(;f<r&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let w=0;w<h;w+=1)typeof s[w]>"u"&&(s[w]=[]),s[w].push(null);else s.push([null]);else for(let w=0;w<h;w++)s[w].splice(m,0,null);f+=1,m+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):n!=="auto"&&this.metaManager.createColumn(g,r));const v=this.instance.toVisualColumn(g);return this.instance.runHooks("afterCreateCol",v,f,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:g}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.instance.countSourceRows();if(i=(o+i)%o,this.instance.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);const u=ze(this.tableMeta.columns)||ze(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((u,h)=>h-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.instance.runHooks("afterRemoveRow",i,l,s,n),this.instance.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.instance.countCols()+i)%this.instance.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((h,d)=>d-h);if(this.instance.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0;const c=o.length,u=this.dataSource;for(let h=0;h<c;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.instance.countSourceRows();h<d;h++)u[h].splice(s[0],r),h===0&&this.metaManager.removeColumn(s[0],r);else for(let h=0,d=this.instance.countSourceRows();h<d;h++)for(let f=0;f<c;f++)u[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(s),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,r,s,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.instance.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];f3(l,o);let u=0;for(;u<n;)l.push(null),u+=1;return b$e(l),this.instance.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.instance.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];f3(l,o);let u=0;for(;u<n;)l.push(null),u+=1;return this.instance.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.instance.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.instance.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.instance.toPhysicalRow(e);let i=this.dataSource[n];const s=this.instance.runHooks("modifyRowData",n);i=isNaN(s)?s:i;let o=null;if(i&&i.hasOwnProperty&&zr(i,r))o=i[r];else if(typeof r=="string"&&r.indexOf(".")>-1){const a=r.split(".");let l=i;if(!l)return null;for(let c=0,u=a.length;c<u;c++)if(l=l[a[c]],typeof l>"u")return null;o=l}else typeof r=="function"&&(o=r(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){const a=bf(o);this.instance.runHooks("modifyData",n,this.propToCol(r),a,"get"),a.isTouched()&&(o=a.value)}return o}getCopyable(e,r){return this.instance.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.instance.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.instance.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.instance.hasHook("modifyData")){const l=bf(s);this.instance.runHooks("modifyData",i,this.propToCol(r),l,"set"),l.isTouched()&&(s=l.value)}if(o&&o.hasOwnProperty&&zr(o,r))o[r]=s;else if(typeof r=="string"&&r.indexOf(".")>-1){const l=r.split(".");let c=o,u=0,h;for(u=0,h=l.length-1;u<h;u++)typeof c[l[u]]>"u"&&(c[l[u]]={}),c=c[l[u]];c[l[u]]=s}else typeof r=="function"?r(this.dataSource.slice(i,i+1)[0],s):o[r]=s}visualRowsToPhysical(e,r){const n=this.instance.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.instance.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.instance.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.instance.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let r=0;r<this.instance.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-r.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,r,gd.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];const u=n===gd.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(c-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=h;s++){a=[];const f=s>=0?this.instance.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=d&&f!==null;o++)a.push(u.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,r){return jm(this.getRange(e,r,gd.DESTINATION_RENDERER))}getCopyableText(e,r){return jm(this.getRange(e,r,gd.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:L3e,getItem:F3e,hasItem:oK,getNames:get,getValues:met}=Ws("cellTypes");function $3e(t){if(!oK(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return F3e(t)}function Do(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&Gi(t,r),n&&Ea(t,n),i&&cm(t,i),L3e(t,e)}function H3e(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!zr(e,t)}function nC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?$3e(e.type):e.type;if(t._automaticallyAssignedMetaProps&&bt(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!wt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};bt(n,(s,o)=>{if(H3e(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),cn(t,i)}function j3e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ac(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function kw(t){return Number.isInteger(t)&&t>=0}function Iw(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function wy(t){return t==null}const aK=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),yn(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),yn(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),AN(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function B3e(){return class{}}class V3e{constructor(e){this.metaCtor=B3e(),this.meta=this.metaCtor.prototype,cn(this.meta,aK()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;cn(this.meta,e),nC(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}class U3e{constructor(e){const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){cn(this.meta,e),nC(this.meta,e,e)}}class ek{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){Iw(()=>kw(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Iw(()=>kw(e)||wy(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=wy(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Iw(()=>kw(e)||wy(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(wy(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Fs(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const W3e=["data","width"];class z3e{constructor(e){this.globalMeta=e,this.metas=new ek(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);cn(n,r),nC(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return j3e(this.globalMeta.getMetaConstructor(),W3e).prototype}}class G3e{constructor(e){this.columnMeta=e,this.metas=new ek(()=>this._createRow())}updateMeta(e,r,n){const i=this.getMeta(e,r);cn(i,n),nC(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)e.push(...r[n].values());return e}getMetasAtRow(e){Iw(()=>kw(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ek(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class lK{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new V3e(e),this.tableMeta=new U3e(this.globalMeta),this.columnMeta=new z3e(this.globalMeta),this.cellMeta=new G3e(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let{visualRow:i,visualColumn:s}=n;const o=this.cellMeta.getMeta(e,r);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=r,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}tr(lK,Ri);function hB(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:c,firstRun:u}=n,h=po(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ar(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,u,l);const f=new gd(i,t,c);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let g,v=0,w=0;for(v=0,w=d.startRows;v<w;v++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)g=Si(m),t.push(g);else if(i.dataType==="array")g=Si(m[0]),t.push(g);else{g=[];for(let b=0,x=d.startCols;b<x;b++)g.push(null);t.push(g)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),r(f),i.runHooks(`after${h}`,t,u,l),u||(i.runHooks("afterChange",null,a),i.render())}class Y3e{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),Ye.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const c=zr(e,"type")?e.type:null;let u=ar(e.cells)?e.cells(n,i,l):null;if(c)if(u){var h;u.type=(h=u.type)!==null&&h!==void 0?h:c}else u={type:c};u&&this.metaManager.updateCellMeta(n,i,u),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}class K3e{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(r,n,i){if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{target:n,onChange:i=()=>{}}=e,s=typeof n=="string",o=s?n:r,a=`_${o}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[o],this.installPropWatcher(r,a,i),s&&this.installPropWatcher(n,a,i)})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const dB=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),xy=t=>t.map(e=>{const r=e.toLowerCase();return dB.has(r)?dB.get(r):r}).sort().join("+"),X3e=t=>t.split("+"),fB=t=>t.toLowerCase(),q3e=t=>{const e=zS({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:c,group:u,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:g,position:v}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ur(u))throw new Error("You need to define the shortcut's group.");if(ar(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Jt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const w={callback:c,group:u,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};ze(g)&&([w.relativeToGroup,w.position]=[g,v]),l.forEach(b=>{const x=xy(b);if(e.hasItem(x)){const S=e.getItem(x);let E=S.findIndex(T=>T.group===g);E!==-1?v==="before"?E-=1:E+=1:E=S.length,S.splice(E,0,w)}else e.addItem(x,[w])})},n=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{bt(c,(h,d)=>{Object.prototype.hasOwnProperty.call(u,d)===!1&&(u[d]=c[d])}),r(u)})},i=l=>{const c=xy(l);e.removeItem(c)};return{addShortcut:r,addShortcuts:n,getShortcuts:l=>{const c=xy(l),u=e.getItem(c);return ze(u)?u.slice():[]},hasShortcut:l=>{const c=xy(l);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[h,d]=u;const f=d.filter(m=>m.group!==l);f.length===0?i(X3e(h)):(d.length=0,d.push(...f))})}}};function J3e(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Z3e=["meta","alt","shift","control"],jg=J3e();function Q3e(t,e,r,n,i){const s=d=>Z3e.includes(d),o=function(d){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return d.altKey&&m.push("alt"),f&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},a=d=>{if(e(d)===!1)return;const f=r(d);if(d.keyCode===229||f===!1||Yh(d))return;const m=fB(d.key);let g=[];s(m)?jg.press(m):g=o(d);const v=[m].concat(g);!i(d,v)&&(M3()&&g.includes("meta")||!M3()&&g.includes("control"))&&i(d,[m].concat(o(d,!0))),n(d)},l=d=>{if(e(d)===!1)return;const f=fB(d.key);s(f)!==!1&&jg.release(f)},c=()=>{jg.releaseAll()};return{mount:()=>{let d=t;for(;d;)d.document.documentElement.addEventListener("keydown",a),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",c),d=S1(d)},unmount:()=>{let d=t;for(;d;)d.document.documentElement.removeEventListener("keydown",a),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",c),d=S1(d)},isPressed:d=>jg.isPressed(d),releasePressedKeys:()=>jg.releaseAll()}}const eBe=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=zS({errorIdExists:f=>`The "${f}" context name is already registered.`});let o="grid";const a=f=>{const m=q3e(f);return s.addItem(f,m),m},l=()=>o,c=f=>s.getItem(f),u=f=>{o=f};let h=!1;const d=Q3e(e,r,n,i,(f,m)=>{const g=c(l());let v=!1;if(!g.hasShortcut(m))return v;const w=g.getShortcuts(m);for(let b=0;b<w.length;b++){const{callback:x,runOnlyIf:C,preventDefault:S,stopPropagation:E,captureCtrl:T}=w[b];if(C(f)!==!1&&(h=T,v=x(f,m)===!1,h=!1,S&&f.preventDefault(),E&&f.stopPropagation(),v))break}return v});return d.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!h&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}},tBe="gridDefault";let OT=null;function SP(t,e){var r;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=this;const o=new $r(s);let a,l,c,u,h=!0;Oje(n)&&Aje(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const d=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",f=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",f),this.isRtl=function(){return f==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=v3e(e.language);const m=new lK(s,e,[Y3e,K3e]),g=m.getTableMeta(),v=m.getGlobalMeta(),w=zS();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),JO(this)&&T$e(e.licenseKey,t),this.guid=`ht_${sY()}`,this.columnIndexMapper=new ZO,this.rowIndexMapper=new ZO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",y=>{s.runHooks("afterColumnSequenceChange",y)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",y=>{s.runHooks("afterRowSequenceChange",y)}),l=new jje(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const b=y=>{const{row:_,col:R}=y;return s._createCellCoords(_>=0?s.rowIndexMapper.getRenderableFromVisualIndex(_):_,R>=0?s.columnIndexMapper.getRenderableFromVisualIndex(R):R)},x=y=>{const{row:_,col:R}=y;return s._createCellCoords(_>=0?s.rowIndexMapper.getVisualFromRenderableIndex(_):_,R>=0?s.columnIndexMapper.getVisualFromRenderableIndex(R):R)};let C=new sK(g,{rowIndexMapper:()=>s.rowIndexMapper,columnIndexMapper:()=>s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:y=>a.propToCol(y),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(y,_)=>s._createCellCoords(y,_),createCellRange:(y,_,R)=>s._createCellRange(y,_,R),visualToRenderableCoords:b,renderableToVisualCoords:x,isDisabledCellSelection:(y,_)=>s.getCellMeta(y,_).disableVisualSelection});this.selection=C;const S=y=>{let{hiddenIndexesChanged:_}=y;_&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",S),this.rowIndexMapper.addLocalHook("cacheUpdated",S),this.selection.addLocalHook("beforeSetRangeStart",y=>{this.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",y=>{this.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",y=>{this.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=this.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",y=>{const _=bf(!1),R=this.selection.getSelectedRange(),{from:A,to:O}=R.current(),N=R.size()-1;this.runHooks("afterSelection",A.row,A.col,O.row,O.col,_,N),this.runHooks("afterSelectionByProp",A.row,s.colToProp(A.col),O.row,s.colToProp(O.col),_,N);const F=this.selection.isSelectedByAnyHeader(),j=this.selection.selectedRange.current();let z=!0;i&&(z=!1),_.isTouched()&&(z=!_.value);const Q=this.selection.isSelectedByRowHeader(),W=this.selection.isSelectedByColumnHeader();z!==!1&&(F?Q?this.view.scrollViewportVertically(s.rowIndexMapper.getRenderableFromVisualIndex(y.row)):W&&this.view.scrollViewportHorizontally(s.columnIndexMapper.getRenderableFromVisualIndex(y.col)):j&&!this.selection.isMultiple()?this.view.scrollViewport(b(j.from)):this.view.scrollViewport(b(y))),Q&&W?De(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?(ct(this.rootElement,"ht__selection--columns"),De(this.rootElement,"ht__selection--rows")):W?(ct(this.rootElement,"ht__selection--rows"),De(this.rootElement,"ht__selection--columns")):ct(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",y=>{const _=y.length-1,{from:R,to:A}=y[_];this.runHooks("afterSelectionEnd",R.row,R.col,A.row,A.col,_),this.runHooks("afterSelectionEndByProp",R.row,s.colToProp(R.col),A.row,s.colToProp(A.col),_)}),this.selection.addLocalHook("afterIsMultipleSelection",y=>{const _=this.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=_)}),this.selection.addLocalHook("beforeModifyTransformStart",y=>{this.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",(y,_,R)=>{this.runHooks("afterModifyTransformStart",y,_,R)}),this.selection.addLocalHook("beforeModifyTransformEnd",y=>{this.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",(y,_,R)=>{this.runHooks("afterModifyTransformEnd",y,_,R)}),this.selection.addLocalHook("afterDeselect",()=>{u.destroyEditor(),this._refreshBorders(),ct(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",y=>{this.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",y=>{this.alter("insert_col_start",y,1,"auto")}),c={alter(y,_){var R,A;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const j=z=>{if(z.length===0)return[];const Q=[...z];return Q.sort((ae,ye)=>{let[H]=ae,[Re]=ye;return H===Re?0:H>Re?1:-1}),ai(Q,(ae,ye)=>{let[H,Re]=ye;const ue=ae[ae.length-1],[Pe,ke]=ue,be=Pe+ke;if(H<=be){const Fe=Math.max(Re-(be-H),0);ue[1]+=Fe}else ae.push([H,Re]);return ae},[Q[0]])};switch(y){case"insert_row_below":case"insert_row_above":const z=s.countSourceRows();if(g.maxRows===z)return;const Q=y==="insert_row_below"?"below":"above";_=(R=_)!==null&&R!==void 0?R:Q==="below"?z:0;const{delta:W,startPhysicalIndex:ae}=a.createRow(_,O,{source:N,mode:Q});if(W){const ke=C.selectedRange.current(),be=ke==null?void 0:ke.from,Fe=be==null?void 0:be.row,He=s.toVisualRow(ae);if(C.isSelectedByCorner())s.selectAll();else if(ze(Fe)&&Fe>=He){const{row:V,col:K}=ke.to;let te=be.col;C.isSelectedByRowHeader()&&(te=-1),C.getSelectedRange().pop(),C.setRangeStartOnly(s._createCellCoords(Fe+W,te),!0),C.setRangeEnd(s._createCellCoords(V+W,K))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const ye=y==="insert_col_end"?"end":"start";_=(A=_)!==null&&A!==void 0?A:ye==="end"?s.countSourceCols():0;const{delta:H,startPhysicalIndex:Re}=a.createCol(_,O,{source:N,mode:ye});if(H){if(Array.isArray(g.colHeaders)){const V=[s.toVisualColumn(Re),0];V.length+=H,Array.prototype.splice.apply(g.colHeaders,V)}const ke=C.selectedRange.current(),be=ke==null?void 0:ke.from,Fe=be==null?void 0:be.col,He=s.toVisualColumn(Re);if(C.isSelectedByCorner())s.selectAll();else if(ze(Fe)&&Fe>=He){const{row:V,col:K}=ke.to;let te=be.row;C.isSelectedByColumnHeader()&&(te=-1),C.getSelectedRange().pop(),C.setRangeStartOnly(s._createCellCoords(te,Fe+H),!0),C.setRangeEnd(s._createCellCoords(V,K+H))}else s._refreshBorders()}break;case"remove_row":const ue=ke=>{let be=0;he(ke,Fe=>{let[He,V]=Fe;const K=yn(He)?s.countRows()-1:Math.max(He-be,0);if(Number.isInteger(He)&&(He=Math.max(He-be,0)),!a.removeRow(He,V,N))return;const ve=s.countRows(),le=g.fixedRowsTop;le>=K+1&&(g.fixedRowsTop-=Math.min(V,le-K));const ce=g.fixedRowsBottom;ce&&K>=ve-ce&&(g.fixedRowsBottom-=Math.min(V,ce)),be+=V})};Array.isArray(_)?ue(j(_)):ue([[_,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Pe=ke=>{let be=0;he(ke,Fe=>{let[He,V]=Fe;const K=yn(He)?s.countCols()-1:Math.max(He-be,0);let te=s.toPhysicalColumn(K);if(Number.isInteger(He)&&(He=Math.max(He-be,0)),!a.removeCol(He,V,N))return;const le=g.fixedColumnsStart;le>=K+1&&(g.fixedColumnsStart-=Math.min(V,le-K)),Array.isArray(g.colHeaders)&&(typeof te>"u"&&(te=-1),g.colHeaders.splice(te,V)),be+=V})};Array.isArray(_)?Pe(j(_)):Pe([[_,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${y}"`)}F||c.adjustRowsAndCols()},adjustRowsAndCols(){const y=g.minRows,_=g.minSpareRows,R=g.minCols,A=g.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&C.deselect(),y){const O=s.countRows();O<y&&a.createRow(O,y-O,{source:"auto"})}if(_){const O=s.countEmptyRows(!0);if(O<_){const N=_-O,F=Math.min(N,g.maxRows-s.countSourceRows());a.createRow(s.countRows(),F,{source:"auto"})}}{let O;(R||A)&&(O=s.countEmptyCols(!0));let N=s.countCols();if(R&&!g.columns&&N<R){const F=R-N;O+=F,a.createCol(N,F,{source:"auto"})}if(A&&!g.columns&&s.dataType==="array"&&O<A){N=s.countCols();const F=A-O,j=Math.min(F,g.maxCols-N);a.createCol(N,j,{source:"auto"})}}if(C.isSelected()){const O=s.countRows(),N=s.countCols();he(C.selectedRange,F=>{let j=!1,z=F.from.row,Q=F.from.col,W=F.to.row,ae=F.to.col;z>O-1?(z=O-1,j=!0,W>z&&(W=z)):W>O-1&&(W=O-1,j=!0,z>W&&(z=W)),Q>N-1?(Q=N-1,j=!0,ae>Q&&(ae=Q)):ae>N-1&&(ae=N-1,j=!0,Q>ae&&(Q=ae)),j&&s.selectCell(z,Q,W,ae)})}s.view&&s.view.adjustElementsSize()},populateFromArray(y,_,R,A,O){let N,F,j,z;const Q=[],W={},ae=[],ye=y.row,H=y.col;if(F=_.length,F===0)return!1;let Re=0,ue=0;switch(wt(R)&&(Re=R.col-H+1,ue=R.row-ye+1),O){case"shift_down":const Pe=Rw(_),ke=Pe.length,be=Math.max(ke,Re),Fe=s.getData().slice(ye),He=Rw(Fe).slice(H,H+be);for(j=0;j<be;j+=1)if(j<ke){for(N=0,F=Pe[j].length;N<ue-F;N+=1)Pe[j].push(Pe[j][N%F]);j<He.length?ae.push(Pe[j].concat(He[j])):ae.push(Pe[j].concat(new Array(Fe.length).fill(null)))}else ae.push(Pe[j%ke].concat(He[j]));s.populateFromArray(ye,H,Rw(ae));break;case"shift_right":const V=_.length,K=Math.max(V,ue),te=s.getData().slice(ye).map(pe=>pe.slice(H));for(N=0;N<K;N+=1)if(N<V){for(j=0,z=_[N].length;j<Re-z;j+=1)_[N].push(_[N][j%z]);if(N<te.length)for(let pe=0;pe<te[N].length;pe+=1)_[N].push(te[N][pe]);else _[N].push(...new Array(te[0].length).fill(null))}else _.push(_[N%F].slice(0,K).concat(te[N]));s.populateFromArray(ye,H,_);break;case"overwrite":default:W.row=y.row,W.col=y.col;let ve=0,le=0,ce=!0,me;const de=function(Ie){let je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Be=_[Ie%_.length];return je!==null?Be[je%Be.length]:Be},fe=_.length,ge=R?R.row-y.row+1:0;for(R?F=ge:F=Math.max(fe,ge),N=0;N<F&&!(R&&W.row>R.row&&ge>fe||!g.allowInsertRow&&W.row>s.countRows()-1||W.row>=g.maxRows);N++){const pe=N-ve,Ie=de(pe).length,je=R?R.col-y.col+1:0;if(R?z=je:z=Math.max(Ie,je),W.col=y.col,me=s.getCellMeta(W.row,W.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&me.skipRowOnPaste){ve+=1,W.row+=1,F+=1;continue}for(le=0,j=0;j<z&&!(R&&W.col>R.col&&je>Ie||!g.allowInsertColumn&&W.col>s.countCols()-1||W.col>=g.maxCols);j++){if(me=s.getCellMeta(W.row,W.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&me.skipColumnOnPaste){le+=1,W.col+=1,z+=1;continue}if(me.readOnly&&A!=="UndoRedo.undo"){W.col+=1;continue}const Be=j-le;let Je=de(pe,Be),it=s.getDataAtCell(W.row,W.col);if(Je!==null&&typeof Je=="object")if(Array.isArray(Je)&&it===null&&(it=[]),it===null||typeof it!="object")ce=!1;else{const Rt=c0(Array.isArray(it)?it:it[0]||it),ot=c0(Array.isArray(Je)?Je:Je[0]||Je);AN(Rt,ot)||Array.isArray(Rt)&&Array.isArray(ot)?Je=Si(Je):ce=!1}else it!==null&&typeof it=="object"&&(ce=!1);ce&&Q.push([W.row,W.col,Je]),ce=!0,W.col+=1}W.row+=1}s.setDataAtCell(Q,null,null,A||"populateFromArray");break}}};function E(y){const _=XY(y);yP(_)?(s.runHooks("beforeLanguageChange",_),v.language=_,s.runHooks("afterLanguageChange",_)):qY(y)}function T(y,_){const R=y==="className"?s.rootElement:s.table;if(h)De(R,_);else{let A=[],O=[];v[y]&&(A=Array.isArray(v[y])?v[y]:m3(v[y])),_&&(O=Array.isArray(_)?_:m3(_));const N=g3(A,O),F=g3(O,A);N.length&&ct(R,N),F.length&&De(R,F)}v[y]=_}this.init=function(){l.setData(g.data),s.runHooks("beforeInit"),(Go()||xY())&&De(s.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new Dje(this),u=UO.getInstance(s,g,C),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&s.rootElement.offsetParent===null&&F$e(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof h=="object"&&(s.runHooks("afterChange",h[0],h[1]),h=!1),s.runHooks("afterInit")};function I(){let y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function k(y){const _=y.replace(",",".");return isNaN(parseFloat(_))===!1?parseFloat(_):y}function M(y,_,R){if(!y.length)return;const A=s.getActiveEditor(),O=new I;let N=!0;O.onQueueEmpty=F=>{A&&N&&A.cancelChanges(),R(F)};for(let F=y.length-1;F>=0;F--){const[j,z,,Q]=y[F],W=a.propToCol(z),ae=s.getCellMeta(j,W);ae.type==="numeric"&&typeof Q=="string"&&yHe(Q)&&(y[F][3]=k(Q)),s.getCellValidator(ae)&&(O.addValidatorToQueue(),s.validateCell(y[F][3],ae,function(ye,H){return function(Re){if(typeof Re!="boolean")throw new Error("Validation error: result is not boolean");if(Re===!1&&H.allowInvalid===!1){N=!1,y.splice(ye,1),H.valid=!0;const ue=s.getCell(H.visualRow,H.visualCol);ue!==null&&ct(ue,g.invalidCellClassName)}O.removeValidatorFormQueue()}}(F,ae),_))}O.checkIfQueueIsEmpty()}function D(y,_){let R=y.length-1;if(R<0)return;for(;R>=0;R--){let O=!1;if(y[R]===null){y.splice(R,1);continue}if(!((y[R][2]===null||y[R][2]===void 0)&&(y[R][3]===null||y[R][3]===void 0))){if(g.allowInsertRow)for(;y[R][0]>s.countRows()-1;){const{delta:N}=a.createRow(void 0,void 0,{source:_});if(N===0){O=!0;break}}if(s.dataType==="array"&&(!g.columns||g.columns.length===0)&&g.allowInsertColumn)for(;a.propToCol(y[R][1])>s.countCols()-1;){const{delta:N}=a.createCol(void 0,void 0,{source:_});if(N===0){O=!0;break}}O||a.set(y[R][0],y[R][1],y[R][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",y,_),u.lockEditor(),s._refreshBorders(null),u.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",y,_||"edit");const A=s.getActiveEditor();A&&ze(A.refreshValue)&&A.refreshValue()}this._createCellCoords=function(y,_){return s.view._wt.createCellCoords(y,_)},this._createCellRange=function(y,_,R){return s.view._wt.createCellRange(y,_,R)},this.validateCell=function(y,_,R,A){let O=s.getCellValidator(_);function N(F){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||_.hidden===!0){R(F);return}const z=_.visualCol,Q=_.visualRow,W=s.getCell(Q,z,!0);if(W&&W.nodeName!=="TH"){const ae=s.rowIndexMapper.getRenderableFromVisualIndex(Q),ye=s.columnIndexMapper.getRenderableFromVisualIndex(z);s.view._wt.getSetting("cellRenderer",ae,ye,W)}R(F)}S$e(O)&&(O=function(F){return function(j,z){z(F.test(j))}}(O)),ar(O)?(y=s.runHooks("beforeValidate",y,_.visualRow,_.prop,A),s._registerImmediate(()=>{O.call(_,y,F=>{s&&(F=s.runHooks("afterValidate",F,y,_.visualRow,_.prop,A),_.valid=F,N(F),s.runHooks("postAfterValidate",F,y,_.visualRow,_.prop,A))})})):s._registerImmediate(()=>{_.valid=!0,N(_.valid,!1)})};function L(y,_,R){return Array.isArray(y)?y:[[y,_,R]]}function U(y,_){const R=s.getActiveEditor(),A=s.runHooks("beforeChange",y,_||"edit"),O=y.filter(N=>N!==null);return A===!1||O.length===0?(R&&R.cancelChanges(),[]):O}this.setDataAtCell=function(y,_,R,A){const O=L(y,_,R),N=[];let F=A,j,z,Q;for(j=0,z=O.length;j<z;j++){if(typeof O[j]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[j][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[j][1]>=this.countCols()?Q=O[j][1]:Q=a.colToProp(O[j][1]),N.push([O[j][0],Q,l.getAtCell(this.toPhysicalRow(O[j][0]),O[j][1]),O[j][2]])}!F&&typeof y=="object"&&(F=_);const W=U(N,A);s.runHooks("afterSetDataAtCell",W,F),M(W,F,()=>{D(W,F)})},this.setDataAtRowProp=function(y,_,R,A){const O=L(y,_,R),N=[];let F=A,j,z;for(j=0,z=O.length;j<z;j++)N.push([O[j][0],O[j][1],l.getAtCell(this.toPhysicalRow(O[j][0]),O[j][1]),O[j][2]]);!F&&typeof y=="object"&&(F=_);const Q=U(N,A);s.runHooks("afterSetDataAtRowProp",Q,F),M(Q,F,()=>{D(Q,F)})},this.listen=function(){s&&!s.isListening()&&(OT=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(OT=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return OT===s.guid},this.destroyEditor=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(y,_)},this.populateFromArray=function(y,_,R,A,O,N,F){if(!(typeof R=="object"&&typeof R[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const j=typeof A=="number"?s._createCellCoords(A,O):null;return c.populateFromArray(s._createCellCoords(y,_),R,j,N,F)},this.spliceCol=function(y,_,R){for(var A=arguments.length,O=new Array(A>3?A-3:0),N=3;N<A;N++)O[N-3]=arguments[N];return a.spliceCol(y,_,R,...O)},this.spliceRow=function(y,_,R){for(var A=arguments.length,O=new Array(A>3?A-3:0),N=3;N<A;N++)O[N-3]=arguments[N];return a.spliceRow(y,_,R,...O)},this.getSelected=function(){if(C.isSelected())return yt(C.getSelectedRange(),y=>{let{from:_,to:R}=y;return[_.row,_.col,R.row,R.col]})},this.getSelectedLast=function(){const y=this.getSelected();let _;return y&&y.length>0&&(_=y[y.length-1]),_},this.getSelectedRange=function(){if(C.isSelected())return Array.from(C.getSelectedRange())},this.getSelectedRangeLast=function(){const y=this.getSelectedRange();let _;return y&&y.length>0&&(_=y[y.length-1]),_},this.emptySelectedCells=function(y){if(!C.isSelected()||this.countRows()===0||this.countCols()===0)return;const _=[];he(C.getSelectedRange(),R=>{const A=R.getTopStartCorner(),O=R.getBottomEndCorner();Qe(A.row,O.row,N=>{Qe(A.col,O.col,F=>{this.getCellMeta(N,F).readOnly||_.push([N,F,null])})})}),_.length>0&&this.setDataAtCell(_,y)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(y){this.suspendRender();const _=y();return this.resumeRender(),_},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const _=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(_,0),(!this.isExecutionSuspended()&&_===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const R=y();return this.resumeExecution(_),R},this.batch=function(y){this.suspendRender(),this.suspendExecution();const _=y();return this.resumeExecution(),this.resumeRender(),_},this.refreshDimensions=function(){if(!s.view)return;const{width:y,height:_}=s.view.getLastSize(),{width:R,height:A}=s.rootElement.getBoundingClientRect(),O=R!==y||A!==_;s.runHooks("beforeRefreshDimensions",{width:y,height:_},{width:R,height:A},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(R,A),s.render()),s.runHooks("afterRefreshDimensions",{width:y,height:_},{width:R,height:A},O))},this.updateData=function(y,_){hB(y,R=>{a=R},R=>{a=R,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:_,metaManager:m,firstRun:h})},this.loadData=function(y,_){hB(y,R=>{a=R},()=>{m.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:_,metaManager:m,firstRun:h})},this.getInitialColumnCount=function(){const y=g.columns;let _=0;if(Array.isArray(y))_=y.length;else if(ar(y))if(s.dataType==="array"){const R=this.countSourceCols();for(let A=0;A<R;A+=1)y(A)&&(_+=1)}else(s.dataType==="object"||s.dataType==="function")&&(_=a.colToPropCache.length);else if(ze(g.dataSchema)){const R=a.getSchema();_=Array.isArray(R)?R.length:ON(R)}else _=this.countSourceCols();return _},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,_,R,A){return ur(y)?a.getAll():a.getRange(s._createCellCoords(y,_),s._createCellCoords(R,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(y,_,R,A){return a.getCopyableText(s._createCellCoords(y,_),s._createCellCoords(R,A))},this.getCopyableData=function(y,_){return a.getCopyable(y,a.colToProp(_))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const R=(h?s.loadData:s.updateData).bind(this);let A=!1,O,N;if(ze(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ze(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ze(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in y)O==="data"||(O==="language"?E(y.language):O==="className"?T("className",y.className):O==="tableClassName"&&s.table?(T("tableClassName",y.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Ye.getSingleton().isRegistered(O)||Ye.getSingleton().isDeprecated(O)?(ar(y[O])||Array.isArray(y[O]))&&(y[O].initialHook=!0,s.addHook(O,y[O])):!_&&zr(y,O)&&(v[O]=y[O]));y.data===void 0&&g.data===void 0?R(null,"updateSettings"):y.data!==void 0?R(y.data,"updateSettings"):y.columns!==void 0&&(a.createMap(),s.initIndexMappers());const F=s.countCols(),j=g.columns;if(j&&ar(j)&&(A=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&m.clearCache(),F>0)for(O=0,N=0;O<F;O++){if(j){const W=A?j(O):j[N];W&&m.updateColumnMeta(N,W)}N+=1}ze(y.cell)&&bt(y.cell,W=>{s.setCellMetaObject(W.row,W.col,W)}),s.runHooks("afterCellMetaReset");let z=s.rootElement.style.height;z!==""&&(z=parseInt(s.rootElement.style.height,10));let Q=y.height;if(ar(Q)&&(Q=Q()),_&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Q===null){const W=s.rootElement.getAttribute("data-initialstyle");W&&(W.indexOf("height")>-1||W.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",W):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Q!==void 0&&(s.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,s.rootElement.style.overflow="hidden");if(typeof y.width<"u"){let W=y.width;ar(W)&&(W=W()),s.rootElement.style.width=isNaN(W)?`${W}`:`${W}px`}_||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",y)),c.adjustRowsAndCols(),s.view&&!h&&(s.forceFullRender=!0,u.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),!_&&s.view&&(z===""||Q===""||Q===void 0)&&z!==Q&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const y=s.getSelectedLast();if(g.getValue){if(ar(g.getValue))return g.getValue.call(s);if(y)return s.getData()[y[0][0]][g.getValue]}else if(y)return s.getDataAtCell(y[0],y[1])},this.getSettings=function(){return g},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,_,R,A,O){c.alter(y,_,R,A,O)},this.getCell=function(y,_){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=_,O=y;if(_>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(_)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(_)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return O===null||A===null?null:s.view.getCellAtCoords(s._createCellCoords(O,A),R)},this.getCoords=function(y){const _=this.view._wt.wtTable.getCoords(y);if(_===null)return null;const{row:R,col:A}=_;let O=R,N=A;return R>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(R)),A>=0&&(N=this.columnIndexMapper.getVisualFromRenderableIndex(A)),s._createCellCoords(O,N)},this.colToProp=function(y){return a.colToProp(y)},this.propToCol=function(y){return a.propToCol(y)},this.toVisualRow=y=>this.rowIndexMapper.getVisualFromPhysicalIndex(y),this.toVisualColumn=y=>this.columnIndexMapper.getVisualFromPhysicalIndex(y),this.toPhysicalRow=y=>this.rowIndexMapper.getPhysicalFromVisualIndex(y),this.toPhysicalColumn=y=>this.columnIndexMapper.getPhysicalFromVisualIndex(y),this.getDataAtCell=function(y,_){return a.get(y,a.colToProp(_))},this.getDataAtRowProp=function(y,_){return a.get(y,_)},this.getDataAtCol=function(y){const _=[],R=a.getRange(s._createCellCoords(0,y),s._createCellCoords(g.data.length-1,y),a.DESTINATION_RENDERER);for(let A=0;A<R.length;A+=1)for(let O=0;O<R[A].length;O+=1)_.push(R[A][O]);return _},this.getDataAtProp=function(y){const _=[],R=a.getRange(s._createCellCoords(0,a.propToCol(y)),s._createCellCoords(g.data.length-1,a.propToCol(y)),a.DESTINATION_RENDERER);for(let A=0;A<R.length;A+=1)for(let O=0;O<R[A].length;O+=1)_.push(R[A][O]);return _},this.getSourceData=function(y,_,R,A){let O;return y===void 0?O=l.getData():O=l.getByRange(s._createCellCoords(y,_),s._createCellCoords(R,A)),O},this.getSourceDataArray=function(y,_,R,A){let O;return y===void 0?O=l.getData(!0):O=l.getByRange(s._createCellCoords(y,_),s._createCellCoords(R,A),!0),O},this.getSourceDataAtCol=function(y){return l.getAtColumn(y)},this.setSourceDataAtCell=function(y,_,R,A){const O=L(y,_,R),N=this.hasHook("afterSetSourceDataAtCell"),F=[];N&&he(O,z=>{let[Q,W,ae]=z;F.push([Q,W,l.getAtCell(Q,W),ae])}),he(O,z=>{let[Q,W,ae]=z;l.setAtCell(Q,W,ae)}),N&&this.runHooks("afterSetSourceDataAtCell",F,A),this.render();const j=s.getActiveEditor();j&&ze(j.refreshValue)&&j.refreshValue()},this.getSourceDataAtRow=function(y){return l.getAtRow(y)},this.getSourceDataAtCell=function(y,_){return l.getAtCell(y,_)},this.getDataAtRow=function(y){return a.getRange(s._createCellCoords(y,0),s._createCellCoords(y,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(y,_,R,A){const O=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,_,R,A],[N,F]=O;let[,,j,z]=O,Q=null,W=null;j===void 0&&(j=N),z===void 0&&(z=F);let ae="mixed";return Qe(Math.max(Math.min(N,j),0),Math.max(N,j),ye=>{let H=!0;return Qe(Math.max(Math.min(F,z),0),Math.max(F,z),Re=>(W=this.getCellMeta(ye,Re).type,Q?H=Q===W:Q=W,H)),ae=H?W:"mixed",H}),ae},this.removeCellMeta=function(y,_,R){const[A,O]=[this.toPhysicalRow(y),this.toPhysicalColumn(_)];let N=m.getCellMetaKeyValue(A,O,R);s.runHooks("beforeRemoveCellMeta",y,_,R,N)!==!1&&(m.removeCellMeta(A,O,R),s.runHooks("afterRemoveCellMeta",y,_,R,N)),N=null},this.spliceCellsMeta=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var R=arguments.length,A=new Array(R>2?R-2:0),O=2;O<R;O++)A[O-2]=arguments[O];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");_>0&&m.removeRow(this.toPhysicalRow(y),_),A.length>0&&he(A.reverse(),N=>{m.createRow(this.toPhysicalRow(y)),he(N,(F,j)=>this.setCellMetaObject(y,j,F))}),s.render()},this.setCellMetaObject=function(y,_,R){typeof R=="object"&&bt(R,(A,O)=>{this.setCellMeta(y,_,O,A)})},this.setCellMeta=function(y,_,R,A){if(s.runHooks("beforeSetCellMeta",y,_,R,A)===!1)return;let N=y,F=_;y<this.countRows()&&(N=this.toPhysicalRow(y)),_<this.countCols()&&(F=this.toPhysicalColumn(_)),m.setCellMeta(N,F,R,A),s.runHooks("afterSetCellMeta",y,_,R,A)},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(y,_){let R=this.toPhysicalRow(y),A=this.toPhysicalColumn(_);return R===null&&(R=y),A===null&&(A=_),m.getCellMeta(R,A,{visualRow:y,visualColumn:_})},this.getCellMetaAtRow=function(y){return m.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||g.columns)},this.getCellRenderer=function(y,_){const R=typeof y=="number"?s.getCellMeta(y,_).renderer:y.renderer;return typeof R=="string"?H3(R):ur(R)?H3("text"):R},this.getCellEditor=function(y,_){const R=typeof y=="number"?s.getCellMeta(y,_).editor:y.editor;return typeof R=="string"?P3(R):ur(R)?P3("text"):R},this.getCellValidator=function(y,_){const R=typeof y=="number"?s.getCellMeta(y,_).validator:y.validator;return typeof R=="string"?DHe(R):R},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,_){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(_,y)},this.validateColumns=function(y,_){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(_,void 0,y)},this._validateCells=function(y,_,R){const A=new I;y&&(A.onQueueEmpty=y);let O=s.countRows()-1;for(;O>=0;){if(_!==void 0&&_.indexOf(O)===-1){O-=1;continue}let N=s.countCols()-1;for(;N>=0;){if(R!==void 0&&R.indexOf(N)===-1){N-=1;continue}A.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,N),s.getCellMeta(O,N),F=>{if(typeof F!="boolean")throw new Error("Validation error: result is not boolean");F===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),N-=1}O-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(y){let _=g.rowHeaders,R=y;return R!==void 0&&(R=s.runHooks("modifyRowHeader",R)),R===void 0?(_=[],Qe(s.countRows()-1,A=>{_.push(s.getRowHeader(A))})):Array.isArray(_)&&_[R]!==void 0?_=_[R]:ar(_)?_=_(R):_&&typeof _!="string"&&typeof _!="number"&&(_=R+1),_},this.hasRowHeaders=function(){return!!g.rowHeaders},this.hasColHeaders=function(){if(g.colHeaders!==void 0&&g.colHeaders!==null)return!!g.colHeaders;for(let y=0,_=s.countCols();y<_;y++)if(s.getColHeader(y))return!0;return!1},this.getColHeader=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const R=s.runHooks("modifyColHeader",y);if(R===void 0){const j=[],z=s.countCols();for(let Q=0;Q<z;Q++)j.push(s.getColHeader(Q));return j}let A=g.colHeaders;const O=function(j){const z=[],Q=s.countCols();let W=0;for(;W<Q;W++)ar(g.columns)&&g.columns(W)&&z.push(W);return z[j]},N=s.toPhysicalColumn(R),F=O(N);return g.colHeaders===!1?A=null:g.columns&&ar(g.columns)&&g.columns(F)&&g.columns(F).title?A=g.columns(F).title:g.columns&&g.columns[N]&&g.columns[N].title?A=g.columns[N].title:Array.isArray(g.colHeaders)&&g.colHeaders[N]!==void 0?A=g.colHeaders[N]:ar(g.colHeaders)?A=g.colHeaders(N):g.colHeaders&&typeof g.colHeaders!="string"&&typeof g.colHeaders!="number"&&(A=Fje(R)),A=s.runHooks("modifyColumnHeaderValue",A,y,_),A},this._getColWidthFromSettings=function(y){let _;if(y>=0&&(_=s.getCellMeta(0,y).width),(_===void 0||_===g.width)&&(_=g.colWidths),_!=null){switch(typeof _){case"object":_=_[y];break;case"function":_=_(y);break}typeof _=="string"&&(_=parseInt(_,10))}return _},this.getColWidth=function(y){let _=s._getColWidthFromSettings(y);return _=s.runHooks("modifyColWidth",_,y),_===void 0&&(_=rv.DEFAULT_WIDTH),_},this._getRowHeightFromSettings=function(y){let _=g.rowHeights;if(_!=null){switch(typeof _){case"object":_=_[y];break;case"function":_=_(y);break}typeof _=="string"&&(_=parseInt(_,10))}return _},this.getRowHeight=function(y){let _=s._getRowHeightFromSettings(y);return _=s.runHooks("modifyRowHeight",_,y),_},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const y=g.maxCols,_=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,_)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return WO(s.countRows()-1,R=>{if(s.isEmptyRow(R))_+=1;else if(y===!0)return!1}),_},this.countEmptyCols=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return WO(s.countCols()-1,R=>{if(s.isEmptyCol(R))_+=1;else if(y===!0)return!1}),_},this.isEmptyRow=function(y){return g.isEmptyRow.call(s,y)},this.isEmptyCol=function(y){return g.isEmptyCol.call(s,y)},this.selectCell=function(y,_,R,A){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,N=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return ur(y)||ur(_)?!1:this.selectCells([[y,_,R,A]],O,N)},this.selectCells=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_===!1&&(i=!0);const A=C.selectCells(y);return A&&R&&s.listen(),i=!1,A},this.selectColumns=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return C.selectColumns(y,_)},this.selectRows=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return C.selectRows(y,_)},this.deselectCell=function(){C.deselect()},this.selectAll=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const _=y&&this.hasRowHeaders(),R=y&&this.hasColHeaders();i=!0,C.selectAll(_,R),i=!1};const J=(y,_)=>y.getNearestNotHiddenIndex(_,1,!0);this.scrollViewportTo=function(y,_){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;const N=!R,F=!A;let j=y,z=_;if(O){const ae=Number.isInteger(y),ye=Number.isInteger(_),H=ae?J(this.rowIndexMapper,y):void 0,Re=ye?J(this.columnIndexMapper,_):void 0;if(H===null||Re===null)return!1;j=ae?s.rowIndexMapper.getRenderableFromVisualIndex(H):void 0,z=ye?s.columnIndexMapper.getRenderableFromVisualIndex(Re):void 0}const Q=Number.isInteger(j),W=Number.isInteger(z);return Q&&W?s.view.scrollViewport(s._createCellCoords(j,z),N,A,R,F):Q&&W===!1?s.view.scrollViewportVertically(j,N,R):W&&Q===!1?s.view.scrollViewportHorizontally(z,A,F):!1},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),m.clearCache(),JO(s)){const y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}ta(s.rootElement),o.destroy(),u&&u.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),w.getItems().forEach(y=>{let[,_]=y;_.destroy()}),w.clear(),s.runHooks("afterDestroy")},!0),Ye.getSingleton().destroy(s),bt(s,(y,_,R)=>{ar(y)?R[_]=X(_):_!=="guid"&&(R[_]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,C=null,u=null,s=null};function X(y){return()=>{throw new Error(`The "${y}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(y){const _=po(y);return _==="UndoRedo"?this.undoRedo:w.getItem(_)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:w.getId(y)},this.getInstance=function(){return s},this.addHook=function(y,_){Ye.getSingleton().add(y,_,s)},this.hasHook=function(y){return Ye.getSingleton().has(y,s)||Ye.getSingleton().has(y)},this.addHookOnce=function(y,_){Ye.getSingleton().once(y,_,s)},this.removeHook=function(y,_){Ye.getSingleton().remove(y,_,s)},this.runHooks=function(y,_,R,A,O,N,F){return Ye.getSingleton().run(s,y,_,R,A,O,N,F)},this.getTranslatedPhrase=function(y,_){return rK(g.language,y,_)},this.toHTML=()=>L3(this),this.toTableElement=()=>{const y=this.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",L3(this)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=y;typeof R=="function"&&(R=setTimeout(R,_)),this.timeouts.push(R)},this._clearTimeouts=function(){he(this.timeouts,y=>{clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){he(this.immediates,y=>{clearImmediate(y)})},this._refreshBorders=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.destroyEditor(y),s.view.render(),_&&C.isSelected()&&u.prepareEditor()},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const ie=eBe({handleEvent(y){const _=s.isListening(),R=(y==null?void 0:y.key)!==void 0;return _&&R},beforeKeyDown:y=>this.runHooks("beforeKeyDown",y),afterKeyDown:y=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",y)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",y=>{y.ctrlKey===!1&&y.metaKey===!1&&ie.releasePressedKeys()}),this.getShortcutManager=function(){return ie};const se=ie.addContext("grid"),P={runOnlyIf:()=>ze(s.getSelected())&&s.countRenderedRows()>0&&s.countRenderedCols()>0,group:tBe};ie.setActiveContextName("grid"),se.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{s.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const y=s.getSelectedRange(),{row:_,col:R}=y[y.length-1].highlight,A=s.getDataAtCell(_,R),O=new Map;for(let N=0;N<y.length;N++)y[N].forAll((F,j)=>{if(F>=0&&j>=0&&(F!==_||j!==R)){const{readOnly:z}=s.getCellMeta(F,j);z||O.set(`${F}x${j}`,[F,j,A])}});s.setDataAtCell(Array.from(O.values()))},runOnlyIf:()=>s.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{C.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{C.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(0,1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{C.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:y,to:_}=s.getSelectedRangeLast(),R=s.rowIndexMapper.getNearestNotHiddenIndex(0,1);C.setRangeStart(y.clone()),C.setRangeEnd(s._createCellCoords(R,_.col))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{C.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{C.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{C.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:y,to:_}=s.getSelectedRangeLast(),R=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1);C.setRangeStart(y.clone()),C.setRangeEnd(s._createCellCoords(R,_.col))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{C.transformStart(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const y=s.getSelectedRangeLast().highlight.row,_=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[s.countCols()-1,-1]:[0,1]);C.setRangeStart(s._createCellCoords(y,_))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{C.transformEnd(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:y,to:_}=s.getSelectedRangeLast(),R=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[s.countCols()-1,-1]:[0,1]);C.setRangeStart(y.clone()),C.setRangeEnd(s._createCellCoords(_.row,R))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{C.transformStart(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const y=s.getSelectedRangeLast().highlight.row,_=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[0,1]:[s.countCols()-1,-1]);C.setRangeStart(s._createCellCoords(y,_))}},{keys:[["ArrowRight","Shift"]],callback:()=>{C.transformEnd(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:y,to:_}=s.getSelectedRangeLast(),R=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[0,1]:[s.countCols()-1,-1]);C.setRangeStart(y.clone()),C.setRangeEnd(s._createCellCoords(_.row,R))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const y=parseInt(s.getSettings().fixedColumnsStart,10),_=s.getSelectedRangeLast().highlight.row,R=s.columnIndexMapper.getNearestNotHiddenIndex(y,1);C.setRangeStart(s._createCellCoords(_,R))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{C.setRangeEnd(s._createCellCoords(C.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const y=parseInt(s.getSettings().fixedRowsTop,10),_=parseInt(s.getSettings().fixedColumnsStart,10),R=s.rowIndexMapper.getNearestNotHiddenIndex(y,1),A=s.columnIndexMapper.getNearestNotHiddenIndex(_,1);C.setRangeStart(s._createCellCoords(R,A))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{C.setRangeStart(s._createCellCoords(s.getSelectedRangeLast().highlight.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{C.setRangeEnd(s._createCellCoords(C.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const y=parseInt(s.getSettings().fixedRowsBottom,10),_=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-y-1,-1),R=s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1);C.setRangeStart(s._createCellCoords(_,R))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{C.transformStart(-s.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:y}=s.getSelectedRangeLast(),_=Math.max(y.row-s.countVisibleRows(),0),R=s.rowIndexMapper.getNearestNotHiddenIndex(_,1);if(R!==null){const A=s._createCellCoords(R,y.col),O=y.row-s.view.getFirstFullyVisibleRow(),N=Math.max(A.row-O,0);C.setRangeEnd(A),s.scrollViewportTo(N)}}},{keys:[["PageDown"]],callback:()=>{C.transformStart(s.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:y}=s.getSelectedRangeLast(),_=Math.min(y.row+s.countVisibleRows(),s.countRows()-1),R=s.rowIndexMapper.getNearestNotHiddenIndex(_,-1);if(R!==null){const A=s._createCellCoords(R,y.col),O=y.row-s.view.getFirstFullyVisibleRow(),N=Math.min(A.row-O,s.countRows()-1);C.setRangeEnd(A),s.scrollViewportTo(N)}}},{keys:[["Tab"]],callback:y=>{const _=typeof g.tabMoves=="function"?g.tabMoves(y):g.tabMoves;C.transformStart(_.row,_.col,!0)}},{keys:[["Shift","Tab"]],callback:y=>{const _=typeof g.tabMoves=="function"?g.tabMoves(y):g.tabMoves;C.transformStart(-_.row,-_.col)}}],P),OY().forEach(y=>{const _=MN(y);w.addItem(y,new _(this))}),Ye.getSingleton().run(s,"construct")}const rBe="hooksRefRegisterer",cK={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){he(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){bt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};gl(cK,"MIXIN_NAME",rBe,{writable:!1,enumerable:!1});const nBe="base",bn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),tk="baseEditor";class sg{static get EDITOR_TYPE(){return nBe}constructor(e){this.hot=e,this.instance=e,this.state=bn.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=bn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const h=this.hot.getSelectedLast();n=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),s=Math.max(h[0],h[2]),o=Math.max(h[1],h[3])}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i);Array.isArray(a)&&([n,i]=a);const c=this.hot.getShortcutManager().getContext("editor"),u={runOnlyIf:()=>ze(this.hot.getSelected()),group:tk};this.isInFullEditMode()&&c.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],u),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==bn.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(i,s)),this.state=bn.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:Zr(this.originalValue);this.setValue(o)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,r,n){let i;if(n){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),n(l),this.hot.view.render()}}if(this.isWaiting())return;const o=this.hot.getShortcutManager().getContext("editor");if(o.removeShortcutsByGroup(tk),o.removeShortcutsByGroup(WS),this.state===bn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===bn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=bn.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=bn.FINISHED,this.discardEditor(l)}):(this.state=bn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=bn.FINISHED,this.discardEditor()}discardEditor(e){this.state===bn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=bn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=bn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===bn.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=an(r),a=qt(r),l=an(this.hot.rootElement),c=qt(this.hot.rootElement),u=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=u!==s?u.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-c,{wtTable:g}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,v=g.name,w=["master","inline_start"].includes(v)?d:0,b=["master","top","bottom"].includes(v)?f:0,x=o.top===l.top?0:1;let C=o.top-l.top-x-w,S=0;this.hot.isRtl()?S=s.innerWidth-o.left-a-m-1+b:S=o.left-l.left-1-b,["top","top_inline_start_corner"].includes(v)&&(C+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(v)&&(S+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const E=this.hot.hasColHeaders(),T=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),I=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),M=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&T<=0||T===M)&&(C+=1),I<=0&&(S+=1);const D=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,U=Math.abs(n.inlineStartOverlay.getScrollPosition()),J=n.topOverlay.getScrollPosition(),X=An(this.hot.rootDocument),ie=r.offsetTop+D-J;let se=0;if(this.hot.isRtl()){const Q=r.offsetLeft;Q>=0?se=g.getWidth()-r.offsetLeft:se=Math.abs(Q),se+=L-U-a}else se=r.offsetLeft+L-U;const P=Bu(this.TD,this.hot.rootWindow),y=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_=parseInt(P[y],10)>0?0:1,R=parseInt(P.borderTopWidth,10)>0?0:1,A=qt(r)+_,O=Lr(r)+R,N=P$e(u)?X:0,F=D$e(h)?X:0,j=this.hot.view.maximumVisibleElementWidth(se)-N+_,z=Math.max(this.hot.view.maximumVisibleElementHeight(ie)-F+R,23);return{top:C,start:S,height:O,maxHeight:z,width:A,maxWidth:j}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}tr(sg,cK);function iBe(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),s=function(d,f,m){d.addEventListener(f,m,!1)},o=function(d,f,m){d.removeEventListener(f,m,!1)},a=function(d){var f,m;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=e.value+d:n.data=e.value+d,i.style.position="absolute",i.style.fontSize=h(e).fontSize,i.style.fontFamily=h(e).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),f=i.clientWidth+2,r.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>f?e.style.width=t.minWidth+"px":f>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=f+"px",m=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>m?e.style.height=t.minHeight+"px":t.maxHeight<m?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=m+"px"},l=function(){window.setTimeout(a,0)},c=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")t.minHeight=e.clientHeight;else{var f=parseInt(d.minHeight);isNaN(f)||(t.minHeight=f)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var m=parseInt(d.maxHeight);isNaN(m)||(t.maxHeight=m)}if(d&&d.minWidth)if(d.minWidth=="inherit")t.minWidth=e.clientWidth;else{var g=parseInt(d.minWidth);isNaN(g)||(t.minWidth=g)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var v=parseInt(d.maxWidth);isNaN(v)||(t.maxWidth=v)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},u=function(d,f,m){e=d,c(f),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),m&&(s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)),a()};function h(d){return d.currentStyle||document.defaultView.getComputedStyle(d)}return{init:function(d,f,m){u(d,f,m)},unObserve:function(){o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)},resize:a}}function gB(t,e){const r=uY(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}BS(e,i)}const sBe="ht_editor_visible",by="ht_editor_hidden",mB="textEditor",oBe="text";class uh extends sg{static get EDITOR_TYPE(){return oBe}constructor(e){super(e),this.eventManager=new $r(this),this.autoResize=iBe(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",r=>this.onAfterDocumentKeyDown(r)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l,fragmentSelection:c}=o;l&&(this.TEXTAREA.value=""),a!==bn.FINISHED&&this.hideEditableElement(),!c&&!Go()&&this.focus()}}beginEditing(e,r){this.state===bn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),BS(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,De(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),De(this.TEXTAREA_PARENT,"handsontableInputHolder"),lt(this.TEXTAREA_PARENT,this.layerClass)&&ct(this.TEXTAREA_PARENT,this.layerClass),De(this.TEXTAREA_PARENT,by),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){sHe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ct(this.TEXTAREA_PARENT,this.layerClass),De(this.TEXTAREA_PARENT,by)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Qe(e.length-1,n=>{const i=e[n];if(lt(i,"handsontableEditor"))return r=!0,!1}),lt(this.TEXTAREA_PARENT,by)&&ct(this.TEXTAREA_PARENT,by),r?(this.layerClass=sBe,De(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),De(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==bn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=Bu(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const c=Bu(this.TEXTAREA),u=parseInt(c.paddingLeft,10)+parseInt(c.paddingRight,10),h=parseInt(c.paddingTop,10)+parseInt(c.paddingBottom,10),d=i-u,f=o-h,m=s-u,g=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,g),maxWidth:m,maxHeight:g},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),wY()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>ze(this.hot.getSelected()),group:mB},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Tab"]],callback:s=>{const o=this.hot.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(s):o.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:s=>{const o=this.hot.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(s):o.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey,relativeToGroup:Hm,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:Hm,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(i(),!1),relativeToGroup:Hm,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;gB(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;gB(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],n)}unregisterShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");r.removeShortcutsByGroup(WS),r.removeShortcutsByGroup(mB),r.removeShortcutsByGroup(tk)}onAfterDocumentKeyDown(e){[Ze.ARROW_UP,Ze.ARROW_RIGHT,Ze.ARROW_DOWN,Ze.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const aBe="base";function lv(t,e,r,n,i,s,o){const a=[],l=[];o.className&&De(e,o.className),o.readOnly&&a.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?a.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&a.push(o.noWordWrapClassName),!s&&o.placeholder&&a.push(o.placeholderCellClassName),ct(e,l),De(e,a)}lv.RENDERER_TYPE=aBe;const lBe="text";function kc(t,e,r,n,i,s,o){lv.apply(this,[t,e,r,n,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Zr(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){ta(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else ju(e,a)}kc.RENDERER_TYPE=lBe;const cBe="text",uK={CELL_TYPE:cBe,editor:uh,renderer:kc};Do(uK);Tt.editors={BaseEditor:sg};function Tt(t,e){const r=new SP(t,e||{},GN);return r.init(),r}Tt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new SP(t,e,GN)};Tt.DefaultSettings=aK();Tt.hooks=Ye.getSingleton();Tt.CellCoords=Sf;Tt.CellRange=nv;Tt.packageName="handsontable";Tt.buildDate="31/08/2023 08:23:33";Tt.version="13.1.0";Tt.languages={dictionaryKeys:u3e,getLanguageDictionary:tK,getLanguagesDictionaries:m3e,registerLanguageDictionary:eK,getTranslatedPhrase:rK};function pB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uBe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pB(Object(r),!0).forEach(function(n){hBe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g0(t){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g0(t)}function Ef(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dK(n.key),n)}}function Tf(t,e,r){return e&&vB(t.prototype,e),r&&vB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hBe(t,e,r){return e=dK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rk(t,e)}function k1(t){return k1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k1(t)}function rk(t,e){return rk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rk(t,e)}function dBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fBe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hK(t)}function p0(t){var e=dBe();return function(){var n=k1(t),i;if(e){var s=k1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return fBe(this,i)}}function gBe(t){return mBe(t)||pBe(t)||vBe(t)||yBe()}function mBe(t){if(Array.isArray(t))return nk(t)}function pBe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vBe(t,e){if(t){if(typeof t=="string")return nk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nk(t,e)}}function nk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wBe(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function dK(t){var e=wBe(t,"string");return typeof e=="symbol"?e:String(e)}var kT=null,xBe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",bBe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",I1="global",SBe="hot-wrapper-editor-container";function CBe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function ik(t,e){var r=oe.Children.toArray(t),n=oe.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function fK(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function gK(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var r=pK(e.props,!1);return r.className="".concat(SBe," ").concat(r.className),zV.createPortal(oe.createElement("div",Object.assign({},r),e),t.body)}function mK(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:I1,n=ik(t,"hot-editor"),i=fK(n);return n?oe.cloneElement(n,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??I1,o)},editorColumnScope:r,isEditor:!0}):null}function EBe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),kT||(kT=r.createDocumentFragment());var n=r.createElement("DIV");kT.appendChild(n);var i=oe.cloneElement(t,uBe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:zV.createPortal(i,n,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:n}}function pK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var vK=function(){function t(){Ef(this,t)}return Tf(t,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])}for(var o in r)o!=="settings"&&o!=="children"&&r.hasOwnProperty(o)&&(n[o]=r[o]);return n}}]),t}(),TBe=function(t){m0(r,t);var e=p0(r);function r(){return Ef(this,r),e.apply(this,arguments)}return Tf(r,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(s){return!i.internalProps.includes(s)}).reduce(function(s,o){return s[o]=i.props[o],s},{})}},{key:"getLocalEditorElement",value:function(){return mK(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),s=this.getLocalEditorElement();this.columnSettings=vK.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),s!==null&&(this.columnSettings.editor=this.props._getEditorClass(s,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),s=gK(i,this.getLocalEditorElement());return oe.createElement(oe.Fragment,null,s)}}]),r}(oe.Component),_Be=function(t){m0(r,t);var e=p0(r);function r(){var n;return Ef(this,r),n=e.apply(this,arguments),n.state={portals:[]},n}return Tf(r,[{key:"render",value:function(){return oe.createElement(oe.Fragment,null,this.state.portals)}}]),r}(oe.Component),RBe="13.1.0";function CP(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var In=typeof Symbol=="function"&&Symbol.for,EP=In?Symbol.for("react.element"):60103,TP=In?Symbol.for("react.portal"):60106,iC=In?Symbol.for("react.fragment"):60107,sC=In?Symbol.for("react.strict_mode"):60108,oC=In?Symbol.for("react.profiler"):60114,aC=In?Symbol.for("react.provider"):60109,lC=In?Symbol.for("react.context"):60110,_P=In?Symbol.for("react.async_mode"):60111,cC=In?Symbol.for("react.concurrent_mode"):60111,uC=In?Symbol.for("react.forward_ref"):60112,hC=In?Symbol.for("react.suspense"):60113,ABe=In?Symbol.for("react.suspense_list"):60120,dC=In?Symbol.for("react.memo"):60115,fC=In?Symbol.for("react.lazy"):60116,OBe=In?Symbol.for("react.block"):60121,kBe=In?Symbol.for("react.fundamental"):60117,IBe=In?Symbol.for("react.responder"):60118,NBe=In?Symbol.for("react.scope"):60119;function hs(t){if(g0(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case EP:switch(t=t.type,t){case _P:case cC:case iC:case oC:case sC:case hC:return t;default:switch(t=t&&t.$$typeof,t){case lC:case uC:case fC:case dC:case aC:return t;default:return e}}case TP:return e}}}function yK(t){return hs(t)===cC}var MBe=_P,PBe=cC,DBe=lC,LBe=aC,FBe=EP,$Be=uC,HBe=iC,jBe=fC,BBe=dC,VBe=TP,UBe=oC,WBe=sC,zBe=hC,GBe=function(e){return yK(e)||hs(e)===_P},YBe=yK,KBe=function(e){return hs(e)===lC},XBe=function(e){return hs(e)===aC},qBe=function(e){return g0(e)==="object"&&e!==null&&e.$$typeof===EP},JBe=function(e){return hs(e)===uC},ZBe=function(e){return hs(e)===iC},QBe=function(e){return hs(e)===fC},e6e=function(e){return hs(e)===dC},t6e=function(e){return hs(e)===TP},r6e=function(e){return hs(e)===oC},n6e=function(e){return hs(e)===sC},i6e=function(e){return hs(e)===hC},s6e=function(e){return typeof e=="string"||typeof e=="function"||e===iC||e===cC||e===oC||e===sC||e===hC||e===ABe||g0(e)==="object"&&e!==null&&(e.$$typeof===fC||e.$$typeof===dC||e.$$typeof===aC||e.$$typeof===lC||e.$$typeof===uC||e.$$typeof===kBe||e.$$typeof===IBe||e.$$typeof===NBe||e.$$typeof===OBe)},o6e=hs,a6e={AsyncMode:MBe,ConcurrentMode:PBe,ContextConsumer:DBe,ContextProvider:LBe,Element:FBe,ForwardRef:$Be,Fragment:HBe,Lazy:jBe,Memo:BBe,Portal:VBe,Profiler:UBe,StrictMode:WBe,Suspense:zBe,isAsyncMode:GBe,isConcurrentMode:YBe,isContextConsumer:KBe,isContextProvider:XBe,isElement:qBe,isForwardRef:JBe,isFragment:ZBe,isLazy:QBe,isMemo:e6e,isPortal:t6e,isProfiler:r6e,isStrictMode:n6e,isSuspense:i6e,isValidElementType:s6e,typeOf:o6e},Qt=CP(function(t,e){});Qt.AsyncMode;Qt.ConcurrentMode;Qt.ContextConsumer;Qt.ContextProvider;Qt.Element;Qt.ForwardRef;Qt.Fragment;Qt.Lazy;Qt.Memo;Qt.Portal;Qt.Profiler;Qt.StrictMode;Qt.Suspense;Qt.isAsyncMode;Qt.isConcurrentMode;Qt.isContextConsumer;Qt.isContextProvider;Qt.isElement;Qt.isForwardRef;Qt.isFragment;Qt.isLazy;Qt.isMemo;Qt.isPortal;Qt.isProfiler;Qt.isStrictMode;Qt.isSuspense;Qt.isValidElementType;Qt.typeOf;CP(function(t){t.exports=a6e});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var yB=Object.getOwnPropertySymbols,l6e=Object.prototype.hasOwnProperty,c6e=Object.prototype.propertyIsEnumerable;function u6e(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function h6e(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(s){i[s]=s}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}h6e();var d6e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",f6e=d6e;Function.call.bind(Object.prototype.hasOwnProperty);function wK(){}function xK(){}xK.resetWarningCache=wK;var g6e=function(){function e(i,s,o,a,l,c){if(c!==f6e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:xK,resetWarningCache:wK};return n.PropTypes=n,n},m6e=CP(function(t){t.exports=g6e()}),IT=m6e,bK=function(t){m0(r,t);var e=p0(r);function r(){var n;return Ef(this,r),n=e.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return Tf(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(bBe),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var s=this;return function(o,a,l,c,u,h,d){var f=s.getRenderedCellCache();if(f.has("".concat(l,"-").concat(c))&&(a.innerHTML=f.get("".concat(l,"-").concat(c)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var m=EBe(i,{TD:a,row:l,col:c,prop:u,value:h,cellProperties:d,isRenderer:!0},a.ownerDocument),g=m.portal,v=m.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(v),s.portalCacheArray.push(g)}return f.set("".concat(l,"-").concat(c),a),a}}},{key:"getEditorClass",value:function(i){var s,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:I1,a=fK(i),l=(s=this.getEditorCache().get(a))===null||s===void 0?void 0:s.get(o);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var s=function(o){m0(l,o);var a=p0(l);function l(c){var u;return Ef(this,l),u=a.call(this,c),i.hotCustomEditorInstance=hK(u),u.editorComponent=i,u}return Tf(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(Tt.editors.BaseEditor);return Object.getOwnPropertyNames(Tt.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(s.prototype[o]=function(){for(var a,l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return(a=i[o]).call.apply(a,[i].concat(c))})}),s}},{key:"getGlobalRendererElement",value:function(){return ik(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return mK(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=vK.getSettings(this.props),s=this.getGlobalRendererElement(),o=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,o?i.editor=this.getEditorClass(o,I1):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),s?(i.renderer=this.getRendererWrapper(s),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var s,o;this.hotInstance&&((s=this.hotInstance.getPlugin("autoRowSize"))!==null&&s!==void 0&&s.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&CBe(xBe)}},{key:"setHotColumnSettings",value:function(i,s){this.columnSettings[s]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:gBe(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,s=this.createNewGlobalSettings();this.hotInstance=new Tt.Core(this.hotElementRef,s),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(s)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,s=pK(this.props),o=function(h){return h.type===TBe},a=oe.Children.toArray(this.props.children),l=a.filter(function(u){return o(u)}).map(function(u,h){return oe.cloneElement(u,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:h,_getChildElementByType:ik.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:u.props.children})}),c=gK(this.getOwnerDocument(),this.getGlobalEditorElement());return oe.createElement(oe.Fragment,null,oe.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},s),l),oe.createElement(_Be,{ref:this.setRenderersPortalManagerRef.bind(this)}),c)}}],[{key:"version",get:function(){return RBe}}]),r}(oe.Component);bK.propTypes={style:IT.object,id:IT.string,className:IT.string};oe.Component;const wB="handsontableEditor",p6e="handsontable";class RP extends uh{static get EDITOR_TYPE(){return p6e}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),BS(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(c,u){const h=this.getSourceData(u.row,u.col);h!==void 0&&a.setValue(h),a.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&cn(l,o.handsontable),this.htOptions=l}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getInstance().getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:wB,relativeToGroup:WS,position:"before"},i=(s,o)=>{const a=this.htEditor.getInstance();if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),ra(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor.getInstance();let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor.getInstance();let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const c=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(c,l+1)}}return i(a,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wB)}}function v6e(t,e,r){return e=y6e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y6e(t){var e=w6e(t,"string");return typeof e=="symbol"?e:String(e)}function w6e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const NT=new WeakMap,x6e="autocomplete";class AP extends RP{static get EDITOR_TYPE(){return x6e}constructor(e){super(e),v6e(this,"sortByRelevance",function(r,n,i){const s=[],o=[],a=r.length;let l=n.length,c,u,h,d;if(a===0){for(h=0;h<l;h++)o.push(h);return o}for(h=0;h<l;h++){if(u=x3(Zr(n[h])),i)d=u.indexOf(r);else{const f=this.cellProperties.locale;d=u.toLocaleLowerCase(f).indexOf(r.toLocaleLowerCase(f))}d!==-1&&(c=u.length-d-a,s.push({baseIndex:h,index:d,charsLeft:c,value:u}))}for(s.sort((f,m)=>{if(m.index===-1)return-1;if(f.index===-1)return 1;if(f.index<m.index)return-1;if(m.index<f.index)return 1;if(f.index===m.index){if(f.charsLeft<m.charsLeft)return-1;if(f.charsLeft>m.charsLeft)return 1}return 0}),h=0,l=s.length;h<l;h++)o.push(s[h].baseIndex);return o}),this.query=null,this.strippedChoices=[],this.rawChoices=[],NT.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return ze(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),De(this.htContainer,"autocompleteEditor"),De(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}open(){const e=NT.get(this);super.open();const r=this.htEditor.getInstance(),n=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let i=An();i===0&&e.isMacOS&&(i+=15),this.addHook("beforeKeyDown",s=>this.onBeforeKeyDown(s)),r.updateSettings({colWidths:n?[qt(this.TEXTAREA)-2]:void 0,width:n?qt(this.TEXTAREA)+i:void 0,renderer:(s,o,a,l,c,u,h)=>{kc(s,o,a,l,c,u,h);const{filteringCaseSensitive:d,allowHtml:f,locale:m}=this.cellProperties,g=this.query;let v=Zr(u),w,b;v&&!f&&(w=d===!0?v.indexOf(g):v.toLocaleLowerCase(m).indexOf(g.toLocaleLowerCase(m)),w!==-1&&(b=v.substr(w,g.length),v=v.replace(b,`<strong>${b}</strong>`))),o.innerHTML=v},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=uY(this.TEXTAREA),n=I$e(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(o)?o.length:0;if(s===!1)c&&(a=o[0]);else{const u=[];for(let h=0,d=l.length;h<d&&!(i&&c<=h);h++)c?u.push(l[o[h]]):u.push(l[h]);a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(Rw([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a),this.hot.listen(),BS(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownIfNeeded(){const e=xf(this.hot.view._wt.wtTable.TABLE),r=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(r||!r&&(n||n==="horizontal"))return!1;const i=an(this.TEXTAREA),s=Lr(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=Lr(this.hot.view._wt.wtTable.THEAD),c=an(e),u=i.top-c.top-l+a,h=e.scrollHeight-u-l-s,d=o>h&&u>h;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?u:h,o),d}limitDropdownIfNeeded(e,r){if(r>e){let n=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=s,i+=1;while(n<e);o=n-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-o}px`),this.setDropdownHeight(n-s)}}flipDropdown(e){const r=this.htEditor.rootElement.style;r.position="absolute",r.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+An(this.hot.rootDocument)+2,r=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:r?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getInstance().getRowHeight(0)||23,r=this.cellProperties.visibleRows;return this.strippedChoices.length>=r?r*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=yt(e,s=>Zr(s));return yt(n,s=>r?s:x3(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===Ze.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===Ze.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){const r=NT.get(this);if(r.skipOne=!1,aHe(e.keyCode)||e.keyCode===Ze.BACKSPACE||e.keyCode===Ze.DELETE||e.keyCode===Ze.INSERT){let n=10;if(e.keyCode===Ze.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),r.skipOne=!0},n)}}}const b6e="checkbox";class SK extends sg{static get EDITOR_TYPE(){return b6e}beginEditing(e,r){if(r&&r.type==="mouseup"){const n=this.TD.querySelector('input[type="checkbox"]');lt(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var CK={exports:{}};const S6e=CJ(x$e);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(r,n){var i;{try{i=S6e}catch{}t.exports=n(i)}})(ka,function(r){var n=typeof r=="function",i=!!window.addEventListener,s=window.document,o=window.setTimeout,a=function(P,y,_,R){i?P.addEventListener(y,_,!!R):P.attachEvent("on"+y,_)},l=function(P,y,_,R){i?P.removeEventListener(y,_,!!R):P.detachEvent("on"+y,_)},c=function(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")},u=function(P,y){return(" "+P.className+" ").indexOf(" "+y+" ")!==-1},h=function(P,y){u(P,y)||(P.className=P.className===""?y:P.className+" "+y)},d=function(P,y){P.className=c((" "+P.className+" ").replace(" "+y+" "," "))},f=function(P){return/Array/.test(Object.prototype.toString.call(P))},m=function(P){return/Date/.test(Object.prototype.toString.call(P))&&!isNaN(P.getTime())},g=function(P){var y=P.getDay();return y===0||y===6},v=function(P){return P%4===0&&P%100!==0||P%400===0},w=function(P,y){return[31,v(P)?29:28,31,30,31,30,31,31,30,31,30,31][y]},b=function(P){m(P)&&P.setHours(0,0,0,0)},x=function(P,y){return P.getTime()===y.getTime()},C=function(P,y,_){var R,A;for(R in y)A=P[R]!==void 0,A&&typeof y[R]=="object"&&y[R]!==null&&y[R].nodeName===void 0?m(y[R])?_&&(P[R]=new Date(y[R].getTime())):f(y[R])?_&&(P[R]=y[R].slice(0)):P[R]=C({},y[R],_):(_||!A)&&(P[R]=y[R]);return P},S=function(P,y,_){var R;s.createEvent?(R=s.createEvent("HTMLEvents"),R.initEvent(y,!0,!1),R=C(R,_),P.dispatchEvent(R)):s.createEventObject&&(R=s.createEventObject(),R=C(R,_),P.fireEvent("on"+y,R))},E=function(P){return P.month<0&&(P.year-=Math.ceil(Math.abs(P.month)/12),P.month+=12),P.month>11&&(P.year+=Math.floor(Math.abs(P.month)/12),P.month-=12),P},T={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},I=function(P,y,_){for(y+=P.firstDay;y>=7;)y-=7;return _?P.i18n.weekdaysShort[y]:P.i18n.weekdays[y]},k=function(P){var y=[],_="false";if(P.isEmpty)if(P.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),P.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return P.isDisabled&&y.push("is-disabled"),P.isToday&&y.push("is-today"),P.isSelected&&(y.push("is-selected"),_="true"),P.hasEvent&&y.push("has-event"),P.isInRange&&y.push("is-inrange"),P.isStartRange&&y.push("is-startrange"),P.isEndRange&&y.push("is-endrange"),'<td data-day="'+P.day+'" class="'+y.join(" ")+'" aria-selected="'+_+'"><button class="pika-button pika-day" type="button" data-pika-year="'+P.year+'" data-pika-month="'+P.month+'" data-pika-day="'+P.day+'">'+P.day+"</button></td>"},M=function(P,y){P.setHours(0,0,0,0);var _=P.getDate(),R=P.getDay(),A=y,O=A-1,N=7,F=function(ae){return(ae+N-1)%N};P.setDate(_+O-F(R));var j=new Date(P.getFullYear(),0,A),z=24*60*60*1e3,Q=(P.getTime()-j.getTime())/z,W=1+Math.round((Q-O+F(j.getDay()))/N);return W},D=function(P,y,_,R){var A=new Date(_,y,P),O=n?r(A).isoWeek():M(A,R);return'<td class="pika-week">'+O+"</td>"},L=function(P,y,_,R){return'<tr class="pika-row'+(_?" pick-whole-week":"")+(R?" is-selected":"")+'">'+(y?P.reverse():P).join("")+"</tr>"},U=function(P){return"<tbody>"+P.join("")+"</tbody>"},J=function(P){var y,_=[];for(P.showWeekNumber&&_.push("<th></th>"),y=0;y<7;y++)_.push('<th scope="col"><abbr title="'+I(P,y)+'">'+I(P,y,!0)+"</abbr></th>");return"<thead><tr>"+(P.isRTL?_.reverse():_).join("")+"</tr></thead>"},X=function(P,y,_,R,A,O){var N,F,j,z=P._o,Q=_===z.minYear,W=_===z.maxYear,ae='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',ye,H,Re=!0,ue=!0;for(j=[],N=0;N<12;N++)j.push('<option value="'+(_===A?N-y:12+N-y)+'"'+(N===R?' selected="selected"':"")+(Q&&N<z.minMonth||W&&N>z.maxMonth?' disabled="disabled"':"")+">"+z.i18n.months[N]+"</option>");for(ye='<div class="pika-label">'+z.i18n.months[R]+'<select class="pika-select pika-select-month" tabindex="-1">'+j.join("")+"</select></div>",f(z.yearRange)?(N=z.yearRange[0],F=z.yearRange[1]+1):(N=_-z.yearRange,F=1+_+z.yearRange),j=[];N<F&&N<=z.maxYear;N++)N>=z.minYear&&j.push('<option value="'+N+'"'+(N===_?' selected="selected"':"")+">"+N+"</option>");return H='<div class="pika-label">'+_+z.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+j.join("")+"</select></div>",z.showMonthAfterYear?ae+=H+ye:ae+=ye+H,Q&&(R===0||z.minMonth>=R)&&(Re=!1),W&&(R===11||z.maxMonth<=R)&&(ue=!1),y===0&&(ae+='<button class="pika-prev'+(Re?"":" is-disabled")+'" type="button">'+z.i18n.previousMonth+"</button>"),y===P._o.numberOfMonths-1&&(ae+='<button class="pika-next'+(ue?"":" is-disabled")+'" type="button">'+z.i18n.nextMonth+"</button>"),ae+="</div>"},ie=function(P,y,_){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+_+'">'+J(P)+U(y)+"</table>"},se=function(P){var y=this,_=y.config(P);y._onMouseDown=function(A){if(y._v){A=A||window.event;var O=A.target||A.srcElement;if(O)if(u(O,"is-disabled")||(u(O,"pika-button")&&!u(O,"is-empty")&&!u(O.parentNode,"is-disabled")?(y.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),_.bound&&o(function(){y.hide(),_.blurFieldOnSelect&&_.field&&_.field.blur()},100)):u(O,"pika-prev")?y.prevMonth():u(O,"pika-next")&&y.nextMonth()),u(O,"pika-select"))y._c=!0;else if(A.preventDefault)A.preventDefault();else return A.returnValue=!1,!1}},y._onChange=function(A){A=A||window.event;var O=A.target||A.srcElement;O&&(u(O,"pika-select-month")?y.gotoMonth(O.value):u(O,"pika-select-year")&&y.gotoYear(O.value))},y._onKeyChange=function(A){if(A=A||window.event,y.isVisible())switch(A.keyCode){case 13:case 27:_.field&&_.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(_.parse)return _.parse(_.field.value,_.format);if(n){var A=r(_.field.value,_.format,_.formatStrict);return A&&A.isValid()?A.toDate():null}else return new Date(Date.parse(_.field.value))},y._onInputChange=function(A){var O;A.firedBy!==y&&(O=y._parseFieldValue(),m(O)&&y.setDate(O),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var A=s.activeElement;do if(u(A,"pika-single"))return;while(A=A.parentNode);y._c||(y._b=o(function(){y.hide()},50)),y._c=!1},y._onClick=function(A){A=A||window.event;var O=A.target||A.srcElement,N=O;if(O){!i&&u(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),a(O,"change",y._onChange)));do if(u(N,"pika-single")||N===_.trigger)return;while(N=N.parentNode);y._v&&O!==_.trigger&&N!==_.trigger&&y.hide()}},y.el=s.createElement("div"),y.el.className="pika-single"+(_.isRTL?" is-rtl":"")+(_.theme?" "+_.theme:""),a(y.el,"mousedown",y._onMouseDown,!0),a(y.el,"touchend",y._onMouseDown,!0),a(y.el,"change",y._onChange),_.keyboardInput&&a(s,"keydown",y._onKeyChange),_.field&&(_.container?_.container.appendChild(y.el):_.bound?s.body.appendChild(y.el):_.field.parentNode.insertBefore(y.el,_.field.nextSibling),a(_.field,"change",y._onInputChange),_.defaultDate||(_.defaultDate=y._parseFieldValue(),_.setDefaultDate=!0));var R=_.defaultDate;m(R)?_.setDefaultDate?y.setDate(R,!0):y.gotoDate(R):y.gotoDate(new Date),_.bound?(this.hide(),y.el.className+=" is-bound",a(_.trigger,"click",y._onInputClick),a(_.trigger,"focus",y._onInputFocus),a(_.trigger,"blur",y._onInputBlur)):this.show()};return se.prototype={config:function(P){this._o||(this._o=C({},T,!0));var y=C(this._o,P,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var _=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=_>4?4:_,m(y.minDate)||(y.minDate=!1),m(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),f(y.yearRange)){var R=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||R,y.yearRange[1]=parseInt(y.yearRange[1],10)||R}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||T.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(P){return P=P||this._o.format,m(this._d)?this._o.toString?this._o.toString(this._d,P):n?r(this._d).format(P):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(P,y){n&&r.isMoment(P)&&this.setDate(P.toDate(),y)},getDate:function(){return m(this._d)?new Date(this._d.getTime()):null},setDate:function(P,y){if(!P)return this._d=null,this._o.field&&(this._o.field.value="",S(this._o.field,"change",{firedBy:this})),this.draw();if(typeof P=="string"&&(P=new Date(Date.parse(P))),!!m(P)){var _=this._o.minDate,R=this._o.maxDate;m(_)&&P<_?P=_:m(R)&&P>R&&(P=R),this._d=new Date(P.getTime()),b(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),S(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(P){var y=!0;if(m(P)){if(this.calendars){var _=new Date(this.calendars[0].year,this.calendars[0].month,1),R=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),A=P.getTime();R.setMonth(R.getMonth()+1),R.setDate(R.getDate()-1),y=A<_.getTime()||R.getTime()<A}y&&(this.calendars=[{month:P.getMonth(),year:P.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(P,y){var _=this.getDate()||new Date,R=parseInt(y)*24*60*60*1e3,A;P==="add"?A=new Date(_.valueOf()+R):P==="subtract"&&(A=new Date(_.valueOf()-R)),this.setDate(A)},adjustCalendars:function(){this.calendars[0]=E(this.calendars[0]);for(var P=1;P<this._o.numberOfMonths;P++)this.calendars[P]=E({month:this.calendars[0].month+P,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(P){isNaN(P)||(this.calendars[0].month=parseInt(P,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(P){isNaN(P)||(this.calendars[0].year=parseInt(P,10),this.adjustCalendars())},setMinDate:function(P){P instanceof Date?(b(P),this._o.minDate=P,this._o.minYear=P.getFullYear(),this._o.minMonth=P.getMonth()):(this._o.minDate=T.minDate,this._o.minYear=T.minYear,this._o.minMonth=T.minMonth,this._o.startRange=T.startRange),this.draw()},setMaxDate:function(P){P instanceof Date?(b(P),this._o.maxDate=P,this._o.maxYear=P.getFullYear(),this._o.maxMonth=P.getMonth()):(this._o.maxDate=T.maxDate,this._o.maxYear=T.maxYear,this._o.maxMonth=T.maxMonth,this._o.endRange=T.endRange),this.draw()},setStartRange:function(P){this._o.startRange=P},setEndRange:function(P){this._o.endRange=P},draw:function(P){if(!(!this._v&&!P)){var y=this._o,_=y.minYear,R=y.maxYear,A=y.minMonth,O=y.maxMonth,N="",F;this._y<=_&&(this._y=_,!isNaN(A)&&this._m<A&&(this._m=A)),this._y>=R&&(this._y=R,!isNaN(O)&&this._m>O&&(this._m=O));for(var j=0;j<y.numberOfMonths;j++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),N+='<div class="pika-lendar">'+X(this,j,this.calendars[j].year,this.calendars[j].month,this.calendars[0].year,F)+this.render(this.calendars[j].year,this.calendars[j].month,F)+"</div>";this.el.innerHTML=N,y.bound&&y.field.type!=="hidden"&&o(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var P,y,_,R,A,O,N,F,j,z,Q,W;if(!this._o.container){if(this.el.style.position="absolute",P=this._o.trigger,y=P,_=this.el.offsetWidth,R=this.el.offsetHeight,A=window.innerWidth||s.documentElement.clientWidth,O=window.innerHeight||s.documentElement.clientHeight,N=window.pageYOffset||s.body.scrollTop||s.documentElement.scrollTop,Q=!0,W=!0,typeof P.getBoundingClientRect=="function")z=P.getBoundingClientRect(),F=z.left+window.pageXOffset,j=z.bottom+window.pageYOffset;else for(F=y.offsetLeft,j=y.offsetTop+y.offsetHeight;y=y.offsetParent;)F+=y.offsetLeft,j+=y.offsetTop;(this._o.reposition&&F+_>A||this._o.position.indexOf("right")>-1&&F-_+P.offsetWidth>0)&&(F=F-_+P.offsetWidth,Q=!1),(this._o.reposition&&j+R>O+N||this._o.position.indexOf("top")>-1&&j-R-P.offsetHeight>0)&&(j=j-R-P.offsetHeight,W=!1),this.el.style.left=F+"px",this.el.style.top=j+"px",h(this.el,Q?"left-aligned":"right-aligned"),h(this.el,W?"bottom-aligned":"top-aligned"),d(this.el,Q?"right-aligned":"left-aligned"),d(this.el,W?"top-aligned":"bottom-aligned")}},render:function(P,y,_){var R=this._o,A=new Date,O=w(P,y),N=new Date(P,y,1).getDay(),F=[],j=[];b(A),R.firstDay>0&&(N-=R.firstDay,N<0&&(N+=7));for(var z=y===0?11:y-1,Q=y===11?0:y+1,W=y===0?P-1:P,ae=y===11?P+1:P,ye=w(W,z),H=O+N,Re=H;Re>7;)Re-=7;H+=7-Re;for(var ue=!1,Pe=0,ke=0;Pe<H;Pe++){var be=new Date(P,y,1+(Pe-N)),Fe=m(this._d)?x(be,this._d):!1,He=x(be,A),V=R.events.indexOf(be.toDateString())!==-1,K=Pe<N||Pe>=O+N,te=1+(Pe-N),ve=y,le=P,ce=R.startRange&&x(R.startRange,be),me=R.endRange&&x(R.endRange,be),de=R.startRange&&R.endRange&&R.startRange<be&&be<R.endRange,fe=R.minDate&&be<R.minDate||R.maxDate&&be>R.maxDate||R.disableWeekends&&g(be)||R.disableDayFn&&R.disableDayFn(be);K&&(Pe<N?(te=ye+te,ve=z,le=W):(te=te-O,ve=Q,le=ae));var ge={day:te,month:ve,year:le,hasEvent:V,isSelected:Fe,isToday:He,isDisabled:fe,isEmpty:K,isStartRange:ce,isEndRange:me,isInRange:de,showDaysInNextAndPreviousMonths:R.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:R.enableSelectionDaysInNextAndPreviousMonths};R.pickWholeWeek&&Fe&&(ue=!0),j.push(k(ge)),++ke===7&&(R.showWeekNumber&&j.unshift(D(Pe-N,y,P,R.firstWeekOfYearMinDays)),F.push(L(j,R.isRTL,R.pickWholeWeek,ue)),j=[],ke=0,ue=!1)}return ie(R,F,_)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),d(this.el,"is-hidden"),this._o.bound&&(a(s,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var P=this._v;P!==!1&&(this._o.bound&&l(s,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,P!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var P=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),P.keyboardInput&&l(s,"keydown",this._onKeyChange),P.field&&(l(P.field,"change",this._onInputChange),P.bound&&(l(P.trigger,"click",this._onInputClick),l(P.trigger,"focus",this._onInputFocus),l(P.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},se})})(CK);var C6e=CK.exports;const xB=jt(C6e),EK="date",bB="dateEditor";class TK extends uh{static get EDITOR_TYPE(){return EK}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof Me!="function")throw new Error("You need to include moment.js to your project.");if(typeof xB!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),De(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new $r(this).addEventListener(this.datePicker,"mousedown",r=>r.stopPropagation())}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),n.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:bB})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(bB),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const n=this.originalValue;n!==void 0&&this.setValue(n)}super.finishEditing(e,r)}showDatepicker(e){const r=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.instance.view.isMouseDown(),s=e?bY(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new xB(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+r.top+Lr(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=r.right-qt(this.datePicker):a=r.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(o=this.originalValue,Me(o,n,!0).isValid()&&this.$datePicker.setMoment(Me(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Me(o,n,!0).isValid()&&this.$datePicker.setMoment(Me(o,n),!0),!s&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&US(r,this.cellProperties.datePickerConfig);const n=r.onSelect,i=r.onClose;return r.field=e,r.trigger=e,r.container=this.datePicker,r.bound=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=Me(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),this.hideDatepicker(),n&&n()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},r}}const E6e="dropdown";class OP extends AP{static get EDITOR_TYPE(){return E6e}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Ye.getSingleton().add("beforeValidate",function(t,e,r){const n=this.getCellMeta(e,this.propToCol(r));n.editor===OP&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});const T6e="numeric";class _K extends uh{static get EDITOR_TYPE(){return T6e}}const _6e="password";class RK extends uh{static get EDITOR_TYPE(){return _6e}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ta(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const MT="ht_editor_visible",SB="selectEditor",R6e="select";class A6e extends sg{static get EDITOR_TYPE(){return R6e}init(){this.select=this.hot.rootDocument.createElement("SELECT"),De(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",lt(this.select,MT)&&ct(this.select,MT),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ta(this.select),bt(l,(c,u)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=u,tg(h,c),this.select.appendChild(h)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==bn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",De(this.select,MT)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:SB};this.isInFullEditMode()!==!1&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SB)}}const O6e="time";class AK extends uh{static get EDITOR_TYPE(){return O6e}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.TEXTAREA.dir="ltr"}}function k6e(){Gi(sg),Gi(AP),Gi(SK),Gi(TK),Gi(OP),Gi(RP),Gi(_K),Gi(RK),Gi(A6e),Gi(uh),Gi(AK)}const I6e="html";function kP(t,e,r,n,i,s,o){lv.apply(this,[t,e,r,n,i,s,o]),tg(e,s??"",!1)}kP.RENDERER_TYPE=I6e;const N6e="autocomplete";function og(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?kP:kc,c=a.createElement("DIV");if(c.className="htAutocompleteArrow",c.appendChild(a.createTextNode("")),l.apply(this,[t,e,r,n,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("")),e.insertBefore(c,e.firstChild),De(e,"htAutocomplete"),!t.acArrowListener){const u=new $r(t);t.acArrowListener=function(h){lt(h.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},u.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{u.destroy()})}}og.RENDERER_TYPE=N6e;const CB=new WeakMap,EB=new WeakMap,M6e="htBadValue",_f="data-row",Rf="data-col",P6e="checkboxRenderer",OK="checkbox";Ye.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:o,prop:a}=e;if(i===OK){if(n){const{value:l,property:c}=n;let u=r;if(l)u=typeof l=="function"?l(s,o,a,r):l;else if(c){const h=this.getDataAtRowProp(s,c);u=h!==null?h:r}t=u}return t}});function IP(t,e,r,n,i,s,o){const{rootDocument:a}=t;lv.apply(this,[t,e,r,n,i,s,o]),D6e(t);let l=L6e(a);const c=o.label;let u=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),ta(e),s===o.checkedTemplate||Zr(s).toLocaleLowerCase(o.locale)===Zr(o.checkedTemplate).toLocaleLowerCase(o.locale)?l.checked=!0:s===o.uncheckedTemplate||Zr(s).toLocaleLowerCase(o.locale)===Zr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?l.checked=!1:yn(s)?De(l,"noValue"):(l.style.display="none",De(l,M6e),u=!0),l.setAttribute(_f,r),l.setAttribute(Rf,n),!u&&c){let m="";if(c.value)m=typeof c.value=="function"?c.value.call(this,r,n,i,s):c.value;else if(c.property){const v=t.getDataAtRowProp(r,c.property);m=v!==null?v:""}const g=F6e(a,m,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(g),e.appendChild(l)):(g.appendChild(l),l=g):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(l),e.appendChild(g)):(g.insertBefore(l,g.firstChild),l=g))}(!c||c&&!c.separated)&&e.appendChild(l),u&&e.appendChild(a.createTextNode("#bad-value#")),CB.has(t)||(CB.set(t,!0),h());function h(){const g=t.getShortcutManager().getContext("grid"),v={group:P6e};g.addShortcuts([{keys:[["space"]],callback:()=>(d(),!f())},{keys:[["enter"]],callback:()=>(d(),!f()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!f()),relativeToGroup:Hm,position:"before"}],v)}function d(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=t.getSelectedRange();if(g)for(let v=0;v<g.length;v++){const{row:w,col:b}=g[v].getTopStartCorner(),{row:x,col:C}=g[v].getBottomEndCorner(),S=[];for(let E=w;E<=x;E+=1)for(let T=b;T<=C;T+=1){const I=t.getCellMeta(E,T);if(I.type!=="checkbox")return;if(I.readOnly===!0)continue;typeof I.checkedTemplate>"u"&&(I.checkedTemplate=!0),typeof I.uncheckedTemplate>"u"&&(I.uncheckedTemplate=!1);const k=t.getDataAtCell(E,T);m===!1?[I.checkedTemplate,I.checkedTemplate.toString()].includes(k)?S.push([E,T,I.uncheckedTemplate]):[I.uncheckedTemplate,I.uncheckedTemplate.toString(),null,void 0].includes(k)&&S.push([E,T,I.checkedTemplate]):S.push([E,T,I.uncheckedTemplate])}S.length>0&&t.setDataAtCell(S)}}function f(){const m=t.getSelectedRange();if(m){for(let g=0;g<m.length;g++){const v=m[g].getTopStartCorner(),w=m[g].getBottomEndCorner();for(let b=v.row;b<=w.row;b++)for(let x=v.col;x<=w.col;x++){const C=t.getCellMeta(b,x);if(C.type!=="checkbox")return!1;const S=t.getCell(b,x);if(S==null)return!0;if(S.querySelectorAll("input[type=checkbox]").length>0&&!C.readOnly)return!0}}return!1}}}IP.RENDERER_TYPE=OK;function D6e(t){let e=EB.get(t);if(!e){const{rootElement:r}=t;e=new $r(t),e.addEventListener(r,"click",n=>H6e(n,t)),e.addEventListener(r,"mouseup",n=>$6e(n,t)),e.addEventListener(r,"change",n=>j6e(n,t)),EB.set(t,e)}return e}function L6e(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function F6e(t,e,r){const n=t.createElement("label");return n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function $6e(t,e){const{target:r}=t;NP(r)&&(!r.hasAttribute(_f)||!r.hasAttribute(Rf)||setTimeout(e.listen,10))}function H6e(t,e){const{target:r}=t;if(!NP(r)||!r.hasAttribute(_f)||!r.hasAttribute(Rf))return;const n=parseInt(r.getAttribute(_f),10),i=parseInt(r.getAttribute(Rf),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function j6e(t,e){const{target:r}=t;if(!NP(r)||!r.hasAttribute(_f)||!r.hasAttribute(Rf))return;const n=parseInt(r.getAttribute(_f),10),i=parseInt(r.getAttribute(Rf),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function NP(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function Sy(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kK={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,s){function o(c,u){if(!i[c]){if(!n[c]){var h=typeof Sy=="function"&&Sy;if(!u&&h)return h(c,!0);if(a)return a(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[c]={exports:{}};n[c][0].call(f.exports,function(m){return o(n[c][1][m]||m)},f,f.exports,r,n,i,s)}return i[c].exports}for(var a=typeof Sy=="function"&&Sy,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(r,n,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,c=Math.floor,u="[BigNumber Error] ",h=u+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,w=1e9;function b(k){var M=0|k;return 0<k||k===M?M:M-1}function x(k){for(var M,D,L=1,U=k.length,J=k[0]+"";L<U;){for(M=k[L++]+"",D=f-M.length;D--;M="0"+M);J+=M}for(U=J.length;J.charCodeAt(--U)===48;);return J.slice(0,U+1||1)}function C(k,M){var D,L,U=k.c,J=M.c,X=k.s,ie=M.s,se=k.e,P=M.e;if(!X||!ie)return null;if(D=U&&!U[0],L=J&&!J[0],D||L)return D?L?0:-ie:X;if(X!=ie)return X;if(D=X<0,L=se==P,!U||!J)return L?0:!U^D?1:-1;if(!L)return P<se^D?1:-1;for(ie=(se=U.length)<(P=J.length)?se:P,X=0;X<ie;X++)if(U[X]!=J[X])return U[X]>J[X]^D?1:-1;return se==P?0:P<se^D?1:-1}function S(k,M,D,L){if(k<M||D<k||k!==(k<0?l(k):c(k)))throw Error(u+(L||"Argument")+(typeof k=="number"?k<M||D<k?" out of range: ":" not an integer: ":" not a primitive number: ")+String(k))}function E(k){var M=k.c.length-1;return b(k.e/f)==M&&k.c[M]%2!=0}function T(k,M){return(1<k.length?k.charAt(0)+"."+k.slice(1):k)+(M<0?"e":"e+")+M}function I(k,M,D){var L,U;if(M<0){for(U=D+".";++M;U+=D);k=U+k}else if(++M>(L=k.length)){for(U=D,M-=L;--M;U+=D);k+=U}else M<L&&(k=k.slice(0,M)+"."+k.slice(M));return k}(o=function k(M){var D,L,U,J,X,ie,se,P,y,_,R=ue.prototype={constructor:ue,toString:null,valueOf:null},A=new ue(1),O=20,N=4,F=-7,j=21,z=-1e7,Q=1e7,W=!1,ae=1,ye=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Re="0123456789abcdefghijklmnopqrstuvwxyz";function ue(V,K){var te,ve,le,ce,me,de,fe,ge,pe=this;if(!(pe instanceof ue))return new ue(V,K);if(K==null){if(V instanceof ue)return pe.s=V.s,pe.e=V.e,void(pe.c=(V=V.c)?V.slice():V);if((de=typeof V=="number")&&0*V==0){if(pe.s=1/V<0?(V=-V,-1):1,V===~~V){for(ce=0,me=V;10<=me;me/=10,ce++);return pe.e=ce,void(pe.c=[V])}ge=String(V)}else{if(ge=String(V),!a.test(ge))return U(pe,ge,de);pe.s=ge.charCodeAt(0)==45?(ge=ge.slice(1),-1):1}-1<(ce=ge.indexOf("."))&&(ge=ge.replace(".","")),0<(me=ge.search(/e/i))?(ce<0&&(ce=me),ce+=+ge.slice(me+1),ge=ge.substring(0,me)):ce<0&&(ce=ge.length)}else{if(S(K,2,Re.length,"Base"),ge=String(V),K==10)return Fe(pe=new ue(V instanceof ue?V:ge),O+pe.e+1,N);if(de=typeof V=="number"){if(0*V!=0)return U(pe,ge,de,K);if(pe.s=1/V<0?(ge=ge.slice(1),-1):1,ue.DEBUG&&15<ge.replace(/^0\.0*|\./,"").length)throw Error(h+V);de=!1}else pe.s=ge.charCodeAt(0)===45?(ge=ge.slice(1),-1):1;for(te=Re.slice(0,K),ce=me=0,fe=ge.length;me<fe;me++)if(te.indexOf(ve=ge.charAt(me))<0){if(ve=="."){if(ce<me){ce=fe;continue}}else if(!le&&(ge==ge.toUpperCase()&&(ge=ge.toLowerCase())||ge==ge.toLowerCase()&&(ge=ge.toUpperCase()))){le=!0,me=-1,ce=0;continue}return U(pe,String(V),de,K)}-1<(ce=(ge=L(ge,K,10,pe.s)).indexOf("."))?ge=ge.replace(".",""):ce=ge.length}for(me=0;ge.charCodeAt(me)===48;me++);for(fe=ge.length;ge.charCodeAt(--fe)===48;);if(ge=ge.slice(me,++fe)){if(fe-=me,de&&ue.DEBUG&&15<fe&&(m<V||V!==c(V)))throw Error(h+pe.s*V);if(Q<(ce=ce-me-1))pe.c=pe.e=null;else if(ce<z)pe.c=[pe.e=0];else{if(pe.e=ce,pe.c=[],me=(ce+1)%f,ce<0&&(me+=f),me<fe){for(me&&pe.c.push(+ge.slice(0,me)),fe-=f;me<fe;)pe.c.push(+ge.slice(me,me+=f));ge=ge.slice(me),me=f-ge.length}else me-=fe;for(;me--;ge+="0");pe.c.push(+ge)}}else pe.c=[pe.e=0]}function Pe(V,K,te,ve){var le,ce,me,de,fe;if(te==null?te=N:S(te,0,8),!V.c)return V.toString();if(le=V.c[0],me=V.e,K==null)fe=x(V.c),fe=ve==1||ve==2&&(me<=F||j<=me)?T(fe,me):I(fe,me,"0");else if(ce=(V=Fe(new ue(V),K,te)).e,de=(fe=x(V.c)).length,ve==1||ve==2&&(K<=ce||ce<=F)){for(;de<K;fe+="0",de++);fe=T(fe,ce)}else if(K-=me,fe=I(fe,ce,"0"),de<ce+1){if(0<--K)for(fe+=".";K--;fe+="0");}else if(0<(K+=ce-de))for(ce+1==de&&(fe+=".");K--;fe+="0");return V.s<0&&le?"-"+fe:fe}function ke(V,K){for(var te,ve=1,le=new ue(V[0]);ve<V.length;ve++){if(!(te=new ue(V[ve])).s){le=te;break}K.call(le,te)&&(le=te)}return le}function be(V,K,te){for(var ve=1,le=K.length;!K[--le];K.pop());for(le=K[0];10<=le;le/=10,ve++);return(te=ve+te*f-1)>Q?V.c=V.e=null:V.c=te<z?[V.e=0]:(V.e=te,K),V}function Fe(V,K,te,ve){var le,ce,me,de,fe,ge,pe,Ie=V.c,je=g;if(Ie){e:{for(le=1,de=Ie[0];10<=de;de/=10,le++);if((ce=K-le)<0)ce+=f,me=K,pe=(fe=Ie[ge=0])/je[le-me-1]%10|0;else if((ge=l((ce+1)/f))>=Ie.length){if(!ve)break e;for(;Ie.length<=ge;Ie.push(0));fe=pe=0,me=(ce%=f)-f+(le=1)}else{for(fe=de=Ie[ge],le=1;10<=de;de/=10,le++);pe=(me=(ce%=f)-f+le)<0?0:fe/je[le-me-1]%10|0}if(ve=ve||K<0||Ie[ge+1]!=null||(me<0?fe:fe%je[le-me-1]),ve=te<4?(pe||ve)&&(te==0||te==(V.s<0?3:2)):5<pe||pe==5&&(te==4||ve||te==6&&(0<ce?0<me?fe/je[le-me]:0:Ie[ge-1])%10&1||te==(V.s<0?8:7)),K<1||!Ie[0])return Ie.length=0,ve?(K-=V.e+1,Ie[0]=je[(f-K%f)%f],V.e=-K||0):Ie[0]=V.e=0,V;if(ce==0?(Ie.length=ge,de=1,ge--):(Ie.length=ge+1,de=je[f-ce],Ie[ge]=0<me?c(fe/je[le-me]%je[me])*de:0),ve)for(;;){if(ge==0){for(ce=1,me=Ie[0];10<=me;me/=10,ce++);for(me=Ie[0]+=de,de=1;10<=me;me/=10,de++);ce!=de&&(V.e++,Ie[0]==d&&(Ie[0]=1));break}if(Ie[ge]+=de,Ie[ge]!=d)break;Ie[ge--]=0,de=1}for(ce=Ie.length;Ie[--ce]===0;Ie.pop());}V.e>Q?V.c=V.e=null:V.e<z&&(V.c=[V.e=0])}return V}function He(V){var K,te=V.e;return te===null?V.toString():(K=x(V.c),K=te<=F||j<=te?T(K,te):I(K,te,"0"),V.s<0?"-"+K:K)}return ue.clone=k,ue.ROUND_UP=0,ue.ROUND_DOWN=1,ue.ROUND_CEIL=2,ue.ROUND_FLOOR=3,ue.ROUND_HALF_UP=4,ue.ROUND_HALF_DOWN=5,ue.ROUND_HALF_EVEN=6,ue.ROUND_HALF_CEIL=7,ue.ROUND_HALF_FLOOR=8,ue.EUCLID=9,ue.config=ue.set=function(V){var K,te;if(V!=null){if(typeof V!="object")throw Error(u+"Object expected: "+V);if(V.hasOwnProperty(K="DECIMAL_PLACES")&&(S(te=V[K],0,w,K),O=te),V.hasOwnProperty(K="ROUNDING_MODE")&&(S(te=V[K],0,8,K),N=te),V.hasOwnProperty(K="EXPONENTIAL_AT")&&((te=V[K])&&te.pop?(S(te[0],-1e9,0,K),S(te[1],0,w,K),F=te[0],j=te[1]):(S(te,-1e9,w,K),F=-(j=te<0?-te:te))),V.hasOwnProperty(K="RANGE"))if((te=V[K])&&te.pop)S(te[0],-1e9,-1,K),S(te[1],1,w,K),z=te[0],Q=te[1];else{if(S(te,-1e9,w,K),!te)throw Error(u+K+" cannot be zero: "+te);z=-(Q=te<0?-te:te)}if(V.hasOwnProperty(K="CRYPTO")){if((te=V[K])!==!!te)throw Error(u+K+" not true or false: "+te);if(te){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw W=!te,Error(u+"crypto unavailable");W=te}else W=te}if(V.hasOwnProperty(K="MODULO_MODE")&&(S(te=V[K],0,9,K),ae=te),V.hasOwnProperty(K="POW_PRECISION")&&(S(te=V[K],0,w,K),ye=te),V.hasOwnProperty(K="FORMAT")){if(typeof(te=V[K])!="object")throw Error(u+K+" not an object: "+te);H=te}if(V.hasOwnProperty(K="ALPHABET")){if(typeof(te=V[K])!="string"||/^.$|[+-.\s]|(.).*\1/.test(te))throw Error(u+K+" invalid: "+te);Re=te}}return{DECIMAL_PLACES:O,ROUNDING_MODE:N,EXPONENTIAL_AT:[F,j],RANGE:[z,Q],CRYPTO:W,MODULO_MODE:ae,POW_PRECISION:ye,FORMAT:H,ALPHABET:Re}},ue.isBigNumber=function(V){return V instanceof ue||V&&V._isBigNumber===!0||!1},ue.maximum=ue.max=function(){return ke(arguments,R.lt)},ue.minimum=ue.min=function(){return ke(arguments,R.gt)},ue.random=(J=9007199254740992,X=Math.random()*J&2097151?function(){return c(Math.random()*J)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(V){var K,te,ve,le,ce,me=0,de=[],fe=new ue(A);if(V==null?V=O:S(V,0,w),le=l(V/f),W)if(crypto.getRandomValues){for(K=crypto.getRandomValues(new Uint32Array(le*=2));me<le;)9e15<=(ce=131072*K[me]+(K[me+1]>>>11))?(te=crypto.getRandomValues(new Uint32Array(2)),K[me]=te[0],K[me+1]=te[1]):(de.push(ce%1e14),me+=2);me=le/2}else{if(!crypto.randomBytes)throw W=!1,Error(u+"crypto unavailable");for(K=crypto.randomBytes(le*=7);me<le;)9e15<=(ce=281474976710656*(31&K[me])+1099511627776*K[me+1]+4294967296*K[me+2]+16777216*K[me+3]+(K[me+4]<<16)+(K[me+5]<<8)+K[me+6])?crypto.randomBytes(7).copy(K,me):(de.push(ce%1e14),me+=7);me=le/7}if(!W)for(;me<le;)(ce=X())<9e15&&(de[me++]=ce%1e14);for(le=de[--me],V%=f,le&&V&&(ce=g[f-V],de[me]=c(le/ce)*ce);de[me]===0;de.pop(),me--);if(me<0)de=[ve=0];else{for(ve=-1;de[0]===0;de.splice(0,1),ve-=f);for(me=1,ce=de[0];10<=ce;ce/=10,me++);me<f&&(ve-=f-me)}return fe.e=ve,fe.c=de,fe}),ue.sum=function(){for(var V=1,K=arguments,te=new ue(K[0]);V<K.length;)te=te.plus(K[V++]);return te},L=function(){var V="0123456789";function K(te,ve,le,ce){for(var me,de,fe=[0],ge=0,pe=te.length;ge<pe;){for(de=fe.length;de--;fe[de]*=ve);for(fe[0]+=ce.indexOf(te.charAt(ge++)),me=0;me<fe.length;me++)fe[me]>le-1&&(fe[me+1]==null&&(fe[me+1]=0),fe[me+1]+=fe[me]/le|0,fe[me]%=le)}return fe.reverse()}return function(te,ve,le,ce,me){var de,fe,ge,pe,Ie,je,Be,Je,it=te.indexOf("."),Rt=O,ot=N;for(0<=it&&(pe=ye,ye=0,te=te.replace(".",""),je=(Je=new ue(ve)).pow(te.length-it),ye=pe,Je.c=K(I(x(je.c),je.e,"0"),10,le,V),Je.e=Je.c.length),ge=pe=(Be=K(te,ve,le,me?(de=Re,V):(de=V,Re))).length;Be[--pe]==0;Be.pop());if(!Be[0])return de.charAt(0);if(it<0?--ge:(je.c=Be,je.e=ge,je.s=ce,Be=(je=D(je,Je,Rt,ot,le)).c,Ie=je.r,ge=je.e),it=Be[fe=ge+Rt+1],pe=le/2,Ie=Ie||fe<0||Be[fe+1]!=null,Ie=ot<4?(it!=null||Ie)&&(ot==0||ot==(je.s<0?3:2)):pe<it||it==pe&&(ot==4||Ie||ot==6&&1&Be[fe-1]||ot==(je.s<0?8:7)),fe<1||!Be[0])te=Ie?I(de.charAt(1),-Rt,de.charAt(0)):de.charAt(0);else{if(Be.length=fe,Ie)for(--le;++Be[--fe]>le;)Be[fe]=0,fe||(++ge,Be=[1].concat(Be));for(pe=Be.length;!Be[--pe];);for(it=0,te="";it<=pe;te+=de.charAt(Be[it++]));te=I(te,ge,de.charAt(0))}return te}}(),D=function(){function V(ve,le,ce){var me,de,fe,ge,pe=0,Ie=ve.length,je=le%v,Be=le/v|0;for(ve=ve.slice();Ie--;)pe=((de=je*(fe=ve[Ie]%v)+(me=Be*fe+(ge=ve[Ie]/v|0)*je)%v*v+pe)/ce|0)+(me/v|0)+Be*ge,ve[Ie]=de%ce;return pe&&(ve=[pe].concat(ve)),ve}function K(ve,le,ce,me){var de,fe;if(ce!=me)fe=me<ce?1:-1;else for(de=fe=0;de<ce;de++)if(ve[de]!=le[de]){fe=ve[de]>le[de]?1:-1;break}return fe}function te(ve,le,ce,me){for(var de=0;ce--;)ve[ce]-=de,de=ve[ce]<le[ce]?1:0,ve[ce]=de*me+ve[ce]-le[ce];for(;!ve[0]&&1<ve.length;ve.splice(0,1));}return function(ve,le,ce,me,de){var fe,ge,pe,Ie,je,Be,Je,it,Rt,ot,Et,rr,ds,Vn,Co,en,Wt,Cr=ve.s==le.s?1:-1,jr=ve.c,Ve=le.c;if(!(jr&&jr[0]&&Ve&&Ve[0]))return new ue(ve.s&&le.s&&(jr?!Ve||jr[0]!=Ve[0]:Ve)?jr&&jr[0]==0||!Ve?0*Cr:Cr/0:NaN);for(Rt=(it=new ue(Cr)).c=[],Cr=ce+(ge=ve.e-le.e)+1,de||(de=d,ge=b(ve.e/f)-b(le.e/f),Cr=Cr/f|0),pe=0;Ve[pe]==(jr[pe]||0);pe++);if(Ve[pe]>(jr[pe]||0)&&ge--,Cr<0)Rt.push(1),Ie=!0;else{for(Vn=jr.length,en=Ve.length,Cr+=2,1<(je=c(de/(Ve[pe=0]+1)))&&(Ve=V(Ve,je,de),jr=V(jr,je,de),en=Ve.length,Vn=jr.length),ds=en,Et=(ot=jr.slice(0,en)).length;Et<en;ot[Et++]=0);Wt=Ve.slice(),Wt=[0].concat(Wt),Co=Ve[0],Ve[1]>=de/2&&Co++;do{if(je=0,(fe=K(Ve,ot,en,Et))<0){if(rr=ot[0],en!=Et&&(rr=rr*de+(ot[1]||0)),1<(je=c(rr/Co)))for(de<=je&&(je=de-1),Je=(Be=V(Ve,je,de)).length,Et=ot.length;K(Be,ot,Je,Et)==1;)je--,te(Be,en<Je?Wt:Ve,Je,de),Je=Be.length,fe=1;else je==0&&(fe=je=1),Je=(Be=Ve.slice()).length;if(Je<Et&&(Be=[0].concat(Be)),te(ot,Be,Et,de),Et=ot.length,fe==-1)for(;K(Ve,ot,en,Et)<1;)je++,te(ot,en<Et?Wt:Ve,Et,de),Et=ot.length}else fe===0&&(je++,ot=[0]);Rt[pe++]=je,ot[0]?ot[Et++]=jr[ds]||0:(ot=[jr[ds]],Et=1)}while((ds++<Vn||ot[0]!=null)&&Cr--);Ie=ot[0]!=null,Rt[0]||Rt.splice(0,1)}if(de==d){for(pe=1,Cr=Rt[0];10<=Cr;Cr/=10,pe++);Fe(it,ce+(it.e=pe+ge*f-1)+1,me,Ie)}else it.e=ge,it.r=+Ie;return it}}(),ie=/^(-?)0([xbo])(?=\w[\w.]*$)/i,se=/^([^.]+)\.$/,P=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,_=/^\s*\+(?=[\w.])|^\s+|\s+$/g,U=function(V,K,te,ve){var le,ce=te?K:K.replace(_,"");if(y.test(ce))V.s=isNaN(ce)?null:ce<0?-1:1,V.c=V.e=null;else{if(!te&&(ce=ce.replace(ie,function(me,de,fe){return le=(fe=fe.toLowerCase())=="x"?16:fe=="b"?2:8,ve&&ve!=le?me:de}),ve&&(le=ve,ce=ce.replace(se,"$1").replace(P,"0.$1")),K!=ce))return new ue(ce,le);if(ue.DEBUG)throw Error(u+"Not a"+(ve?" base "+ve:"")+" number: "+K);V.c=V.e=V.s=null}},R.absoluteValue=R.abs=function(){var V=new ue(this);return V.s<0&&(V.s=1),V},R.comparedTo=function(V,K){return C(this,new ue(V,K))},R.decimalPlaces=R.dp=function(V,K){var te,ve,le;if(V!=null)return S(V,0,w),K==null?K=N:S(K,0,8),Fe(new ue(this),V+this.e+1,K);if(!(te=this.c))return null;if(ve=((le=te.length-1)-b(this.e/f))*f,le=te[le])for(;le%10==0;le/=10,ve--);return ve<0&&(ve=0),ve},R.dividedBy=R.div=function(V,K){return D(this,new ue(V,K),O,N)},R.dividedToIntegerBy=R.idiv=function(V,K){return D(this,new ue(V,K),0,1)},R.exponentiatedBy=R.pow=function(V,K){var te,ve,le,ce,me,de,fe,ge,pe=this;if((V=new ue(V)).c&&!V.isInteger())throw Error(u+"Exponent not an integer: "+He(V));if(K!=null&&(K=new ue(K)),me=14<V.e,!pe.c||!pe.c[0]||pe.c[0]==1&&!pe.e&&pe.c.length==1||!V.c||!V.c[0])return ge=new ue(Math.pow(+He(pe),me?2-E(V):+He(V))),K?ge.mod(K):ge;if(de=V.s<0,K){if(K.c?!K.c[0]:!K.s)return new ue(NaN);(ve=!de&&pe.isInteger()&&K.isInteger())&&(pe=pe.mod(K))}else{if(9<V.e&&(0<pe.e||pe.e<-1||(pe.e==0?1<pe.c[0]||me&&24e7<=pe.c[1]:pe.c[0]<8e13||me&&pe.c[0]<=9999975e7)))return ce=pe.s<0&&E(V)?-0:0,-1<pe.e&&(ce=1/ce),new ue(de?1/ce:ce);ye&&(ce=l(ye/f+2))}for(fe=me?(te=new ue(.5),de&&(V.s=1),E(V)):(le=Math.abs(+He(V)))%2,ge=new ue(A);;){if(fe){if(!(ge=ge.times(pe)).c)break;ce?ge.c.length>ce&&(ge.c.length=ce):ve&&(ge=ge.mod(K))}if(le){if((le=c(le/2))===0)break;fe=le%2}else if(Fe(V=V.times(te),V.e+1,1),14<V.e)fe=E(V);else{if((le=+He(V))==0)break;fe=le%2}pe=pe.times(pe),ce?pe.c&&pe.c.length>ce&&(pe.c.length=ce):ve&&(pe=pe.mod(K))}return ve?ge:(de&&(ge=A.div(ge)),K?ge.mod(K):ce?Fe(ge,ye,N,void 0):ge)},R.integerValue=function(V){var K=new ue(this);return V==null?V=N:S(V,0,8),Fe(K,K.e+1,V)},R.isEqualTo=R.eq=function(V,K){return C(this,new ue(V,K))===0},R.isFinite=function(){return!!this.c},R.isGreaterThan=R.gt=function(V,K){return 0<C(this,new ue(V,K))},R.isGreaterThanOrEqualTo=R.gte=function(V,K){return(K=C(this,new ue(V,K)))===1||K===0},R.isInteger=function(){return!!this.c&&b(this.e/f)>this.c.length-2},R.isLessThan=R.lt=function(V,K){return C(this,new ue(V,K))<0},R.isLessThanOrEqualTo=R.lte=function(V,K){return(K=C(this,new ue(V,K)))===-1||K===0},R.isNaN=function(){return!this.s},R.isNegative=function(){return this.s<0},R.isPositive=function(){return 0<this.s},R.isZero=function(){return!!this.c&&this.c[0]==0},R.minus=function(V,K){var te,ve,le,ce,me=this,de=me.s;if(K=(V=new ue(V,K)).s,!de||!K)return new ue(NaN);if(de!=K)return V.s=-K,me.plus(V);var fe=me.e/f,ge=V.e/f,pe=me.c,Ie=V.c;if(!fe||!ge){if(!pe||!Ie)return pe?(V.s=-K,V):new ue(Ie?me:NaN);if(!pe[0]||!Ie[0])return Ie[0]?(V.s=-K,V):new ue(pe[0]?me:N==3?-0:0)}if(fe=b(fe),ge=b(ge),pe=pe.slice(),de=fe-ge){for((le=(ce=de<0)?(de=-de,pe):(ge=fe,Ie)).reverse(),K=de;K--;le.push(0));le.reverse()}else for(ve=(ce=(de=pe.length)<(K=Ie.length))?de:K,de=K=0;K<ve;K++)if(pe[K]!=Ie[K]){ce=pe[K]<Ie[K];break}if(ce&&(le=pe,pe=Ie,Ie=le,V.s=-V.s),0<(K=(ve=Ie.length)-(te=pe.length)))for(;K--;pe[te++]=0);for(K=d-1;de<ve;){if(pe[--ve]<Ie[ve]){for(te=ve;te&&!pe[--te];pe[te]=K);--pe[te],pe[ve]+=d}pe[ve]-=Ie[ve]}for(;pe[0]==0;pe.splice(0,1),--ge);return pe[0]?be(V,pe,ge):(V.s=N==3?-1:1,V.c=[V.e=0],V)},R.modulo=R.mod=function(V,K){var te,ve,le=this;return V=new ue(V,K),!le.c||!V.s||V.c&&!V.c[0]?new ue(NaN):!V.c||le.c&&!le.c[0]?new ue(le):(ae==9?(ve=V.s,V.s=1,te=D(le,V,0,3),V.s=ve,te.s*=ve):te=D(le,V,0,ae),(V=le.minus(te.times(V))).c[0]||ae!=1||(V.s=le.s),V)},R.multipliedBy=R.times=function(V,K){var te,ve,le,ce,me,de,fe,ge,pe,Ie,je,Be,Je,it,Rt,ot=this,Et=ot.c,rr=(V=new ue(V,K)).c;if(!(Et&&rr&&Et[0]&&rr[0]))return!ot.s||!V.s||Et&&!Et[0]&&!rr||rr&&!rr[0]&&!Et?V.c=V.e=V.s=null:(V.s*=ot.s,Et&&rr?(V.c=[0],V.e=0):V.c=V.e=null),V;for(ve=b(ot.e/f)+b(V.e/f),V.s*=ot.s,(fe=Et.length)<(Ie=rr.length)&&(Je=Et,Et=rr,rr=Je,le=fe,fe=Ie,Ie=le),le=fe+Ie,Je=[];le--;Je.push(0));for(it=d,Rt=v,le=Ie;0<=--le;){for(te=0,je=rr[le]%Rt,Be=rr[le]/Rt|0,ce=le+(me=fe);le<ce;)te=((ge=je*(ge=Et[--me]%Rt)+(de=Be*ge+(pe=Et[me]/Rt|0)*je)%Rt*Rt+Je[ce]+te)/it|0)+(de/Rt|0)+Be*pe,Je[ce--]=ge%it;Je[ce]=te}return te?++ve:Je.splice(0,1),be(V,Je,ve)},R.negated=function(){var V=new ue(this);return V.s=-V.s||null,V},R.plus=function(V,K){var te,ve=this,le=ve.s;if(K=(V=new ue(V,K)).s,!le||!K)return new ue(NaN);if(le!=K)return V.s=-K,ve.minus(V);var ce=ve.e/f,me=V.e/f,de=ve.c,fe=V.c;if(!ce||!me){if(!de||!fe)return new ue(le/0);if(!de[0]||!fe[0])return fe[0]?V:new ue(de[0]?ve:0*le)}if(ce=b(ce),me=b(me),de=de.slice(),le=ce-me){for((te=0<le?(me=ce,fe):(le=-le,de)).reverse();le--;te.push(0));te.reverse()}for((le=de.length)-(K=fe.length)<0&&(te=fe,fe=de,de=te,K=le),le=0;K;)le=(de[--K]=de[K]+fe[K]+le)/d|0,de[K]=d===de[K]?0:de[K]%d;return le&&(de=[le].concat(de),++me),be(V,de,me)},R.precision=R.sd=function(V,K){var te,ve,le;if(V!=null&&V!==!!V)return S(V,1,w),K==null?K=N:S(K,0,8),Fe(new ue(this),V,K);if(!(te=this.c))return null;if(ve=(le=te.length-1)*f+1,le=te[le]){for(;le%10==0;le/=10,ve--);for(le=te[0];10<=le;le/=10,ve++);}return V&&this.e+1>ve&&(ve=this.e+1),ve},R.shiftedBy=function(V){return S(V,-9007199254740991,m),this.times("1e"+V)},R.squareRoot=R.sqrt=function(){var V,K,te,ve,le,ce=this,me=ce.c,de=ce.s,fe=ce.e,ge=O+4,pe=new ue("0.5");if(de!==1||!me||!me[0])return new ue(!de||de<0&&(!me||me[0])?NaN:me?ce:1/0);if((te=(de=Math.sqrt(+He(ce)))==0||de==1/0?(((K=x(me)).length+fe)%2==0&&(K+="0"),de=Math.sqrt(+K),fe=b((fe+1)/2)-(fe<0||fe%2),new ue(K=de==1/0?"1e"+fe:(K=de.toExponential()).slice(0,K.indexOf("e")+1)+fe)):new ue(de+"")).c[0]){for((de=(fe=te.e)+ge)<3&&(de=0);;)if(le=te,te=pe.times(le.plus(D(ce,le,ge,1))),x(le.c).slice(0,de)===(K=x(te.c)).slice(0,de)){if(te.e<fe&&--de,(K=K.slice(de-3,de+1))!="9999"&&(ve||K!="4999")){+K&&(+K.slice(1)||K.charAt(0)!="5")||(Fe(te,te.e+O+2,1),V=!te.times(te).eq(ce));break}if(!ve&&(Fe(le,le.e+O+2,0),le.times(le).eq(ce))){te=le;break}ge+=4,de+=4,ve=1}}return Fe(te,te.e+O+1,N,V)},R.toExponential=function(V,K){return V!=null&&(S(V,0,w),V++),Pe(this,V,K,1)},R.toFixed=function(V,K){return V!=null&&(S(V,0,w),V=V+this.e+1),Pe(this,V,K)},R.toFormat=function(V,K,te){var ve;if(te==null)V!=null&&K&&typeof K=="object"?(te=K,K=null):V&&typeof V=="object"?(te=V,V=K=null):te=H;else if(typeof te!="object")throw Error(u+"Argument not an object: "+te);if(ve=this.toFixed(V,K),this.c){var le,ce=ve.split("."),me=+te.groupSize,de=+te.secondaryGroupSize,fe=te.groupSeparator||"",ge=ce[0],pe=ce[1],Ie=this.s<0,je=Ie?ge.slice(1):ge,Be=je.length;if(de&&(le=me,me=de,Be-=de=le),0<me&&0<Be){for(le=Be%me||me,ge=je.substr(0,le);le<Be;le+=me)ge+=fe+je.substr(le,me);0<de&&(ge+=fe+je.slice(le)),Ie&&(ge="-"+ge)}ve=pe?ge+(te.decimalSeparator||"")+((de=+te.fractionGroupSize)?pe.replace(new RegExp("\\d{"+de+"}\\B","g"),"$&"+(te.fractionGroupSeparator||"")):pe):ge}return(te.prefix||"")+ve+(te.suffix||"")},R.toFraction=function(V){var K,te,ve,le,ce,me,de,fe,ge,pe,Ie,je,Be=this,Je=Be.c;if(V!=null&&(!(de=new ue(V)).isInteger()&&(de.c||de.s!==1)||de.lt(A)))throw Error(u+"Argument "+(de.isInteger()?"out of range: ":"not an integer: ")+He(de));if(!Je)return new ue(Be);for(K=new ue(A),ge=te=new ue(A),ve=fe=new ue(A),je=x(Je),ce=K.e=je.length-Be.e-1,K.c[0]=g[(me=ce%f)<0?f+me:me],V=!V||0<de.comparedTo(K)?0<ce?K:ge:de,me=Q,Q=1/0,de=new ue(je),fe.c[0]=0;pe=D(de,K,0,1),(le=te.plus(pe.times(ve))).comparedTo(V)!=1;)te=ve,ve=le,ge=fe.plus(pe.times(le=ge)),fe=le,K=de.minus(pe.times(le=K)),de=le;return le=D(V.minus(te),ve,0,1),fe=fe.plus(le.times(ge)),te=te.plus(le.times(ve)),fe.s=ge.s=Be.s,Ie=D(ge,ve,ce*=2,N).minus(Be).abs().comparedTo(D(fe,te,ce,N).minus(Be).abs())<1?[ge,ve]:[fe,te],Q=me,Ie},R.toNumber=function(){return+He(this)},R.toPrecision=function(V,K){return V!=null&&S(V,1,w),Pe(this,V,K,2)},R.toString=function(V){var K,te=this,ve=te.s,le=te.e;return le===null?ve?(K="Infinity",ve<0&&(K="-"+K)):K="NaN":(K=V==null?le<=F||j<=le?T(x(te.c),le):I(x(te.c),le,"0"):V===10?I(x((te=Fe(new ue(te),O+le+1,N)).c),te.e,"0"):(S(V,2,Re.length,"Base"),L(I(x(te.c),le,"0"),10,V,ve,!0)),ve<0&&te.c[0]&&(K="-"+K)),K},R.valueOf=R.toJSON=function(){return He(this)},R._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(R[Symbol.toStringTag]="BigNumber",R[Symbol.for("nodejs.util.inspect.custom")]=R.valueOf),M!=null&&ue.set(M),ue}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function s(b,x){return function(C){if(Array.isArray(C))return C}(b)||function(C,S){var E=[],T=!0,I=!1,k=void 0;try{for(var M,D=C[Symbol.iterator]();!(T=(M=D.next()).done)&&(E.push(M.value),!S||E.length!==S);T=!0);}catch(L){I=!0,k=L}finally{try{T||D.return==null||D.return()}finally{if(I)throw k}}return E}(b,x)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),a=r("./validating"),l=r("./parsing"),c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],u={general:{scale:1024,suffixes:c,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:c,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(b){var x=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},C=2<arguments.length?arguments[2]:void 0;if(typeof x=="string"&&(x=l.parseFormat(x)),!a.validateFormat(x))return"ERROR: invalid format";var S=x.prefix||"",E=x.postfix||"",T=function(I,k,M){switch(k.output){case"currency":return k=w(k,o.currentCurrencyDefaultFormat()),function(Re,ue,Pe){var ke=Pe.currentCurrency(),be=Object.assign({},h,ue),Fe=void 0,He="",V=!!be.totalLength||!!be.forceAverage||be.average,K=ue.currencyPosition||ke.position,te=ue.currencySymbol||ke.symbol;be.spaceSeparated&&(He=" "),K==="infix"&&(Fe=He+te+He);var ve=v({instance:Re,providedFormat:ue,state:Pe,decimalSeparator:Fe});return K==="prefix"&&(ve=Re._value<0&&be.negative==="sign"?"-".concat(He).concat(te).concat(ve.slice(1)):te+He+ve),K&&K!=="postfix"||(ve=ve+(He=V?"":He)+te),ve}(I,k,o);case"percent":return k=w(k,o.currentPercentageDefaultFormat()),function(Re,ue,Pe,ke){var be=ue.prefixSymbol,Fe=v({instance:ke(100*Re._value),providedFormat:ue,state:Pe}),He=Object.assign({},h,ue);return be?"%".concat(He.spaceSeparated?" ":"").concat(Fe):"".concat(Fe).concat(He.spaceSeparated?" ":"","%")}(I,k,o,M);case"byte":return k=w(k,o.currentByteDefaultFormat()),A=I,N=o,F=M,j=(O=k).base||"binary",z=u[j],Q=f(A._value,z.suffixes,z.scale),W=Q.value,ae=Q.suffix,ye=v({instance:F(W),providedFormat:O,state:N,defaults:N.currentByteDefaultFormat()}),H=N.currentAbbreviations(),"".concat(ye).concat(H.spaced?" ":"").concat(ae);case"time":return k=w(k,o.currentTimeDefaultFormat()),P=I,y=Math.floor(P._value/60/60),_=Math.floor((P._value-60*y*60)/60),R=Math.round(P._value-60*y*60-60*_),"".concat(y,":").concat(_<10?"0":"").concat(_,":").concat(R<10?"0":"").concat(R);case"ordinal":return k=w(k,o.currentOrdinalDefaultFormat()),D=I,L=k,J=(U=o).currentOrdinal(),X=Object.assign({},h,L),ie=v({instance:D,providedFormat:L,state:U}),se=J(D._value),"".concat(ie).concat(X.spaceSeparated?" ":"").concat(se);case"number":default:return v({instance:I,providedFormat:k})}var D,L,U,J,X,ie,se,P,y,_,R,A,O,N,F,j,z,Q,W,ae,ye,H}(b,x,C);return T=(T=S+T)+E}function f(b,x,C){var S=x[0],E=Math.abs(b);if(C<=E){for(var T=1;T<x.length;++T){var I=Math.pow(C,T),k=Math.pow(C,T+1);if(I<=E&&E<k){S=x[T],b/=I;break}}S===x[0]&&(b/=Math.pow(C,x.length-1),S=x[x.length-1])}return{value:b,suffix:S}}function m(b){for(var x="",C=0;C<b;C++)x+="0";return x}function g(b,x){return b.toString().indexOf("e")!==-1?function(C,S){var E=C.toString(),T=s(E.split("e"),2),I=T[0],k=T[1],M=s(I.split("."),2),D=M[0],L=M[1],U=L===void 0?"":L;if(0<+k)E=D+U+m(k-U.length);else{var J=".";J=+D<0?"-0".concat(J):"0".concat(J);var X=(m(-k-1)+Math.abs(D)+U).substr(0,S);X.length<S&&(X+=m(S-X.length)),E=J+X}return 0<+k&&0<S&&(E+=".".concat(m(S))),E}(b,x):(Math.round(+"".concat(b,"e+").concat(x))/Math.pow(10,x)).toFixed(x)}function v(b){var x=b.instance,C=b.providedFormat,S=b.state,E=S===void 0?o:S,T=b.decimalSeparator,I=b.defaults,k=I===void 0?E.currentDefaults():I,M=x._value;if(M===0&&E.hasZeroFormat())return E.getZeroFormat();if(!isFinite(M))return M.toString();var D,L,U,J,X,ie,se,P,y=Object.assign({},h,k,C),_=y.totalLength,R=_?0:y.characteristic,A=y.optionalCharacteristic,O=y.forceAverage,N=!!_||!!O||y.average,F=_?-1:N&&C.mantissa===void 0?0:y.mantissa,j=!_&&(C.optionalMantissa===void 0?F===-1:y.optionalMantissa),z=y.trimMantissa,Q=y.thousandSeparated,W=y.spaceSeparated,ae=y.negative,ye=y.forceSign,H=y.exponential,Re="";if(N){var ue=function(V){var K=V.value,te=V.forceAverage,ve=V.abbreviations,le=V.spaceSeparated,ce=le!==void 0&&le,me=V.totalLength,de=me===void 0?0:me,fe="",ge=Math.abs(K),pe=-1;if(ge>=Math.pow(10,12)&&!te||te==="trillion"?(fe=ve.trillion,K/=Math.pow(10,12)):ge<Math.pow(10,12)&&ge>=Math.pow(10,9)&&!te||te==="billion"?(fe=ve.billion,K/=Math.pow(10,9)):ge<Math.pow(10,9)&&ge>=Math.pow(10,6)&&!te||te==="million"?(fe=ve.million,K/=Math.pow(10,6)):(ge<Math.pow(10,6)&&ge>=Math.pow(10,3)&&!te||te==="thousand")&&(fe=ve.thousand,K/=Math.pow(10,3)),fe&&(fe=(ce?" ":"")+fe),de){var Ie=K.toString().split(".")[0];pe=Math.max(de-Ie.length,0)}return{value:K,abbreviation:fe,mantissaPrecision:pe}}({value:M,forceAverage:O,abbreviations:E.currentAbbreviations(),spaceSeparated:W,totalLength:_});M=ue.value,Re+=ue.abbreviation,_&&(F=ue.mantissaPrecision)}if(H){var Pe=(L=(D={value:M,characteristicPrecision:R}).value,U=D.characteristicPrecision,J=U===void 0?0:U,X=s(L.toExponential().split("e"),2),ie=X[0],se=X[1],P=+ie,J&&1<J&&(P*=Math.pow(10,J-1),se=0<=(se=+se-(J-1))?"+".concat(se):se),{value:P,abbreviation:"e".concat(se)});M=Pe.value,Re=Pe.abbreviation+Re}var ke,be,Fe,He=function(V,K,te,ve,le){if(ve===-1)return V;var ce=g(K,ve),me=s(ce.toString().split("."),2),de=me[0],fe=me[1],ge=fe===void 0?"":fe;if(ge.match(/^0+$/)&&(te||le))return de;var pe=ge.match(/0+$/);return le&&pe?"".concat(de,".").concat(ge.toString().slice(0,pe.index)):ce.toString()}(M.toString(),M,j,F,z);return He=function(V,K,te,ve,le){var ce=ve.currentDelimiters(),me=ce.thousands;le=le||ce.decimal;var de=ce.thousandsSize||3,fe=V.toString(),ge=fe.split(".")[0],pe=fe.split(".")[1];return te&&(K<0&&(ge=ge.slice(1)),function(Ie,je){for(var Be=[],Je=0,it=Ie;0<it;it--)Je===je&&(Be.unshift(it),Je=0),Je++;return Be}(ge.length,de).forEach(function(Ie,je){ge=ge.slice(0,Ie+je)+me+ge.slice(Ie+je)}),K<0&&(ge="-".concat(ge))),fe=pe?ge+le+pe:ge}(He=function(V,K,te,ve){var le=V,ce=s(le.toString().split("."),2),me=ce[0],de=ce[1];if(me.match(/^-?0$/)&&te)return de?"".concat(me.replace("0",""),".").concat(de):me.replace("0","");if(me.length<ve)for(var fe=ve-me.length,ge=0;ge<fe;ge++)le="0".concat(le);return le.toString()}(He,0,A,R),M,Q,E,T),(N||H)&&(He=He+Re),(ye||M<0)&&(ke=He,Fe=ae,He=(be=M)===0?ke:+ke==0?ke.replace("-",""):0<be?"+".concat(ke):Fe==="sign"?ke:"(".concat(ke.replace("-",""),")")),He}function w(b,x){if(!b)return x;var C=Object.keys(b);return C.length===1&&C[0]==="output"?x:b}n.exports=function(b){return{format:function(){for(var x=arguments.length,C=new Array(x),S=0;S<x;S++)C[S]=arguments[S];return d.apply(void 0,C.concat([b]))},getByteUnit:function(){for(var x=arguments.length,C=new Array(x),S=0;S<x;S++)C[S]=arguments[S];return(function(E){var T=u.general;return f(E._value,T.suffixes,T.scale).suffix}).apply(void 0,C.concat([b]))},getBinaryByteUnit:function(){for(var x=arguments.length,C=new Array(x),S=0;S<x;S++)C[S]=arguments[S];return(function(E){var T=u.binary;return f(E._value,T.suffixes,T.scale).suffix}).apply(void 0,C.concat([b]))},getDecimalByteUnit:function(){for(var x=arguments.length,C=new Array(x),S=0;S<x;S++)C[S]=arguments[S];return(function(E){var T=u.decimal;return f(E._value,T.suffixes,T.scale).suffix}).apply(void 0,C.concat([b]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var s=r("./en-US"),o=r("./validating"),a=r("./parsing"),l={},c=void 0,u={},h=null,d={};function f(g){c=g}function m(){return u[c]}l.languages=function(){return Object.assign({},u)},l.currentLanguage=function(){return c},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(g){g=a.parseFormat(g),o.validateFormat(g)&&(d=g)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(g){return h=typeof g=="string"?g:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(g){if(g){if(u[g])return u[g];throw new Error('Unknown tag "'.concat(g,'"'))}return m()},l.registerLanguage=function(g){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(g))throw new Error("Invalid language data");u[g.languageTag]=g,v&&f(g.languageTag)},l.setLanguage=function(g){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!u[g]){var w=g.split("-")[0],b=Object.keys(u).find(function(x){return x.split("-")[0]===w});return u[b]?void f(b):void f(v)}f(g)},l.registerLanguage(s),c=s.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var c=void 0;try{c=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}c&&a.registerLanguage(c)});var a}}}},{}],6:[function(r,n,i){var s=r("bignumber.js");function o(a,l,c){var u=new s(a._value),h=l;return c.isNumbro(l)&&(h=l._value),h=new s(h),a._value=u.minus(h).toNumber(),a}n.exports=function(a){return{add:function(l,c){return h=c,d=a,f=new s((u=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),u._value=f.plus(m).toNumber(),u;var u,h,d,f,m},subtract:function(l,c){return o(l,c,a)},multiply:function(l,c){return h=c,d=a,f=new s((u=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),u._value=f.times(m).toNumber(),u;var u,h,d,f,m},divide:function(l,c){return h=c,d=a,f=new s((u=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),u._value=f.dividedBy(m).toNumber(),u;var u,h,d,f,m},set:function(l,c){return u=l,d=h=c,a.isNumbro(h)&&(d=h._value),u._value=d,u;var u,h,d},difference:function(l,c){return u=c,o(d=(h=a)(l._value),u,h),Math.abs(d._value);var u,h,d}}}},{"bignumber.js":1}],7:[function(r,n,i){function s(v,w){for(var b=0;b<w.length;b++){var x=w[b];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(v,x.key,x)}}var o=r("./globalState"),a=r("./validating"),l=r("./loading")(g),c=r("./unformatting"),u=r("./formatting")(g),h=r("./manipulating")(g),d=r("./parsing"),f=function(){function v(x){(function(C,S){if(!(C instanceof S))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=x}var w,b;return w=v,(b=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return u.format(this,x)}},{key:"formatCurrency",value:function(x){return typeof x=="string"&&(x=d.parseFormat(x)),(x=u.formatOrDefault(x,o.currentCurrencyDefaultFormat())).output="currency",u.format(this,x)}},{key:"formatTime",value:function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return x.output="time",u.format(this,x)}},{key:"binaryByteUnits",value:function(){return u.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return u.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return u.getByteUnit(this)}},{key:"difference",value:function(x){return h.difference(this,x)}},{key:"add",value:function(x){return h.add(this,x)}},{key:"subtract",value:function(x){return h.subtract(this,x)}},{key:"multiply",value:function(x){return h.multiply(this,x)}},{key:"divide",value:function(x){return h.divide(this,x)}},{key:"set",value:function(x){return h.set(this,m(x))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(w.prototype,b),v}();function m(v){var w=v;return g.isNumbro(v)?w=v._value:typeof v=="string"?w=g.unformat(v):isNaN(v)&&(w=NaN),w}function g(v){return new f(m(v))}g.version="2.1.2",g.isNumbro=function(v){return v instanceof f},g.language=o.currentLanguage,g.registerLanguage=o.registerLanguage,g.setLanguage=o.setLanguage,g.languages=o.languages,g.languageData=o.languageData,g.zeroFormat=o.setZeroFormat,g.defaultFormat=o.currentDefaults,g.setDefaults=o.setDefaults,g.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,g.validate=a.validate,g.loadLanguagesInNode=l.loadLanguagesInNode,g.unformat=c.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(s){var o,a,l,c,u,h,d,f,m,g,v,w,b,x,C,S,E,T,I,k,M=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=M,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,u=M,function(D,L){if(D.indexOf("$")===-1){if(D.indexOf("%")===-1)return D.indexOf("bd")!==-1?(L.output="byte",L.base="general"):D.indexOf("b")!==-1?(L.output="byte",L.base="binary"):D.indexOf("d")!==-1?(L.output="byte",L.base="decimal"):D.indexOf(":")===-1?D.indexOf("o")!==-1&&(L.output="ordinal"):L.output="time";L.output="percent"}else L.output="currency"}(s=(h=(c=s).match(/{([^}]*)}$/))?(u.postfix=h[1],c.slice(0,-h[0].length)):c,M),d=M,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=M,(g=s.split(".")[0].match(/0+/))&&(m.characteristic=g[0].length),function(D,L){if(D.indexOf(".")!==-1){var U=D.split(".")[0];L.optionalCharacteristic=U.indexOf("0")===-1}}(s,M),v=M,s.indexOf("a")!==-1&&(v.average=!0),b=M,(w=s).indexOf("K")!==-1?b.forceAverage="thousand":w.indexOf("M")!==-1?b.forceAverage="million":w.indexOf("B")!==-1?b.forceAverage="billion":w.indexOf("T")!==-1&&(b.forceAverage="trillion"),function(D,L){var U=D.split(".")[1];if(U){var J=U.match(/0+/);J&&(L.mantissa=J[0].length)}}(s,M),C=M,(x=s).match(/\[\.]/)?C.optionalMantissa=!0:x.match(/\./)&&(C.optionalMantissa=!1),S=M,s.indexOf(",")!==-1&&(S.thousandSeparated=!0),E=M,s.indexOf(" ")!==-1&&(E.spaceSeparated=!0),I=M,(T=s).match(/^\+?\([^)]*\)$/)&&(I.negative="parenthesis"),T.match(/^\+?-/)&&(I.negative="sign"),k=M,s.match(/^\+/)&&(k.forceSign=!0),M)}}},{}],9:[function(r,n,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function g(v,w){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",x=3<arguments.length?arguments[3]:void 0,C=4<arguments.length?arguments[4]:void 0,S=5<arguments.length?arguments[5]:void 0,E=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var T="",I=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(I!==v)return-1*g(I,w,b,x,C,S,E);for(var k=0;k<s.length;k++){var M=s[k];if((T=v.replace(M.key,""))!==v)return g(T,w,b,x,C,S,E)*M.factor}if((T=v.replace("%",""))!==v)return g(T,w,b,x,C,S,E)/100;var D=parseFloat(v);if(!isNaN(D)){var L=x(D);if(L&&L!=="."&&(T=v.replace(new RegExp("".concat(o(L),"$")),""))!==v)return g(T,w,b,x,C,S,E);var U={};Object.keys(S).forEach(function(_){U[S[_]]=_});for(var J=Object.keys(U).sort().reverse(),X=J.length,ie=0;ie<X;ie++){var se=J[ie],P=U[se];if((T=v.replace(se,""))!==v){var y=void 0;switch(P){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return g(T,w,b,x,C,S,E)*y}}}}(function(g,v){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=g.replace(w,"");return b=(b=b.replace(new RegExp("([0-9])".concat(o(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")}(l,c,u),c,u,h,d,f,m)}n.exports={unformat:function(l,c){var u,h,d,f=r("./globalState"),m=f.currentDelimiters(),g=f.currentCurrency().symbol,v=f.currentOrdinal(),w=f.getZeroFormat(),b=f.currentAbbreviations(),x=void 0;if(typeof l=="string")x=function(C,S){if(!C.indexOf(":")||S.thousands===":")return!1;var E=C.split(":");if(E.length!==3)return!1;var T=+E[0],I=+E[1],k=+E[2];return!isNaN(T)&&!isNaN(I)&&!isNaN(k)}(l,m)?(u=l.split(":"),h=+u[0],d=+u[1],+u[2]+60*d+3600*h):a(l,m,g,v,w,b,c);else{if(typeof l!="number")return;x=l}if(x!==void 0)return x}}},{"./globalState":4}],10:[function(r,n,i){function s(m){return function(g){if(Array.isArray(g)){for(var v=0,w=new Array(g.length);v<g.length;v++)w[v]=g[v];return w}}(m)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}var a=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,c={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,g,v){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],b=Object.keys(m).map(function(x){if(!g[x])return console.error("".concat(v," Invalid key: ").concat(x)),!1;var C=m[x],S=g[x];if(typeof S=="string"&&(S={type:S}),S.type==="format"){if(!d(C,c,"[Validate ".concat(x,"]"),!0))return!1}else if(o(C)!==S.type)return console.error("".concat(v," ").concat(x,' type mismatched: "').concat(S.type,'" expected, "').concat(o(C),'" provided')),!1;if(S.restrictions&&S.restrictions.length)for(var E=S.restrictions.length,T=0;T<E;T++){var I=S.restrictions[T],k=I.restriction,M=I.message;if(!k(C,m))return console.error("".concat(v," ").concat(x," invalid value: ").concat(M)),!1}return S.restriction&&!S.restriction(C,m)?(console.error("".concat(v," ").concat(x," invalid value: ").concat(S.message)),!1):S.validValues&&S.validValues.indexOf(C)===-1?(console.error("".concat(v," ").concat(x," invalid value: must be among ").concat(JSON.stringify(S.validValues),', "').concat(C,'" provided')),!1):!(S.children&&!d(C,S.children,"[Validate ".concat(x,"]")))});return w||b.push.apply(b,s(Object.keys(g).map(function(x){var C=g[x];if(typeof C=="string"&&(C={type:C}),C.mandatory){var S=C.mandatory;if(typeof S=="function"&&(S=S(m)),S&&m[x]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(x,'"')),!1}return!0}))),b.reduce(function(x,C){return x&&C},!0)}function f(m){return d(m,c,"[Validate format]")}n.exports={validate:function(m,g){var v=h(m),w=f(g);return v&&w},validateFormat:f,validateInput:h,validateLanguage:function(m){return d(m,u,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(kK);var B6e=kK.exports;const Vc=jt(B6e),V6e="numeric";function MP(t,e,r,n,i,s,o){let a=s;if(Mi(a)){const l=o.numericFormat,c=l&&l.culture||"-",u=l&&l.pattern,h=o.className||"",d=h.length?h.split(" "):[];if(typeof c<"u"&&!Vc.languages()[c]){const f=c.replace("-",""),m=Vc.allLanguages?Vc.allLanguages[c]:Vc[f];m&&Vc.registerLanguage(m)}Vc.setLanguage(c),a=Vc(a).format(u||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),o.className=d.join(" "),e.dir="ltr"}kc(t,e,r,n,i,a,o)}MP.RENDERER_TYPE=V6e;const U6e="password";function PP(t,e,r,n,i,s,o){kc.apply(this,[t,e,r,n,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let c="";Qe(a-1,()=>{c+=l}),tg(e,c)}PP.RENDERER_TYPE=U6e;const W6e="time";function DP(t,e,r,n,i,s,o){kc.apply(this,[t,e,r,n,i,s,o]),e.dir="ltr"}DP.RENDERER_TYPE=W6e;function z6e(){Ea(og),Ea(lv),Ea(IP),Ea(kP),Ea(MP),Ea(PP),Ea(kc),Ea(DP)}const G6e="autocomplete";function gC(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,TB(r,e)):TB(r,e)(this.source):e(!0)}gC.VALIDATOR_TYPE=G6e;function TB(t,e){const r=t;return function(n){let i=!1;for(let s=0,o=n.length;s<o;s++)if(r===n[s]){i=!0;break}e(i)}}function Y6e(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const K6e="date";function LP(t,e){const r=EY(EK,this.instance);let n=t,i=!0;n==null&&(n="");let s=Me(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=Me(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=X6e(n,this.dateFormat),l=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,c,a,"dateValidator"),i=!0}else i=!1;e(i)}LP.VALIDATOR_TYPE=K6e;function X6e(t,e){const r=Me(Y6e(t)),n=Me(t,e),i=t.search(/[A-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const q6e="numeric";function FP(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Mi(t))}FP.VALIDATOR_TYPE=q6e;const J6e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Z6e="time";function $P(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=Me(i,J6e,!0).isValid()?Me(i):Me(i,r);let a=o.isValid(),l=Me(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(n=!1),!a&&l&&(n=!0),a&&!l)if(this.correctFormat===!0){const c=o.format(r),u=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(u,h,c,"timeValidator"),n=!0}else n=!1;e(n)}$P.VALIDATOR_TYPE=Z6e;function Q6e(){cm(gC),cm(LP),cm(FP),cm($P)}const e5e="autocomplete",t5e={CELL_TYPE:e5e,editor:AP,renderer:og,validator:gC},r5e="checkbox",n5e={CELL_TYPE:r5e,editor:SK,renderer:IP},i5e="date",s5e={CELL_TYPE:i5e,editor:TK,renderer:og,validator:LP},o5e="dropdown",a5e={CELL_TYPE:o5e,editor:OP,renderer:og,validator:gC},l5e="handsontable",c5e={CELL_TYPE:l5e,editor:RP,renderer:og},u5e="numeric",h5e={CELL_TYPE:u5e,editor:_K,renderer:MP,validator:FP,dataType:"number"},d5e="password",f5e={CELL_TYPE:d5e,editor:RK,renderer:PP,copyable:!1},g5e="time",m5e={CELL_TYPE:g5e,editor:AK,renderer:DP,validator:$P};function p5e(){Do(t5e),Do(n5e),Do(s5e),Do(a5e),Do(c5e),Do(h5e),Do(f5e),Do(uK),Do(m5e)}function v5e(t,e){y5e(t,e),e.add(t)}function y5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w5e(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}const _B=new Map([["plugin",AHe],["cell-type",oK],["editor",CY],["renderer",kY],["validator",IY]]),x5e="base",Uc=new WeakMap,PT=[];let Ao=null;var RB=new WeakSet;class Vt{static get PLUGIN_KEY(){return x5e}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){v5e(this,RB),gl(this,"hot",e,{writable:!1}),Uc.set(this,{hooks:{}}),Ao=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!_B.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);_B.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");PT.push(s)}}if(Ao||(Ao=OY()),Ao.indexOf("UndoRedo")>=0&&Ao.splice(Ao.indexOf("UndoRedo"),1),Ao.indexOf(this.pluginName)>=0&&Ao.splice(Ao.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ao.length===0){if(PT.length>0){const i=[`${PT.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,r){Uc.get(this).hooks[e]=Uc.get(this).hooks[e]||[];const n=Uc.get(this).hooks[e];this.hot.addHook(e,r),n.push(r),Uc.get(this).hooks[e]=n}removeHooks(e){he(Uc.get(this).hooks[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Uc.get(this).hooks;bt(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){he(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=w5e(this,RB,b5e).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),bt(this,(e,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function b5e(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}let IK=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),he(this.rows,r=>{e(r.row,Lr(r.table)-1)})}getWidths(e){this.injected||this.injectTable(),he(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(r=>{he(r.strings,n=>{e.appendChild(this.createColElement(n.col))})}),e}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{he(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const c=this.hot.getCellRenderer(l),u=r.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),o.value,l),n.appendChild(u)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{he(i.strings,s=>{const o=s.col,a=e.createElement("th");n.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),he(n,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{he(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e);a.col=e,a.row=o;const l=this.hot.getCellRenderer(a),c=r.createElement("td"),u=r.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,o,e,this.hot.colToProp(e),s.value,a),u.appendChild(c),n.appendChild(u)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){const r=this.hot.rootDocument.createElement("col");return r.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),c=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(c),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),De(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return De(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};class mC{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:mC.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n;return Qe(s,o,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Qe(r.from,r.to,a=>{const{value:l,bundleSeed:c}=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n),u=typeof c=="string"&&c.length>0;let h;u?h=c:wt(l)?h=`${Object.keys(l).length}`:Array.isArray(l)?h=`${l.length}`:h=`${Zr(l).length}`,i.has(h)||i.set(h,{needed:this.getSampleCount(),strings:[]});const d=i.get(h);d.needed&&(!(o.indexOf(l)>-1)||this.allowDuplicates||u)&&(d.strings.push({value:l,[s]:a}),o.push(l),d.needed-=1)}),i}}Ye.getSingleton().register("modifyAutoColumnSizeSeed");const Bg="autoColumnSize",S5e=10,DT=new WeakMap,C5e="autoColumnSize";class Bm extends Vt{static get PLUGIN_KEY(){return Bg}static get PLUGIN_PRIORITY(){return S5e}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),DT.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new IK(this.hot),this.samplesGenerator=new mC((r,n)=>{const i=this.hot.getCellMeta(r,n);let s="";i.spanned||(s=this.hot.getDataAtCell(r,n));let o="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(o=this.hot.runHooks("modifyAutoColumnSizeSeed",o,i,s)),{value:s,bundleSeed:o}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new Oc,this.hot.columnIndexMapper.registerMap(C5e,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>this.onBeforeColumnResize(r,n,i))}isEnabled(){return this.hot.getSettings()[Bg]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Bg];r&&r.useHeaders!==null&&r.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",r.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",n=>this.onBeforeChange(n)),this.addHook("afterFormulasValuesUpdate",n=>this.onAfterFormulasValuesUpdate(n)),this.addHook("beforeViewRender",n=>this.onBeforeViewRender(n)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>this.onBeforeColumnResize(e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const r=this.hot.renderCall,n=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();n===-1||i===-1||this.calculateColumnsWidth({from:n,to:i},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;Qe(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);if(a===null&&(a=o),n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(o,s);he(l,c=>{let[u,h]=c;return this.ghostTable.addColumn(u,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0;const n=this.hot.countCols()-1;let i=null;this.inProgress=!0;const s=()=>{if(!this.hot){_1(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Bm.CALCULATION_STEP,n)},e),r=r+Bm.CALCULATION_STEP+1,r<n?i=PN(s):(_1(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateColumnsWidth({from:0,to:o},e),this.firstCalculation=!1,r=o+1),r<n?s():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Bg],r=e&&zr(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&zr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Bg];let r=Bm.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return wt(e)&&(r=e.syncLimit,oY(r)?r=_Y(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,rv.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const r=e.wtTable.getFirstVisibleColumn();if(r!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)}if(e.wtViewport.columnsRenderCalculator){const r=e.wtTable.getFirstRenderedColumn();if(r!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const r=e.wtTable.getLastVisibleColumn();if(r!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)}if(e.wtViewport.columnsRenderCalculator){const r=e.wtTable.getLastRenderedColumn();if(r!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:r}=DT.get(this);return ai(e,(i,s,o)=>{const a=r.length;return(a-1<o||r[o]!==s)&&i.push(o),a-1<o?r.push(s):r[o]=s,i},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{he(e,r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Fs(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const r=yt(e,n=>{let[,i]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(i))});this.clearCache(Array.from(new Set(r)))}onBeforeColumnResize(e,r,n){let i=e;return n&&(this.calculateColumnsWidth(r,void 0,!0),i=this.getColumnWidth(r,void 0,!1)),i}onAfterInit(){DT.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const r=Fs(e,i=>{var s;return ze((s=i.address)===null||s===void 0?void 0:s.col)}),n=yt(r,i=>i.address.col);this.clearCache(Array.from(new Set(n)))}destroy(){this.ghostTable.clean(),super.destroy()}}const mu={horizontal:"horizontal",vertical:"vertical"};function E5e(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function T5e(t){const e={};return t===!0?(e.directions=Object.keys(mu),e.autoInsertRow=!0):wt(t)?(ze(t.autoInsertRow)?t.direction===mu.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ze(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(mu)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}Ye.getSingleton().register("modifyAutofillRange");Ye.getSingleton().register("beforeAutofill");Ye.getSingleton().register("afterAutofill");const AB="autofill",_5e=20,R5e=["fillHandle"],A5e="insert_row_below",O5e=200;class k5e extends Vt{static get PLUGIN_KEY(){return AB}static get PLUGIN_PRIORITY(){return _5e}static get SETTING_KEYS(){return[AB,...R5e]}constructor(e){super(e),this.eventManager=new $r(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,r)=>this.onBeforeCellMouseOver(r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),a=[],l=[],c=[];return he(o,u=>{for(let h=u.startRow;h<=u.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=u.startCol;h<=u.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),he(a,u=>{const h=[];he(l,d=>{h.push(this.hot.getCopyableData(u,d))}),c.push(h)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,n),Math.max(a.col,i)],l),{directionOfDrag:u,startOfDragCoords:h,endOfDragCoords:d}=E5e(l,c,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=s.clone(),g=this.hot._createCellRange(h,h,d),v=this.hot.runHooks("beforeAutofill",f,m,g,u);if(v===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=v;const b=v;if(["up","left"].indexOf(u)>-1&&!(b.length===1&&b[0].length===0))if(w=[],u==="up"){const x=d.row-h.row+1,C=x%b.length;for(let S=0;S<x;S++)w.push(b[(S+(b.length-C))%b.length])}else{const x=d.col-h.col+1,C=x%b[0].length;for(let S=0;S<b.length;S++){w.push([]);for(let E=0;E<x;E++)w[S].push(b[S][(E+(b[S].length-C))%b[S].length])}}this.hot.populateFromArray(h.row,h.col,w,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",w,m,g,u),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(mu.vertical)&&this.directions.includes(mu.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(mu.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(mu.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(A5e,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},O5e)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let l=e[1];l<=e[3];l++)if(r[s][l])return-1;const o=r[s][e[1]-1],a=r[s][e[3]+1];(o||a)&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...yt(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=an(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+Lr(this.hot.table),i=an(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+qt(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",r=>this.onMouseMove(r))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const r=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&r?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=T5e(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const Cy="autoRowSize",I5e=40,N5e="autoRowSize";class Vm extends Vt{static get PLUGIN_KEY(){return Cy}static get PLUGIN_PRIORITY(){return I5e}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new IK(this.hot),this.samplesGenerator=new mC((r,n)=>{let i;return r>=0?i=this.hot.getDataAtCell(r,n):r===-1&&(i=this.hot.getColHeader(n)),{value:i}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new Oc,this.hot.rowIndexMapper.registerMap(N5e,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>this.onBeforeRowResize(r,n,i))}isEnabled(){const e=this.hot.getSettings()[Cy];return e===!0||wt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",r=>this.onBeforeChange(r)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",r=>this.onBeforeViewRender(r)),this.addHook("modifyRowHeight",(r,n)=>this.getRowHeight(n,r)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>this.onBeforeRowResize(e,r,n))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Qe(i.from,i.to,o=>{if(n||this.rowHeightsMap.getValueAtIndex(o)===null){const a=this.samplesGenerator.generateRowSamples(o,s);he(a,l=>{let[c,u]=l;return this.ghostTable.addRow(c,u)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0;const n=this.hot.countRows()-1;let i=null;this.inProgress=!0;const s=()=>{if(!this.hot){_1(i),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Vm.CALCULATION_STEP,n)},e),r=r+Vm.CALCULATION_STEP+1,r<n?i=PN(s):(_1(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateRowsHeight({from:0,to:o},e),this.firstCalculation=!1,r=o+1),r<n?s():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Cy],r=e&&zr(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&zr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){o0(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Cy];let r=Vm.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return wt(e)&&(r=e.syncLimit,oY(r)?r=_Y(n,r):r>>=0),Math.min(r,n)}getRowHeight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Qe(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!Fs(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,r=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),i=this.getLastVisibleRow();if(!(n===-1||i===-1)){if(this.calculateRowsHeight({from:n,to:i},void 0,e),r){const s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-r,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,r){this.clearCacheByRange({from:e,to:r}),this.calculateAllRowsHeight()}onBeforeRowResize(e,r,n){let i=e;return n&&(this.calculateRowsHeight(r,void 0,!0),i=this.getRowHeight(r)),i}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let r=null;e.length===1?r=e[0][0]:e.length>1&&(r={from:e[0][0],to:e[e.length-1][0]}),r!==null&&this.clearCacheByRange(r)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:M5e,getListWithRemovedItems:P5e}=WY("physicallyIndexed");class D5e extends ch{constructor(){super(e=>e)}insert(e,r){const n=JN(this.indexedValues,r);this.indexedValues=M5e(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=P5e(this.indexedValues,e);this.indexedValues=qN(r,e),super.remove(e)}}const{getListWithInsertedItems:L5e,getListWithRemovedItems:F5e}=WY("physicallyIndexed");class $5e extends ch{constructor(){super(e=>e)}insert(e,r){this.indexedValues=L5e(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=F5e(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const LT="bindRowsWithHeaders",H5e=210,j5e="loose",B5e=new Map([["loose",D5e],["strict",$5e]]);class V5e extends Vt{static get PLUGIN_KEY(){return LT}static get PLUGIN_PRIORITY(){return H5e}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[LT]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[LT];typeof e!="string"&&(e=j5e);const r=B5e.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>this.onModifyRowHeader(n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function U5e(t,e,r){W5e(t,e),e.set(t,r)}function W5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FT(t,e,r){return e=z5e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z5e(t){var e=G5e(t,"string");return typeof e=="symbol"?e:String(e)}function G5e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OB(t,e){var r=NK(t,e,"get");return Y5e(t,r)}function Y5e(t,e){return e.get?e.get.call(t):e.value}function $T(t,e,r){var n=NK(t,e,"set");return K5e(t,n,r),r}function NK(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function K5e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}const HT="collapsibleColumns",X5e=290,q5e=["nestedHeaders"],kh="collapsibleIndicator",kB=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ih=new WeakMap;class J5e extends Vt{constructor(){super(...arguments),FT(this,"nestedHeadersPlugin",null),FT(this,"eventManager",new $r(this)),FT(this,"headerStateManager",null),U5e(this,Ih,{writable:!0,value:null})}static get PLUGIN_KEY(){return HT}static get PLUGIN_PRIORITY(){return X5e}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[HT,...q5e]}isEnabled(){return!!this.hot.getSettings()[HT]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||lr("You need to configure the Nested Headers plugin in order to use collapsible headers."),$T(this,Ih,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>this.onBeforeOnCellMouseDown(n,i,s)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),$T(this,Ih,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Qe(0,e-1,o=>{const a=r.childNodes[o],l=n.childNodes[o],c=i?i.childNodes[o]:null;Qe(0,a.childNodes.length-1,u=>{let h=a.childNodes[u].querySelector(`.${kh}`);s(h),l&&l.childNodes[u]&&(h=l.childNodes[u].querySelector(`.${kh}`),s(h)),i&&c&&c.childNodes[u]&&(h=c.childNodes[u].querySelector(`.${kh}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=n;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!kB.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=Fs(e,d=>{let{row:f}=d;return f<0});let i=n.length>0;he(n,d=>{var f;let{row:m,col:g}=d;const{collapsible:v,isCollapsed:w}=(f=this.headerStateManager.getHeaderSettings(m,g))!==null&&f!==void 0?f:{};if(!v||w&&r==="collapse"||!w&&r==="expand")return i=!1,!1});const s=[],o=[];i&&he(n,d=>{let{row:f,col:m}=d;const{colspanCompensation:g,affectedColumns:v,rollbackModification:w}=this.headerStateManager.triggerNodeModification(r,f,m);g>0&&(o.push(...v),s.push(w))});const a=this.getCollapsedColumns();let l=[];r==="collapse"?l=iY([...a,...o]):r==="expand"&&(l=Fs(a,d=>!o.includes(d)));const c=kB.get(r);if(this.hot.runHooks(c.beforeHook,a,l,i)===!1){he(s,d=>{d()});return}this.hot.batchExecution(()=>{he(o,d=>{OB(this,Ih).setValueAtIndex(this.hot.toPhysicalColumn(d),c.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(c.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return OB(this,Ih).getHiddenIndexes()}onAfterGetColHeader(e,r,n){var i;const{collapsible:s,origColspan:o,isCollapsed:a}=(i=this.headerStateManager.getHeaderSettings(n,e))!==null&&i!==void 0?i:{},l=s&&o>1&&e>=this.hot.getSettings().fixedColumnsStart;let c=r.querySelector(`.${kh}`);if(l)c||(c=this.hot.rootDocument.createElement("div"),De(c,kh),r.querySelector("div:first-child").appendChild(c)),ct(c,["collapsed","expanded"]),a?(De(c,"collapsed"),ju(c,"+")):(De(c,"expanded"),ju(c,"-"));else{var u;(u=c)===null||u===void 0||u.remove()}}onBeforeOnCellMouseDown(e,r){lt(e.target,kh)&&(lt(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([r],"collapse")):lt(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([r],"expand")),ra(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,r){r||this.updatePlugin()}destroy(){$T(this,Ih,null),super.destroy()}}const Z5e=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Q5e=!1,e8e=!0,t8e=!0;class r8e{constructor(e,r){this.hot=e,this.sortingStates=new qS,this.sortEmptyCells=Q5e,this.indicator=e8e,this.headerAction=t8e,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){wt(e)&&bt(e,(r,n)=>{Z5e.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return wt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(ze(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const N1="asc",M1="desc",n8e="colHeader";function i8e(t){if(wt(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[N1,M1].includes(r)}function s8e(t){if(t.some(r=>i8e(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function IB(t){if(t!==M1)return t===N1?M1:N1}function NB(t){return t.querySelector(`.${n8e}`)}function MB(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function sk(t,e,r){return t===-1&&e>=0&&Vu(r)===!1}const o8e="ascending",a8e="descending",MK="indicatorDisabled",PK="columnSorting",DK="sortAction",LK=new Map([[N1,o8e],[M1,a8e]]);function l8e(t,e,r,n){const i=[PK];if(n&&i.push(DK),r===!1)return i.push(MK),i;const s=t.getSortOrderOfColumn(e);return ze(s)&&i.push(LK.get(s)),i}function c8e(){return Array.from(LK.values()).concat(DK,MK,PK)}function FK(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:o}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?Jo:yn(i)?yn(s)?Jo:o&&t==="asc"?Mr:Pr:yn(s)?o&&t==="asc"?Pr:Mr:isNaN(i)&&!isNaN(s)?t==="asc"?Pr:Mr:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?Mr:Pr:i>s?t==="asc"?Pr:Mr:Jo}}const $K="default";function u8e(t,e,r){return function(n,i){const s=parseFloat(n),o=parseFloat(i),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return Jo;if(a){if(yn(n))return t==="asc"?Mr:Pr;if(yn(i))return t==="asc"?Pr:Mr}return isNaN(s)?Pr:isNaN(o)?Mr:s<o?t==="asc"?Mr:Pr:s>o?t==="asc"?Pr:Mr:Jo}}const h8e="numeric";function d8e(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const l=yn(o),c=yn(a),u=l?i:o,h=c?i:a,d=u===i||u===n,f=h===i||h===n;if(s===!1){if(l&&c===!1)return Pr;if(l===!1&&c)return Mr}return d===!1&&f?t==="asc"?Mr:Pr:d&&f===!1?t==="asc"?Pr:Mr:d===!1&&f===!1?FK(t,e,r)(o,a):u===i&&h===n?t==="asc"?Mr:Pr:u===n&&h===i?t==="asc"?Pr:Mr:Jo}}const f8e="checkbox";function g8e(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return Jo;if(yn(n))return yn(i)?Jo:s&&t==="asc"?Mr:Pr;if(yn(i))return s&&t==="asc"?Pr:Mr;const o=e.dateFormat,a=Me(n,o),l=Me(i,o);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?Mr:Pr:l.isBefore(a)?t==="asc"?Pr:Mr:Jo:Mr:Pr}}const m8e="date",{register:pC,getItem:PB,hasItem:p8e}=Ws("sorting.compareFunctionFactory"),{register:HK,getItem:v8e}=Ws("sorting.mainSortComparator");function jK(t){return p8e(t)?PB(t):PB($K)}pC(h8e,u8e);pC(f8e,d8e);pC(m8e,g8e);pC($K,FK);const Jo=0,Mr=-1,Pr=1;function y8e(t,e){const r=v8e(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}function w8e(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(a){const l=t[a],c=e[a],u=i[a],h=s[a],d=c.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:jK(c.type))(l,c,d)(u,h)}(0)}}const ok="columnSorting",x8e=50,DB="append",b8e="replace";HK(ok,w8e);Ye.getSingleton().register("beforeColumnSort");Ye.getSingleton().register("afterColumnSort");class BK extends Vt{static get PLUGIN_KEY(){return ok}static get PLUGIN_PRIORITY(){return x8e}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=ok,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new r8e(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Oc(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>this.onAfterGetColHeader(r,n)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=NB(n);MB(r,n)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new zY),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ze(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return s8e(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=yt(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return ze(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=yt(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(ze(r)){const i=IB(r);return ze(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:IB()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DB;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(ur(o))return[...s.slice(0,n),...s.slice(n+1)];if(r===DB)return[...s.slice(0,n),...s.slice(n+1),o];if(r===b8e)return[...s.slice(0,n),o,...s.slice(n+1)]}return ze(o)?s.concat(o):s}getPluginColumnConfig(e){if(wt(e)){const r=e[this.pluginKey];if(wt(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):ar(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const r=[],n=this.hot.countRows(),i=c=>yt(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)r.push([this.hot.toPhysicalRow(c)].concat(i(c)));const s=yt(r,c=>c[0]);y8e(r,this.pluginKey,yt(e,c=>c.sortOrder),yt(e,c=>this.getFirstCellSettings(c.column)));for(let c=r.length;c<n;c+=1)r.push([c].concat(i(c)));const o=yt(r,c=>c[0]),a=new Map(yt(s,(c,u)=>[c,o[u]])),l=yt(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(wt(e))this.sortBySettings(e);else{const r=this.hot.getSettings()[this.pluginKey];this.sortBySettings(r)}}sortBySettings(e){if(wt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||wt(r))&&this.sort(r)}else this.hot.render()}onAfterGetColHeader(e,r){const n=NB(r);if(MB(e,r)===!1||n===null)return;const i=this.getFirstCellSettings(e)[this.pluginKey],s=i.indicator,o=i.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,s,o)}updateHeaderClasses(e){if(ct(e,c8e()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];De(e,l8e(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ze(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,r,n,i){sk(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}onAfterOnCellMouseDown(e,r){sk(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col)),this.sort(this.getColumnNextConfig(r.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class S8e{constructor(e,r){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),he(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();he(s,o=>{i==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=n:e==="remove_row"&&(o.alterRowOffset=-1*n)),i==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=n:e==="remove_col"&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,h=r;he(c,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*n),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*n)}),this.resetAllEndpoints(c,!u),u?he(c,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):he(c,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){he(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];he(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),he(i,s=>{let o=[];he(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),n.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),n.push(o))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,he(e.ranges,n=>{he(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],he(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],he(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],he(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&he(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),he(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){lr("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function jT(t){return t==null||isNaN(t)}const BT="columnSummary",C8e=220;class E8e extends Vt{static get PLUGIN_KEY(){return BT}static get PLUGIN_PRIORITY(){return C8e}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[BT]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[BT],this.endpoints=new S8e(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return bt(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,r),s=jT(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,r){let n=null;return bt(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=jT(o)?null:o,i===null)i=o;else if(o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=jT(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return bt(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(n!==null&&i!==null&&(o=this.hot.getCellMeta(n,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Jt`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,r){e&&r!=="ColumnSummary.reset"&&r!=="ColumnSummary.set"&&r!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,r){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",r,e.length,e,this.pluginName)}}class md{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r){this.rootDocument=e,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,r){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:qt(this.getInputElement()),height:Lr(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),r=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),De(this.container,md.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),De(e,md.CLASS_EDITOR),De(r,md.CLASS_INPUT),e.appendChild(r),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${md.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const vt="---------";function T8e(){return{name:vt}}function _8e(t){return yt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Ey(t){return lt(t,"htSeparator")}function R8e(t){return lt(t,"htSubmenu")}function Ty(t){return lt(t,"htDisabled")}function _y(t){return lt(t,"htSelectionDisabled")}function hh(t){const e=t.getSelected();return!e||e[0]<0?null:e}function A8e(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function O8e(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Wc(t,e){const r={};return he(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function Il(t,e,r,n,i){he(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&k8e(o,a,e,r,n,i)})})}function k8e(t,e,r,n,i,s){const o=i(t,e);let a=n;o.className&&(r==="vertical"?a=A8e(o.className,n):a=O8e(o.className,n)),s(t,e,"className",a)}function Ho(t,e){let r=!1;return Array.isArray(t)&&he(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function Aa(t){return`<span class="selected"></span>${t}`}function I8e(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function VK(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function N8e(t,e){let r=t.slice(0);return r.reverse(),r=VK(r,e),r.reverse(),r}function M8e(t){const e=[];return he(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function P8e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vt,r=t.slice(0);return r=VK(r,e),r=N8e(r,e),r=M8e(r),r}const D8e=250,L8e=250;class UK{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},L8e)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:D8e;this.showDebounced=dY(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}tr(UK,Ri);const VT="comments",F8e=60,Ry=new WeakMap,Oo="comment",Nh="value",LB="style",Ay="readOnly";class $8e extends Vt{static get PLUGIN_KEY(){return VT}static get PLUGIN_PRIORITY(){return F8e}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Ry.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[VT]}enablePlugin(){this.enabled||(this.editor||(this.editor=new md(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new $r(this)),this.displaySwitch||(this.displaySwitch=new UK(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,r,n,i,s,o)=>this.onAfterRenderer(e,o)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,r)=>this.showAtCell(e,r)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(e,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",r=>this.onEditorMouseDown(r)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",r=>this.onEditorMouseUp(r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=_u(e.target,"TD","TBODY");return!!(r&&lt(r,"htCommentCell")&&_u(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=this.editor.getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Nh]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Oo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,Nh)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,Nh)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:r}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(n[Oo]?n[Oo][Nh]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,r;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!this.editor.isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),c=s.getRenderableFromVisualIndex(a);const u=l===null;this.editor.setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),c===null&&(c=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=c===null;l=(e=l)!==null&&e!==void 0?e:0,c=(r=c)!==null&&r!==void 0?r:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:g}=m,v=m.getCell({row:l,col:c},!0),w=this.getCommentMeta(o,a,LB);w?this.editor.setSize(w.width,w.height):this.editor.resetSize();const b=d?0:g.getStretchedColumnWidth(c),x=u&&!h?Lr(v):0,{left:C,top:S,width:E,height:T}=v.getBoundingClientRect(),{width:I,height:k}=this.editor.getSize(),{innerWidth:M,innerHeight:D}=this.hot.rootWindow,L=this.hot.rootDocument.documentElement;let U=C+f.scrollX+b,J=S+f.scrollY+x;this.hot.isRtl()&&(U-=I+b),this.hot.isLtr()&&C+E+I>M?U=C+f.scrollX-I-1:this.hot.isRtl()&&U<-(L.scrollWidth-L.clientWidth)&&(U=C+f.scrollX+b+1),S+k>D&&(J-=k-T+1),this.editor.setPosition(U,J),this.editor.setReadOnlyState(this.getCommentMeta(o,a,Ay))}checkSelectionCommentsConsistency(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;let r=!1;const n=e.getTopStartCorner();return this.getCommentMeta(n.row,n.col,Nh)&&(r=!0),r}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[Oo];let s;i?(s=Si(i),US(s,n)):s=n,this.hot.setCellMeta(e,r,Oo,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[Oo])return i[Oo][n]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){const r=_u(e.target,"TD","TBODY");let n=null;r&&(n=this.hot.getCoords(r)),(!r||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}onMouseOver(e){const r=Ry.get(this),{rootDocument:n}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||lt(e.target,"wtBorder")||r.cellBelowCursor===e.target||!this.editor))if(r.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){const i=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(i)}else Ru(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,r){r[Oo]&&r[Oo][Nh]&&De(e,r.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){const r=Ry.get(this);r.tempEditorDimensions={width:qt(e.target),height:Lr(e.target)}}onEditorMouseUp(e){const r=Ry.get(this),n=qt(e.target),i=Lr(e.target);(n!==r.tempEditorDimensions.width+1||i!==r.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[LB]:{width:n,height:i}})}onContextMenuAddComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((r,n)=>{r>=0&&n>=0&&this.removeCommentAtCell(r,n,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((r,n)=>{if(r>=0&&n>=0){const i=!!this.getCommentMeta(r,n,Ay);this.updateCommentMeta(r,n,{[Ay]:!i})}})}addToContextMenu(e){const r=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(xM):this.hot.getTranslatedPhrase(wM),callback:()=>this.onContextMenuAddComment(),disabled:()=>r()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsRemove",name(){return this.getTranslatedPhrase(bM)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>r()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsReadOnly",name(){let n=this.getTranslatedPhrase(SM);return Ho(this.getSelectedRangeLast(),(s,o)=>{let a=this.getCellMeta(s,o)[Oo];if(a&&(a=a[Ay]),a)return!0})&&(n=Aa(n)),n},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>r()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency():!0})}getDisplayDelaySetting(){const e=this.hot.getSettings()[VT];if(wt(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}var FB=I9,H8e=TypeError,j8e=function(t,e){if(!delete t[e])throw new H8e("Cannot delete property "+FB(e)+" of "+FB(t))},B8e=sh,V8e=ES,U8e=RS,W8e=K9,z8e=j8e,G8e=X9,Y8e=[].unshift(0)!==1,K8e=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},X8e=Y8e||!K8e();B8e({target:"Array",proto:!0,arity:1,forced:X8e},{unshift:function(e){var r=V8e(this),n=U8e(r),i=arguments.length;if(i){G8e(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:z8e(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return W8e(r,n+i)}});class WK{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=q8e(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||zr(l,"submenu"))return;const c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(s.join(":")),he(c,u=>u.apply(this.hot,n))}}function q8e(t,e){let r;return he(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}const Cs="alignment";function J8e(){return{key:Cs,name(){return this.getTranslatedPhrase(CM)},disabled(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Cs}:left`,name(){let t=this.getTranslatedPhrase(EM);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Cs}:center`,name(){let t=this.getTranslatedPhrase(TM);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Cs}:right`,name(){let t=this.getTranslatedPhrase(_M);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Cs}:justify`,name(){let t=this.getTranslatedPhrase(RM);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:vt},{key:`${Cs}:top`,name(){let t=this.getTranslatedPhrase(AM);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Cs}:middle`,name(){let t=this.getTranslatedPhrase(OM);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Cs}:bottom`,name(){let t=this.getTranslatedPhrase(kM);return Ho(this.getSelectedRange(),(r,n)=>{const i=this.getCellMeta(r,n).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Wc(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Il(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const vC="clear_column";function Z8e(){return{key:vC,name(){return this.getTranslatedPhrase(cM)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){return hh(this)?!this.selection.isSelectedByColumnHeader():!0}}}const cv="col_left";function Q8e(){return{key:cv,name(){return this.getTranslatedPhrase(rM)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!hh(this)?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const uv="col_right";function eVe(){return{key:uv,name(){return this.getTranslatedPhrase(nM)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!hh(this)?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const hv="make_read_only";function tVe(){return{key:hv,name(){let t=this.getTranslatedPhrase(lM);return Ho(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Aa(t)),t},callback(){const t=this.getSelectedRange(),e=Ho(t,(r,n)=>this.getCellMeta(r,n).readOnly);he(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const yC="redo";function rVe(){return{key:yC,name(){return this.getTranslatedPhrase(aM)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const dv="remove_col";function nVe(){return{key:dv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(sM,e)},callback(){this.alter("remove_col",N3e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed()||!hh(this))return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const wC="remove_row";function iVe(){return{key:wC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(iM,e)},callback(){this.alter("remove_row",M3e(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!hh(this))return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const xC="row_above";function sVe(){return{key:xC,name(){return this.getTranslatedPhrase(eM)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){return hh(this)?this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const bC="row_below";function oVe(){return{key:bC,name(){return this.getTranslatedPhrase(tM)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){return hh(this)?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const v0="no_items";function aVe(){return{key:v0,name(){return this.getTranslatedPhrase(QN)},disabled:!0,isCommand:!1}}const SC="undo";function lVe(){return{key:SC,name(){return this.getTranslatedPhrase(oM)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const cVe=[xC,bC,cv,uv,vC,wC,dv,SC,yC,hv,Cs,vt,v0],uVe={[vt]:T8e,[v0]:aVe,[xC]:sVe,[bC]:oVe,[cv]:Q8e,[uv]:eVe,[vC]:Z8e,[wC]:iVe,[dv]:nVe,[SC]:lVe,[yC]:rVe,[hv]:tVe,[Cs]:J8e};function zK(){const t={};return bt(uVe,(e,r)=>{t[r]=e()}),t}class GK{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=zK(),this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,bt(e,(n,i)=>{let s="";n.name===vt?(r[vt]=n,s=vt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return hVe(e,this.defaultOrderPattern,this.predefinedItems)}}function hVe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),wt(i)?bt(i,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),wt(s)?cn(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),n.push(a)}):he(i,(s,o)=>{let a=r[s];!a&&cVe.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),wt(s)&&cn(a,s),a.key===void 0&&(a.key=o),n.push(a))}),n}class dVe{constructor(e,r){const n=a0(r),i=wf(r);let s,o,a,l,c,u;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,o=s,l=a,s+=n,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,o=s-n,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}const $B=215,YK="menu",fVe=YK;class ag{constructor(e,r){this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:$B,container:this.hot.rootDocument.documentElement},this.eventManager=new $r(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=S1(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=r}isSubMenu(){return this.parentMenu!==null}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const r=dY(d=>this.openSubMenu(d),300),n=this.options.minWidth||$B;let i=!1,s=Fs(this.menuItems,d=>(d.key===v0&&(i=!0),I8e(d,this.hot)));if(s.length<1&&!i)s.push(zK()[v0]);else if(s.length===0)return;s=P8e(s,vt);let o=!1;const a={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(d){return ze(d)&&d<n?n:d},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(d,f,m,g,v,w)=>this.menuItemRenderer(d,f,m,g,v,w)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(d,f)=>{this.isAllSubMenusClosed()?r(f.row):this.openSubMenu(f.row)},rowHeights:d=>s[d].name===vt?1:23,afterOnCellContextMenu:d=>{d.preventDefault(),N3()&&o&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:d=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(d))},afterOnCellMouseUp:d=>{(!N3()||!Vu(d))&&o&&this.hasSelectedItem()&&(Go()||xY()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new SP(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen();const l=this.hotMenu.getShortcutManager(),c=l.addContext(fVe),h={...{group:YK},runOnlyIf:d=>T1(d.target)===!1||this.container.contains(d.target)===!1};l.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.selectNextCell(d[0],d[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.selectPrevCell(d[0],d[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const d=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,d){const f=this.openSubMenu(d[0]);f&&f.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:d=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(f[0]).submenu||(this.executeCommand(d),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!R8e(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new ag(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];n&&(n.destroy(),delete this.hotSubMenus[r.key])}closeAllSubMenus(){he(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?_8e(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){const{isCommand:r,name:n,disabled:i,submenu:s}=e,o=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return r===!1||n===vt||o===!0||s}setPosition(e){const r=new dVe(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(r.fitsBelow(this.container)?this.setPositionBelowCursor(r):r.fitsAbove(this.container)?this.setPositionAboveCursor(r):this.setPositionBelowCursor(r),this.hot.isLtr()?this.setHorizontalPositionForLtr(r):this.setHorizontalPositionForRtl(r)):(this.setPositionBelowCursor(r),this.setPositionOnRightOfCursor(r))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let r=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(r=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${r}px`}setPositionBelowCursor(e){let r=this.offset.below+e.top+1;this.isSubMenu()&&(r=e.top-1),this.container.style.top=`${r}px`}setPositionOnRightOfCursor(e){let r=e.left;if(this.isSubMenu()){const{right:n}=this.parentMenu.container.getBoundingClientRect();r+=e.cellWidth+n-(e.left+e.cellWidth)}else r+=this.offset.right;this.container.style.left=`${r}px`}setPositionOnLeftOfCursor(e){let r=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:n}=this.parentMenu.container.getBoundingClientRect();r-=e.left-n}this.container.style.left=`${r}px`}selectFirstCell(){const e=this.hotMenu.getCell(0,0);Ey(e)||Ty(e)||_y(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const e=this.hotMenu.countRows()-1,r=this.hotMenu.getCell(e,0);Ey(r)||Ty(r)||_y(r)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,r){const n=e+1,i=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,r):null;i&&(Ey(i)||Ty(i)||_y(i)?this.selectNextCell(n,r):this.hotMenu.selectCell(n,r))}selectPrevCell(e,r){const n=e-1,i=n>=0?this.hotMenu.getCell(n,r):null;i&&(Ey(i)||Ty(i)||_y(i)?this.selectPrevCell(n,r):this.hotMenu.selectCell(n,r))}menuItemRenderer(e,r,n,i,s,o){const a=e.getSourceDataAtRow(n),l=this.hot.rootDocument.createElement("div"),c=m=>zr(m,"submenu"),u=m=>new RegExp(vt,"i").test(m.name),h=m=>m.disabled===!0||typeof m.disabled=="function"&&m.disabled.call(this.hot)===!0,d=m=>m.disableSelection;let f=o;typeof f=="function"&&(f=f.call(this.hot)),ta(r),De(l,"htItemWrapper"),r.appendChild(l),u(a)?De(r,"htSeparator"):typeof a.renderer=="function"?(De(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,s,f))):tg(l,f),h(a)?(De(r,"htDisabled"),this.eventManager.addEventListener(r,"mouseenter",()=>e.deselectCell())):d(a)?(De(r,"htSelectionDisabled"),this.eventManager.addEventListener(r,"mouseenter",()=>e.deselectCell())):c(a)?(De(r,"htSubmenu"),d(a)?this.eventManager.addEventListener(r,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(r,"mouseenter",()=>e.selectCell(n,i,void 0,void 0,!1,!1))):(ct(r,["htSubmenu","htDisabled"]),d(a)?this.eventManager.addEventListener(r,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(r,"mouseenter",()=>e.selectCell(n,i,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(ar(n)&&(n=n.call(this.hot),n===null||ur(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),De(i,`htMenu ${this.options.className}`),n&&De(i,n),this.options.container.appendChild(i)),i}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),o=ai(r,(a,l)=>a+(l.name===vt?1:26),0);i.width=`${s+3}px`,i.height=`${o+3}px`,n.height=i.height}onAfterSelection(e,r,n,i,s){this.keyEvent===!1&&(s.value=!0)}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ru(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ru(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&lt(e.target,"htCore")&&Ru(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}tr(ag,Ri);const Oy="contextMenu",gVe=70;Ye.getSingleton().register("afterContextMenuDefaultOptions");Ye.getSingleton().register("beforeContextMenuShow");Ye.getSingleton().register("afterContextMenuShow");Ye.getSingleton().register("afterContextMenuHide");Ye.getSingleton().register("afterContextMenuExecute");class CC extends Vt{static get PLUGIN_KEY(){return Oy}static get PLUGIN_PRIORITY(){return gVe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[xC,bC,vt,cv,uv,vt,wC,dv,vt,SC,yC,vt,hv,vt,Cs]}constructor(e){super(e),this.eventManager=new $r(this),this.commandExecutor=new WK(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[Oy]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Oy];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new ag(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>this.onAfterOnCellContextMenu(n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu||(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened()))return;let r=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:i}=this.hot.rootWindow,{top:s,left:o}=i.getBoundingClientRect();r=s-a0(e.view),n=o-wf(e.view)}else r=-1*a0(this.menu.hotMenu.rootWindow),n=-1*wf(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+r,left:parseInt(e.pageX,10)+n})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new GK(this.hot,CC.DEFAULT_ITEMS);const e=this.hot.getSettings()[Oy],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),he(n,i=>this.commandExecutor.registerCommand(i.key,i))}onAfterOnCellContextMenu(e){const r=this.hot.getSettings(),n=r.rowHeaders,i=r.colHeaders;function s(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=e.target;this.close(),!lt(o,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),!(!(n||i)&&!s(o)&&!(lt(o,"current")&&lt(o,"wtBorder")))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}CC.SEPARATOR={name:vt};function mVe(t){return{key:"copy",name(){return this.getTranslatedPhrase(uM)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function pVe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(fM,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function vVe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(dM,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function yVe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(hM,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function wVe(t){return{key:"cut",name(){return this.getTranslatedPhrase(gM)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}class xVe{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class bVe{constructor(){this.clipboardData=new xVe}}class HP{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new $r(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){const e=EVe(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),HB(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),HB(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",Go()||L$e(this.mainElement)}}tr(HP,Ri);const P1=new WeakMap;function SVe(t){const e=new HP(t);let r=P1.get(t);return r=isNaN(r)?0:r,P1.set(t,r+1),e}function CVe(t){t.eventManager.clear()}const UT=(t,e)=>r=>e.runLocalHooks(t,r);function HB(t,e,r){t.addEventListener(e,"copy",UT("copy",r)),t.addEventListener(e,"cut",UT("cut",r)),t.addEventListener(e,"paste",UT("paste",r))}const D1=new WeakMap;function EVe(t){const e=D1.get(t);if(e)return e.parentElement||t.appendChild(e),e;const n=(t.defaultView?t:t.ownerDocument).createElement("textarea");return D1.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function jB(t){if(!(t instanceof HP))return;let e=P1.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),CVe(t),e<=0){e=0;const r=D1.get(t.container);r&&r.parentNode&&(r.parentNode.removeChild(r),D1.delete(t.container)),t.mainElement=null}P1.set(t.container,e)}function BB(t,e){KK(t,e),e.add(t)}function Mh(t,e,r){KK(t,e),e.set(t,r)}function KK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ky(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function hi(t,e){var r=XK(t,e,"get");return TVe(t,r)}function TVe(t,e){return e.get?e.get.call(t):e.value}function Ph(t,e,r){var n=XK(t,e,"set");return _Ve(t,n,r),r}function XK(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function _Ve(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Cl=new WeakMap,WT=new WeakMap,Vg=new WeakMap,ak=new WeakMap,lk=new WeakMap,Ug=new WeakMap,Iy=new WeakSet,VB=new WeakSet;class RVe{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;BB(this,VB),BB(this,Iy),Mh(this,Cl,{writable:!0,value:void 0}),Mh(this,WT,{writable:!0,value:void 0}),Mh(this,Vg,{writable:!0,value:void 0}),Mh(this,ak,{writable:!0,value:void 0}),Mh(this,lk,{writable:!0,value:void 0}),Mh(this,Ug,{writable:!0,value:void 0}),Ph(this,WT,r),Ph(this,Vg,n),Ph(this,ak,i),Ph(this,lk,s),Ph(this,Ug,o)}setSelectedRange(e){Ph(this,Cl,e)}getCellsRange(){if(hi(this,WT).call(this)===0||hi(this,Vg).call(this)===0)return null;const{row:e,col:r}=hi(this,Cl).getTopStartCorner(),{row:n,col:i}=hi(this,Cl).getBottomEndCorner(),s=ky(this,VB,AVe).call(this,e,n),o=ky(this,Iy,zT).call(this,r,i);return{isRangeTrimmed:n!==s||i!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(hi(this,Vg).call(this)===0||hi(this,Ug).call(this)===0)return null;const{col:e}=hi(this,Cl).getTopStartCorner(),{col:r}=hi(this,Cl).getBottomEndCorner(),n=ky(this,Iy,zT).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(hi(this,Vg).call(this)===0||hi(this,Ug).call(this)===0)return null;const{col:e}=hi(this,Cl).getTopStartCorner(),{col:r}=hi(this,Cl).getBottomEndCorner(),n=ky(this,Iy,zT).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-hi(this,Ug).call(this),startCol:e,endRow:-1,endCol:n}}}function zT(t,e){return Math.min(e,Math.max(t+hi(this,lk).call(this)-1,t))}function AVe(t,e){return Math.min(e,Math.max(t+hi(this,ak).call(this)-1,t))}function qK(t){const e=[],r=[];return he(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);Qe(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Qe(o,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function OVe(t,e){JK(t,e),e.add(t)}function zc(t,e,r){JK(t,e),e.set(t,r)}function JK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dh(t,e,r){return e=kVe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kVe(t){var e=IVe(t,"string");return typeof e=="symbol"?e:String(e)}function IVe(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NVe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function Bi(t,e){var r=ZK(t,e,"get");return MVe(t,r)}function MVe(t,e){return e.get?e.get.call(t):e.value}function ya(t,e,r){var n=ZK(t,e,"set");return PVe(t,n,r),r}function ZK(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function PVe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ye.getSingleton().register("afterCopyLimit");Ye.getSingleton().register("modifyCopyableRange");Ye.getSingleton().register("beforeCut");Ye.getSingleton().register("afterCut");Ye.getSingleton().register("beforePaste");Ye.getSingleton().register("afterPaste");Ye.getSingleton().register("beforeCopy");Ye.getSingleton().register("afterCopy");const Ny="copyPaste",DVe=80,LVe=["fragmentSelection"],UB=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var GT=new WeakMap,YT=new WeakMap,KT=new WeakMap,Lh=new WeakMap,My=new WeakMap,Py=new WeakMap,Fh=new WeakMap,WB=new WeakSet;class FVe extends Vt{constructor(){super(...arguments),OVe(this,WB),Dh(this,"columnsLimit",1/0),Dh(this,"rowsLimit",1/0),Dh(this,"pasteMode","overwrite"),Dh(this,"uiContainer",this.hot.rootDocument.body),zc(this,GT,{writable:!0,value:!1}),zc(this,YT,{writable:!0,value:!1}),zc(this,KT,{writable:!0,value:!1}),zc(this,Lh,{writable:!0,value:"cells-only"}),zc(this,My,{writable:!0,value:!1}),zc(this,Py,{writable:!0,value:!1}),zc(this,Fh,{writable:!0,value:new RVe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Dh(this,"copyableRanges",[]),Dh(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return Ny}static get SETTING_KEYS(){return[Ny,...LVe]}static get PLUGIN_PRIORITY(){return DVe}isEnabled(){return!!this.hot.getSettings()[Ny]}enablePlugin(){if(this.enabled)return;const{[Ny]:e}=this.hot.getSettings();if(typeof e=="object"){var r,n;this.pasteMode=(r=e.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,ya(this,GT,!!e.copyColumnHeaders),ya(this,YT,!!e.copyColumnGroupHeaders),ya(this,KT,!!e.copyColumnHeadersOnly),this.uiContainer=(n=e.uiContainer)!==null&&n!==void 0?n:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",i=>this.onAfterContextMenuDefaultOptions(i)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=SVe(this.uiContainer),this.focusableElement.addLocalHook("copy",i=>this.onCopy(i)).addLocalHook("cut",i=>this.onCut(i)).addLocalHook("paste",i=>this.onPaste(i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&jB(this.focusableElement),super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ya(this,Lh,e),ya(this,My,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ya(this,Py,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return jm(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=qK(e);return he(n,s=>{const o=[];he(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new bVe;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.getOrCreateFocusableElement(),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;Bi(this,Fh).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Bi(this,Lh)==="column-headers-only"?r.set("headers",Bi(this,Fh).getMostBottomColumnHeadersRange()):(Bi(this,Lh)==="with-column-headers"?r.set("headers",Bi(this,Fh).getMostBottomColumnHeadersRange()):Bi(this,Lh)==="with-column-group-headers"&&r.set("headers",Bi(this,Fh).getAllColumnHeadersRange()),r.set("cells",Bi(this,Fh).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=n;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;const r=(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA;r?this.focusableElement.setFocusableElement(r):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:o,col:a}=r.getTopStartCorner(),{row:l,col:c}=r.getBottomEndCorner();let u=o,h=a,d=o,f=a;for(;s.length<n||u<=l;){const{skipRowOnPaste:m,visualRow:g}=this.hot.getCellMeta(u,a);if(u=g+1,m===!0)continue;d=g,h=a;const v=[],w=s.length%n;for(;v.length<i||h<=c;){const{skipColumnOnPaste:b,visualCol:x}=this.hot.getCellMeta(o,h);if(h=x+1,b===!0)continue;f=x;const C=v.length%i;v.push(e[w][C])}s.push(v)}return this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){if(!this.hot.isListening()&&!Bi(this,My)||this.isEditorOpened())return;this.setCopyableText(),ya(this,My,!1);const r=this.getRangedData(this.copyableRanges),n=NVe(this,WB,$Ve).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",r,this.copyableRanges,n)){const s=jm(r);if(e&&e.clipboardData){const o=F3(r,this.hot.rootDocument);e.clipboardData.setData("text/plain",s),e.clipboardData.setData("text/html",[UB,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",r,this.copyableRanges,n)}ya(this,Lh,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Bi(this,Py)||this.isEditorOpened())return;this.setCopyableText(),ya(this,Py,!1);const r=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",r,this.copyableRanges)){const i=jm(r);if(e&&e.clipboardData){const s=F3(r,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[UB,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",r,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;e&&e.preventDefault&&e.preventDefault();let r;if(e&&typeof e.clipboardData<"u"){const a=TN(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?r=vHe(a,this.hot.rootDocument).data:r=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(r=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof r=="string"&&(r=D3e(r)),r&&r.length===0||this.hot.runHooks("beforePaste",r,this.copyableRanges)===!1)return;const[n,i,s,o]=this.populateValues(r);this.hot.selectCell(n,i,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,o)),this.hot.runHooks("afterPaste",r,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},mVe(this)),Bi(this,GT)&&e.items.push(yVe(this)),Bi(this,YT)&&e.items.push(vVe(this)),Bi(this,KT)&&e.items.push(pVe(this)),e.items.push(wVe(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&N$e())&&(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const e=this.hot.rootDocument.activeElement,r=this.hot.getActiveEditor();!r||e!==this.focusableElement.getFocusableElement()&&e!==r.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(jB(this.focusableElement),this.focusableElement=null),super.destroy()}}function $Ve(t){const{rows:e}=qK(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function QK(t,e){return`border_row${t}col${e}`}function um(){return{width:1,color:"#000"}}function $a(){return{hide:!0}}function HVe(){return{width:1,color:"#000",cornerVisible:!1}}function XT(t){if(ze(t.start)||ze(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ze(t.end)||ze(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function Wg(t){return ze(t.start)&&(t.left=t.start),ze(t.end)&&(t.right=t.end),t}function qT(t,e){return{id:QK(t,e),border:HVe(),row:t,col:e,top:$a(),bottom:$a(),start:$a(),end:$a()}}function jVe(t,e){return zr(e,"border")&&e.border&&(t.border=e.border),zr(e,"top")&&ze(e.top)&&(e.top?(wt(e.top)||(e.top=um()),t.top=e.top):(e.top=$a(),t.top=e.top)),zr(e,"bottom")&&ze(e.bottom)&&(e.bottom?(wt(e.bottom)||(e.bottom=um()),t.bottom=e.bottom):(e.bottom=$a(),t.bottom=e.bottom)),zr(e,"start")&&ze(e.start)&&(e.start?(wt(e.start)||(e.start=um()),t.start=e.start):(e.start=$a(),t.start=e.start)),zr(e,"end")&&ze(e.end)&&(e.end?(wt(e.end)||(e.end=um()),t.end=e.end):(e.end=$a(),t.end=e.end)),t}function il(t,e){let r=!1;return he(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!zr(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function EC(t){return`<span class="selected"></span>${t}`}function BVe(t){return t.some(e=>ze(e.left)||ze(e.right))}function VVe(t){return t.some(e=>ze(e.start)||ze(e.end))}const UVe=new Map([["left","start"],["right","end"]]);function WVe(t){var e;return(e=UVe.get(t))!==null&&e!==void 0?e:t}function zVe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(PM);return il(this,"bottom")&&(e=EC(e)),e},callback(e,r){const n=il(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function GVe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(DM);return il(this,e)&&(r=EC(r)),r},callback(r,n){const i=il(this,e);t.prepareBorder(n,e,i)}}}function YVe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(LM)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!il(this)}}}function KVe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(MM);return il(this,e)&&(r=EC(r)),r},callback(r,n){const i=il(this,e);t.prepareBorder(n,e,i)}}}function XVe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(NM);return il(this,"top")&&(e=EC(e)),e},callback(e,r){const n=il(this,"top");t.prepareBorder(r,"top",n)}}}function qVe(t,e,r){return e=JVe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JVe(t){var e=ZVe(t,"string");return typeof e=="symbol"?e:String(e)}function ZVe(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dy="customBorders",QVe=90;class eUe extends Vt{constructor(){super(...arguments),qVe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Dy}static get PLUGIN_PRIORITY(){return QVe}isEnabled(){return!!this.hot.getSettings()[Dy]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=XT(r));const s=Cf(e),o=f0(s);he(e,a=>{const[l,c,u,h]=o(a);for(let d=l;d<=u;d+=1)for(let f=c;f<=h;f+=1)he(n,m=>{this.prepareBorderFromCustomAdded(d,f,i,WVe(m))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=Cf(e),n=f0(r),i=[];return he(e,s=>{const[o,a,l,c]=n(s);for(let u=o;u<=l;u+=1)for(let h=a;h<=c;h+=1)he(this.savedBorders,d=>{d.row===u&&d.col===h&&i.push(Wg(d))})}),i}clearBorders(e){e?this.setBorders(e):(he(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=qT(e,r);n&&(a=jVe(a,n),he(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,n),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",Wg(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Qe(e.from.row,n,s=>{Qe(e.from.col,i,o=>{const a=qT(s,o);let l=0;s===e.from.row&&zr(r,"top")&&(l+=1,a.top=r.top),s===e.to.row&&zr(r,"bottom")&&(l+=1,a.bottom=r.bottom),o===e.from.col&&zr(r,"start")&&(l+=1,a.start=r.start),o===e.to.col&&zr(r,"end")&&(l+=1,a.end=r.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Wg(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const n=QK(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=qT(e,r):s=XT(s),i?(s[n]=$a(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Wg(s)))):(s[n]=um(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Wg(s)))}prepareBorder(e,r,n){he(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":Qe(s.col,o.col,a=>{Qe(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Qe(s.col,o.col,a=>{this.setBorder(s.row,a,r,n)});break;case"bottom":Qe(s.col,o.col,a=>{this.setBorder(o.row,a,r,n)});break;case"start":Qe(s.row,o.row,a=>{this.setBorder(a,s.col,r,n)});break;case"end":Qe(s.row,o.row,a=>{this.setBorder(a,o.col,r,n)});break}})}createCustomBorders(e){he(e,r=>{const n=XT(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return ai([r,n,i,s],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const r=yt(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){he(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){he(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=yt(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):he(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return he(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id)return bt(s.instanceBorders,o=>{o.toggleHiddenClass(r,n)}),i=!0,!1}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):he(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id)return o.visualCellRange=r,o.commit(),n&&bt(o.instanceBorders,a=>{a.changeBorderStyle(n,e)}),s=!0,!1}),s}changeBorderSettings(){const e=this.hot.getSettings()[Dy];if(Array.isArray(e)){const r=Si(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=BVe(e),n=VVe(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[Dy]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(IM)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[XVe(this),KVe(this),zVe(this),GVe(this),YVe(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const zB="dragToScroll",tUe=100;class rUe extends Vt{static get PLUGIN_KEY(){return zB}static get PLUGIN_PRIORITY(){return tUe}constructor(e){super(e),this.eventManager=new $r(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[zB]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=S1(r)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(Vu(e))return;const r=this.hot.view._wt.wtTable.holder;r!==this.hot.rootWindow&&(this.setBoundaries(r.getBoundingClientRect()),this.setCallback((n,i)=>{n<0?r.scrollLeft-=50:n>0&&(r.scrollLeft+=50),i<0?r.scrollTop-=20:i>0&&(r.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}Ye.getSingleton().register("afterDropdownMenuDefaultOptions");Ye.getSingleton().register("beforeDropdownMenuShow");Ye.getSingleton().register("afterDropdownMenuShow");Ye.getSingleton().register("afterDropdownMenuHide");Ye.getSingleton().register("afterDropdownMenuExecute");const JT="dropdownMenu",nUe=230,ZT="changeType";class TC extends Vt{static get PLUGIN_KEY(){return JT}static get PLUGIN_PRIORITY(){return nUe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[cv,uv,vt,dv,vt,vC,vt,hv,vt,Cs]}constructor(e){super(e),this.eventManager=new $r(this),this.commandExecutor=new WK(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(r,n)=>this.onAfterGetColHeader(r,n))}isEnabled(){return this.hot.getSettings()[JT]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new GK(this.hot,TC.DEFAULT_ITEMS);const r=this.hot.getSettings()[JT],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new ag(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),he(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),lt(e.target,ZT)&&!this.menu.isOpened()){let r=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:s}=this.hot.rootWindow,{top:o,left:a}=s.getBoundingClientRect();r=o,n=a}const i=e.target.getBoundingClientRect();this.open({left:i.left+n,top:i.top+e.target.offsetHeight+3+r,width:i.width,height:i.height})}}onAfterGetColHeader(e,r){const n=r.parentNode;if(!n)return;const i=n.parentNode.childNodes,s=Array.prototype.indexOf.call(i,n);if(e<0||s!==i.length-1)return;const o=r.querySelector(`.${ZT}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const a=this.hot.rootDocument.createElement("button");a.className=ZT,a.type="button",a.onclick=function(){return!1},r.firstChild.insertBefore(a,r.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}TC.SEPARATOR={name:vt};class iUe{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,o=[];return Qe(e,n,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Qe(r,i,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();Qe(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();Qe(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,o=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:n,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}class jP{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Li(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=cn(Li(jP.DEFAULT_OPTIONS),r),r=cn(r,e),r.filename=aY(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}const sUe="\r",oUe='"',aUe=`
`;class lUe extends jP{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(n=yt(n,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),he(r,(l,c)=>{c>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[c])+e.columnDelimiter),a+=l.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Zr(e);return n!==""&&(r||n.indexOf(sUe)>=0||n.indexOf(oUe)>=0||n.indexOf(aUe)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const cUe="csv",ck={[cUe]:lUe};function uUe(t,e,r){return typeof ck[t]=="function"?new ck[t](e,r):null}const hUe="exportFile",dUe=240;class fUe extends Vt{static get PLUGIN_KEY(){return hUe}static get PLUGIN_PRIORITY(){return dUe}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=i.URL||i.webkitURL,l=n.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,c)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ck[e])throw new Error(`Export format type "${e}" is not supported.`);return uUe(e,new iUe(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}class fv{constructor(e,r){let{id:n,stateless:i=!0}=r;this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new qS)}reset(){he(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),he(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}tr(fv,Ri);const y0={};function mc(t,e){if(!y0[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=y0[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function pu(t){if(!y0[t])throw Error(`Filter condition "${t}" does not exist.`);return y0[t].descriptor}function Qr(t,e,r){r.key=t,y0[t]={condition:e,descriptor:r}}const Cn="none";function gUe(){return!0}Qr(Cn,gUe,{name:JS,inputsCount:0,showOperators:!1});const Um="empty";function mUe(t){return yn(t.value)}Qr(Um,mUe,{name:UM,inputsCount:0,showOperators:!0});const Nw="not_empty";function pUe(t,e){return!mc(Um,e)(t)}Qr(Nw,pUe,{name:WM,inputsCount:0,showOperators:!0});const Wm="eq";function vUe(t,e){let[r]=e;return Zr(t.value).toLocaleLowerCase(t.meta.locale)===Zr(r)}Qr(Wm,vUe,{name:zM,inputsCount:1,showOperators:!0});const Mw="neq";function yUe(t,e){return!mc(Wm,e)(t)}Qr(Mw,yUe,{name:GM,inputsCount:1,showOperators:!0});const eX="gt";function wUe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}Qr(eX,wUe,{name:JM,inputsCount:1,showOperators:!0});const tX="gte";function xUe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}Qr(tX,xUe,{name:ZM,inputsCount:1,showOperators:!0});const rX="lt";function bUe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}Qr(rX,bUe,{name:QM,inputsCount:1,showOperators:!0});const nX="lte";function SUe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}Qr(nX,SUe,{name:eP,inputsCount:1,showOperators:!0});const BP="date_after";function CUe(t,e){let[r]=e;const n=Me(t.value,t.meta.dateFormat),i=Me(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}Qr(BP,CUe,{name:nP,inputsCount:1,showOperators:!0});const VP="date_before";function EUe(t,e){let[r]=e;const n=Me(t.value,t.meta.dateFormat),i=Me(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}Qr(VP,EUe,{name:iP,inputsCount:1,showOperators:!0});const L1="between";function TUe(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=mc(VP,[s]),a=mc(BP,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}Qr(L1,TUe,{name:tP,inputsCount:2,showOperators:!0});const iX="not_between";function _Ue(t,e){return!mc(L1,e)(t)}Qr(iX,_Ue,{name:rP,inputsCount:2,showOperators:!0});const sX="begins_with";function RUe(t,e){let[r]=e;return Zr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Zr(r))}Qr(sX,RUe,{name:YM,inputsCount:1,showOperators:!0});const oX="ends_with";function AUe(t,e){let[r]=e;return Zr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Zr(r))}Qr(oX,AUe,{name:KM,inputsCount:1,showOperators:!0});const UP="contains";function OUe(t,e){let[r]=e;return Zr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Zr(r))>=0}Qr(UP,OUe,{name:XM,inputsCount:1,showOperators:!0});const aX="not_contains";function kUe(t,e){return!mc(UP,e)(t)}Qr(aX,kUe,{name:qM,inputsCount:1,showOperators:!0});const lX="date_tomorrow";function IUe(t){const e=Me(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Me().subtract(-1,"days").startOf("day"),"d"):!1}Qr(lX,IUe,{name:oP,inputsCount:0});const cX="date_today";function NUe(t){const e=Me(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Me().startOf("day"),"d"):!1}Qr(cX,NUe,{name:sP,inputsCount:0});const uX="date_yesterday";function MUe(t){const e=Me(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Me().subtract(1,"days").startOf("day"),"d"):!1}Qr(uX,MUe,{name:aP,inputsCount:0});S4e();function PUe(t,e){let r=t;return r===""&&(r=`(${e})`),r}const uk=new Set([1]).has(1),DUe=uk&&typeof Array.from=="function";function gv(t){let e=t;return uk&&(e=new Set(e)),function(r){let n;return uk?n=e.has(r):n=!!~e.indexOf(r),n}}function hX(t){return t??""}function hk(t){let e=t;return DUe?e=Array.from(new Set(e)):e=iY(e),e=e.sort((r,n)=>typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1),e}function GB(t,e,r,n){const i=[],s=t===e;let o;return s||(o=gv(e)),he(t,a=>{let l=!1;(s||o(a))&&(l=!0);const c={checked:l,value:a,visualValue:PUe(a,r)};n&&n(c),i.push(c)}),i}const vu="by_value";function LUe(t,e){let[r]=e;return r(t.value)}Qr(vu,LUe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[gv(e)]},showOperators:!1});const w0={};function FUe(t){if(!w0[t])throw Error(`Operation with id "${t}" does not exist.`);const e=w0[t].func;return function(r,n){return e(r,n)}}function $Ue(t){return w0[t].name}function WP(t,e,r){w0[t]={name:e,func:r}}const uc="conjunction",HUe=uP;function jUe(t,e){return t.every(r=>r.func(e))}WP(uc,HUe,jUe);const F1="disjunction",BUe=ZS;function VUe(t,e){return t.some(r=>r.func(e))}WP(F1,BUe,VUe);const zP="disjunctionWithExtraCondition",UUe=ZS;function WUe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}WP(zP,UUe,WUe);const zUe="numeric",dX="text",GUe="date",YB={[zUe]:[Cn,vt,Um,Nw,vt,Wm,Mw,vt,eX,tX,rX,nX,L1,iX],[dX]:[Cn,vt,Um,Nw,vt,Wm,Mw,vt,sX,oX,vt,UP,aX],[GUe]:[Cn,vt,Um,Nw,vt,Wm,Mw,vt,VP,BP,L1,vt,lX,cX,uX]};function YUe(t){const e=[];let r=t;return YB[r]||(r=dX),he(YB[r],n=>{let i;n===vt?i={name:vt}:i=Li(pu(n)),e.push(i)}),e}const QT="built",e_="building",KB=["click","input","keydown","keypress","keyup","focus","blur","change"];let za=class fX{static get DEFAULTS(){return Li({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){this.hot=e,this.eventManager=new $r(this),this.options=cn(fX.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===e_?this._element:this.buildState===QT?(this.update(),this._element):(this.buildState=e_,this.build(),this.buildState=QT,this._element)}isBuilt(){return this.buildState===QT}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Ai)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=e_),this.options.className&&De(this._element,this.options.className),this.options.children.length)he(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);bt(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),he(KB,n=>e(r,n))}else he(KB,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};tr(za,Ri);const Ly=new WeakMap;class hc extends za{static get DEFAULTS(){return Li({placeholder:"",type:"text",tagName:"input"})}constructor(e,r){super(e,cn(hc.DEFAULTS,r)),Ly.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();const e=Ly.get(this),r=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,De(this._element,"htUIInput"),De(r,"htUIInputIcon"),this._element.appendChild(r),this.update()}update(){if(!this.isBuilt())return;const e=Ly.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&Ly.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}const Fy=new WeakMap;class $1 extends za{static get DEFAULTS(){return Li({className:"htUISelect",wrapIt:!1})}constructor(e,r){super(e,cn($1.DEFAULTS,r)),Fy.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return he(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),this.menu=new ag(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new za(this.hot,{className:"htUISelectCaption"}),r=new za(this.hot,{className:"htUISelectDropdown"}),n=Fy.get(this);n.caption=e,n.captionElement=e.element,n.dropdown=r,he([e,r],i=>this._element.appendChild(i.element)),this.menu.addLocalHook("select",i=>this.onMenuSelect(i)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(JS),Fy.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==vt&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:r}=Fy.get(this);e&&e.destroy(),r&&r.destroy(),super.destroy()}}class t_ extends fv{constructor(e,r){super(e,{id:r.id,stateless:!1}),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new $1(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new hc(this.hot,{placeholder:pP})),this.elements.push(new hc(this.hot,{placeholder:vP})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),he(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>this.onInputKeyDown(r))})}setState(e){if(this.reset(),!e)return;const r=Li(e.command);r.name.startsWith(Hr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),he(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||setTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||pu(Cn),r=[];return he(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=pu(e?e.name:Cn);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||he(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof $1)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof hc)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{De(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&De(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return De(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentNode.hasAttribute("ghost-table")||he(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[pu(Cn)];if(e!==null){const{visualIndex:n}=e;r=YUe(this.hot.getDataType(0,n,this.hot.countRows(),n))}he(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}onConditionSelect(e){he(this.getInputElements(),(r,n)=>{r[e.inputsCount>n?"show":"hide"](),n===0&&setTimeout(()=>r.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){u0(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),ra(e)):u0(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ra(e))}}const $y=new WeakMap;class H1 extends za{static get DEFAULTS(){return Li({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,cn(H1.DEFAULTS,r)),$y.set(this,{})}build(){super.build();const e=$y.get(this);e.input=this._element.firstChild;const r=this.hot.rootDocument.createElement("label");r.textContent=this.translateIfPossible(this.options.label.textContent),r.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=r,this._element.appendChild(r),this.update()}update(){if(!this.isBuilt())return;const e=$y.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&$y.get(this).input.focus()}}const XB=0;class KUe extends fv{constructor(e,r){super(e,{id:r.id,stateless:!1}),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(De(r.parentNode,"htFiltersMenuOperators"),r.parentNode.hasAttribute("ghost-table")||he(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[uc,F1];he(e,r=>{const n=new H1(this.hot,{name:"operator",label:{htmlFor:r,textContent:$Ue(r)},value:r,checked:r===e[XB],id:r});n.addLocalHook("change",i=>this.onRadioInputChange(i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Jt`Radio button with index ${e} doesn't exist.`);he(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof H1&&r.isChecked());return e?e.getValue():uc}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&he(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uc,r=arguments.length>1?arguments[1]:void 0,n=e;n===zP&&(n=F1),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(XB)}onRadioInputChange(e){this.setState(e.target.value)}}const r_=new WeakMap;class j1 extends za{static get DEFAULTS(){return Li({href:"#",tagName:"a"})}constructor(e,r){super(e,cn(j1.DEFAULTS,r)),r_.set(this,{})}build(){super.build();const e=r_.get(this);e.link=this._element.firstChild}update(){this.isBuilt()&&(r_.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}const XUe=new WeakMap,qUe="multipleSelect.itemBox";class B1 extends za{static get DEFAULTS(){return Li({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,cn(B1.DEFAULTS,r)),XUe.set(this,{}),this.searchInput=new hc(this.hot,{placeholder:mP,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new j1(this.hot,{textContent:hP,className:"htUISelectAll"}),this.clearAllUI=new j1(this.hot,{textContent:dP,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return ZUe(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new za(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),De(s,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(s,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,c,u,h,d,f)=>{l.title=f.instance.getDataAtRowProp(c,f.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-An(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:qUe})};i(r),setTimeout(()=>i(r),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(JUe(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const r=e.target.value.toLocaleLowerCase(this.getLocale());let n;r===""?n=[...this.items]:n=Fs(this.items,i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(r)>=0),this.itemsBox.loadData(n)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),fY(u0,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(ra(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const r=[];e.preventDefault(),he(this.itemsBox.getSourceData(),(n,i)=>{n.checked=!0,r.push(nB(n,i)[0])}),this.itemsBox.setSourceDataAtCell(r)}onClearAllClick(e){const r=[];e.preventDefault(),he(this.itemsBox.getSourceData(),(n,i)=>{n.checked=!1,r.push(nB(n,i)[0])}),this.itemsBox.setSourceDataAtCell(r)}}function JUe(t,e){const r=gv(e);return yt(t,n=>(n.checked=r(n.value),n))}function ZUe(t){const e=[];return he(t,r=>{r.checked&&e.push(r.value)}),e}class QUe extends fv{constructor(e,r){super(e,{id:r.id,stateless:!1}),this.name=r.name,this.elements.push(new B1(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===vu){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?Cn:vu},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,o,a)=>{const[l]=Fs(i,h=>h.name===vu),c={},u=this.hot.getTranslatedPhrase(O1);if(l){const h=hk(yt(o(n,a),g=>g.value));s&&(l.args[0]=s);const d=[],f=GB(h,l.args[0],u,g=>{g.checked&&d.push(g.value)}),m=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,m).locale,c.args=[d],c.command=pu(vu),c.itemsSnapshot=f}else c.args=[],c.command=pu(Cn);this.state.setValueAtIndex(n,c)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof B1)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{De(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return De(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentNode.hasAttribute("ghost-table")||he(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(O1),r=hk(this._getColumnVisibleValues()),n=GB(r,r,e);this.getMultipleSelectElement().setItems(n),super.reset(),this.getMultipleSelectElement().setValue(r);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}onInputKeyDown(e){u0(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ra(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:yt(this.hot.getDataAtCol(e.visualIndex),r=>hX(r))}}class zm extends fv{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),this.name=r.name,this.elements.push(new hc(this.hot,{type:"button",value:fP,className:"htUIButton htUIButtonOK",identifier:zm.BUTTON_OK})),this.elements.push(new hc(this.hot,{type:"button",value:gP,className:"htUIButton htUIButtonCancel",identifier:zm.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){he(this.elements,e=>{e.addLocalHook("click",(r,n)=>this.onButtonClick(r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(De(r.parentNode,"htFiltersMenuActionBar"),r.parentNode.hasAttribute("ghost-table")||he(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,r){r.options.identifier===zm.BUTTON_OK?this.accept():this.cancel()}}const qB="ConditionCollection.filteringStates";class GP{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=r,this.filteringStates=new qS,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(qB,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uc;return e.length?FUe(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uc,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=yt(r.args,u=>typeof u=="string"?u.toLocaleLowerCase(s):u),a=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(Jt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(ur(w0[n]))throw new Error(Jt`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:mc(a,o)}]},i):c.push({name:a,args:o,func:mc(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return ai(this.filteringStates.getEntries(),(e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:yt(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),he(e,r=>{he(r.conditions,n=>this.addCondition(r.column,n))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(qB),this.filteringStates=null,this.clearLocalHooks()}}tr(GP,Ri);class gX{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return he(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return he(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return he(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}class mX{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",i=>this._onConditionBeforeModify(i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,he(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=$$e(function(u,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new GP(n.hot,!1),m=[].concat(u,d);f.importAllConditions(m);const g=n.columnDataFactory(h);let v;f.isEmpty()?v=g:v=new gX(f,b=>n.columnDataFactory(b)).filter(),v=yt(v,b=>b.meta.visualRow);const w=gv(v);return f.destroy(),Fs(g,b=>w(b.meta.visualRow))})(o),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:r})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){he(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),bt(this,(e,r)=>{this[r]=null})}}tr(mX,Ri);const JB="filters",eWe=250;class tWe extends Vt{static get PLUGIN_KEY(){return JB}static get PLUGIN_PRIORITY(){return eWe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new $r(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(r,n)=>this.onAfterGetColHeader(r,n))}isEnabled(){return!!this.hot.getSettings()[JB]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new ov),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,r=e&&e.uiContainer||this.hot.rootDocument.body,n=o=>(o.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),o.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),o.addLocalHook("change",a=>this.onComponentChange(o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(lP)}:`,s=()=>`${this.hot.getTranslatedPhrase(cP)}:`;if(!this.components.get("filter_by_condition")){const o=new t_(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});o.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",n(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new KUe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new t_(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});o.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",n(o))}this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new QUe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new zm(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new GP(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new mX(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>this.updateComponents(o))),this.components.forEach(o=>o.show()),this.addHook("beforeDropdownMenuSetItems",o=>this.onBeforeDropdownMenuSetItems(o)),this.addHook("afterDropdownMenuDefaultOptions",o=>this.onAfterDropdownMenuDefaultOptions(o)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",o=>this.onAfterChange(o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}super.disablePlugin()}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:uc;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}filter(){const e=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let n=[];const i=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",i)!==!1)if(r){const o=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),n=yt(e.filter(),l=>l.meta.visualRow);const a=gv(n);Qe(this.hot.countSourceRows()-1,l=>{a(l)||o.push(l)}),he(o,l=>{this.filtersRowsMap.setValueAtIndex(l,!0)})},!0),n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}clearColumnSelection(){const e=this.getSelectedColumn();e!==null&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return he(this.hot.getSourceDataAtCol(r),(i,s)=>{var o;const{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,r),g=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:i;n.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:d,dateFormat:f,locale:m},value:hX(g)})}),n}onAfterChange(e){e&&he(e,r=>{const[,n]=r,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=hk(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:vt}),this.components.forEach(r=>{e.items.push(r.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===F1&&r.command.key!==Cn&&n.command.key!==Cn&&i.command.key!==Cn?s=zP:i.command.key!==Cn&&(r.command.key===Cn||n.command.key===Cn)&&(s=uc),s}onActionBarSubmit(e){var r;if(e==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:s}=i,o=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),c=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,a,l);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(s);u===-1&&(u=void 0),this.conditionCollection.removeConditions(s),o.command.key!==Cn&&(this.conditionCollection.addCondition(s,o,c,u),a.command.key!==Cn&&this.conditionCollection.addCondition(s,a,c,u)),l.command.key!==Cn&&this.conditionCollection.addCondition(s,l,c,u),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(s)),this.filtersRowsMap.clear(),this.filter()}(r=this.dropdownMenuPlugin)===null||r===void 0||r.close()}onComponentChange(e,r){this.updateDependentComponentsVisibility(),e.constructor===t_&&!r.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}onAfterGetColHeader(e,r){const n=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?De(r,"htFiltersActive"):ct(r,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new gX(e,r=>this.getDataMapAtColumn(r))}updateComponents(e){var r;if(!((r=this.dropdownMenuPlugin)!==null&&r!==void 0&&r.enabled))return;const{editedConditionStack:{conditions:n,column:i}}=e,s=n.filter(a=>a.name===vu),o=n.filter(a=>a.name!==vu);if(s.length>=2||o.length>=3)lr(Jt`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return he(i,o=>{he(r.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const pX="internal-use-in-handsontable",dk={licenseKey:pX,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function vX(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Yn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function yX(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function rWe(t){var e;const r=t[Yn],n=yX(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=vX(t);return{...dk,...n,...i}}function nWe(t){var e;const r=t[Yn],n=yX(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=vX(t);return{...n,...i}}function iWe(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function _C(){const t="engine_relationship",e=Ws(Yn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function YP(){const t="shared_engine_usage",e=Ws(Yn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function sWe(t){const e=t.getSettings(),r=e[Yn],n=r==null?void 0:r.engine;if(r===!0||ur(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return oWe((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&ur(n.hyperformula)){const s=_C(),o=YP().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:pX}),(n.getConfig().leapYear1900!==dk.leapYear1900||AN(n.getConfig().nullDate,dk.nullDate)===!1)&&lr(Jt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function oWe(t,e,r){const n=e[Yn],i=rWe(e),s=_C(),o=YP();aWe(t,n.functions),lWe(t,n.language);const a=t.buildEmpty(i);return s.set(a,[r]),o.set(a,[r.guid]),cWe(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function ZB(t){var e;const r=_C(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function QB(t,e){if(t){const r=_C(),n=r.get(t),i=YP(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function aWe(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(o){lr(o.message)}})}function lWe(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){lr(n.message)}}}function cWe(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:o}=r;try{t.addNamedExpression(n,i,s,o)}catch(a){lr(a.message)}}),t.resumeEvaluation())}function uWe(t,e){return(ur(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const wX="DD/MM/YYYY";function xX(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function hWe(t){return xX(t)?t.substr(1):t}function dWe(t){return typeof t=="string"&&t.startsWith("=")}function n_(t,e){return typeof t=="string"&&e==="date"}function e6(t,e){return Me(t,e,!0).isValid()}function t6(t,e){return Me(t,e,!0).format(wX)}function fWe(t,e){return Me(t,wX,!0).format(e)}function r6(t,e){const n=new Date(Date.UTC(0,0,t+-1));return Me(n).format(e)}function Gc(t,e,r){gWe(t,e),e.set(t,r)}function gWe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pr(t,e){var r=bX(t,e,"get");return mWe(t,r)}function mWe(t,e){return e.get?e.get.call(t):e.value}function El(t,e,r){var n=bX(t,e,"set");return pWe(t,n,r),r}function bX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function pWe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var zg=new WeakMap,Tl=new WeakMap,Vi=new WeakMap,Hy=new WeakMap,i_=new WeakMap,s_=new WeakMap,jy=new WeakMap;class n6{constructor(e,r,n){Gc(this,zg,{writable:!0,value:void 0}),Gc(this,Tl,{writable:!0,value:void 0}),Gc(this,Vi,{writable:!0,value:void 0}),Gc(this,Hy,{writable:!0,value:[]}),Gc(this,i_,{writable:!0,value:[]}),Gc(this,s_,{writable:!0,value:void 0}),Gc(this,jy,{writable:!0,value:[]}),El(this,zg,e),El(this,Tl,r),El(this,Vi,n)}setRemovedHfIndexes(e){return El(this,jy,e.map(r=>{const n=pr(this,Tl).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),pr(this,jy)}getRemovedHfIndexes(){return pr(this,jy)}getHfIndexFromVisualIndex(e){const r=pr(this,Tl).getIndexesSequence(),n=pr(this,Tl).getNotTrimmedIndexes();return r.indexOf(n[e])}syncMoves(e){const n=`move${po(pr(this,zg))}s`;pr(this,Vi).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&pr(this,Vi).getEngine()[n](pr(this,Vi).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(El(this,i_,e.map(i=>this.getHfIndexFromVisualIndex(i))),El(this,s_,this.getHfIndexFromVisualIndex(r)))}getMoveLine(e,r){const n=pr(this,Tl).getNumberOfIndexes(),i=Array.from(Array(n).keys()).filter(o=>e.includes(o)===!1);if(r===0){var s;return(s=i[r])!==null&&s!==void 0?s:0}return i[r-1]+1}getInitiallyCalculatedMoves(e,r){let n=this.getMoveLine(e,r);const i=[];return e.forEach(s=>{const o={from:s,to:n};i.forEach(a=>{const l=a.from>a.to,c=a.to<=o.from;a.from>o.from&&c&&l&&(o.from+=1)}),o.from>=n&&(n+=1),i.push(o)}),i}adjustedCalculatedMoves(e){return e.forEach((r,n)=>{e.slice(n+1).forEach(s=>{const o=s.from<s.to;s.from>r.from&&o&&(s.from-=1)})}),e}calculateAndSyncMoves(e,r){if(pr(this,Vi).isPerformingUndoRedo()||e===!1||r===!1)return;const n=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(pr(this,i_),pr(this,s_)));pr(this,Vi).getSheetId()===null?pr(this,Vi).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${po(pr(this,zg))}Order`;return r=>{if(pr(this,Vi).isPerformingUndoRedo())return;const n=pr(this,Tl).getIndexesSequence();if(r==="update"){const i=pr(this,Hy).map(l=>n.indexOf(l)),s=pr(this,Vi).getEngine().getSheetDimensions(pr(this,Vi).getSheetId());let o;pr(this,zg)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);pr(this,Vi).getEngine()[e](pr(this,Vi).getSheetId(),i)}El(this,Hy,n)}}init(){El(this,Hy,pr(this,Tl).getIndexesSequence())}}function Yc(t,e,r){vWe(t,e),e.set(t,r)}function vWe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(t,e){var r=SX(t,e,"get");return yWe(t,r)}function yWe(t,e){return e.get?e.get.call(t):e.value}function Kc(t,e,r){var n=SX(t,e,"set");return wWe(t,n,r),r}function SX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function wWe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var By=new WeakMap,Vy=new WeakMap,o_=new WeakMap,a_=new WeakMap,l_=new WeakMap,c_=new WeakMap,u_=new WeakMap;class xWe{constructor(e,r,n){Yc(this,By,{writable:!0,value:void 0}),Yc(this,Vy,{writable:!0,value:void 0}),Yc(this,o_,{writable:!0,value:void 0}),Yc(this,a_,{writable:!0,value:!1}),Yc(this,l_,{writable:!0,value:!1}),Yc(this,c_,{writable:!0,value:null}),Yc(this,u_,{writable:!0,value:null}),Kc(this,By,new n6("row",e,this)),Kc(this,Vy,new n6("column",r,this)),Kc(this,o_,n)}getForAxis(e){return e==="row"?wa(this,By):wa(this,Vy)}setPerformUndo(e){Kc(this,a_,e)}setPerformRedo(e){Kc(this,l_,e)}isPerformingUndoRedo(){return wa(this,a_)||wa(this,l_)}getSheetId(){return wa(this,u_)}getEngine(){return wa(this,c_)}getPostponeAction(){return wa(this,o_)}setupSyncEndpoint(e,r){Kc(this,c_,e),Kc(this,u_,r),wa(this,By).init(),wa(this,Vy).init()}}function $h(t,e,r){return e=bWe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bWe(t){var e=SWe(t,"string");return typeof e=="symbol"?e:String(e)}function SWe(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h_(t,e,r){CWe(t,e),e.set(t,r)}function CWe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e,r){var n=CX(t,e,"set");return EWe(t,n,r),r}function EWe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Hh(t,e){var r=CX(t,e,"get");return TWe(t,r)}function CX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function TWe(t,e){return e.get?e.get.call(t):e.value}const Yn="formulas",_We=["maxRows","maxColumns","language"],RWe=260;Ye.getSingleton().register("afterNamedExpressionAdded");Ye.getSingleton().register("afterNamedExpressionRemoved");Ye.getSingleton().register("afterSheetAdded");Ye.getSingleton().register("afterSheetRemoved");Ye.getSingleton().register("afterSheetRenamed");Ye.getSingleton().register("afterFormulasValuesUpdate");const jh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var xa=new WeakMap,d_=new WeakMap,Gg=new WeakMap;class AWe extends Vt{constructor(){var e;super(...arguments),e=this,h_(this,xa,{writable:!0,value:!1}),h_(this,d_,{writable:!0,value:!1}),h_(this,Gg,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),$h(this,"staticRegister",Ws("formulas")),$h(this,"engine",null),$h(this,"sheetName",null),$h(this,"indexSyncer",null),$h(this,"rowAxisSyncer",null),$h(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Yn}static get PLUGIN_PRIORITY(){return RWe}static get SETTING_KEYS(){return[Yn,..._We]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Yn]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=sWe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){lr("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){return r.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return r.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return r.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return r.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return r.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return r.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return r.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return r.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return r.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return r.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return r.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return r.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return r.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return r.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return r.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return r.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return r.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return r.onAfterRemoveCol(...arguments)}),this.indexSyncer=new xWe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("beforeColumnMove",(n,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("afterRowMove",(n,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(n,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){return r.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return r.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return r.onBeforeAutofill(...arguments)}),Hh(this,Gg).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Hh(this,Gg).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),QB(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=nWe(this.hot.getSettings());iWe(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[Yn];if(ze(n)&&ze(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Yn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Hh(this,Gg).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),_l(this,Gg,null),QB(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(ze(r)&&!$je(r))return lr("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return lr("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return lr(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){IN(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${po(Yn)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(n.has(o)||n.add(o))}),ZB(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var o;const{row:a,col:l,sheet:c}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return ze(c)?`${c}:${a}x${l}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var o,a;const{row:l,col:c}=(o=s.address)!==null&&o!==void 0?o:{};if(ze(l)===!1||ze(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;const u=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=n(s);if(u!==void 0&&!i.has(h)){const d=ZB(this.engine).get(u);if(!d)return;d.validateCell(d.getDataAtCell(l,c),d.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){lr(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return n_(n,s.type)&&(e6(n,s.dateFormat)?n=t6(n,s.dateFormat):dWe(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}onBeforeValidate(e,r,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(r,i)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(r,i);let a=this.engine.getCellValue(s);return o.type==="date"&&Mi(a)&&(a=r6(a,o.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return e}onBeforeAutofill(e,r,n){const{row:i,col:s}=r.getTopStartCorner(),{row:o,col:a}=r.getBottomEndCorner(),{row:l,col:c}=n.getTopStartCorner(),{row:u,col:h}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const m=this.engine.getFillRangeData(d,f),{row:g,col:v}=d.start,{row:w,col:b}=d.end,x=w-g+1,C=b-v+1;for(let S=0;S<m.length;S+=1)for(let E=0;E<m[S].length;E+=1){const T=m[S][E],I=S%x,k=E%C,M=this.hot.getCellMeta(I,k);n_(T,M.type)&&(T.startsWith("'")?m[S][E]=T.slice(1):this.isFormulaCellType(I,k,this.sheetId)===!1&&(m[S][E]=fWe(T,M.dateFormat)))}return m}onBeforeLoadData(e,r){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(po(Yn))||_l(this,d_,ur(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let r=!1;e.forEach((n,i)=>{n.forEach((s,o)=>{const a=this.hot.getCellMeta(i,o),l=a.dateFormat;n_(s,a.type)&&(r=!0,e6(s,l)?e[i][o]=t6(s,l):this.isFormulaCellType(i,o)===!1&&(e[i][o]=`'${s}`))})}),r===!0&&(_l(this,xa,!0),this.engine.setSheetContent(this.sheetId,e),_l(this,xa,!1))}onAfterLoadData(e,r){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(po(Yn)))if(this.sheetName=uWe(this.engine,this.hot.getSettings()[Yn].sheetName),Hh(this,d_))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){_l(this,xa,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),_l(this,xa,!1)}}}onModifyData(e,r,n,i){if(i!=="get"||Hh(this,xa)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(e);if(s===null||r===null)return;if(!this.isFormulaCellType(s,r)&&this.getCellType(s,r)!=="ARRAY"){xX(n.value)&&(n.value=hWe(n.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};let l=this.engine.getCellValue(a);const c=this.hot.getCellMeta(s,r);c.type==="date"&&Mi(l)&&(l=r6(l,c.dateFormat));const u=typeof l=="object"&&l!==null?l.value:l;n.value=u}onModifySourceData(e,r,n,i){if(i!=="get"||Hh(this,xa)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(e),o=this.hot.propToCol(r);if(s===null||o===null||!this.isFormulaCellType(s,o)&&this.getCellType(s,o)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(c)}onAfterSetDataAtCell(e,r){if(jh(r))return;const n=[],i=[],s=this.engine.batch(()=>{e.forEach(o=>{let[a,l,,c]=o;const u=this.hot.propToCol(l),h=this.hot.toPhysicalRow(a),d=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};h!==null&&d!==null?this.syncChangeWithEngine(a,u,c):n.push([a,u,c]),i.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(a=>{let[l,c,u]=a;this.syncChangeWithEngine(l,c,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,i)}onAfterSetSourceDataAtCell(e,r){if(jh(r))return;const n=[],i=[];e.forEach(s=>{let[o,a,,l]=s;const c=this.hot.propToCol(a);if(!Mi(c))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){lr(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,l))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}onBeforeCreateRow(e,r){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,r]))return!1}onBeforeCreateCol(e,r){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,r]))return!1}onBeforeRemoveRow(e,r,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}onBeforeRemoveCol(e,r,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}onAfterCreateRow(e,r,n){if(jh(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),r]);this.renderDependentSheets(i)}onAfterCreateCol(e,r,n){if(jh(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),r]);this.renderDependentSheets(i)}onAfterRemoveRow(e,r,n,i){if(jh(i))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(o)}onAfterRemoveCol(e,r,n,i){if(jh(i))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(o)}onAfterDetachChild(e,r,n){var i;_l(this,xa,!0);const s=this.hot.getSourceDataArray(n,0,n+(((i=r.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());_l(this,xa,!1),s.forEach((o,a)=>{o.forEach((l,c)=>{this.engine.setCellContents({col:c,row:n+a,sheet:this.sheetId},[[l]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,r){this.hot.runHooks("afterNamedExpressionAdded",e,r)}onEngineNamedExpressionsRemoved(e,r){this.hot.runHooks("afterNamedExpressionRemoved",e,r)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,r){this.hot.runHooks("afterSheetRenamed",e,r)}onEngineSheetRemoved(e,r){this.hot.runHooks("afterSheetRemoved",e,r)}}function OWe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(HM,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function kWe(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(jM,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=yt(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=c.slice(i,s+1);u.push(...f.filter(m=>r.includes(m)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&u.push(...c.slice(s+1))}return he(u,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function i6(t,e,r){IWe(t,e),e.set(t,r)}function IWe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(t,e){var r=EX(t,e,"get");return NWe(t,r)}function NWe(t,e){return e.get?e.get.call(t):e.value}function Yg(t,e,r){var n=EX(t,e,"set");return MWe(t,n,r),r}function EX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function MWe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ye.getSingleton().register("beforeHideColumns");Ye.getSingleton().register("afterHideColumns");Ye.getSingleton().register("beforeUnhideColumns");Ye.getSingleton().register("afterUnhideColumns");const f_="hiddenColumns",PWe=310;var ko=new WeakMap,Io=new WeakMap;class DWe extends Vt{constructor(){super(...arguments),i6(this,ko,{writable:!0,value:{}}),i6(this,Io,{writable:!0,value:null})}static get PLUGIN_KEY(){return f_}static get PLUGIN_PRIORITY(){return PWe}isEnabled(){return!!this.hot.getSettings()[f_]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[f_];wt(r)&&(Yg(this,ko,r),ur(r.copyPasteEnabled)&&(r.copyPasteEnabled=!0)),Yg(this,Io,new XS),Ui(this,Io).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,Ui(this,Io)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(n,i,s)=>this.onAfterGetCellMeta(n,i,s)),this.addHook("modifyColWidth",(n,i)=>this.onModifyColWidth(n,i)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",n=>this.onModifyCopyableRange(n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Yg(this,ko,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=Ui(this,Io).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(c=>this.hot.toPhysicalColumn(c));he(l,c=>{s[c]=!1}),i=ai(s,(c,u,h)=>(u&&c.push(this.hot.toVisualColumn(h)),c),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&o)!==!1&&(n&&o&&Ui(this,Io).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&o,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{he(e,o=>{Ui(this,Io).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return yt(Ui(this,Io).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ui(this,Io).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){he(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,r){if(this.isHidden(r))return 0;if(Ui(this,ko).indicators&&(this.isHidden(r+1)||this.isHidden(r-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,r,n){if(Ui(this,ko).copyPasteEnabled===!1&&this.isHidden(r)&&(n.skipColumnOnPaste=!0),this.isHidden(r-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenColumn");s>-1&&i.splice(s,1),n.className=i.join(" ")}}}onModifyCopyableRange(e){if(Ui(this,ko).copyPasteEnabled)return e;const r=[],n=(i,s,o,a)=>{r.push({startRow:i,endRow:s,startCol:o,endCol:a})};return he(e,i=>{let s=!0,o=0;Qe(i.startCol,i.endCol,a=>{this.isHidden(a)?(s||n(i.startRow,i.endRow,o,a-1),s=!0):(s&&(o=a),a===i.endCol&&n(i.startRow,i.endRow,o,a),s=!1)})}),r}onAfterGetColHeader(e,r){if(!Ui(this,ko).indicators||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),De(r,n)}onAfterContextMenuDefaultOptions(e){e.items.push({name:vt},OWe(this),kWe(this))}onMapInit(){Array.isArray(Ui(this,ko).columns)&&this.hideColumns(Ui(this,ko).columns)}destroy(){Yg(this,ko,null),Yg(this,Io,null),super.destroy()}}function LWe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(BM,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function FWe(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(VM,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=yt(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=c.slice(i,s+1);u.push(...f.filter(m=>r.includes(m)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&u.push(...c.slice(s+1))}return he(u,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function s6(t,e,r){$We(t,e),e.set(t,r)}function $We(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e){var r=TX(t,e,"get");return HWe(t,r)}function HWe(t,e){return e.get?e.get.call(t):e.value}function Kg(t,e,r){var n=TX(t,e,"set");return jWe(t,n,r),r}function TX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function jWe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ye.getSingleton().register("beforeHideRows");Ye.getSingleton().register("afterHideRows");Ye.getSingleton().register("beforeUnhideRows");Ye.getSingleton().register("afterUnhideRows");const g_="hiddenRows",BWe=320;var ba=new WeakMap,No=new WeakMap;class VWe extends Vt{constructor(){super(...arguments),s6(this,ba,{writable:!0,value:{}}),s6(this,No,{writable:!0,value:null})}static get PLUGIN_KEY(){return g_}static get PLUGIN_PRIORITY(){return BWe}isEnabled(){return!!this.hot.getSettings()[g_]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[g_];wt(r)&&(Kg(this,ba,r),ur(r.copyPasteEnabled)&&(r.copyPasteEnabled=!0)),Kg(this,No,new XS),vs(this,No).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,vs(this,No)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(n,i,s)=>this.onAfterGetCellMeta(n,i,s)),this.addHook("modifyRowHeight",(n,i)=>this.onModifyRowHeight(n,i)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",n=>this.onModifyCopyableRange(n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Kg(this,ba,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=vs(this,No).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(c=>this.hot.toPhysicalRow(c));he(l,c=>{s[c]=!1}),i=ai(s,(c,u,h)=>(u&&c.push(this.hot.toVisualRow(h)),c),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&o)!==!1&&(n&&o&&vs(this,No).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&o,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{he(e,o=>{vs(this,No).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return yt(vs(this,No).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return vs(this,No).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){he(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,r){return this.isHidden(r)?0:e}onAfterGetCellMeta(e,r,n){if(vs(this,ba).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenRow");s>-1&&i.splice(s,1),n.className=i.join(" ")}}}onModifyCopyableRange(e){if(vs(this,ba).copyPasteEnabled)return e;const r=[],n=(i,s,o,a)=>{r.push({startRow:i,endRow:s,startCol:o,endCol:a})};return he(e,i=>{let s=!0,o=0;Qe(i.startRow,i.endRow,a=>{this.isHidden(a)?(s||n(o,a-1,i.startCol,i.endCol),s=!0):(s&&(o=a),a===i.endRow&&n(o,a,i.startCol,i.endCol),s=!1)})}),r}onAfterGetRowHeader(e,r){if(!vs(this,ba).indicators||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),De(r,n)}onAfterContextMenuDefaultOptions(e){e.items.push({name:vt},LWe(this),FWe(this))}onMapInit(){Array.isArray(vs(this,ba).rows)&&this.hideRows(vs(this,ba).rows)}destroy(){Kg(this,ba,null),Kg(this,No,null),super.destroy()}}function UWe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(mM)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function WWe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(pM)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}Ye.getSingleton().register("beforeColumnFreeze");Ye.getSingleton().register("afterColumnFreeze");Ye.getSingleton().register("beforeColumnUnfreeze");Ye.getSingleton().register("afterColumnUnfreeze");const o6="manualColumnFreeze",zWe=110,Xg=new WeakMap;class GWe extends Vt{static get PLUGIN_KEY(){return o6}static get PLUGIN_PRIORITY(){return zWe}constructor(e){super(e),Xg.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[o6]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,r)=>this.onBeforeColumnMove(e,r)),super.enablePlugin())}disablePlugin(){const e=Xg.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=Xg.get(this),n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;r.afterFirstUse||(r.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const r=Xg.get(this),n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;r.afterFirstUse||(r.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}addContextMenuEntry(e){e.items.push({name:"---------"},UWe(this),WWe(this))}onBeforeColumnMove(e,r){if(Xg.get(this).afterFirstUse){const i=this.hot.getSettings().fixedColumnsStart;if(r<i||e.some(s=>s<i))return!1}}}const m_=0,a6=1,l6=2,Bh="px";let _X=class{constructor(e){this.hot=e,this._element=null,this.state=m_,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=l6}build(){this.state===m_&&(this._element=this.hot.rootDocument.createElement("div"),this.state=a6)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=m_}isAppended(){return this.state===l6}isBuilt(){return this.state>=a6}setPosition(e,r){Mi(e)&&(this._element.style.top=e+Bh),Mi(r)&&(this._element.style[this.inlineProperty]=r+Bh)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){Mi(e)&&(this._element.style.width=e+Bh),Mi(r)&&(this._element.style.height=r+Bh)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){Mi(e)&&(this._element.style.marginTop=e+Bh),Mi(r)&&(this._element.style[`margin${po(this.inlineProperty)}`]=r+Bh)}getOffset(){const e=this._element.style,r=`margin${po(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const YWe="ht__manualColumnMove--backlight";let KWe=class extends _X{build(){super.build(),De(this._element,YWe)}};const XWe="ht__manualColumnMove--guideline";let qWe=class extends _X{build(){super.build(),De(this._element,XWe)}};Ye.getSingleton().register("beforeColumnMove");Ye.getSingleton().register("afterColumnMove");const p_="manualColumnMove",JWe=120,Rl=new WeakMap,c6="ht__manualColumnMove",Uy="show-ui",v_="on-moving--columns",y_="after-selection--columns";class ZWe extends Vt{static get PLUGIN_KEY(){return p_}static get PLUGIN_PRIORITY(){return JWe}constructor(e){super(e),Rl.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new $r(this),this.backlight=new KWe(e),this.guideline=new qWe(e)}isEnabled(){return!!this.hot.getSettings()[p_]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),De(this.hot.rootElement,c6),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ct(this.hot.rootElement,c6),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=Rl.get(this),i=n.cachedDropIndex,s=this.isMovePossible(e,r),o=this.hot.runHooks("beforeColumnMove",e,r,i,s);if(n.cachedDropIndex=void 0,o===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,r);const a=s&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,i,s,a),a}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r),i=Rl.get(this);return i.cachedDropIndex=r,this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=ai(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const o=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[p_];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return Qe(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=Rl.get(this),r=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&r>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1));const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const a=n.hider.offsetWidth,l=n.TBODY.offsetLeft,c=this.backlight.getOffset().start,u=this.backlight.getSize().width;let h=0,d=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,v=qt(this.hot.rootElement),w=g.innerWidth-e.rootElementOffset-v;d=g.innerWidth-e.target.eventPageX-w-(i.scrollX===void 0?s:0)}else d=e.target.eventPageX-(e.rootElementOffset-(i.scrollX===void 0?s:0));if(e.hasRowHeaders&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(o+=s),o+=h,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=r>0?r-1:r;else if(e.target.TD.offsetWidth/2+o<=d){const g=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=g+1,o+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let f=d,m=o;d+u+c>=a?f=a-u-c:d+c<l+h&&(f=l+h+Math.abs(c)),o>=a-1?m=a-1:m===0?m=1:i.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(m-=e.rootElementOffset<=i.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,m)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,r,n,i){const s=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=Rl.get(this),c=lt(e.target,"sortAction");if(!a||!o||l.pressed||e.button!==0||c){l.pressed=!1,l.columnsToMove.length=0,ct(this.hot.rootElement,[v_,Uy]);return}const u=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&h&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));const{from:d,to:f}=a,m=Math.min(d.col,f.col),g=Math.max(d.col,f.col);if(r.row<0&&r.col>=m&&r.col<=g){i.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=r.col,l.target.TD=n,l.target.col=r.col,l.columnsToMove=this.prepareColumnsToMoving(m,g),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=an(this.hot.rootElement).left;const v=l.hasRowHeaders?-1:0,w=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,b=r.col<l.fixedColumnsStart,x=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),C=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),S=this.getColumnsWidth(m,r.col-1)+C,E=this.getColumnsWidth(v,m-1)+(b?x:0)+S;this.backlight.setPosition(w,E),this.backlight.setSize(this.getColumnsWidth(m,g),s.hider.offsetHeight-w),this.backlight.setOffset(null,-S),De(this.hot.rootElement,v_)}else ct(this.hot.rootElement,y_),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(e){const r=Rl.get(this);if(r.pressed){if(e.target===this.backlight.element){const n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}r.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,r,n,i){const s=this.hot.getSelectedRangeLast(),o=Rl.get(this);!s||!o.pressed||(o.columnsToMove.indexOf(r.col)>-1?ct(this.hot.rootElement,Uy):De(this.hot.rootElement,Uy),i.row=!0,i.column=!0,i.cell=!0,o.hoveredColumn=r.col,o.target.TD=n)}onMouseUp(){const e=Rl.get(this),r=e.target.col,n=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,ct(this.hot.rootElement,[v_,Uy,y_]),this.hot.selection.isSelectedByColumnHeader()&&De(this.hot.rootElement,y_),n<1||r===void 0)return;const i=e.columnsToMove[0],s=this.hot.toPhysicalColumn(i),o=this.dragColumns(e.columnsToMove,r);if(e.columnsToMove.length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualColumn(s),l=a+n-1;this.hot.selectColumns(a,l)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,r=e.getColumnHeaderHeight(0)+1,n=e.holder.scrollTop,i=r+n;this.backlight.setPosition(i),this.backlight.setSize(null,e.hider.offsetHeight-i)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Wy="manualColumnResize",QWe=130,u6="manualColumnWidths",w_=new WeakMap;class e7e extends Vt{static get PLUGIN_KEY(){return Wy}static get PLUGIN_PRIORITY(){return QWe}constructor(e){super(e);const{rootDocument:r}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=r.createElement("DIV"),this.guide=r.createElement("DIV"),this.eventManager=new $r(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,w_.set(this,{config:void 0}),De(this.handle,"manualColumnResizer"),De(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Wy]}enablePlugin(){this.enabled||(this.columnWidthsMap=new Oc,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,r)=>this.onModifyColWidth(e,r)),this.addHook("beforeStretchingColumnWidth",(e,r)=>this.onBeforeStretchingColumnWidth(e,r)),this.addHook("beforeColumnResize",(e,r,n)=>this.onBeforeColumnResize(e,r,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=w_.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",u6,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",u6,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(r,null)}onMapInit(){const e=w_.get(this),r=this.hot.getSettings()[Wy],n=this.loadManualColumnWidths();typeof n<"u"?this.hot.batchExecution(()=>{n.forEach((i,s)=>{this.columnWidthsMap.setValueAtIndex(s,i)})},!0):Array.isArray(r)?(this.hot.batchExecution(()=>{r.forEach((i,s)=>{this.columnWidthsMap.setValueAtIndex(s,i)})},!0),e.config=r):r===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((i,s)=>{this.columnWidthsMap.setValueAtIndex(s,i)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(this.currentTH),i=n.col;if(i<0)return;const s=Lr(this.currentTH),o=this.currentTH.getBoundingClientRect(),a=i<r.getSetting("fixedColumnsStart");let l;a&&(l=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),l||(l=r.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.selectedCols=[];const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const u=this.hot.getSelectedRange();he(u,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;Qe(d,f,m=>{this.selectedCols.includes(m)||this.selectedCols.push(m)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(o.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(Lr(this.handle),10),r=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);De(this.handle,"active"),De(this.guide,"active"),this.guide.style.top=`${r}px`,this.refreshGuidePosition(),this.guide.style.height=`${n-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){ct(this.handle,"active"),ct(this.guide,"active")}checkIfColumnHeader(e){return!!_u(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!hY(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const r=this.getClosestTHParent(e.target);if(!r)return;const n=r.getAttribute("colspan");r&&(n===null||n==="1")&&(this.pressed||this.setupHandlePosition(r))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",this.newSize,n,!0);s!==void 0&&(this.newSize=s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(n):this.setManualSize(n,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!0),i&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(he(this.selectedCols,i=>{r(i)}),e()):he(this.selectedCols,i=>{r(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){lt(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const r=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+r,he(this.selectedCols,n=>{this.newSize=this.setManualSize(n,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},r=(n,i)=>{this.hot.runHooks("beforeColumnResize",this.newSize,n,!1),i&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(he(this.selectedCols,i=>{r(i)}),e()):he(this.selectedCols,i=>{r(i,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>this.onMouseOver(n)),this.eventManager.addEventListener(r,"mousedown",n=>this.onMouseDown(n)),this.eventManager.addEventListener(e,"mousemove",n=>this.onMouseMove(n)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,r){let n=e;if(this.enabled){const i=this.hot.toPhysicalColumn(r),s=this.columnWidthsMap.getValueAtIndex(i);this.hot.getSettings()[Wy]&&s&&(n=s)}return n}onBeforeStretchingColumnWidth(e,r){let n=this.columnWidthsMap.getValueAtIndex(r);return n===null&&(n=e),n}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const x_=0,h6=1,d6=2,Vh="px";let RX=class{constructor(e){this.hot=e,this._element=null,this.state=x_}appendTo(e){e.appendChild(this._element),this.state=d6}build(){this.state===x_&&(this._element=this.hot.rootDocument.createElement("div"),this.state=h6)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=x_}isAppended(){return this.state===d6}isBuilt(){return this.state>=h6}setPosition(e,r){e!==void 0&&(this._element.style.top=e+Vh),r!==void 0&&(this._element.style.left=r+Vh)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+Vh),r&&(this._element.style.height=r+Vh)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+Vh),r&&(this._element.style.marginLeft=r+Vh)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const t7e="ht__manualRowMove--backlight";class r7e extends RX{build(){super.build(),De(this._element,t7e)}}const n7e="ht__manualRowMove--guideline";class i7e extends RX{build(){super.build(),De(this._element,n7e)}}Ye.getSingleton().register("beforeRowMove");Ye.getSingleton().register("afterRowMove");const b_="manualRowMove",s7e=140,Al=new WeakMap,f6="ht__manualRowMove",zy="show-ui",S_="on-moving--rows",C_="after-selection--rows";class o7e extends Vt{static get PLUGIN_KEY(){return b_}static get PLUGIN_PRIORITY(){return s7e}constructor(e){super(e),Al.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new $r(this),this.backlight=new r7e(e),this.guideline=new i7e(e)}isEnabled(){return!!this.hot.getSettings()[b_]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),De(this.hot.rootElement,f6),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ct(this.hot.rootElement,f6),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=Al.get(this),i=n.cachedDropIndex,s=this.isMovePossible(e,r),o=this.hot.runHooks("beforeRowMove",e,r,i,s);if(n.cachedDropIndex=void 0,o===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,r);const a=s&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,i,s,a),a}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r),i=Al.get(this);return i.cachedDropIndex=r,this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=ai(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const o=n.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[b_];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return Qe(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=Al.get(this),r=e.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(r.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(r.row)&&i<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=e.target.TD,l=this.hot.rootElement,c=an(l),u=xf(l),h=o.holder.scrollTop;let d;this.hot.rootWindow===u?d=u.scrollY:d=u.scrollTop;const f=c.top-d,m=e.target.eventPageY-f+h,g=o.hider.offsetHeight,v=o.TBODY.offsetTop,w=this.backlight.getOffset().top,b=this.backlight.getSize().height,x=a.offsetHeight/2,C=a.offsetHeight;let S=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,r.row-1);const E=m>=S+x;this.isFixedRowTop(r.row)&&(S+=o.holder.scrollTop),r.row<0?e.target.row=n>0?n-1:n:E?(e.target.row=r.row+1,S+=r.row===0?C-1:C):e.target.row=r.row;let T=m,I=S;m+b+w>=g?T=g-b-w:m+w<v&&(T=v+Math.abs(w)),S>=g-1&&(I=g-1),this.backlight.setPosition(T),this.guideline.setPosition(I)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,r,n,i){const{wtTable:s,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),c=Al.get(this);if(!l||!a||c.pressed||e.button!==0){c.pressed=!1,c.rowsToMove.length=0,ct(this.hot.rootElement,[S_,zy]);return}const u=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&h&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));const{from:d,to:f}=l,m=Math.min(d.row,f.row),g=Math.max(d.row,f.row);if(r.col<0&&r.row>=m&&r.row<=g){i.row=!0,c.pressed=!0,c.target.eventPageY=e.pageY,c.target.coords=r,c.target.TD=n,c.rowsToMove=this.prepareRowsToMoving();const v=s.holder.scrollLeft+o.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(s.hider.offsetWidth-v,this.getRowsHeight(m,g)),this.backlight.setOffset((this.getRowsHeight(m,r.row-1)+e.offsetY)*-1,null),De(this.hot.rootElement,S_),this.refreshPositions()}else ct(this.hot.rootElement,C_),c.pressed=!1,c.rowsToMove.length=0}onMouseMove(e){const r=Al.get(this);if(r.pressed){if(e.target===this.backlight.element){const n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}r.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,r,n,i){const s=this.hot.getSelectedRangeLast(),o=Al.get(this);!s||!o.pressed||(o.rowsToMove.indexOf(r.row)>-1?ct(this.hot.rootElement,zy):De(this.hot.rootElement,zy),i.row=!0,i.column=!0,i.cell=!0,o.target.coords=r,o.target.TD=n)}onMouseUp(){const e=Al.get(this),r=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,ct(this.hot.rootElement,[S_,zy,C_]),this.hot.selection.isSelectedByRowHeader()&&De(this.hot.rootElement,C_),n<1||r===void 0)return;const i=e.rowsToMove[0],s=this.hot.toPhysicalRow(i),o=this.dragRows(e.rowsToMove,r);if(e.rowsToMove.length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualRow(s),l=a+n-1;this.hot.selectRows(a,l)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=e.holder.scrollLeft,i=r+n;this.backlight.setPosition(null,i),this.backlight.setSize(e.hider.offsetWidth-i)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Gy="manualRowResize",a7e=30,g6="manualRowHeights",E_=new WeakMap;class l7e extends Vt{static get PLUGIN_KEY(){return Gy}static get PLUGIN_PRIORITY(){return a7e}constructor(e){super(e);const{rootDocument:r}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=r.createElement("DIV"),this.guide=r.createElement("DIV"),this.eventManager=new $r(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,E_.set(this,{config:void 0}),De(this.handle,"manualRowResizer"),De(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Gy]}enablePlugin(){this.enabled||(this.rowHeightsMap=new Oc,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,r)=>this.onModifyRowHeight(e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=E_.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",g6,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",g6,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,GS.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,i),i}setupHandlePosition(e){this.currentTH=e;const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(this.currentTH),s=i.row;if(s<0)return;const o=qt(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=s<n.getSetting("fixedRowsTop"),c=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let u;l?u=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col):c&&(u=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),u||(u=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),this.selectedRows=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();he(d,f=>{const m=f.getTopStartCorner().row,g=f.getBottomStartCorner().row;Qe(m,g,v=>{this.selectedRows.includes(v)||this.selectedRows.push(v)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=u.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${u.start}px`,this.handle.style.width=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(qt(this.handle),10),r=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);De(this.handle,"active"),De(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${r}px`,this.guide.style.width=`${n-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){ct(this.handle,"active"),ct(this.guide,"active")}checkIfRowHeader(e){var r;return _u(e,["TH"],this.hot.rootElement)&&((r=e.parentNode)===null||r===void 0||(r=r.parentNode)===null||r===void 0?void 0:r.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&this.newSize<r?r:this.newSize}onMouseOver(e){if(!hY(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const r=this.getClosestTHParent(e.target);r&&(this.pressed||this.setupHandlePosition(r))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&(this.newSize=s),this.setManualSize(n,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(he(this.selectedRows,i=>{r(i)}),e()):he(this.selectedRows,i=>{r(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){lt(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),he(this.selectedRows,r=>{this.newSize=this.setManualSize(r,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},r=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(he(this.selectedRows,i=>{r(i)}),e()):he(this.selectedRows,i=>{r(i,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>this.onMouseOver(n)),this.eventManager.addEventListener(e,"mousedown",n=>this.onMouseDown(n)),this.eventManager.addEventListener(r,"mousemove",n=>this.onMouseMove(n)),this.eventManager.addEventListener(r,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,r){let n=e;if(this.enabled){const i=this.hot.toPhysicalRow(r),s=this.rowHeightsMap.getValueAtIndex(i);this.hot.getSettings()[Gy]&&s&&(n=s)}return n}onMapInit(){const e=E_.get(this),r=this.hot.getSettings()[Gy],n=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof n<"u"?n.forEach((i,s)=>{this.rowHeightsMap.setValueAtIndex(s,i)}):Array.isArray(r)?(r.forEach((i,s)=>{this.rowHeightsMap.setValueAtIndex(s,i)}),e.config=r):r===!0&&Array.isArray(e.config)&&e.config.forEach((i,s)=>{this.rowHeightsMap.setValueAtIndex(s,i)})},!0)}destroy(){super.destroy()}}class $o{constructor(e,r,n,i,s,o){this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){return Jt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return Jt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return Jt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return Jt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,i),l=Math.max(r,i),c=this[o],u=this[o]+this[s]-1;if(c>=r&&(this[o]+=n),n>0)r<=u&&r>c&&(this[s]+=n);else if(n<0){if(a<=c&&l>=u)return this.removed=!0,!1;if(c>=a&&c<=l){const h=l-c+1,d=Math.abs(n)-h;this[o]-=d+n,this[s]-=h}else if(c<=a&&u>=l)this[s]+=n;else if(c<=a&&u>=a&&u<l){const h=u-a+1;this[s]-=h}}return!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}function fk(t,e,r,n){e?e.row===r&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}class KP{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return Jt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){const n=this.mergedCells;let i=!1;return he(n,s=>s.row<=e&&s.row+s.rowspan-1>=e&&s.col<=r&&s.col+s.colspan-1>=r?(i=s,!1):!0),i}getByRange(e){const r=this.mergedCells;let n=!1;return he(r,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(n=i,n):!0),n}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCells,i=[];let s=e;if(!s.includesRange){const o=this.hot._createCellCoords(s.from.row,s.from.col),a=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(o,o,a)}return he(n,o=>{const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1),c=this.hot._createCellRange(a,a,l);r?s.overlaps(c)&&i.push(o):s.includesRange(c)&&i.push(o)}),i.length?i:!1}add(e){const r=this.mergedCells,n=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new $o(n,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,i),c=this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),r.push(a),a):(lr(KP.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const n=this.mergedCells,i=this.get(e,r),s=i?this.mergedCells.indexOf(i):-1;return i&&s!==-1?(n.splice(s,1),i):!1}clear(){const e=this.mergedCells,r=[],n=[];he(e,i=>{const s=this.hot.getCell(i.row,i.col);s&&r.push([s,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,he(r,(i,s)=>{Qe(0,i.rowspan-1,o=>{Qe(0,i.colspan-1,a=>{if(a!==0||o!==0){const l=this.hot.getCell(i.row+o,i.col+a);l&&n.push([l,null,null,null])}})}),r[s][1]=null}),he(r,i=>{fk(...i)}),he(n,i=>{fk(...i)})}isOverlapping(e){const r=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let n=!1;return he(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(r)?(n=!0,!1):!0),n}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}he(this.mergedCells,s=>{s.shift(i,r)}),WO(this.mergedCells.length-1,0,s=>{const o=this.mergedCells[s];o&&o.removed&&this.mergedCells.splice(this.mergedCells.indexOf(o),1)})}}class c7e{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),o=this.getAutofillSize(e,r,n),[a,l,c,u]=e,d=["up","down"].indexOf(n)>-1?c-a+1:u-l+1,f=Math.floor(o/d)*d,m=o-f,g=this.getFarthestCollection(e,r,n,i);if(g){if(n==="down"){const v=g.row+g.rowspan-a-m;s[2]+v>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?v:0}else if(n==="right"){const v=g.col+g.colspan-l-m;s[3]+v>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?v:0}else if(n==="up"){const v=c-m-g.row+1;s[0]+v<0?s[0]+=m:s[0]-=m?v:0}else if(n==="left"){const v=u-m-g.col+1;s[1]+v<0?s[1]+=m:s[1]-=m?v:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),cn(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,o,a]=e,[l,c,u,h]=r;switch(n){case"up":return i-l;case"down":return u-o;case"left":return s-c;case"right":return h-a;default:return null}}getDragArea(e,r,n){const[i,s,o,a]=e,[l,c,u,h]=r;switch(n){case"up":return[l,c,i-1,a];case"down":return[o+1,s,u,a];case"left":return[l,c,o,s-1];case"right":return[i,a+1,u,h];default:return null}}getFarthestCollection(e,r,n,i){const[s,o,a,l]=e,c=["up","down"].indexOf(n)>-1,u=c?a:l,h=c?s:o,d=this.getAutofillSize(e,r,n),f=c?a-s+1:l-o+1,m=Math.floor(d/f)*f,g=d-m;let v=null,w=null,b=null;switch(n){case"up":v="includesVertically",b=u-g+1;break;case"left":v="includesHorizontally",b=u-g+1;break;case"down":v="includesVertically",b=h+g-1;break;case"right":v="includesHorizontally",b=h+g-1;break}return he(i,x=>{x[v](b)&&x.isFarther(w,n)&&(w=x)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(c,u)=>{switch(i){case"up":return c.row-u>=r.from.row;case"down":return c.row+c.rowspan-1+u<=r.to.row;case"left":return c.col-u>=r.from.column;case"right":return c.col+c.colspan-1+u<=r.to.column;default:return null}};let o=0,a=null,l=1;do for(let c=0;c<n.length;c+=1){if(a=n[c],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}c===n.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return he(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,o,a,l]=i,c=this.plugin.hot._createCellCoords(s,o),u=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(c,c,u);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}class u7e{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,r,n){const i=r.to,s=i.row+e.row,o=i.col+e.col;e.row?this.jumpOverMergedCell(e,n,s):e.col&&this.jumpOverMergedCell(e,n,o)}jumpOverMergedCell(e,r,n){let i=e.row||e.col,s=null,o=null,a=null;e.row?(s=r.includesVertically(n),o=r.row,a=r.getLastRow()):e.col&&(s=r.includesHorizontally(n),o=r.col,a=r.getLastColumn()),i!==0&&(i>0?s&&n!==o&&(i+=a-n+1):s&&n!==a&&(i-=n-o+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,r){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+r.row,e.to.col+r.col))}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const u=this.plugin.mergedCellsCollection.get(e,r);if(!u)return;const h=u.getLastRow(),d=u.getLastColumn();if(s<=u.row&&o<=u.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function h7e(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(yM)}return this.getTranslatedPhrase(vM)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?$o.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}Ye.getSingleton().register("beforeMergeCells");Ye.getSingleton().register("afterMergeCells");Ye.getSingleton().register("beforeUnmergeCells");Ye.getSingleton().register("afterUnmergeCells");const hm="mergeCells",d7e=150,m6=new WeakMap,p6=hm;class f7e extends Vt{static get PLUGIN_KEY(){return hm}static get PLUGIN_PRIORITY(){return d7e}constructor(e){super(e),m6.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[hm]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new KP(this),this.autofillCalculations=new c7e(this),this.selectionCalculations=new u7e(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[hm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!yY())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let o=i+1;o<i+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=l0(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=l0(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let r=!0;return e?($o.containsNegativeValues(e)?(lr($o.NEGATIVE_VALUES_WARNING(e)),r=!1):$o.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(lr($o.IS_OUT_OF_BOUNDS_WARNING(e)),r=!1):$o.isSingleCell(e)?(lr($o.IS_SINGLE_CELL(e)),r=!1):$o.containsZeroSpan(e)&&(lr($o.ZERO_SPAN_WARNING(e)),r=!1),r):!1}generateFromSettings(e){if(Array.isArray(e)){const r=[];if(he(e,n=>{if(!this.validateSetting(n))return;const i=this.hot._createCellCoords(n.row,n.col),s=this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1),o=this.hot._createCellRange(i,i,s);this.mergeRange(o,!0,!0),Qe(n.row,n.row+n.rowspan-1,a=>{Qe(n.col,n.col+n.colspan-1,l=>{a===n.row&&l===n.col||r.push([a,l,null])})})}),r.length===0)return;this.hot.setDataAtCell(r)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.toggleMerge(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),Qe(0,o.rowspan-1,u=>{Qe(0,o.colspan-1,h=>{let d=null;a[u]||(a[u]=[]),u===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+u,o.col+h,"hidden",!0),a[u][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o)?(n?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),l):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n&&(this.hot.runHooks("beforeUnmergeCells",e,r),he(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),Qe(0,i.rowspan-1,s=>{Qe(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const r=this.mergedCellsCollection.get(e.from.row,e.from.col);r.row===e.from.row&&r.col===e.from.col&&r.row+r.rowspan-1===e.to.row&&r.col+r.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[hm]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:n=>!n.altKey,group:p6})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(p6)}onAfterIsMultipleSelection(e){if(e){const r=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let i=0;i<r.length;i+=1)if(n.from.row===r[i].row&&n.from.col===r[i].col&&n.to.row===r[i].row+r[i].rowspan-1&&n.to.col===r[i].col+r[i].colspan-1)return!1}return e}onModifyTransformStart(e){const r=m6.get(this),n=this.hot.getSelectedRangeLast();let i={row:e.row,col:e.col},s=null;const o=this.hot._createCellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(o.row,o.col);if(r.lastDesiredCoords||(r.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){const c=this.hot._createCellCoords(a.row,a.col),u=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);this.hot._createCellRange(c,c,u).includes(r.lastDesiredCoords)||(r.lastDesiredCoords=this.hot._createCellCoords(null,null)),i.row=r.lastDesiredCoords.row?r.lastDesiredCoords.row-o.row:i.row,i.col=r.lastDesiredCoords.col?r.lastDesiredCoords.col-o.col:i.col,e.row>0?i.row=a.row+a.rowspan-1-o.row+e.row:e.row<0&&(i.row=o.row-a.row+e.row),e.col>0?i.col=a.col+a.colspan-1-o.col+e.col:e.col<0&&(i.col=o.col-a.col+e.col)}s=this.hot._createCellCoords(n.highlight.row+i.row,n.highlight.col+i.col);const l=this.mergedCellsCollection.get(s.row,s.col);if(l){const c=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);r.lastDesiredCoords=s,i={row:c.row-o.row,col:c.col-o.col}}i.row!==0&&(e.row=i.row),i.col!==0&&(e.col=i.col)}onModifyTransformEnd(e){const r=this.hot.getSelectedRangeLast(),n=Li(e),i=this.selectionCalculations.getUpdatedSelectionRange(r,e);let s=Li(n);const o=this.mergedCellsCollection.getWithinRange(i,!0);do s=Li(n),this.selectionCalculations.getUpdatedSelectionRange(r,n),he(o,a=>{this.selectionCalculations.snapDelta(n,r,a)});while(n.row!==s.row||n.col!==s.col);e.row=n.row,e.col=n.col}onModifyGetCellCoords(e,r){if(e<0||r<0)return;const n=this.mergedCellsCollection.get(e,r);if(!n)return;const{row:i,col:s,colspan:o,rowspan:a}=n;return[i,s,i+a-1,s+o-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},h7e(this))}onAfterRenderer(e,r,n){const i=this.mergedCellsCollection.get(r,n),s=wt(i)?Li(i):void 0;if(wt(s)){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot,{row:l,col:c,colspan:u,rowspan:h}=s,[d,f]=this.translateMergedCellToRenderable(l,h,c,u),m=o.getRenderableFromVisualIndex(r),g=a.getRenderableFromVisualIndex(n),v=d-m+1,w=f-g+1;s.row=o.getNearestNotHiddenIndex(s.row,1),s.col=a.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,v),s.colspan=Math.min(s.colspan,w)}fk(e,s,r,n)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const r=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[r.row,r.col]}}onBeforeSetRangeEnd(e){const r=this.hot.getSelectedRangeLast();r.highlight=this.hot._createCellCoords(r.highlight.row,r.highlight.col),r.to=e;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){const o=this.mergedCellsCollection.mergedCells[i].getRange();r.expandByRange(o)&&(e.row=r.to.row,e.col=r.to.col,n=!0)}}while(n)}onAfterGetCellMeta(e,r,n){const i=this.mergedCellsCollection.get(e,r);i&&(i.row!==e||i.col!==r?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}onAfterViewportRowCalculatorOverride(e){const r=this.hot.countCols();this.modifyViewportRowStart(e,r),this.modifyViewportRowEnd(e,r)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(wt(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(wt(o)){const a=o.row+o.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,r);return}}}}onAfterViewportColumnCalculatorOverride(e){const r=this.hot.countRows();this.modifyViewportColumnStart(e,r),this.modifyViewportColumnEnd(e,r)}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(wt(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(wt(o)){const a=o.col+o.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?l=o.getNearestNotHiddenIndex(n,1):l=o.getNearestNotHiddenIndex(n+i-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(a):e,u=n>=0?o.getRenderableFromVisualIndex(l):n;return[c,u]}onModifyAutofillRange(e,r){this.autofillCalculations.correctSelectionAreaSize(r);const n=this.autofillCalculations.getDirection(r,e);let i=e;if(this.autofillCalculations.dragAreaOverlapsCollections(r,i,n))return i=r,i;const s=this.mergedCellsCollection.getWithinRange({from:{row:r[0],col:r[1]},to:{row:r[2],col:r[3]}});return s&&(i=this.autofillCalculations.snapDragArea(r,i,n,s)),i}onAfterCreateCol(e,r){this.mergedCellsCollection.shiftCollections("right",e,r)}onAfterRemoveCol(e,r){this.mergedCellsCollection.shiftCollections("left",e,r)}onAfterCreateRow(e,r,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,r)}onAfterRemoveRow(e,r){this.mergedCellsCollection.shiftCollections("up",e,r)}onAfterChange(e,r){r==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,r){if(r&&r==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);he(i,s=>{n.getBottomEndCorner().row===s.getLastRow()&&n.getBottomEndCorner().col===s.getLastColumn()&&(e[2]=s.row,e[3]=s.col)})}}onAfterModifyTransformStart(e,r,n){if(!this.enabled)return;const i=this.mergedCellsCollection.get(e.row,e.col);if(!i)return;const s=r>0,o=r<0,a=n<0,l=n>0,c=i.row+i.rowspan-1===this.hot.countRows()-1,u=i.row===0,h=i.col+i.colspan-1===this.hot.countCols()-1,d=i.col===0;(s&&c||o&&u||l&&h||a&&d)&&(e.row=i.row,e.col=i.col)}onAfterDrawSelection(e,r,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,r,n,i)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function g7e(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function o(a){const l=t[a],c=e[a],u=i[a],h=s[a],d=c.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:jK(c.type))(l,c,d)(u,h);if(m===Jo){const g=a+1;if(typeof e[g]<"u")return o(g)}return m}(0)}}function v6(){lr(Jt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const AX="sort";function m7e(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${AX}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function p7e(t){const e=t.className.split(" "),r=new RegExp(`^${AX}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}const gk="multiColumnSorting",v7e=170,y7e="append",y6="columnSorting";HK(gk,g7e);class w7e extends BK{static get PLUGIN_KEY(){return gk}static get PLUGIN_PRIORITY(){return v7e}constructor(e){super(e),this.pluginKey=gk}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[y6]&&v6(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),ct(e,p7e(e)),this.enabled!==!1&&De(e,m7e(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[y6]&&v6(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,r){sk(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,y7e))):this.sort(this.getColumnNextConfig(r.col)))}}const x7e="multipleSelectionHandles",b7e=160;class S7e extends Vt{static get PLUGIN_KEY(){return x7e}static get PLUGIN_PRIORITY(){return b7e}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return Go()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new $r(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(lt(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(lt(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(lt(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(lt(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,c,u,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,u,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner();let u={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?u={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(u={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?u={start:r,end:l}:u.end=r;break;case"NW-SE":s==="top"?u={start:r,end:a}:u.end=r;break;case"SE-NW":s==="top"?u={start:r,end:o}:u.end=r;break;case"SW-NE":s==="top"?u={start:r,end:c}:u.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?u={start:this.hot._createCellCoords(r.row,c.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(u={start:l,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(u.end=r);break;case"SE-NW":s==="top"?u.end=r:u={start:r,end:o};break}break}return u}isDragged(){return this.dragged.length>0}}function mk(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l}}function OX(){return{label:"",isPlaceholder:!0}}function C7e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;he(t,i=>{const s=[];let o=0;r.push(s),he(i,a=>{const l=mk();if(wt(a)){const{label:u,colspan:h}=a;l.label=Zr(u),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Zr(a);o+=l.origColspan;let c=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,c=!0),s.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)s.push(OX());return!c})});const n=Math.max(...yt(r,i=>i.length));return he(r,i=>{if(i.length<n){const s=yt(new Array(n-i.length),()=>mk());i.splice(i.length,0,...s)}}),r}function T_(t,e,r){E7e(t,e),e.set(t,r)}function E7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Js(t,e){var r=kX(t,e,"get");return T7e(t,r)}function T7e(t,e){return e.get?e.get.call(t):e.value}function qg(t,e,r){var n=kX(t,e,"set");return _7e(t,n,r),r}function kX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function _7e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}const w6=["label","collapsible"];var Sa=new WeakMap,Xc=new WeakMap,__=new WeakMap;class R7e{constructor(){T_(this,Sa,{writable:!0,value:[]}),T_(this,Xc,{writable:!0,value:0}),T_(this,__,{writable:!0,value:1/0})}setColumnsLimit(e){qg(this,__,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];qg(this,Sa,C7e(e,Js(this,__))),qg(this,Xc,Js(this,Sa).length)}getData(){return Js(this,Sa)}mergeWith(e){he(e,r=>{let{row:n,col:i,...s}=r;const o=this.getHeaderSettings(n,i);o!==null&&cn(o,s,w6)})}map(e){he(Js(this,Sa),r=>{he(r,n=>{const i=e({...n});wt(i)&&cn(n,i,w6)})})}getHeaderSettings(e,r){var n;if(e>=Js(this,Xc)||e<0)return null;const i=Js(this,Sa)[e];return r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Js(this,Xc)||e<0)return i;const s=Js(this,Sa)[e];let o=0;for(let a=r;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Js(this,Xc)}getColumnsCount(){return Js(this,Xc)>0?Js(this,Sa)[0].length:0}clear(){qg(this,Sa,[]),qg(this,Xc,0)}}function R_(t,e,r){return e=A7e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A7e(t){var e=O7e(t,"string");return typeof e=="symbol"?e:String(e)}function O7e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k7e="DF-pre-order";function IX(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=IX.call(this.childs[n],t,e)}return r}const I7e="DF-post-order";function NX(t,e){for(let r=0;r<this.childs.length;r++)if(NX.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const MX="BF";function N7e(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const M7e=MX,x6=new Map([[k7e,IX],[I7e,NX],[MX,N7e]]);class V1{constructor(e){R_(this,"data",{}),R_(this,"parent",null),R_(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new V1({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:M7e;if(!x6.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);x6.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function A_(t,e,r){P7e(t,e),e.set(t,r)}function P7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(t,e){var r=PX(t,e,"get");return D7e(t,r)}function D7e(t,e){return e.get?e.get.call(t):e.value}function L7e(t,e,r){var n=PX(t,e,"set");return F7e(t,n,r),r}function PX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function F7e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Uh=new WeakMap,qc=new WeakMap,Wh=new WeakMap;class $7e{constructor(e){A_(this,Uh,{writable:!0,value:new Map}),A_(this,qc,{writable:!0,value:new Map}),A_(this,Wh,{writable:!0,value:null}),L7e(this,Wh,e)}getRoots(){return Array.from(ui(this,Uh).values())}getRootByColumn(e){let r;return ui(this,qc).has(e)&&(r=ui(this,Uh).get(ui(this,qc).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-ui(this,qc).get(r);let s=0,o;return n.walkDown(a=>{const{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;ui(this,qc).clear(),he(ui(this,Uh),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)ui(this,qc).set(i,e);e+=n})}buildTree(){this.clear();const e=ui(this,Wh).getColumnsCount();let r=0;for(;r<e;){const n=ui(this,Wh).getHeaderSettings(0,r),i=new V1;ui(this,Uh).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=ui(this,Wh).getHeadersSettings(n,r,i);n+=1,he(s,o=>{const a={...o,headerLevel:n-1,columnIndex:r};let l;n===1?(e.data=a,l=e):(l=new V1(a),e.addChild(l)),n<ui(this,Wh).getLayersCount()&&this.buildLeaves(l,r,n,o.origColspan),r+=o.origColspan})}clear(){ui(this,Uh).clear(),ui(this,qc).clear()}}function DX(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function U1(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function W1(t){return U1(t,"origColspan")===t.data.origColspan}function XP(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(W1(t))return XP(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let o=0;if(i.length>0)he(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,DX(a,c=>{s.add(c)})});else{const{colspan:a,origColspan:l,columnIndex:c}=e;o=l-a;for(let u=1;u<l;u++)s.add(c+u)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):W1(a)&&(l.isCollapsed=U1(a,"isCollapsed"))}),{rollbackModification:()=>qP(t),affectedColumns:Array.from(s),colspanCompensation:o}}function qP(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(W1(t))return qP(n[0]);r.isCollapsed=!0;const s=n.slice(1),o=new Set;if(s.length>0)he(s,l=>{DX(l,c=>{o.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{const{origColspan:l,columnIndex:c}=r;for(let u=1;u<l;u++){const h=c+u;o.add(h)}}const a=r.colspan-((e=U1(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):W1(l)&&(c.isCollapsed=U1(l,"isCollapsed"))}),{rollbackModification:()=>XP(t),affectedColumns:Array.from(o),colspanCompensation:a}}function H7e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Jt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function j7e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Jt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const b6=new Map([["collapse",qP],["expand",XP],["hide-column",H7e],["show-column",j7e]]);function B7e(t,e,r){if(!b6.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return b6.get(t)(e,r)}function Yy(t){const e=[];return he(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,c=U7e(e,a);let u=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||u)c.push(OX());else{const f=V7e(i);f.isRoot=!0,c.push(f),u=!0}})}),e}function V7e(t){const{crossHiddenColumns:e,...r}=mk(t);return r}function U7e(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function O_(t,e,r){W7e(t,e),e.set(t,r)}function W7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jg(t,e,r){var n=LX(t,e,"set");return z7e(t,n,r),r}function z7e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Br(t,e){var r=LX(t,e,"get");return G7e(t,r)}function LX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function G7e(t,e){return e.get?e.get.call(t):e.value}var Mo=new WeakMap,Wi=new WeakMap,Jc=new WeakMap;class Y7e{constructor(){O_(this,Mo,{writable:!0,value:new R7e}),O_(this,Wi,{writable:!0,value:new $7e(Br(this,Mo))}),O_(this,Jc,{writable:!0,value:[[]]})}setState(e){Br(this,Mo).setData(e);let r=!1;try{Br(this,Wi).buildTree()}catch{Br(this,Wi).clear(),Br(this,Mo).clear(),r=!0}return Jg(this,Jc,Yy(Br(this,Wi).getRoots())),r}setColumnsLimit(e){Br(this,Mo).setColumnsLimit(e)}mergeStateWith(e){const r=yt(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Br(this,Mo).mergeWith(r),Br(this,Wi).buildTree(),Jg(this,Jc,Yy(Br(this,Wi).getRoots()))}mapState(e){Br(this,Mo).map(e),Br(this,Wi).buildTree(),Jg(this,Jc,Yy(Br(this,Wi).getRoots()))}mapNodes(e){return ai(Br(this,Wi).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=Br(this,Wi).getNode(r,n);let s;return i&&(s=B7e(e,i,n),Jg(this,Jc,Yy(Br(this,Wi).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=Br(this,Jc)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=Br(this,Wi).getNode(e,r);return n?{...n.data}:null}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}getLayersCount(){return Br(this,Mo).getLayersCount()}getColumnsCount(){return Br(this,Mo).getColumnsCount()}clear(){Jg(this,Jc,[]),Br(this,Mo).clear(),Br(this,Wi).clear()}}function Zg(t,e,r){return e=K7e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K7e(t){var e=X7e(t,"string");return typeof e=="symbol"?e:String(e)}function X7e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q7e{constructor(e,r){Zg(this,"hot",void 0),Zg(this,"nestedHeaderSettingsGetter",void 0),Zg(this,"layersCount",0),Zg(this,"container",void 0),Zg(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(let n=0;n<r;n++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const c=r.createElement("tr");for(let u=0;u<a;u++){let h=n.getVisualFromRenderableIndex(u);h===null&&(h=u);const d=r.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),tg(d,m),d.colSpan=f.colspan,c.appendChild(d)}}s.appendChild(c)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function S6(t,e,r){return e=J7e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J7e(t){var e=Z7e(t,"string");return typeof e=="symbol"?e:String(e)}function Z7e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function C6(t,e,r){Q7e(t,e),e.set(t,r)}function Q7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ky(t,e,r){var n=FX(t,e,"set");return eze(t,n,r),r}function eze(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Ir(t,e){var r=FX(t,e,"get");return tze(t,r)}function FX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function tze(t,e){return e.get?e.get.call(t):e.value}const E6="nestedHeaders",rze=280;var Kr=new WeakMap,Ol=new WeakMap;class nze extends Vt{constructor(){super(...arguments),C6(this,Kr,{writable:!0,value:new Y7e}),C6(this,Ol,{writable:!0,value:null}),S6(this,"ghostTable",new q7e(this.hot,(e,r)=>this.getHeaderSettings(e,r))),S6(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return E6}static get PLUGIN_PRIORITY(){return rze}isEnabled(){return!!this.hot.getSettings()[E6]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&lr(Jt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",n=>this.onAfterGetColumnHeaderRenderers(n)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ir(this,Kr).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ir(this,Kr).setState(e)),this.detectedOverlappedHeaders&&lr(Jt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Ir(this,Kr).triggerColumnModification(i,n)}),!Ir(this,Ol)&&this.enabled&&Ky(this,Ol,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:o}=n;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Ir(this,Kr).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ir(this,Kr).clear(),Ir(this,Ol).unsubscribe(),Ky(this,Ol,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ir(this,Kr)}getLayersCount(){return Ir(this,Kr).getLayersCount()}getHeaderSettings(e,r){return Ir(this,Kr).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=n.childNodes[o];if(!a)break;const l=i.childNodes[o],c=s?s.childNodes[o]:null;for(let u=0,h=a.childNodes.length;u<h;u++)a.childNodes[u].removeAttribute("colspan"),ct(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),ct(l.childNodes[u],"hiddenHeader")),s&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),ct(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let c=a.getVisualFromRenderableIndex(i);c===null&&(c=i),s.removeAttribute("colspan"),ct(s,"hiddenHeader");const{colspan:u,isHidden:h,isPlaceholder:d}=(o=Ir(this,Kr).getHeaderSettings(e,c))!==null&&o!==void 0?o:{};if(d||h)De(s,"hiddenHeader");else if(u>1){var f,m;const{wtOverlays:g}=l._wt,v=(f=g.topInlineStartCornerOverlay)===null||f===void 0?void 0:f.clone.wtTable.THEAD.contains(s),w=(m=g.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),b=v||w?Math.min(u,n-i):u;b>1&&s.setAttribute("colspan",b)}this.hot.view.appendColHeader(c,s,function(){return r.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Ir(this,Kr).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}onBeforeHighlightingColumnHeader(e,r,n){const i=Ir(this,Kr).getHeaderTreeNodeData(r,e);if(!i)return e;const{classNames:s,columnCursor:o,selectionType:a,selectionWidth:l}=n,{isRoot:c,colspan:u}=Ir(this,Kr).getHeaderSettings(r,e);if(a===av){if(!c)return i.columnIndex}else a===QS&&(u>l-o||!c)&&(s.length=0);return e}onBeforeCopy(e,r,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<r.length;o++){const{startRow:a,startCol:l,endRow:c,endCol:u}=r[o],h=c-a+1,d=l-u+1;if(a>=0||d===1)break;for(let f=l;f<=u;f++)for(let m=a;m<=c;m++){var s;const g=h+m,v=f-l;if(v===0)continue;((s=Ir(this,Kr).getHeaderTreeNodeData(m,f))===null||s===void 0?void 0:s.isRoot)===!1&&(e[g][v]="")}}}onBeforeOnCellMouseDown(e,r,n,i){this._getHeaderTreeNodeDataByCoords(r)&&(i.column=!0)}onAfterOnCellMouseDown(e,r){const n=this._getHeaderTreeNodeDataByCoords(r);if(!n)return;const{selection:i}=this.hot,s=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:l}=n,c=!i.inInSelection(r);e.shiftKey&&s?r.col<s.from.col?o.push(s.getTopEndCorner().col,a,r.row):r.col>s.from.col?o.push(s.getTopStartCorner().col,a+l-1,r.row):o.push(a,a+l-1,r.row):(kN(e)||Vu(e)&&c)&&o.push(a,a+l-1,r.row),i.selectColumns(...o)}onBeforeOnCellMouseOver(e,r,n,i){if(!this.hot.view.isMouseDown())return;const s=this._getHeaderTreeNodeDataByCoords(r);if(!s)return;const{columnIndex:o,origColspan:a}=s,l=this.hot.getSelectedRangeLast(),c=l.getTopStartCorner(),u=l.getBottomEndCorner(),{from:h}=l;i.column=!0,i.cell=!0;const d=[];r.col<h.col?d.push(u.col,o):r.col>h.col?d.push(c.col,o+a-1):d.push(o,o+a-1),this.hot.selectColumns(...d)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let r=0;r<Ir(this,Kr).getLayersCount();r++)e.push(this.headerRendererFactory(r))}onAfterViewportColumnCalculatorOverride(e){const r=Ir(this,Kr).getLayersCount();let n=e.startColumn,i=!!r;for(let s=0;s<r;s++){const o=Ir(this,Kr).findLeftMostColumnIndex(s,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Mi(a)&&a<e.startColumn){n=a;break}}e.startColumn=i?Ir(this,Kr).getHeaderTreeNodeData(0,n).columnIndex:n}onModifyColWidth(e,r){const n=this.ghostTable.getWidth(r);return e>n?e:n}onModifyColumnHeaderValue(e,r,n){var i;const{label:s}=(i=Ir(this,Kr).getHeaderTreeNodeData(n,r))!==null&&i!==void 0?i:{label:""};return s}onInit(){this.updatePlugin()}onAfterLoadData(e,r){r||this.updatePlugin()}destroy(){Ky(this,Kr,null),Ir(this,Ol)!==null&&(Ir(this,Ol).unsubscribe(),Ky(this,Ol,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ir(this,Kr).getHeaderTreeNodeData(e.row,e.col)}}class ize{constructor(e,r){this.hot=r,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Qe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&he(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),n!=null&&o===n?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&he(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,n,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return bt(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(he(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(Qe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),Qe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),l=this.getRowParent(n),c=this.getRowParent(l),u=this.getRowIndex(c);let h=null;if(this.hot.runHooks("beforeDetachChild",l,n),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),c){h=u+this.countChildren(c);const f=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),c.__children.push(n)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];he(n,s=>{i.push(this.getDataObject(s))}),he(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(o,r,...n):s.__children.splice(o,r):n?this.data.splice(o,r,...n):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=null;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),c=e>r;let u=s?this.getRowParent(r-1):this.getRowParent(r);u==null&&(u=this.getRowParent(r-1)),u==null&&(u=this.getDataObject(r-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(r),u.__children=[]);const h=s||n||i?u.__children.length:this.getRowIndexWithinParent(r),d=o===u;u.__children.splice(h,0,l[0]),o.__children.splice(a+(c&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}class JP{constructor(e,r){this.hot=r,this.plugin=e}}class jo extends JP{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]');if(he(l,c=>{c&&o.removeChild(c)}),De(r,jo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,u=a.cloneNode(!0);o.innerHTML="",Qe(0,i-1,()=>{const h=c.createElement("SPAN");De(h,jo.CSS_CLASSES.emptyIndicator),o.appendChild(h)}),o.appendChild(u)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");De(r,jo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?De(c,`${jo.CSS_CLASSES.button} ${jo.CSS_CLASSES.expandButton}`):De(c,`${jo.CSS_CLASSES.button} ${jo.CSS_CLASSES.collapseButton}`),o.appendChild(c)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*r+25),this.hot.render()}}class sze extends JP{constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),he(n.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(n.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{Qe(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&he(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),n&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];he(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return he(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);he(i.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return he(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);he(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&he(s.__children,l=>{const c=this.dataManager.getRowIndex(l);i.push(c)}),a=this.expandRows(i,!0,!1),n&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];he(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];he(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];he(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{he(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{he(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&he(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);lt(e.target,jo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),ra(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const T6=new WeakMap;class oze extends JP{constructor(e,r){super(e,r),T6.set(this,{row_above:(n,i)=>{const s=i[i.length-1];this.dataManager.addSibling(s.start.row,"above")},row_below:(n,i)=>{const s=i[i.length-1];this.dataManager.addSibling(s.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(FM)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase($M)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Qe(0,e.items.length-1,n=>{if(n===0)return he(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const r=T6.get(this);return Qe(0,e.items.length-1,n=>{const i=r[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}class aze{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let l=!0;const c=e.map(m=>{if(!l)return!1;const g=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(g,a),g}),u=c.indexOf(a)===-1;if(!l||!u)return!1;const h=this.getBaseParent(c),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,f),this.moveRows(c,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let o=!1;return ur(i)&&(lr(Jt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[n-1]<r?l=this.dataManager.translateTrimmedRow(r-n):l=this.dataManager.translateTrimmedRow(r);const c=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(c);i=this.dataManager.untranslateTrimmedRow(u),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}const k_="nestedRows",lze=300,Ca=new WeakMap,cze="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class uze extends Vt{static get PLUGIN_KEY(){return k_}static get PLUGIN_PRIORITY(){return lze}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,Ca.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[k_]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new ov),this.dataManager=new ize(this,this.hot),this.collapsingUI=new sze(this,this.hot),this.headersUI=new jo(this,this.hot),this.contextMenuUI=new oze(this,this.hot),this.rowMoveController=new aze(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",r=>this.onBeforeLoadData(r)),this.addHook("beforeUpdateData",r=>this.onBeforeLoadData(r)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,r,n,i){return this.rowMoveController.onBeforeRowMove(e,r,n,i)}disableCoreAPIModifiers(){const e=Ca.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=Ca.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,r,n){this.collapsingUI.toggleState(e,r,n)}onModifyRowData(e){if(!Ca.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Ca.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return Ca.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}onFilterData(e,r,n){const i=Ca.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],r),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*r),this.dataManager.filterData(e,r,n),i.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,r){this.headersUI.appendLevelIndicators(e,r)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,r,n,i){if(i===this.pluginName)return;const s=Ca.get(this);setTimeout(()=>{s.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,r,n){const i=Array.from(n.reduce((s,o)=>{if(this.dataManager.isParent(o)){const a=this.dataManager.getDataObject(o).__children;return s.add(o),Array.isArray(a)&&a.forEach(l=>s.add(this.dataManager.getRowIndex(l))),s}return s.add(o)},new Set));n.length=0,n.push(...i)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,r){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(r)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,r,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,r){Ca.get(this).skipRender&&(r.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!Hje(e)){IN(cze),this.hot.getSettings()[k_]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class hze{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=r,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){he(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}Ye.getSingleton().register("persistentStateSave");Ye.getSingleton().register("persistentStateLoad");Ye.getSingleton().register("persistentStateReset");const _6="persistentState",dze=0;class fze extends Vt{static get PLUGIN_KEY(){return _6}static get PLUGIN_PRIORITY(){return dze}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[_6]}enablePlugin(){this.enabled||(this.storage||(this.storage=new hze(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const I_="search",gze=190,mze="htSearchResult",pze=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},vze=function(t,e,r){return ur(t)||t===null||!t.toLocaleLowerCase||t.length===0||ur(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};class yze extends Vt{static get PLUGIN_KEY(){return I_}static get PLUGIN_PRIORITY(){return gze}constructor(e){super(e),this.callback=pze,this.queryMethod=vze,this.searchResultClass=mze}isEnabled(){return this.hot.getSettings()[I_]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[I_];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Qe(0,i-1,l=>{Qe(0,s-1,c=>{const u=this.hot.getDataAtCell(l,c),h=this.hot.getCellMeta(l,c),d=h.search.callback||r,m=(h.search.queryMethod||n)(e,u,h);if(m){const g={row:l,col:c,data:u};o.push(g)}d&&d(a,l,c,u,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){wt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,r,n,i,s,o){const a=o.className||[];let l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}destroy(){super.destroy()}}const wze="touchScroll",xze=200;class bze extends Vt{static get PLUGIN_KEY(){return wze}static get PLUGIN_PRIORITY(){return xze}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return FY()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:r,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),r.clone&&this.scrollbars.push(r),this.scrollbars.push(n),i&&this.scrollbars.push(i),s&&s.clone&&this.scrollbars.push(s),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,he(this.clones,e=>{De(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,he(this.clones,e=>{ct(e,"hide-tween"),De(e,"show-tween")}),this.hot._registerTimeout(()=>{he(this.clones,e=>{ct(e,"show-tween")})},400),he(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const Xy="trimRows",Sze=330;class Cze extends Vt{static get PLUGIN_KEY(){return Xy}static get PLUGIN_PRIORITY(){return Sze}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[Xy]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new ov),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Xy];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),he(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{he(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(he(e,l=>{s[l]=!1}),i=ai(s,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&o)!==!1&&(n&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&o,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}onMapInit(){const e=this.hot.getSettings()[Xy];Array.isArray(e)&&this.hot.batchExecution(()=>{he(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0)}destroy(){super.destroy()}}const $X="undoRedo",Eze="undoRedo";function Ge(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,n){const i=r&&r.length;if(!i||!r.find(a=>{const[,,l,c]=a;return l!==c}))return;const o=()=>{const a=r.reduce((c,u)=>(c.push([...u]),c),[]);he(a,c=>{c[1]=t.propToCol(c[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new Ge.ChangeAction(a,l)};e.done(o,n)}),t.addHook("afterCreateRow",(r,n,i)=>{e.done(()=>new Ge.CreateRowAction(r,n),i)}),t.addHook("beforeRemoveRow",(r,n,i,s)=>{const o=()=>{const a=t.toPhysicalRow(r),l=Si(e.instance.getSourceData(a,0,a+n-1,e.instance.countSourceCols()-1));return new Ge.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(o,s)}),t.addHook("afterCreateCol",(r,n,i)=>{e.done(()=>new Ge.CreateColumnAction(r,n),i)}),t.addHook("beforeRemoveCol",(r,n,i,s)=>{const o=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+r)%e.instance.countCols(),c=[],u=[],h=[];Qe(a.length-1,m=>{const g=[],v=a[m];Qe(l,l+(n-1),w=>{g.push(v[t.toPhysicalColumn(w)])}),c.push(g)}),Qe(n-1,m=>{h.push(t.toPhysicalColumn(l+m))}),Array.isArray(t.getSettings().colHeaders)&&Qe(n-1,m=>{u.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+m)]||null)});const d=t.columnIndexMapper.getIndexesSequence(),f=t.rowIndexMapper.getIndexesSequence();return new Ge.RemoveColumnAction(l,h,c,u,d,f,t.getSettings().fixedColumnsStart)};e.done(o,s)}),t.addHook("beforeCellAlignment",(r,n,i,s)=>{e.done(()=>new Ge.CellAlignmentAction(r,n,i,s))}),t.addHook("beforeFilter",r=>{e.done(()=>new Ge.FiltersAction(r))}),t.addHook("beforeRowMove",(r,n)=>{r!==!1&&e.done(()=>new Ge.RowMoveAction(r,n))}),t.addHook("beforeMergeCells",(r,n)=>{n||e.done(()=>new Ge.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,n)=>{n||e.done(()=>new Ge.UnmergeCellsAction(t,r))}),t.addHook("afterInit",()=>{e.init()})}Ge.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const s=t(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};Ge.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const r=Si(e);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};Ge.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const r=Si(e);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};Ge.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Ge.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Ge.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Ge.prototype.isEnabled=function(){return this.enabled};Ge.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Rze(t),this.registerShortcuts(),t.addHook("afterChange",HX)};Ge.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Aze(t),this.unregisterShortcuts(),t.removeHook("afterChange",HX)};Ge.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Ge.Action=function(){};Ge.Action.prototype.undo=function(){};Ge.Action.prototype.redo=function(){};Ge.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ac(Ge.ChangeAction,Ge.Action);Ge.ChangeAction.prototype.undo=function(t,e){const r=Si(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,o=r.length;s<o;s++)r[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(let s=0,o=r.length;s<o;s++){const[a,l]=r[s];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};Ge.ChangeAction.prototype.redo=function(t,e){const r=Si(this.changes);for(let n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Ge.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ac(Ge.CreateRowAction,Ge.Action);Ge.CreateRowAction.prototype.undo=function(t,e){const r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Ge.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Ge.RemoveRowAction=function(t,e,r,n,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Ac(Ge.RemoveRowAction,Ge.Action);Ge.RemoveRowAction.prototype.undo=function(t,e){const r=t.getSettings(),n=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);n.push([this.index+s,isNaN(a)?o:a,i[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Ge.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Ge.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ac(Ge.CreateColumnAction,Ge.Action);Ge.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Ge.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Ge.RemoveColumnAction=function(t,e,r,n,i,s,o){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o};Ac(Ge.RemoveColumnAction,Ge.Action);Ge.RemoveColumnAction.prototype.undo=function(t,e){const r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(c,u,h)=>h[this.indexes.indexOf(n[u])],s=this.data.length,o=[];for(let c=0;c<s;c++)o.push(yt(this.data[c],i));const a=yt(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),he(t.getSourceDataArray(),(c,u)=>{he(n,(h,d)=>{c[h]=o[u][d],l.push([u,h,c[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&he(a,(c,u)=>{t.getSettings().colHeaders[n[u]]=c}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Ge.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Ge.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};Ge.CellAlignmentAction.prototype.undo=function(t,e){he(this.range,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&t.setCellMeta(n,i,"className",this.stateBefore[n][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Ge.CellAlignmentAction.prototype.redo=function(t,e){Il(this.range,this.type,this.alignment,(r,n)=>t.getCellMeta(r,n),(r,n,i,s)=>t.setCellMeta(r,n,i,s)),t.addHookOnce("afterViewRender",e),t.render()};Ge.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Ac(Ge.FiltersAction,Ge.Action);Ge.FiltersAction.prototype.undo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};Ge.FiltersAction.prototype.redo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class Tze extends Ge.Action{constructor(e,r){super(),this.cellRange=r;const n=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,i.row,i.col)}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}Ge.MergeCellsAction=Tze;class _ze extends Ge.Action{constructor(e,r){super(),this.cellRange=r}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}Ge.UnmergeCellsAction=_ze;Ge.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Ac(Ge.RowMoveAction,Ge.Action);Ge.RowMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualRowMove"),n=[].concat(this.rows),i=n.filter(a=>a>this.finalIndex),s=n.filter(a=>a<=this.finalIndex),o=i.sort((a,l)=>l-a).concat(s.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<o.length;a+=1){const l=t.toVisualRow(o[a]);r.moveRow(l,o[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Ge.RowMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};Ge.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Ge.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:i=>!i.altKey,group:$X};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};Ge.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup($X)};function HX(t,e){const r=this;if(e==="loadData")return r.undoRedo.clear()}function Rze(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Aze(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const mv=Ye.getSingleton();mv.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});mv.register("beforeUndo");mv.register("afterUndo");mv.register("beforeRedo");mv.register("afterRedo");Ge.PLUGIN_KEY=Eze;Ge.SETTING_KEYS=!0;function Oze(){Pt(Bm),Pt(k5e),Pt(Vm),Pt(V5e),Pt(J5e),Pt(BK),Pt(E8e),Pt($8e),Pt(CC),Pt(FVe),Pt(eUe),Pt(rUe),Pt(TC),Pt(fUe),Pt(tWe),Pt(AWe),Pt(DWe),Pt(VWe),Pt(GWe),Pt(ZWe),Pt(e7e),Pt(o7e),Pt(l7e),Pt(f7e),Pt(w7e),Pt(S7e),Pt(nze),Pt(uze),Pt(fze),Pt(yze),Pt(bze),Pt(Cze),Pt(Ge)}function kze(){k6e(),z6e(),Q6e(),p5e(),Oze()}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jX=1252,Ize=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ZP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},QP=function(t){Ize.indexOf(t)!=-1&&(jX=ZP[0]=t)};function Nze(){QP(1252)}var uo=function(t){QP(t)};function BX(){uo(1200),Nze()}function R6(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Mze(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function VX(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var dm=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Mze(t.slice(2)):e==254&&r==255?VX(t.slice(2)):e==65279?t.slice(1):t},qy=function(e){return String.fromCharCode(e)},A6=function(e){return String.fromCharCode(e)},pk,Kl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function O6(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),o=(r&3)<<4|n>>4,i=t.charCodeAt(c++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=Kl.charAt(s)+Kl.charAt(o)+Kl.charAt(a)+Kl.charAt(l);return e}function as(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Kl.indexOf(t.charAt(c++)),o=Kl.indexOf(t.charAt(c++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=Kl.indexOf(t.charAt(c++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=Kl.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),dh=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function pc(t){return kt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function k6(t){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var lo=function(e){return kt?dh(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function fh(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function eD(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return eD(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var jl=kt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:dh(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Pze(t){for(var e=[],r=0,n=t.length+250,i=pc(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=pc(65535),n=65530)}return e.push(i.slice(0,r)),jl(e)}var xi=/\u0000/g,fm=/[\u0001-\u0006]/g;function Md(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ho(t,e){var r=""+t;return r.length>=e?r:Wr("0",e-r.length)+r}function tD(t,e){var r=""+t;return r.length>=e?r:Wr(" ",e-r.length)+r}function z1(t,e){var r=""+t;return r.length>=e?r:r+Wr(" ",e-r.length)}function Dze(t,e){var r=""+Math.round(t);return r.length>=e?r:Wr("0",e-r.length)+r}function Lze(t,e){var r=""+t;return r.length>=e?r:Wr("0",e-r.length)+r}var I6=Math.pow(2,32);function zh(t,e){if(t>I6||t<-I6)return Dze(t,e);var r=Math.round(t);return Lze(r,e)}function G1(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var N6=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],N_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Fze(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},M6={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$ze={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Y1(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!r)return[0,n*a,u];var d=Math.floor(n*a/u);return[d,n*a-d*u,u]}function yu(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Wze(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var UX=new Date(1899,11,31,0,0,0),Hze=UX.getTime(),jze=new Date(1900,2,1,0,0,0);function WX(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=jze&&(r+=24*60*60*1e3),(r-(Hze+(t.getTimezoneOffset()-UX.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function rD(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Bze(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Vze(t){var e=t<0?12:11,r=rD(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Uze(t){var e=rD(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function x0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Vze(t):e===10?r=t.toFixed(10).substr(0,12):r=Uze(t),rD(Bze(r.toUpperCase()))}function Gu(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):x0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return $s(14,WX(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Wze(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function zze(t,e,r,n){var i="",s=0,o=0,a=r.y,l,c=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return N_[r.m-1][1];case 5:return N_[r.m-1][0];default:return N_[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return N6[r.q][0];default:return N6[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ho(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=ho(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?ho(l,c):"";return u}function Xl(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var zX=/%/g;function Gze(t,e,r){var n=e.replace(zX,""),i=e.length-n.length;return Ga(t,n,r*Math.pow(10,2*i))+Wr("%",i)}function Yze(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ga(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function GX(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+GX(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var YX=/# (\?+)( ?)\/( ?)(\d+)/;function Kze(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?Wr(" ",t[1].length+1+t[4].length):tD(o,t[1].length)+t[2]+"/"+t[3]+ho(a,t[4].length))}function Xze(t,e,r){return r+(e===0?"":""+e)+Wr(" ",t[1].length+2+t[4].length)}var KX=/^#*0*\.([0#]+)/,XX=/\).*[0#]/,qX=/\(###\) ###\\?-####/;function fi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function P6(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function D6(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qze(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Jze(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function xs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(XX)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xs("n",n,r):"("+xs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Yze(t,e,r);if(e.indexOf("%")!==-1)return Gze(t,e,r);if(e.indexOf("E")!==-1)return GX(e,r);if(e.charCodeAt(0)===36)return"$"+xs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+zh(l,e.length);if(e.match(/^[#?]+$/))return i=zh(r,0),i==="0"&&(i=""),i.length>e.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(YX))return Kze(s,l,c);if(e.match(/^#+0+$/))return c+zh(l,e.length-e.indexOf("0"));if(s=e.match(KX))return i=P6(r,s[1].length).replace(/^([^\.]+)$/,"$1."+fi(s[1])).replace(/\.$/,"."+fi(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+Wr("0",fi(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+P6(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Xl(zh(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xs(t,e,-r):Xl(""+(Math.floor(r)+qze(r,s[1].length)))+"."+ho(D6(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return xs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Md(xs(t,e.replace(/[\\-]/g,""),r)),o=0,Md(Md(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(e.match(qX))return i=xs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Y1(l,Math.pow(10,o)-1,!1),i=""+c,u=Ga("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=z1(a[2],o),u.length<s[4].length&&(u=fi(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Y1(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?tD(a[1],o)+s[2]+"/"+s[3]+z1(a[2],o):Wr(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=zh(r,0),e.length<=i.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,d=e.length-i.length-h;return fi(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=D6(r,s[1].length),r<0?"-"+xs(t,e,-r):Xl(Jze(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?ho(0,3-m.length):"")+m})+"."+ho(o,s[1].length);switch(e){case"###,##0.00":return xs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=Xl(zh(l,0));return f!=="0"?c+f:"";case"###,###.00":return xs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Zze(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ga(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Qze(t,e,r){var n=e.replace(zX,""),i=e.length-n.length;return Ga(t,n,r*Math.pow(10,2*i))+Wr("%",i)}function JX(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+JX(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Lo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(XX)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Lo("n",n,r):"("+Lo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Zze(t,e,r);if(e.indexOf("%")!==-1)return Qze(t,e,r);if(e.indexOf("E")!==-1)return JX(e,r);if(e.charCodeAt(0)===36)return"$"+Lo(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ho(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(YX))return Xze(s,l,c);if(e.match(/^#+0+$/))return c+ho(l,e.length-e.indexOf("0"));if(s=e.match(KX))return i=(""+r).replace(/^([^\.]+)$/,"$1."+fi(s[1])).replace(/\.$/,"."+fi(s[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+Wr("0",fi(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Xl(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Lo(t,e,-r):Xl(""+r)+"."+Wr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Lo(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Md(Lo(t,e.replace(/[\\-]/g,""),r)),o=0,Md(Md(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(e.match(qX))return i=Lo(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Y1(l,Math.pow(10,o)-1,!1),i=""+c,u=Ga("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=z1(a[2],o),u.length<s[4].length&&(u=fi(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Y1(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?tD(a[1],o)+s[2]+"/"+s[3]+z1(a[2],o):Wr(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,d=e.length-i.length-h;return fi(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Lo(t,e,-r):Xl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?ho(0,3-m.length):"")+m})+"."+ho(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=Xl(""+l);return f!=="0"?c+f:"";default:if(e.match(/\.[0#?]*$/))return Lo(t,e.slice(0,e.lastIndexOf(".")),r)+fi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ga(t,e,r){return(r|0)===r?Lo(t,e,r):xs(t,e,r)}function e9e(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var ZX=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lg(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":G1(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(ZX))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function t9e(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",c,u,h,d="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!G1(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var f=t.charAt(++o),m=f==="("||f===")"?f:"t";i[i.length]={t:m,v:f},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=yu(e,r,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=yu(e,r),c==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=d),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var g={t:a,v:a};if(c==null&&(c=yu(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",o+=5,d="h"):t.substr(o,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",o+=5,d="h"):(g.t="t",++o),c==null&&g.t==="T")return"";i[i.length]=g,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ZX)){if(c==null&&(c=yu(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",lg(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var v=0,w=0,b;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=d,l="h",v<1&&(v=1);break;case"s":(b=i[o].v.match(/\.0+$/))&&(w=Math.max(w,b[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&i[o].v.match(/[Hh]/)&&(v=1),v<2&&i[o].v.match(/[Mm]/)&&(v=2),v<3&&i[o].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",C;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=zze(i[o].t.charCodeAt(0),i[o].v,c,w),i[o].t="t";break;case"n":case"?":for(C=o+1;i[C]!=null&&((a=i[C].t)==="?"||a==="D"||(a===" "||a==="t")&&i[C+1]!=null&&(i[C+1].t==="?"||i[C+1].t==="t"&&i[C+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[C].v==="/"||i[C].v===" "&&i[C+1]!=null&&i[C+1].t=="?"));)i[o].v+=i[C].v,i[C]={v:"",t:";"},++C;x+=i[o].v,o=C-1;break;case"G":i[o].t="t",i[o].v=Gu(e,r);break}var S="",E,T;if(x.length>0){x.charCodeAt(0)==40?(E=e<0&&x.charCodeAt(0)===45?-e:e,T=Ga("n",x,E)):(E=e<0&&n>1?-e:e,T=Ga("n",x,E),E<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),C=T.length-1;var I=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){I=o;break}var k=i.length;if(I===i.length&&T.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(C>=i[o].v.length-1?(C-=i[o].v.length,i[o].v=T.substr(C+1,i[o].v.length)):C<0?i[o].v="":(i[o].v=T.substr(0,C+1),C=-1),i[o].t="t",k=o);C>=0&&k<i.length&&(i[k].v=T.substr(0,C+1)+i[k].v)}else if(I!==i.length&&T.indexOf("E")===-1){for(C=T.indexOf(".")-1,o=I;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===I?i[o].v.indexOf(".")-1:i[o].v.length-1,S=i[o].v.substr(u+1);u>=0;--u)C>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(S=T.charAt(C--)+S);i[o].v=S,i[o].t="t",k=o}for(C>=0&&k<i.length&&(i[k].v=T.substr(0,C+1)+i[k].v),C=T.indexOf(".")+1,o=I;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==I)){for(u=i[o].v.indexOf(".")>-1&&o===I?i[o].v.indexOf(".")+1:0,S=i[o].v.substr(0,u);u<i[o].v.length;++u)C<T.length&&(S+=T.charAt(C++));i[o].v=S,i[o].t="t",k=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(E=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Ga(i[o].t,i[o].v,E),i[o].t="t");var M="";for(o=0;o!==i.length;++o)i[o]!=null&&(M+=i[o].v);return M}var L6=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function F6(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function r9e(t,e){var r=e9e(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(L6),a=r[1].match(L6);return F6(e,o)?[n,r[0]]:F6(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function $s(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[t],n==null&&(n=r.table&&r.table[M6[t]]||ft[M6[t]]),n==null&&(n=$ze[t]||"General");break}if(G1(n,0))return Gu(e,r);e instanceof Date&&(e=WX(e,r.date1904));var i=r9e(n,e);if(G1(i[1]))return Gu(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return t9e(i[1],e,r,i[0])}function Au(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ft[r]==null){e<0&&(e=r);continue}if(ft[r]==t){e=r;break}}e<0&&(e=391)}return ft[e]=t,e}function QX(){ft=Fze()}var n9e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},eq=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i9e(t){var e=typeof t=="number"?ft[t]:t;return e=e.replace(eq,"(\\d+)"),new RegExp("^"+e+"$")}function s9e(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(eq)||[]).forEach(function(h,d){var f=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=f;break;case"d":s=f;break;case"h":o=f;break;case"s":l=f;break;case"m":o>=0?a=f:i=f;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var o9e=function(){var t={};t.version="1.2.0";function e(){for(var T=0,I=new Array(256),k=0;k!=256;++k)T=k,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,I[k]=T;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(T){var I=0,k=0,M=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)D[M]=T[M];for(M=0;M!=256;++M)for(k=T[M],I=256+M;I<4096;I+=256)k=D[I]=k>>>8^T[k&255];var L=[];for(M=1;M!=16;++M)L[M-1]=typeof Int32Array<"u"?D.subarray(M*256,M*256+256):D.slice(M*256,M*256+256);return L}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],f=i[8],m=i[9],g=i[10],v=i[11],w=i[12],b=i[13],x=i[14];function C(T,I){for(var k=I^-1,M=0,D=T.length;M<D;)k=k>>>8^r[(k^T.charCodeAt(M++))&255];return~k}function S(T,I){for(var k=I^-1,M=T.length-15,D=0;D<M;)k=x[T[D++]^k&255]^b[T[D++]^k>>8&255]^w[T[D++]^k>>16&255]^v[T[D++]^k>>>24]^g[T[D++]]^m[T[D++]]^f[T[D++]]^d[T[D++]]^h[T[D++]]^u[T[D++]]^c[T[D++]]^l[T[D++]]^a[T[D++]]^o[T[D++]]^s[T[D++]]^r[T[D++]];for(M+=15;D<M;)k=k>>>8^r[(k^T[D++])&255];return~k}function E(T,I){for(var k=I^-1,M=0,D=T.length,L=0,U=0;M<D;)L=T.charCodeAt(M++),L<128?k=k>>>8^r[(k^L)&255]:L<2048?(k=k>>>8^r[(k^(192|L>>6&31))&255],k=k>>>8^r[(k^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,U=T.charCodeAt(M++)&1023,k=k>>>8^r[(k^(240|L>>8&7))&255],k=k>>>8^r[(k^(128|L>>2&63))&255],k=k>>>8^r[(k^(128|U>>6&15|(L&3)<<4))&255],k=k>>>8^r[(k^(128|U&63))&255]):(k=k>>>8^r[(k^(224|L>>12&15))&255],k=k>>>8^r[(k^(128|L>>6&63))&255],k=k>>>8^r[(k^(128|L&63))&255]);return~k}return t.table=r,t.bstr=C,t.buf=S,t.str=E,t}(),It=function(){var e={};e.version="1.2.1";function r(B,Z){for(var Y=B.split("/"),q=Z.split("/"),re=0,ne=0,Ce=Math.min(Y.length,q.length);re<Ce;++re){if(ne=Y[re].length-q[re].length)return ne;if(Y[re]!=q[re])return Y[re]<q[re]?-1:1}return Y.length-q.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var Z=B.lastIndexOf("/");return Z===-1?B:B.slice(0,Z+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var Z=B.lastIndexOf("/");return Z===-1?B:B.slice(Z+1)}function s(B,Z){typeof Z=="string"&&(Z=new Date(Z));var Y=Z.getHours();Y=Y<<6|Z.getMinutes(),Y=Y<<5|Z.getSeconds()>>>1,B.write_shift(2,Y);var q=Z.getFullYear()-1980;q=q<<4|Z.getMonth()+1,q=q<<5|Z.getDate(),B.write_shift(2,q)}function o(B){var Z=B.read_shift(2)&65535,Y=B.read_shift(2)&65535,q=new Date,re=Y&31;Y>>>=5;var ne=Y&15;Y>>>=4,q.setMilliseconds(0),q.setFullYear(Y+1980),q.setMonth(ne-1),q.setDate(re);var Ce=Z&31;Z>>>=5;var Ae=Z&63;return Z>>>=6,q.setHours(Z),q.setMinutes(Ae),q.setSeconds(Ce<<1),q}function a(B){Ln(B,0);for(var Z={},Y=0;B.l<=B.length-4;){var q=B.read_shift(2),re=B.read_shift(2),ne=B.l+re,Ce={};switch(q){case 21589:Y=B.read_shift(1),Y&1&&(Ce.mtime=B.read_shift(4)),re>5&&(Y&2&&(Ce.atime=B.read_shift(4)),Y&4&&(Ce.ctime=B.read_shift(4))),Ce.mtime&&(Ce.mt=new Date(Ce.mtime*1e3));break}B.l=ne,Z[q]=Ce}return Z}var l;function c(){return l||(l={})}function u(B,Z){if(B[0]==80&&B[1]==75)return ds(B,Z);if((B[0]|32)==109&&(B[1]|32)==105)return nr(B,Z);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var Y=3,q=512,re=0,ne=0,Ce=0,Ae=0,Se=0,Ee=[],_e=B.slice(0,512);Ln(_e,0);var Te=h(_e);switch(Y=Te[0],Y){case 3:q=512;break;case 4:q=4096;break;case 0:if(Te[1]==0)return ds(B,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}q!==512&&(_e=B.slice(0,q),Ln(_e,28));var ee=B.slice(0,q);d(_e,Y);var xe=_e.read_shift(4,"i");if(Y===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);_e.l+=4,Ce=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),Ae=_e.read_shift(4,"i"),re=_e.read_shift(4,"i"),Se=_e.read_shift(4,"i"),ne=_e.read_shift(4,"i");for(var we=-1,Ne=0;Ne<109&&(we=_e.read_shift(4,"i"),!(we<0));++Ne)Ee[Ne]=we;var We=f(B,q);v(Se,ne,We,q,Ee);var St=b(We,Ce,Ee,q);St[Ce].name="!Directory",re>0&&Ae!==U&&(St[Ae].name="!MiniFAT"),St[Ee[0]].name="!FAT",St.fat_addrs=Ee,St.ssz=q;var gt={},Tr=[],gr=[],da=[];x(Ce,St,We,Tr,re,gt,gr,Ae),m(gr,da,Tr),Tr.shift();var pl={FileIndex:gr,FullPaths:da};return Z&&Z.raw&&(pl.raw={header:ee,sectors:We}),pl}function h(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(J,"Header Signature: "),B.l+=16;var Z=B.read_shift(2,"u");return[B.read_shift(2,"u"),Z]}function d(B,Z){var Y=9;switch(B.l+=2,Y=B.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function f(B,Z){for(var Y=Math.ceil(B.length/Z)-1,q=[],re=1;re<Y;++re)q[re-1]=B.slice(re*Z,(re+1)*Z);return q[Y-1]=B.slice(Y*Z),q}function m(B,Z,Y){for(var q=0,re=0,ne=0,Ce=0,Ae=0,Se=Y.length,Ee=[],_e=[];q<Se;++q)Ee[q]=_e[q]=q,Z[q]=Y[q];for(;Ae<_e.length;++Ae)q=_e[Ae],re=B[q].L,ne=B[q].R,Ce=B[q].C,Ee[q]===q&&(re!==-1&&Ee[re]!==re&&(Ee[q]=Ee[re]),ne!==-1&&Ee[ne]!==ne&&(Ee[q]=Ee[ne])),Ce!==-1&&(Ee[Ce]=q),re!==-1&&q!=Ee[q]&&(Ee[re]=Ee[q],_e.lastIndexOf(re)<Ae&&_e.push(re)),ne!==-1&&q!=Ee[q]&&(Ee[ne]=Ee[q],_e.lastIndexOf(ne)<Ae&&_e.push(ne));for(q=1;q<Se;++q)Ee[q]===q&&(ne!==-1&&Ee[ne]!==ne?Ee[q]=Ee[ne]:re!==-1&&Ee[re]!==re&&(Ee[q]=Ee[re]));for(q=1;q<Se;++q)if(B[q].type!==0){if(Ae=q,Ae!=Ee[Ae])do Ae=Ee[Ae],Z[q]=Z[Ae]+"/"+Z[q];while(Ae!==0&&Ee[Ae]!==-1&&Ae!=Ee[Ae]);Ee[q]=-1}for(Z[0]+="/",q=1;q<Se;++q)B[q].type!==2&&(Z[q]+="/")}function g(B,Z,Y){for(var q=B.start,re=B.size,ne=[],Ce=q;Y&&re>0&&Ce>=0;)ne.push(Z.slice(Ce*L,Ce*L+L)),re-=L,Ce=ou(Y,Ce*4);return ne.length===0?hn(0):jl(ne).slice(0,B.size)}function v(B,Z,Y,q,re){var ne=U;if(B===U){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var Ce=Y[B],Ae=(q>>>2)-1;if(!Ce)return;for(var Se=0;Se<Ae&&(ne=ou(Ce,Se*4))!==U;++Se)re.push(ne);v(ou(Ce,q-4),Z-1,Y,q,re)}}function w(B,Z,Y,q,re){var ne=[],Ce=[];re||(re=[]);var Ae=q-1,Se=0,Ee=0;for(Se=Z;Se>=0;){re[Se]=!0,ne[ne.length]=Se,Ce.push(B[Se]);var _e=Y[Math.floor(Se*4/q)];if(Ee=Se*4&Ae,q<4+Ee)throw new Error("FAT boundary crossed: "+Se+" 4 "+q);if(!B[_e])break;Se=ou(B[_e],Ee)}return{nodes:ne,data:Y6([Ce])}}function b(B,Z,Y,q){var re=B.length,ne=[],Ce=[],Ae=[],Se=[],Ee=q-1,_e=0,Te=0,ee=0,xe=0;for(_e=0;_e<re;++_e)if(Ae=[],ee=_e+Z,ee>=re&&(ee-=re),!Ce[ee]){Se=[];var we=[];for(Te=ee;Te>=0;){we[Te]=!0,Ce[Te]=!0,Ae[Ae.length]=Te,Se.push(B[Te]);var Ne=Y[Math.floor(Te*4/q)];if(xe=Te*4&Ee,q<4+xe)throw new Error("FAT boundary crossed: "+Te+" 4 "+q);if(!B[Ne]||(Te=ou(B[Ne],xe),we[Te]))break}ne[ee]={nodes:Ae,data:Y6([Se])}}return ne}function x(B,Z,Y,q,re,ne,Ce,Ae){for(var Se=0,Ee=q.length?2:0,_e=Z[B].data,Te=0,ee=0,xe;Te<_e.length;Te+=128){var we=_e.slice(Te,Te+128);Ln(we,64),ee=we.read_shift(2),xe=aD(we,0,ee-Ee),q.push(xe);var Ne={name:xe,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},We=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);We!==0&&(Ne.ct=C(we,we.l-8));var St=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);St!==0&&(Ne.mt=C(we,we.l-8)),Ne.start=we.read_shift(4,"i"),Ne.size=we.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=U,Ne.name=""),Ne.type===5?(Se=Ne.start,re>0&&Se!==U&&(Z[Se].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",Z[Ne.start]===void 0&&(Z[Ne.start]=w(Y,Ne.start,Z.fat_addrs,Z.ssz)),Z[Ne.start].name=Ne.name,Ne.content=Z[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:Se!==U&&Ne.start!==U&&Z[Se]&&(Ne.content=g(Ne,Z[Se].data,(Z[Ae]||{}).data))),Ne.content&&Ln(Ne.content,0),ne[xe]=Ne,Ce.push(Ne)}}function C(B,Z){return new Date((Zi(B,Z+4)/1e7*Math.pow(2,32)+Zi(B,Z)/1e7-11644473600)*1e3)}function S(B,Z){return c(),u(l.readFileSync(B),Z)}function E(B,Z){var Y=Z&&Z.type;switch(Y||kt&&Buffer.isBuffer(B)&&(Y="buffer"),Y||"base64"){case"file":return S(B,Z);case"base64":return u(lo(as(B)),Z);case"binary":return u(lo(B),Z)}return u(B,Z)}function T(B,Z){var Y=Z||{},q=Y.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=q+"/",B.FileIndex[0]={name:q,type:5}),Y.CLSID&&(B.FileIndex[0].clsid=Y.CLSID),I(B)}function I(B){var Z="Sh33tJ5";if(!It.find(B,"/"+Z)){var Y=hn(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,B.FileIndex.push({name:Z,type:2,content:Y,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Z),k(B)}}function k(B,Z){T(B);for(var Y=!1,q=!1,re=B.FullPaths.length-1;re>=0;--re){var ne=B.FileIndex[re];switch(ne.type){case 0:q?Y=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(ne.R*ne.L*ne.C)&&(Y=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!Z)){var Ce=new Date(1987,1,19),Ae=0,Se=Object.create?Object.create(null):{},Ee=[];for(re=0;re<B.FullPaths.length;++re)Se[B.FullPaths[re]]=!0,B.FileIndex[re].type!==0&&Ee.push([B.FullPaths[re],B.FileIndex[re]]);for(re=0;re<Ee.length;++re){var _e=n(Ee[re][0]);q=Se[_e],q||(Ee.push([_e,{name:i(_e).replace("/",""),type:1,clsid:ie,ct:Ce,mt:Ce,content:null}]),Se[_e]=!0)}for(Ee.sort(function(xe,we){return r(xe[0],we[0])}),B.FullPaths=[],B.FileIndex=[],re=0;re<Ee.length;++re)B.FullPaths[re]=Ee[re][0],B.FileIndex[re]=Ee[re][1];for(re=0;re<Ee.length;++re){var Te=B.FileIndex[re],ee=B.FullPaths[re];if(Te.name=i(ee).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||ie,re===0)Te.C=Ee.length>1?1:-1,Te.size=0,Te.type=5;else if(ee.slice(-1)=="/"){for(Ae=re+1;Ae<Ee.length&&n(B.FullPaths[Ae])!=ee;++Ae);for(Te.C=Ae>=Ee.length?-1:Ae,Ae=re+1;Ae<Ee.length&&n(B.FullPaths[Ae])!=n(ee);++Ae);Te.R=Ae>=Ee.length?-1:Ae,Te.type=1}else n(B.FullPaths[re+1]||"")==n(ee)&&(Te.R=re+1),Te.type=2}}}function M(B,Z){var Y=Z||{};if(Y.fileType=="mad")return kr(B,Y);switch(k(B),Y.fileType){case"zip":return Co(B,Y)}var q=function(xe){for(var we=0,Ne=0,We=0;We<xe.FileIndex.length;++We){var St=xe.FileIndex[We];if(St.content){var gt=St.content.length;gt>0&&(gt<4096?we+=gt+63>>6:Ne+=gt+511>>9)}}for(var Tr=xe.FullPaths.length+3>>2,gr=we+7>>3,da=we+127>>7,pl=gr+Ne+Tr+da,vl=pl+127>>7,IC=vl<=109?0:Math.ceil((vl-109)/127);pl+vl+IC+127>>7>vl;)IC=++vl<=109?0:Math.ceil((vl-109)/127);var fa=[1,IC,vl,da,Tr,Ne,we,0];return xe.FileIndex[0].size=we<<6,fa[7]=(xe.FileIndex[0].start=fa[0]+fa[1]+fa[2]+fa[3]+fa[4]+fa[5])+(fa[6]+7>>3),fa}(B),re=hn(q[7]<<9),ne=0,Ce=0;{for(ne=0;ne<8;++ne)re.write_shift(1,X[ne]);for(ne=0;ne<8;++ne)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ne=0;ne<3;++ne)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,q[2]),re.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:U),re.write_shift(4,q[3]),re.write_shift(-4,q[1]?q[0]-1:U),re.write_shift(4,q[1]),ne=0;ne<109;++ne)re.write_shift(-4,ne<q[2]?q[1]+ne:-1)}if(q[1])for(Ce=0;Ce<q[1];++Ce){for(;ne<236+Ce*127;++ne)re.write_shift(-4,ne<q[2]?q[1]+ne:-1);re.write_shift(-4,Ce===q[1]-1?U:Ce+1)}var Ae=function(xe){for(Ce+=xe;ne<Ce-1;++ne)re.write_shift(-4,ne+1);xe&&(++ne,re.write_shift(-4,U))};for(Ce=ne=0,Ce+=q[1];ne<Ce;++ne)re.write_shift(-4,se.DIFSECT);for(Ce+=q[2];ne<Ce;++ne)re.write_shift(-4,se.FATSECT);Ae(q[3]),Ae(q[4]);for(var Se=0,Ee=0,_e=B.FileIndex[0];Se<B.FileIndex.length;++Se)_e=B.FileIndex[Se],_e.content&&(Ee=_e.content.length,!(Ee<4096)&&(_e.start=Ce,Ae(Ee+511>>9)));for(Ae(q[6]+7>>3);re.l&511;)re.write_shift(-4,se.ENDOFCHAIN);for(Ce=ne=0,Se=0;Se<B.FileIndex.length;++Se)_e=B.FileIndex[Se],_e.content&&(Ee=_e.content.length,!(!Ee||Ee>=4096)&&(_e.start=Ce,Ae(Ee+63>>6)));for(;re.l&511;)re.write_shift(-4,se.ENDOFCHAIN);for(ne=0;ne<q[4]<<2;++ne){var Te=B.FullPaths[ne];if(!Te||Te.length===0){for(Se=0;Se<17;++Se)re.write_shift(4,0);for(Se=0;Se<3;++Se)re.write_shift(4,-1);for(Se=0;Se<12;++Se)re.write_shift(4,0);continue}_e=B.FileIndex[ne],ne===0&&(_e.start=_e.size?_e.start-1:U);var ee=ne===0&&Y.root||_e.name;if(Ee=2*(ee.length+1),re.write_shift(64,ee,"utf16le"),re.write_shift(2,Ee),re.write_shift(1,_e.type),re.write_shift(1,_e.color),re.write_shift(-4,_e.L),re.write_shift(-4,_e.R),re.write_shift(-4,_e.C),_e.clsid)re.write_shift(16,_e.clsid,"hex");else for(Se=0;Se<4;++Se)re.write_shift(4,0);re.write_shift(4,_e.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,_e.start),re.write_shift(4,_e.size),re.write_shift(4,0)}for(ne=1;ne<B.FileIndex.length;++ne)if(_e=B.FileIndex[ne],_e.size>=4096)if(re.l=_e.start+1<<9,kt&&Buffer.isBuffer(_e.content))_e.content.copy(re,re.l,0,_e.size),re.l+=_e.size+511&-512;else{for(Se=0;Se<_e.size;++Se)re.write_shift(1,_e.content[Se]);for(;Se&511;++Se)re.write_shift(1,0)}for(ne=1;ne<B.FileIndex.length;++ne)if(_e=B.FileIndex[ne],_e.size>0&&_e.size<4096)if(kt&&Buffer.isBuffer(_e.content))_e.content.copy(re,re.l,0,_e.size),re.l+=_e.size+63&-64;else{for(Se=0;Se<_e.size;++Se)re.write_shift(1,_e.content[Se]);for(;Se&63;++Se)re.write_shift(1,0)}if(kt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function D(B,Z){var Y=B.FullPaths.map(function(Se){return Se.toUpperCase()}),q=Y.map(function(Se){var Ee=Se.split("/");return Ee[Ee.length-(Se.slice(-1)=="/"?2:1)]}),re=!1;Z.charCodeAt(0)===47?(re=!0,Z=Y[0].slice(0,-1)+Z):re=Z.indexOf("/")!==-1;var ne=Z.toUpperCase(),Ce=re===!0?Y.indexOf(ne):q.indexOf(ne);if(Ce!==-1)return B.FileIndex[Ce];var Ae=!ne.match(fm);for(ne=ne.replace(xi,""),Ae&&(ne=ne.replace(fm,"!")),Ce=0;Ce<Y.length;++Ce)if((Ae?Y[Ce].replace(fm,"!"):Y[Ce]).replace(xi,"")==ne||(Ae?q[Ce].replace(fm,"!"):q[Ce]).replace(xi,"")==ne)return B.FileIndex[Ce];return null}var L=64,U=-2,J="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function P(B,Z,Y){c();var q=M(B,Y);l.writeFileSync(Z,q)}function y(B){for(var Z=new Array(B.length),Y=0;Y<B.length;++Y)Z[Y]=String.fromCharCode(B[Y]);return Z.join("")}function _(B,Z){var Y=M(B,Z);switch(Z&&Z.type||"buffer"){case"file":return c(),l.writeFileSync(Z.filename,Y),Y;case"binary":return typeof Y=="string"?Y:y(Y);case"base64":return O6(typeof Y=="string"?Y:y(Y));case"buffer":if(kt)return Buffer.isBuffer(Y)?Y:dh(Y);case"array":return typeof Y=="string"?lo(Y):Y}return Y}var R;function A(B){try{var Z=B.InflateRaw,Y=new Z;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)R=B;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function O(B,Z){if(!R)return Et(B,Z);var Y=R.InflateRaw,q=new Y,re=q._processChunk(B.slice(B.l),q._finishFlushFlag);return B.l+=q.bytesRead,re}function N(B){return R?R.deflateRawSync(B):pe(B)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(B){var Z=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var W=typeof Uint8Array<"u",ae=W?new Uint8Array(256):[],ye=0;ye<256;++ye)ae[ye]=Q(ye);function H(B,Z){var Y=ae[B&255];return Z<=8?Y>>>8-Z:(Y=Y<<8|ae[B>>8&255],Z<=16?Y>>>16-Z:(Y=Y<<8|ae[B>>16&255],Y>>>24-Z))}function Re(B,Z){var Y=Z&7,q=Z>>>3;return(B[q]|(Y<=6?0:B[q+1]<<8))>>>Y&3}function ue(B,Z){var Y=Z&7,q=Z>>>3;return(B[q]|(Y<=5?0:B[q+1]<<8))>>>Y&7}function Pe(B,Z){var Y=Z&7,q=Z>>>3;return(B[q]|(Y<=4?0:B[q+1]<<8))>>>Y&15}function ke(B,Z){var Y=Z&7,q=Z>>>3;return(B[q]|(Y<=3?0:B[q+1]<<8))>>>Y&31}function be(B,Z){var Y=Z&7,q=Z>>>3;return(B[q]|(Y<=1?0:B[q+1]<<8))>>>Y&127}function Fe(B,Z,Y){var q=Z&7,re=Z>>>3,ne=(1<<Y)-1,Ce=B[re]>>>q;return Y<8-q||(Ce|=B[re+1]<<8-q,Y<16-q)||(Ce|=B[re+2]<<16-q,Y<24-q)||(Ce|=B[re+3]<<24-q),Ce&ne}function He(B,Z,Y){var q=Z&7,re=Z>>>3;return q<=5?B[re]|=(Y&7)<<q:(B[re]|=Y<<q&255,B[re+1]=(Y&7)>>8-q),Z+3}function V(B,Z,Y){var q=Z&7,re=Z>>>3;return Y=(Y&1)<<q,B[re]|=Y,Z+1}function K(B,Z,Y){var q=Z&7,re=Z>>>3;return Y<<=q,B[re]|=Y&255,Y>>>=8,B[re+1]=Y,Z+8}function te(B,Z,Y){var q=Z&7,re=Z>>>3;return Y<<=q,B[re]|=Y&255,Y>>>=8,B[re+1]=Y&255,B[re+2]=Y>>>8,Z+16}function ve(B,Z){var Y=B.length,q=2*Y>Z?2*Y:Z+5,re=0;if(Y>=Z)return B;if(kt){var ne=k6(q);if(B.copy)B.copy(ne);else for(;re<B.length;++re)ne[re]=B[re];return ne}else if(W){var Ce=new Uint8Array(q);if(Ce.set)Ce.set(B);else for(;re<Y;++re)Ce[re]=B[re];return Ce}return B.length=q,B}function le(B){for(var Z=new Array(B),Y=0;Y<B;++Y)Z[Y]=0;return Z}function ce(B,Z,Y){var q=1,re=0,ne=0,Ce=0,Ae=0,Se=B.length,Ee=W?new Uint16Array(32):le(32);for(ne=0;ne<32;++ne)Ee[ne]=0;for(ne=Se;ne<Y;++ne)B[ne]=0;Se=B.length;var _e=W?new Uint16Array(Se):le(Se);for(ne=0;ne<Se;++ne)Ee[re=B[ne]]++,q<re&&(q=re),_e[ne]=0;for(Ee[0]=0,ne=1;ne<=q;++ne)Ee[ne+16]=Ae=Ae+Ee[ne-1]<<1;for(ne=0;ne<Se;++ne)Ae=B[ne],Ae!=0&&(_e[ne]=Ee[Ae+16]++);var Te=0;for(ne=0;ne<Se;++ne)if(Te=B[ne],Te!=0)for(Ae=H(_e[ne],q)>>q-Te,Ce=(1<<q+4-Te)-1;Ce>=0;--Ce)Z[Ae|Ce<<Te]=Te&15|ne<<4;return q}var me=W?new Uint16Array(512):le(512),de=W?new Uint16Array(32):le(32);if(!W){for(var fe=0;fe<512;++fe)me[fe]=0;for(fe=0;fe<32;++fe)de[fe]=0}(function(){for(var B=[],Z=0;Z<32;Z++)B.push(5);ce(B,de,32);var Y=[];for(Z=0;Z<=143;Z++)Y.push(8);for(;Z<=255;Z++)Y.push(9);for(;Z<=279;Z++)Y.push(7);for(;Z<=287;Z++)Y.push(8);ce(Y,me,288)})();var ge=function(){for(var Z=W?new Uint8Array(32768):[],Y=0,q=0;Y<z.length-1;++Y)for(;q<z[Y+1];++q)Z[q]=Y;for(;q<32768;++q)Z[q]=29;var re=W?new Uint8Array(259):[];for(Y=0,q=0;Y<j.length-1;++Y)for(;q<j[Y+1];++q)re[q]=Y;function ne(Ae,Se){for(var Ee=0;Ee<Ae.length;){var _e=Math.min(65535,Ae.length-Ee),Te=Ee+_e==Ae.length;for(Se.write_shift(1,+Te),Se.write_shift(2,_e),Se.write_shift(2,~_e&65535);_e-- >0;)Se[Se.l++]=Ae[Ee++]}return Se.l}function Ce(Ae,Se){for(var Ee=0,_e=0,Te=W?new Uint16Array(32768):[];_e<Ae.length;){var ee=Math.min(65535,Ae.length-_e);if(ee<10){for(Ee=He(Se,Ee,+(_e+ee==Ae.length)),Ee&7&&(Ee+=8-(Ee&7)),Se.l=Ee/8|0,Se.write_shift(2,ee),Se.write_shift(2,~ee&65535);ee-- >0;)Se[Se.l++]=Ae[_e++];Ee=Se.l*8;continue}Ee=He(Se,Ee,+(_e+ee==Ae.length)+2);for(var xe=0;ee-- >0;){var we=Ae[_e];xe=(xe<<5^we)&32767;var Ne=-1,We=0;if((Ne=Te[xe])&&(Ne|=_e&-32768,Ne>_e&&(Ne-=32768),Ne<_e))for(;Ae[Ne+We]==Ae[_e+We]&&We<250;)++We;if(We>2){we=re[We],we<=22?Ee=K(Se,Ee,ae[we+1]>>1)-1:(K(Se,Ee,3),Ee+=5,K(Se,Ee,ae[we-23]>>5),Ee+=3);var St=we<8?0:we-4>>2;St>0&&(te(Se,Ee,We-j[we]),Ee+=St),we=Z[_e-Ne],Ee=K(Se,Ee,ae[we]>>3),Ee-=3;var gt=we<4?0:we-2>>1;gt>0&&(te(Se,Ee,_e-Ne-z[we]),Ee+=gt);for(var Tr=0;Tr<We;++Tr)Te[xe]=_e&32767,xe=(xe<<5^Ae[_e])&32767,++_e;ee-=We-1}else we<=143?we=we+48:Ee=V(Se,Ee,1),Ee=K(Se,Ee,ae[we]),Te[xe]=_e&32767,++_e}Ee=K(Se,Ee,0)-1}return Se.l=(Ee+7)/8|0,Se.l}return function(Se,Ee){return Se.length<8?ne(Se,Ee):Ce(Se,Ee)}}();function pe(B){var Z=hn(50+Math.floor(B.length*1.1)),Y=ge(B,Z);return Z.slice(0,Y)}var Ie=W?new Uint16Array(32768):le(32768),je=W?new Uint16Array(32768):le(32768),Be=W?new Uint16Array(128):le(128),Je=1,it=1;function Rt(B,Z){var Y=ke(B,Z)+257;Z+=5;var q=ke(B,Z)+1;Z+=5;var re=Pe(B,Z)+4;Z+=4;for(var ne=0,Ce=W?new Uint8Array(19):le(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Ee=W?new Uint8Array(8):le(8),_e=W?new Uint8Array(8):le(8),Te=Ce.length,ee=0;ee<re;++ee)Ce[F[ee]]=ne=ue(B,Z),Se<ne&&(Se=ne),Ee[ne]++,Z+=3;var xe=0;for(Ee[0]=0,ee=1;ee<=Se;++ee)_e[ee]=xe=xe+Ee[ee-1]<<1;for(ee=0;ee<Te;++ee)(xe=Ce[ee])!=0&&(Ae[ee]=_e[xe]++);var we=0;for(ee=0;ee<Te;++ee)if(we=Ce[ee],we!=0){xe=ae[Ae[ee]]>>8-we;for(var Ne=(1<<7-we)-1;Ne>=0;--Ne)Be[xe|Ne<<we]=we&7|ee<<3}var We=[];for(Se=1;We.length<Y+q;)switch(xe=Be[be(B,Z)],Z+=xe&7,xe>>>=3){case 16:for(ne=3+Re(B,Z),Z+=2,xe=We[We.length-1];ne-- >0;)We.push(xe);break;case 17:for(ne=3+ue(B,Z),Z+=3;ne-- >0;)We.push(0);break;case 18:for(ne=11+be(B,Z),Z+=7;ne-- >0;)We.push(0);break;default:We.push(xe),Se<xe&&(Se=xe);break}var St=We.slice(0,Y),gt=We.slice(Y);for(ee=Y;ee<286;++ee)St[ee]=0;for(ee=q;ee<30;++ee)gt[ee]=0;return Je=ce(St,Ie,286),it=ce(gt,je,30),Z}function ot(B,Z){if(B[0]==3&&!(B[1]&3))return[pc(Z),2];for(var Y=0,q=0,re=k6(Z||1<<18),ne=0,Ce=re.length>>>0,Ae=0,Se=0;!(q&1);){if(q=ue(B,Y),Y+=3,q>>>1)q>>1==1?(Ae=9,Se=5):(Y=Rt(B,Y),Ae=Je,Se=it);else{Y&7&&(Y+=8-(Y&7));var Ee=B[Y>>>3]|B[(Y>>>3)+1]<<8;if(Y+=32,Ee>0)for(!Z&&Ce<ne+Ee&&(re=ve(re,ne+Ee),Ce=re.length);Ee-- >0;)re[ne++]=B[Y>>>3],Y+=8;continue}for(;;){!Z&&Ce<ne+32767&&(re=ve(re,ne+32767),Ce=re.length);var _e=Fe(B,Y,Ae),Te=q>>>1==1?me[_e]:Ie[_e];if(Y+=Te&15,Te>>>=4,!(Te>>>8&255))re[ne++]=Te;else{if(Te==256)break;Te-=257;var ee=Te<8?0:Te-4>>2;ee>5&&(ee=0);var xe=ne+j[Te];ee>0&&(xe+=Fe(B,Y,ee),Y+=ee),_e=Fe(B,Y,Se),Te=q>>>1==1?de[_e]:je[_e],Y+=Te&15,Te>>>=4;var we=Te<4?0:Te-2>>1,Ne=z[Te];for(we>0&&(Ne+=Fe(B,Y,we),Y+=we),!Z&&Ce<xe&&(re=ve(re,xe+100),Ce=re.length);ne<xe;)re[ne]=re[ne-Ne],++ne}}}return Z?[re,Y+7>>>3]:[re.slice(0,ne),Y+7>>>3]}function Et(B,Z){var Y=B.slice(B.l||0),q=ot(Y,Z);return B.l+=q[1],q[0]}function rr(B,Z){if(B)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function ds(B,Z){var Y=B;Ln(Y,0);var q=[],re=[],ne={FileIndex:q,FullPaths:re};T(ne,{root:Z.root});for(var Ce=Y.length-4;(Y[Ce]!=80||Y[Ce+1]!=75||Y[Ce+2]!=5||Y[Ce+3]!=6)&&Ce>=0;)--Ce;Y.l=Ce+4,Y.l+=4;var Ae=Y.read_shift(2);Y.l+=6;var Se=Y.read_shift(4);for(Y.l=Se,Ce=0;Ce<Ae;++Ce){Y.l+=20;var Ee=Y.read_shift(4),_e=Y.read_shift(4),Te=Y.read_shift(2),ee=Y.read_shift(2),xe=Y.read_shift(2);Y.l+=8;var we=Y.read_shift(4),Ne=a(Y.slice(Y.l+Te,Y.l+Te+ee));Y.l+=Te+ee+xe;var We=Y.l;Y.l=we+4,Vn(Y,Ee,_e,ne,Ne),Y.l=We}return ne}function Vn(B,Z,Y,q,re){B.l+=2;var ne=B.read_shift(2),Ce=B.read_shift(2),Ae=o(B);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var Se=B.read_shift(4),Ee=B.read_shift(4),_e=B.read_shift(4),Te=B.read_shift(2),ee=B.read_shift(2),xe="",we=0;we<Te;++we)xe+=String.fromCharCode(B[B.l++]);if(ee){var Ne=a(B.slice(B.l,B.l+ee));(Ne[21589]||{}).mt&&(Ae=Ne[21589].mt),((re||{})[21589]||{}).mt&&(Ae=re[21589].mt)}B.l+=ee;var We=B.slice(B.l,B.l+Ee);switch(Ce){case 8:We=O(B,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ce)}var St=!1;ne&8&&(Se=B.read_shift(4),Se==134695760&&(Se=B.read_shift(4),St=!0),Ee=B.read_shift(4),_e=B.read_shift(4)),Ee!=Z&&rr(St,"Bad compressed size: "+Z+" != "+Ee),_e!=Y&&rr(St,"Bad uncompressed size: "+Y+" != "+_e),ir(q,xe,We,{unsafe:!0,mt:Ae})}function Co(B,Z){var Y=Z||{},q=[],re=[],ne=hn(1),Ce=Y.compression?8:0,Ae=0,Se=0,Ee=0,_e=0,Te=0,ee=B.FullPaths[0],xe=ee,we=B.FileIndex[0],Ne=[],We=0;for(Se=1;Se<B.FullPaths.length;++Se)if(xe=B.FullPaths[Se].slice(ee.length),we=B.FileIndex[Se],!(!we.size||!we.content||xe=="Sh33tJ5")){var St=_e,gt=hn(xe.length);for(Ee=0;Ee<xe.length;++Ee)gt.write_shift(1,xe.charCodeAt(Ee)&127);gt=gt.slice(0,gt.l),Ne[Te]=o9e.buf(we.content,0);var Tr=we.content;Ce==8&&(Tr=N(Tr)),ne=hn(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,Ae),ne.write_shift(2,Ce),we.mt?s(ne,we.mt):ne.write_shift(4,0),ne.write_shift(-4,Ne[Te]),ne.write_shift(4,Tr.length),ne.write_shift(4,we.content.length),ne.write_shift(2,gt.length),ne.write_shift(2,0),_e+=ne.length,q.push(ne),_e+=gt.length,q.push(gt),_e+=Tr.length,q.push(Tr),ne=hn(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,Ae),ne.write_shift(2,Ce),ne.write_shift(4,0),ne.write_shift(-4,Ne[Te]),ne.write_shift(4,Tr.length),ne.write_shift(4,we.content.length),ne.write_shift(2,gt.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,St),We+=ne.l,re.push(ne),We+=gt.length,re.push(gt),++Te}return ne=hn(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,Te),ne.write_shift(2,Te),ne.write_shift(4,We),ne.write_shift(4,_e),ne.write_shift(2,0),jl([jl(q),jl(re),ne])}var en={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wt(B,Z){if(B.ctype)return B.ctype;var Y=B.name||"",q=Y.match(/\.([^\.]+)$/);return q&&en[q[1]]||Z&&(q=(Y=Z).match(/[\.\\]([^\.\\])+$/),q&&en[q[1]])?en[q[1]]:"application/octet-stream"}function Cr(B){for(var Z=O6(B),Y=[],q=0;q<Z.length;q+=76)Y.push(Z.slice(q,q+76));return Y.join(`\r
`)+`\r
`}function jr(B){var Z=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var _e=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],q=Z.split(`\r
`),re=0;re<q.length;++re){var ne=q[re];if(ne.length==0){Y.push("");continue}for(var Ce=0;Ce<ne.length;){var Ae=76,Se=ne.slice(Ce,Ce+Ae);Se.charAt(Ae-1)=="="?Ae--:Se.charAt(Ae-2)=="="?Ae-=2:Se.charAt(Ae-3)=="="&&(Ae-=3),Se=ne.slice(Ce,Ce+Ae),Ce+=Ae,Ce<ne.length&&(Se+="="),Y.push(Se)}}return Y.join(`\r
`)}function Ve(B){for(var Z=[],Y=0;Y<B.length;++Y){for(var q=B[Y];Y<=B.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+B[++Y];Z.push(q)}for(var re=0;re<Z.length;++re)Z[re]=Z[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return lo(Z.join(`\r
`))}function Ot(B,Z,Y){for(var q="",re="",ne="",Ce,Ae=0;Ae<10;++Ae){var Se=Z[Ae];if(!Se||Se.match(/^\s*$/))break;var Ee=Se.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":q=Ee[2].trim();break;case"content-type":ne=Ee[2].trim();break;case"content-transfer-encoding":re=Ee[2].trim();break}}switch(++Ae,re.toLowerCase()){case"base64":Ce=lo(as(Z.slice(Ae).join("")));break;case"quoted-printable":Ce=Ve(Z.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var _e=ir(B,q.slice(Y.length),Ce,{unsafe:!0});ne&&(_e.ctype=ne)}function nr(B,Z){if(y(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=Z&&Z.root||"",q=(kt&&Buffer.isBuffer(B)?B.toString("binary"):y(B)).split(`\r
`),re=0,ne="";for(re=0;re<q.length;++re)if(ne=q[re],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),Y||(Y=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),ne.slice(0,Y.length)!=Y););var Ce=(q[1]||"").match(/boundary="(.*?)"/);if(!Ce)throw new Error("MAD cannot find boundary");var Ae="--"+(Ce[1]||""),Se=[],Ee=[],_e={FileIndex:Se,FullPaths:Ee};T(_e);var Te,ee=0;for(re=0;re<q.length;++re){var xe=q[re];xe!==Ae&&xe!==Ae+"--"||(ee++&&Ot(_e,q.slice(Te,re),Y),Te=re)}return _e}function kr(B,Z){var Y=Z||{},q=Y.boundary||"SheetJS";q="------="+q;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],ne=B.FullPaths[0],Ce=ne,Ae=B.FileIndex[0],Se=1;Se<B.FullPaths.length;++Se)if(Ce=B.FullPaths[Se].slice(ne.length),Ae=B.FileIndex[Se],!(!Ae.size||!Ae.content||Ce=="Sh33tJ5")){Ce=Ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var Ee=Ae.content,_e=kt&&Buffer.isBuffer(Ee)?Ee.toString("binary"):y(Ee),Te=0,ee=Math.min(1024,_e.length),xe=0,we=0;we<=ee;++we)(xe=_e.charCodeAt(we))>=32&&xe<128&&++Te;var Ne=Te>=ee*4/5;re.push(q),re.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+Ce),re.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),re.push("Content-Type: "+Wt(Ae,Ce)),re.push(""),re.push(Ne?jr(_e):Cr(_e))}return re.push(q+`--\r
`),re.join(`\r
`)}function fr(B){var Z={};return T(Z,B),Z}function ir(B,Z,Y,q){var re=q&&q.unsafe;re||T(B);var ne=!re&&It.find(B,Z);if(!ne){var Ce=B.FullPaths[0];Z.slice(0,Ce.length)==Ce?Ce=Z:(Ce.slice(-1)!="/"&&(Ce+="/"),Ce=(Ce+Z).replace("//","/")),ne={name:i(Z),type:2},B.FileIndex.push(ne),B.FullPaths.push(Ce),re||It.utils.cfb_gc(B)}return ne.content=Y,ne.size=Y?Y.length:0,q&&(q.CLSID&&(ne.clsid=q.CLSID),q.mt&&(ne.mt=q.mt),q.ct&&(ne.ct=q.ct)),ne}function Er(B,Z){T(B);var Y=It.find(B,Z);if(Y){for(var q=0;q<B.FileIndex.length;++q)if(B.FileIndex[q]==Y)return B.FileIndex.splice(q,1),B.FullPaths.splice(q,1),!0}return!1}function Oi(B,Z,Y){T(B);var q=It.find(B,Z);if(q){for(var re=0;re<B.FileIndex.length;++re)if(B.FileIndex[re]==q)return B.FileIndex[re].name=i(Y),B.FullPaths[re]=Y,!0}return!1}function Kt(B){k(B,!0)}return e.find=D,e.read=E,e.parse=u,e.write=_,e.writeFile=P,e.utils={cfb_new:fr,cfb_add:ir,cfb_del:Er,cfb_mov:Oi,cfb_gc:Kt,ReadShift:Gm,CheckField:Sq,prep_blob:Ln,bconcat:jl,use_zlib:A,_deflateRaw:pe,_inflateRaw:Et,consts:se},e}();function a9e(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function na(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function nD(t){for(var e=[],r=na(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var K1=new Date(1899,11,30,0,0,0);function Ci(t,e){var r=t.getTime(),n=K1.getTime()+(t.getTimezoneOffset()-K1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var tq=new Date,l9e=K1.getTime()+(tq.getTimezoneOffset()-K1.getTimezoneOffset())*6e4,$6=tq.getTimezoneOffset();function RC(t){var e=new Date;return e.setTime(t*24*60*60*1e3+l9e),e.getTimezoneOffset()!==$6&&e.setTime(e.getTime()+(e.getTimezoneOffset()-$6)*6e4),e}function c9e(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var H6=new Date("2017-02-19T19:06:09.000Z"),rq=isNaN(H6.getFullYear())?new Date("2/19/17"):H6,u9e=rq.getFullYear()==2017;function On(t,e){var r=new Date(t);if(u9e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(rq.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Yu(t,e){if(kt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return mm(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return mm(VX(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return mm(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return mm(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function $n(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=$n(t[r]));return e}function Wr(t,e){for(var r="";r.length<e;)r+=t;return r}function vo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var h9e=["january","february","march","april","may","june","july","august","september","october","november","december"];function Af(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&h9e.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var d9e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}}();function nq(t){return t?t.content&&t.type?Yu(t.content,!0):t.data?dm(t.data):t.asNodeBuffer&&kt?dm(t.asNodeBuffer().toString("binary")):t.asBinary?dm(t.asBinary()):t._data&&t._data.getContent?dm(Yu(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function iq(t){if(!t)return null;if(t.data)return R6(t.data);if(t.asNodeBuffer&&kt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?R6(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function f9e(t){return t&&t.name.slice(-4)===".bin"?iq(t):nq(t)}function bs(t,e){for(var r=t.FullPaths||na(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function iD(t,e){var r=bs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function nn(t,e,r){if(!r)return f9e(iD(t,e));if(!e)return null;try{return nn(t,e)}catch{return null}}function es(t,e,r){if(!r)return nq(iD(t,e));if(!e)return null;try{return es(t,e)}catch{return null}}function g9e(t,e,r){return iq(iD(t,e))}function j6(t){for(var e=t.FullPaths||na(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function m9e(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return kt?n=dh(r):n=Pze(r),It.utils.cfb_add(t,e,n)}It.utils.cfb_add(t,e,r)}else t.file(e,r)}function sq(t,e){switch(e.type){case"base64":return It.read(t,{type:"base64"});case"binary":return It.read(t,{type:"binary"});case"buffer":case"array":return It.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function gm(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var oq=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,p9e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,B6=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,v9e=/<[^>]*>/g,li=oq.match(B6)?B6:v9e,y9e=/<\w*:/,w9e=/<(\/?)\w+:/;function st(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(p9e),a=0,l="",c=0,u="",h="",d=1;if(o)for(c=0;c!=o.length;++c){for(h=o[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+d,h.length-d),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var f=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(n[f]&&u.slice(a-3,a)=="ext")continue;n[f]=l,n[f.toLowerCase()]=l}}return n}function ua(t){return t.replace(w9e,"<$1")}var aq={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},x9e=nD(aq),Lt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(a,l){return aq[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(e,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),b9e=/[&<>'"]/g,S9e=/[\u0000-\u001f]/g;function sD(t){var e=t+"";return e.replace(b9e,function(r){return x9e[r]}).replace(/\n/g,"<br/>").replace(S9e,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var V6=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Rr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function M_(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function U6(t){var e=pc(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function W6(t){return dh(t,"binary").toString("utf8")}var Jy="foo bar baz",dr=kt&&(W6(Jy)==M_(Jy)&&W6||U6(Jy)==M_(Jy)&&U6)||M_,mm=kt?function(t){return dh(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},b0=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),lq=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),C9e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),E9e=/<\/?(?:vt:)?variant>/g,T9e=/<(?:vt:)([^>]*)>([\s\S]*)</;function z6(t,e){var r=st(t),n=t.match(C9e(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(E9e,"").match(T9e);o&&i.push({v:dr(o[2]),t:o[1]})}),i}var _9e=/(^\s|\s$|\n)/;function R9e(t){return na(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function A9e(t,e,r){return"<"+t+(r!=null?R9e(r):"")+(e!=null?(e.match(_9e)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function oD(t){if(kt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return dr(fh(eD(t)));throw new Error("Bad input format: expected Buffer or string")}var S0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,O9e={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},k9e=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function I9e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function N9e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var G6=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Y6=kt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:dh(e)})):G6(t)}:G6,K6=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ha(t,i)));return n.join("").replace(xi,"")},aD=kt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(xi,""):K6(t,e,r)}:K6,X6=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},cq=kt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):X6(t,e,r)}:X6,q6=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Kh(t,i)));return n.join("")},pv=kt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):q6(e,r,n)}:q6,uq=function(t,e){var r=Zi(t,e);return r>0?pv(t,e+4,e+4+r-1):""},hq=uq,dq=function(t,e){var r=Zi(t,e);return r>0?pv(t,e+4,e+4+r-1):""},fq=dq,gq=function(t,e){var r=2*Zi(t,e);return r>0?pv(t,e+4,e+4+r-1):""},mq=gq,pq=function(e,r){var n=Zi(e,r);return n>0?aD(e,r+4,r+4+n):""},vq=pq,yq=function(t,e){var r=Zi(t,e);return r>0?pv(t,e+4,e+4+r):""},wq=yq,xq=function(t,e){return I9e(t,e)},X1=xq,bq=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kt&&(hq=function(e,r){if(!Buffer.isBuffer(e))return uq(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},fq=function(e,r){if(!Buffer.isBuffer(e))return dq(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},mq=function(e,r){if(!Buffer.isBuffer(e))return gq(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},vq=function(e,r){if(!Buffer.isBuffer(e))return pq(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},wq=function(e,r){if(!Buffer.isBuffer(e))return yq(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},X1=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):xq(e,r)},bq=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Kh=function(t,e){return t[e]},Ha=function(t,e){return t[e+1]*256+t[e]},M9e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Zi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ou=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},P9e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Gm(t,e){var r="",n,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ha(this,c)),c+=2;t*=2;break;case"utf8":r=pv(this,this.l,this.l+t);break;case"utf16le":t*=2,r=aD(this,this.l,this.l+t);break;case"wstr":return Gm.call(this,t,"dbcs");case"lpstr-ansi":r=hq(this,this.l),t=4+Zi(this,this.l);break;case"lpstr-cp":r=fq(this,this.l),t=4+Zi(this,this.l);break;case"lpwstr":r=mq(this,this.l),t=4+2*Zi(this,this.l);break;case"lpp4":t=4+Zi(this,this.l),r=vq(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Zi(this,this.l),r=wq(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Kh(this,this.l+t++))!==0;)s.push(qy(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Ha(this,this.l+t))!==0;)s.push(qy(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Kh(this,c),this.l=c+1,a=Gm.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(qy(Ha(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Kh(this,c),this.l=c+1,a=Gm.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(qy(Kh(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=Kh(this,this.l),this.l++,n;case 2:return n=(e==="i"?M9e:Ha)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ou:P9e)(this,this.l),this.l+=4,n):(i=Zi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=X1(this,this.l):i=X1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=cq(this,this.l,t);break}}return this.l+=t,r}var D9e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},L9e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},F9e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function $9e(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)F9e(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,D9e(this,e,this.l);break;case 8:if(n=8,r==="f"){N9e(this,e,this.l);break}case 16:break;case-4:n=4,L9e(this,e,this.l);break}return this.l+=n,this}function Sq(t,e){var r=cq(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Ln(t,e){t.l=e,t.read_shift=Gm,t.chk=Sq,t.write_shift=$9e}function ni(t,e){t.l+=e}function hn(t){var e=pc(t);return Ln(e,0),e}function ml(t,e,r){if(t){var n,i,s;Ln(t,t.l||0);for(var o=t.length,a=0,l=0;t.l<o;){a=t.read_shift(1),a&128&&(a=(a&127)+((t.read_shift(1)&127)<<7));var c=tb[a]||tb[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var u=c.f&&c.f(t,s,r);if(t.l=l,e(u,c,a))return}}}function vk(){var t=[],e=kt?256:2048,r=function(c){var u=hn(c);return Ln(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},o=function(){return i(),jl(t)},a=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function Ym(t,e,r){var n=$n(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function J6(t,e,r){var n=$n(t);return n.s=Ym(n.s,e.s,r),n.e=Ym(n.e,e.s,r),n}function Km(t,e){if(t.cRel&&t.c<0)for(t=$n(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=$n(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ut(t);return!t.cRel&&t.cRel!=null&&(r=B9e(r)),!t.rRel&&t.rRel!=null&&(r=H9e(r)),r}function P_(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+vn(t.s.c)+":"+(t.e.cRel?"":"$")+vn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Hn(t.s.r)+":"+(t.e.rRel?"":"$")+Hn(t.e.r):Km(t.s,e.biff)+":"+Km(t.e,e.biff)}function lD(t){return parseInt(j9e(t),10)-1}function Hn(t){return""+(t+1)}function H9e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function j9e(t){return t.replace(/\$(\d+)$/,"$1")}function cD(t){for(var e=V9e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function vn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function B9e(t){return t.replace(/^([A-Z])/,"$$$1")}function V9e(t){return t.replace(/^\$([A-Z])/,"$1")}function U9e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yi(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ut(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cg(t){var e=t.indexOf(":");return e==-1?{s:yi(t),e:yi(t)}:{s:yi(t.slice(0,e)),e:yi(t.slice(e+1))}}function Nt(t,e){return typeof e>"u"||typeof e=="number"?Nt(t.s,t.e):(typeof t!="string"&&(t=ut(t)),typeof e!="string"&&(e=ut(e)),t==e?t:t+":"+e)}function Yr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Z6(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=$s(t.z,r?Ci(e):e)}catch{}try{return t.w=$s((t.XF||{}).numFmtId||(r?14:0),r?Ci(e):e)}catch{return""+e}}function sl(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?ph[t.v]||t.v:e==null?Z6(t,t.v):Z6(t,e))}function Ic(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Cq(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?yi(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Yr(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var f={v:e[h][d]},m=o+h,g=a+d;if(c.s.r>m&&(c.s.r=m),c.s.c>g&&(c.s.c=g),c.e.r<m&&(c.e.r=m),c.e.c<g&&(c.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))f=e[h][d];else if(Array.isArray(f.v)&&(f.f=e[h][d][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||ft[14],n.cellDates?(f.t="d",f.w=$s(f.z,Ci(f.v))):(f.t="n",f.v=Ci(f.v),f.w=$s(f.z,f.v))):f.t="s";if(i)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(f.z=s[m][g].z),s[m][g]=f;else{var v=ut({c:g,r:m});s[v]&&s[v].z&&(f.z=s[v].z),s[v]=f}}}return c.s.c<1e7&&(s["!ref"]=Nt(c)),s}function ug(t,e){return Cq(null,t,e)}function W9e(t){return t.read_shift(4,"i")}function ti(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function z9e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function uD(t,e){var r=t.l,n=t.read_shift(1),i=ti(t),s=[],o={t:i,h:i};if(n&1){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(z9e(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}var G9e=uD;function zs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function gh(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var Y9e=ti;function hD(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var K9e=ti,yk=hD;function dD(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?X1([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ou(e,0)>>2;return r?i/100:i}function Eq(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var mh=Eq;function Zn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function X9e(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Ou[i];c&&(e.rgb=E0(c));break;case 2:e.rgb=E0([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function q9e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Tq(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function J9e(t){return Tq(t,1)}function Z9e(t){return Tq(t,2)}var fD=2,Ii=3,Zy=11,Q6=12,q1=19,Qy=64,Q9e=65,eGe=71,tGe=4108,rGe=4126,En=80,_q=81,nGe=[En,_q],iGe={1:{n:"CodePage",t:fD},2:{n:"Category",t:En},3:{n:"PresentationFormat",t:En},4:{n:"ByteCount",t:Ii},5:{n:"LineCount",t:Ii},6:{n:"ParagraphCount",t:Ii},7:{n:"SlideCount",t:Ii},8:{n:"NoteCount",t:Ii},9:{n:"HiddenCount",t:Ii},10:{n:"MultimediaClipCount",t:Ii},11:{n:"ScaleCrop",t:Zy},12:{n:"HeadingPairs",t:tGe},13:{n:"TitlesOfParts",t:rGe},14:{n:"Manager",t:En},15:{n:"Company",t:En},16:{n:"LinksUpToDate",t:Zy},17:{n:"CharacterCount",t:Ii},19:{n:"SharedDoc",t:Zy},22:{n:"HyperlinksChanged",t:Zy},23:{n:"AppVersion",t:Ii,p:"version"},24:{n:"DigSig",t:Q9e},26:{n:"ContentType",t:En},27:{n:"ContentStatus",t:En},28:{n:"Language",t:En},29:{n:"Version",t:En},255:{},2147483648:{n:"Locale",t:q1},2147483651:{n:"Behavior",t:q1},1919054434:{}},sGe={1:{n:"CodePage",t:fD},2:{n:"Title",t:En},3:{n:"Subject",t:En},4:{n:"Author",t:En},5:{n:"Keywords",t:En},6:{n:"Comments",t:En},7:{n:"Template",t:En},8:{n:"LastAuthor",t:En},9:{n:"RevNumber",t:En},10:{n:"EditTime",t:Qy},11:{n:"LastPrinted",t:Qy},12:{n:"CreatedDate",t:Qy},13:{n:"ModifiedDate",t:Qy},14:{n:"PageCount",t:Ii},15:{n:"WordCount",t:Ii},16:{n:"CharCount",t:Ii},17:{n:"Thumbnail",t:eGe},18:{n:"Application",t:En},19:{n:"DocSecurity",t:Ii},255:{},2147483648:{n:"Locale",t:q1},2147483651:{n:"Behavior",t:q1},1919054434:{}},e5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},oGe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function aGe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var lGe=aGe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ou=$n(lGe),ph={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Rq={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},t5={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function cGe(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function uGe(t){var e=cGe();if(!t||!t.match)return e;var r={};if((t.match(li)||[]).forEach(function(n){var i=st(n);switch(i[0].replace(y9e,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[t5[i.ContentType]]!==void 0&&e[t5[i.ContentType]].push(i.PartName);break}}),e.xmlns!==O9e.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var pd={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wk(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Xm(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(li)||[]).forEach(function(i){var s=st(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:gm(s.Target,e);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}var hGe="application/vnd.oasis.opendocument.spreadsheet";function dGe(t,e){for(var r=oD(t),n,i;n=S0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=st(n[0],!1),i.path=="/"&&i.type!==hGe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var qm=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],fGe=function(){for(var t=new Array(qm.length),e=0;e<qm.length;++e){var r=qm[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Aq(t){var e={};t=dr(t);for(var r=0;r<qm.length;++r){var n=qm[r],i=t.match(fGe[r]);i!=null&&i.length>0&&(e[n[1]]=Lt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=On(e[n[1]]))}return e}var gGe=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Oq(t,e,r,n){var i=[];if(typeof t=="string")i=z6(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(u){return{v:u}}));var o=typeof e=="string"?z6(e,n).map(function(u){return u.v}):e,a=0,l=0;if(o.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function mGe(t,e,r){var n={};return e||(e={}),t=dr(t),gGe.forEach(function(i){var s=(t.match(b0(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Lt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Oq(n.HeadingPairs,n.TitlesOfParts,e,r),e}var pGe=/<[^>]+>[^<]*/g;function vGe(t,e){var r={},n="",i=t.match(pGe);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=st(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Lt(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Lt(u);break;case"bool":r[n]=Rr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=On(u);break;case"cy":case"error":r[n]=Lt(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}var yGe={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},D_;function wGe(t,e,r){D_||(D_=nD(yGe)),e=D_[e]||e,t[e]=r}function gD(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kq(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function Iq(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Nq(t,e,r){return e===31?Iq(t):kq(t,e,r)}function xk(t,e,r){return Nq(t,e,r===!1?0:4)}function xGe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Nq(t,e,0)}function bGe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(xi,""),t.l-i&2&&(t.l+=2)}return r}function SGe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(xi,"");return r}function CGe(t){var e=t.l,r=J1(t,_q);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=J1(t,Ii);return[r,n]}function EGe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(CGe(t));return r}function r5(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(xi,"").replace(fm,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Mq(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function TGe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function J1(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Q6&&n!==e&&nGe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Q6?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return kq(t,n,4).replace(xi,"");case 31:return Iq(t);case 64:return gD(t);case 65:return Mq(t);case 71:return TGe(t);case 80:return xk(t,n,!s.raw).replace(xi,"");case 81:return xGe(t,n).replace(xi,"");case 4108:return EGe(t);case 4126:case 4127:return n==4127?bGe(t):SGe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function n5(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0,a=0,l=-1,c={};for(o=0;o!=i;++o){var u=t.read_shift(4),h=t.read_shift(4);s[o]=[u,h+r]}s.sort(function(b,x){return b[1]-x[1]});var d={};for(o=0;o!=i;++o){if(t.l!==s[o][1]){var f=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,f=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],f=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],f=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(f=!1,t.l=s[o][1]),f)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(d[m.n]=J1(t,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:uo(a=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(s[o][0]===1){if(a=d.CodePage=J1(t,fD),uo(a),l!==-1){var g=t.l;t.l=s[l][1],c=r5(t,a),t.l=g}}else if(s[o][0]===0){if(a===0){l=o,t.l=s[o+1][1];continue}c=r5(t,a)}else{var v=c[s[o][0]],w;switch(t[t.l]){case 65:t.l+=4,w=Mq(t);break;case 30:t.l+=4,w=xk(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,w=xk(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,w=t.read_shift(4,"i");break;case 19:t.l+=4,w=t.read_shift(4);break;case 5:t.l+=4,w=t.read_shift(8,"f");break;case 11:t.l+=4,w=Xr(t,4);break;case 64:t.l+=4,w=On(gD(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[v]=w}}return t.l=r+n,d}function i5(t,e,r){var n=t.content;if(!n)return{};Ln(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==It.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var h=n5(n,e),d={SystemIdentifier:c};for(var f in h)d[f]=h[f];if(d.FMTID=s,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=n5(n,null)}catch{}for(f in m)d[f]=m[f];return d.FMTID=[s,o],d}function kl(t,e){return t.read_shift(e),null}function _Ge(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Xr(t,e){return t.read_shift(e)===1}function sn(t){return t.read_shift(2,"u")}function Pq(t,e){return _Ge(t,e,sn)}function RGe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function vv(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function AGe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,a,l={};i&&(o=t.read_shift(2)),n&&(a=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*o),n&&(t.l+=a),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ku(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function yv(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ku(t,n,r)}function vh(t,e,r){if(r.biff>5)return yv(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function OGe(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function kGe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(xi,"");return n&&(t.l+=24),i}function IGe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(xi,"");return r+o}function NGe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kGe(t);case"0303000000000000c000000000000046":return IGe(t);default:throw new Error("Unsupported Moniker "+r)}}function ew(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(xi,""):"";return r}function MGe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,o,a,l,c="",u,h;i&16&&(s=ew(t,r-t.l)),i&128&&(o=ew(t,r-t.l)),(i&257)===257&&(a=ew(t,r-t.l)),(i&257)===1&&(l=NGe(t,r-t.l)),i&8&&(c=ew(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(h=gD(t)),t.l=r;var d=o||a||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var f={Target:d};return u&&(f.guid=u),h&&(f.time=h),s&&(f.Tooltip=s),f}function Dq(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function Lq(t,e){var r=Dq(t);return r[3]=0,r}function ha(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function PGe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function DGe(t,e,r){return e===0?"":vh(t,e,r)}function LGe(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function Fq(t){var e=t.read_shift(2),r=dD(t);return[e,r]}function FGe(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=vv(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function AC(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function $q(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var $Ge=$q;function Hq(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function HGe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function jGe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function zn(t){t.l+=2,t.l+=t.read_shift(2)}var BGe={0:zn,4:zn,5:zn,6:zn,7:jGe,8:zn,9:zn,10:zn,11:zn,12:zn,13:HGe,14:zn,15:zn,16:zn,17:zn,18:zn,19:zn,20:zn,21:Hq};function VGe(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(BGe[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function tw(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function UGe(t,e){return e===0||t.read_shift(2),1200}function WGe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=vh(t,0,r);return t.read_shift(e+n-t.l),i}function zGe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function GGe(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=vv(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function YGe(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0;o!=i&&t.l<r;++o)s.push(AGe(t));return s.Count=n,s.Unique=i,s}function KGe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function XGe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function qGe(t){var e=PGe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function JGe(t){return t.read_shift(2),t.read_shift(4)}function s5(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function ZGe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function QGe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function eYe(){}function tYe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=vv(t,0,r),n}function rYe(t){var e=ha(t);return e.isst=t.read_shift(4),e}function nYe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=ha(t);r.biff==2&&t.l++;var s=yv(t,n-t.l,r);return i.val=s,i}function iYe(t,e,r){var n=t.read_shift(2),i=vh(t,0,r);return[n,i]}var sYe=vh;function o5(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),o=t.read_shift(i),a=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function oYe(t){var e=t.read_shift(2),r=t.read_shift(2),n=Fq(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function aYe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(Fq(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function lYe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function cYe(t,e,r,n){var i={},s=t.read_shift(4),o=t.read_shift(4),a=t.read_shift(4),l=t.read_shift(2);return i.patternType=oGe[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function uYe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=cYe(t,e,n.fStyle,r),n}function hYe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function a5(t,e,r){var n=ha(t);(r.biff==2||e==9)&&++t.l;var i=RGe(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function dYe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ha(t),i=Zn(t);return n.val=i,n}var l5=DGe;function fYe(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Ku(t,s),a=[];n>t.l;)a.push(yv(t));return[s,i,o,a]}function c5(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=FGe(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var gYe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function u5(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),a=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ku(t,o,r);i&32&&(c=gYe[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||a===0||!(u>0)?[]:Xqe(t,u,r,a);return{chKey:s,Name:c,itab:l,rgce:h}}function jq(t,e,r){if(r.biff<8)return mYe(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(LGe(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function mYe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=vv(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function pYe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ku(t,n,r),o=Ku(t,i,r);return[s,o]}function vYe(t,e,r){var n=$q(t);t.l++;var i=t.read_shift(1);return e-=8,[qqe(t,e,r),i,n]}function h5(t,e,r){var n=$Ge(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Yqe(t,e,r)]}function yYe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function wYe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=vh(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},a,o,s]}}function xYe(t,e,r){return wYe(t,e,r)}function bYe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(AC(t));return r}function SYe(t,e,r){if(r&&r.biff<8)return EYe(t,e,r);var n=Hq(t),i=VGe(t,e-22,n[1]);return{cmo:n,ft:i}}var CYe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function EYe(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((CYe[n]||ni)(t,e,r)),{cmo:[i,n,s],ft:o}}function TYe(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=OGe(t,6,r);var a=t.read_shift(2);t.read_shift(2),sn(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=Ku(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function _Ye(t,e){var r=AC(t);t.l+=16;var n=MGe(t,e-24);return[r,n]}function RYe(t,e){t.read_shift(2);var r=AC(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(xi,""),[r,n]}function AYe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=e5[r]||r,r=t.read_shift(2),e[1]=e5[r]||r,e}function OYe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Lq(t));return r}function kYe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Lq(t));return r}function IYe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Bq(t,e,r){if(!r.cellStyles)return ni(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function NYe(t,e){var r={};return e<32||(t.l+=16,r.header=Zn(t),r.footer=Zn(t),t.l+=2),r}function MYe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var PYe=ha,DYe=Pq,LYe=yv;function FYe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function $Ye(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ha(t);++t.l;var i=vh(t,e-7,r);return n.t="str",n.val=i,n}function HYe(t){var e=ha(t);++t.l;var r=Zn(t);return e.t="n",e.val=r,e}function jYe(t){var e=ha(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function BYe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function VYe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function UYe(t,e,r){var n=t.l+e,i=ha(t),s=t.read_shift(2),o=Ku(t,s,r);return t.l=n,i.t="str",i.val=o,i}var WYe=[2,3,48,49,131,139,140,245],d5=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=nD({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=pc(1);switch(l.type){case"base64":u=lo(as(a));break;case"binary":u=lo(a);break;case"buffer":case"array":u=a;break}Ln(u,0);var h=u.read_shift(1),d=!!(h&136),f=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,d=!0;break;case 49:f=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,v=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(v=u.read_shift(2));var w=u.read_shift(2),b=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var x=[],C={},S=Math.min(u.length,h==2?521:v-10-(f?264:0)),E=m?32:11;u.l<S&&u[u.l]!=13;)switch(C={},C.name=pk.utils.decode(b,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,C.type=String.fromCharCode(u.read_shift(1)),h!=2&&!m&&(C.offset=u.read_shift(4)),C.len=u.read_shift(1),h==2&&(C.offset=u.read_shift(2)),C.dec=u.read_shift(1),C.name.length&&x.push(C),h!=2&&(u.l+=m?13:14),C.type){case"B":(!f||C.len!=8)&&l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var T=0,I=0;for(c[0]=[],I=0;I!=x.length;++I)c[0][I]=x[I].name;for(;g-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++T]=[],I=0,I=0;I!=x.length;++I){var k=u.slice(u.l,u.l+x[I].len);u.l+=x[I].len,Ln(k,0);var M=pk.utils.decode(b,k);switch(x[I].type){case"C":M.trim().length&&(c[T][I]=M.replace(/\s+$/,""));break;case"D":M.length===8?c[T][I]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):c[T][I]=M;break;case"F":c[T][I]=parseFloat(M.trim());break;case"+":case"I":c[T][I]=m?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":c[T][I]=!0;break;case"N":case"F":c[T][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[T][I]="##MEMO##"+(m?parseInt(M.trim(),10):k.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(c[T][I]=+M||0);break;case"@":c[T][I]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[T][I]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[T][I]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][I]=-k.read_shift(-8,"f");break;case"B":if(f&&x[I].len==8){c[T][I]=k.read_shift(8,"f");break}case"G":case"P":k.l+=x[I].len;break;case"0":if(x[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[I].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=ug(r(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return Ic(n(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&uo(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=vk(),h=Rk(a,{header:1,raw:!0,cellDates:!0}),d=h[0],f=h.slice(1),m=a["!cols"]||[],g=0,v=0,w=0,b=1;for(g=0;g<d.length;++g){if(((m[g]||{}).DBF||{}).name){d[g]=m[g].DBF.name,++w;continue}if(d[g]!=null){if(++w,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(v=0;v<1024;++v)if(d.indexOf(d[g]+"_"+v)==-1){d[g]+="_"+v;break}}}}var x=Yr(a["!ref"]),C=[],S=[],E=[];for(g=0;g<=x.e.c-x.s.c;++g){var T="",I="",k=0,M=[];for(v=0;v<f.length;++v)f[v][g]!=null&&M.push(f[v][g]);if(M.length==0||d[g]==null){C[g]="?";continue}for(v=0;v<M.length;++v){switch(typeof M[v]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=M[v]instanceof Date?"D":"C";break;default:I="C"}k=Math.max(k,String(M[v]).length),T=T&&T!=I?"C":I}k>250&&(k=250),I=((m[g]||{}).DBF||{}).type,I=="C"&&m[g].DBF.len>k&&(k=m[g].DBF.len),T=="B"&&I=="N"&&(T="N",E[g]=m[g].DBF.dec,k=m[g].DBF.len),S[g]=T=="C"||I=="N"?k:s[T]||0,b+=S[g],C[g]=T}var D=u.next(32);for(D.write_shift(4,318902576),D.write_shift(4,f.length),D.write_shift(2,296+32*w),D.write_shift(2,b),g=0;g<4;++g)D.write_shift(4,0);for(D.write_shift(4,0|(+e[jX]||3)<<8),g=0,v=0;g<d.length;++g)if(d[g]!=null){var L=u.next(32),U=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,U,"sbcs"),L.write_shift(1,C[g]=="?"?"C":C[g],"sbcs"),L.write_shift(4,v),L.write_shift(1,S[g]||s[C[g]]||0),L.write_shift(1,E[g]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),v+=S[g]||s[C[g]]||0}var J=u.next(264);for(J.write_shift(4,13),g=0;g<65;++g)J.write_shift(4,0);for(g=0;g<f.length;++g){var X=u.next(b);for(X.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(C[v]){case"L":X.write_shift(1,f[g][v]==null?63:f[g][v]?84:70);break;case"B":X.write_shift(8,f[g][v]||0,"f");break;case"N":var ie="0";for(typeof f[g][v]=="number"&&(ie=f[g][v].toFixed(E[v]||0)),w=0;w<S[v]-ie.length;++w)X.write_shift(1,32);X.write_shift(1,ie,"sbcs");break;case"D":f[g][v]?(X.write_shift(4,("0000"+f[g][v].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(f[g][v].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+f[g][v].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var se=String(f[g][v]!=null?f[g][v]:"").slice(0,S[v]);for(X.write_shift(1,se,"sbcs"),w=0;w<S[v]-se.length;++w)X.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),zYe=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+na(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,f){var m=t[f];return typeof m=="number"?A6(m):m},n=function(d,f,m){var g=f.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?d:A6(g)};t["|"]=254;function i(d,f){switch(f.type){case"base64":return s(as(d),f);case"binary":return s(d,f);case"buffer":return s(kt&&Buffer.isBuffer(d)?d.toString("binary"):fh(d),f);case"array":return s(Yu(d),f)}throw new Error("Unrecognized type "+f.type)}function s(d,f){var m=d.split(/[\n\r]+/),g=-1,v=-1,w=0,b=0,x=[],C=[],S=null,E={},T=[],I=[],k=[],M=0,D;for(+f.codepage>=0&&uo(+f.codepage);w!==m.length;++w){M=0;var L=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),U=L.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),J=U[0],X;if(L.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&C.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,se=!1,P=!1,y=!1,_=-1,R=-1;for(b=1;b<U.length;++b)switch(U[b].charAt(0)){case"A":break;case"X":v=parseInt(U[b].slice(1))-1,se=!0;break;case"Y":for(g=parseInt(U[b].slice(1))-1,se||(v=0),D=x.length;D<=g;++D)x[D]=[];break;case"K":X=U[b].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(vo(X))?isNaN(Af(X).getDate())||(X=On(X)):(X=vo(X),S!==null&&lg(S)&&(X=RC(X))),ie=!0;break;case"E":y=!0;var A=Pd(U[b].slice(1),{r:g,c:v});x[g][v]=[x[g][v],A];break;case"S":P=!0,x[g][v]=[x[g][v],"S5S"];break;case"G":break;case"R":_=parseInt(U[b].slice(1))-1;break;case"C":R=parseInt(U[b].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+L)}if(ie&&(x[g][v]&&x[g][v].length==2?x[g][v][0]=X:x[g][v]=X,S=null),P){if(y)throw new Error("SYLK shared formula cannot have own formula");var O=_>-1&&x[_][R];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");x[g][v][1]=Jq(O[1],{r:g-_,c:v-R})}break;case"F":var N=0;for(b=1;b<U.length;++b)switch(U[b].charAt(0)){case"X":v=parseInt(U[b].slice(1))-1,++N;break;case"Y":for(g=parseInt(U[b].slice(1))-1,D=x.length;D<=g;++D)x[D]=[];break;case"M":M=parseInt(U[b].slice(1))/20;break;case"F":break;case"G":break;case"P":S=C[parseInt(U[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=U[b].slice(1).split(" "),D=parseInt(k[0],10);D<=parseInt(k[1],10);++D)M=parseInt(k[2],10),I[D-1]=M===0?{hidden:!0}:{wch:M},Of(I[D-1]);break;case"C":v=parseInt(U[b].slice(1))-1,I[v]||(I[v]={});break;case"R":g=parseInt(U[b].slice(1))-1,T[g]||(T[g]={}),M>0?(T[g].hpt=M,T[g].hpx=T0(M)):M===0&&(T[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+L)}N<1&&(S=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+L)}}return T.length>0&&(E["!rows"]=T),I.length>0&&(E["!cols"]=I),f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),[x,E]}function o(d,f){var m=i(d,f),g=m[0],v=m[1],w=ug(g,f);return na(v).forEach(function(b){w[b]=v[b]}),w}function a(d,f){return Ic(o(d,f),f)}function l(d,f,m,g){var v="C;Y"+(m+1)+";X"+(g+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+IXe(d.f,{r:m,c:g}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(d,f){f.forEach(function(m,g){var v="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?v+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Q1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=eb(m.wpx)),typeof m.wch=="number"&&(v+=Math.round(m.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function u(d,f){f.forEach(function(m,g){var v="F;";m.hidden?v+="M0;":m.hpt?v+="M"+20*m.hpt+";":m.hpx&&(v+="M"+20*Kq(m.hpx)+";"),v.length>2&&d.push(v+"R"+(g+1))})}function h(d,f){var m=["ID;PWXL;N;E"],g=[],v=Yr(d["!ref"]),w,b=Array.isArray(d),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&c(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var C=v.s.r;C<=v.e.r;++C)for(var S=v.s.c;S<=v.e.c;++S){var E=ut({r:C,c:S});w=b?(d[C]||[])[S]:d[E],!(!w||w.v==null&&(!w.f||w.F))&&g.push(l(w,d,C,S))}return m.join(x)+x+g.join(x)+x+"E"+x}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),GYe=function(){function t(s,o){switch(o.type){case"base64":return e(as(s),o);case"binary":return e(s,o);case"buffer":return e(kt&&Buffer.isBuffer(s)?s.toString("binary"):fh(s),o);case"array":return e(Yu(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=a[u].trim().split(","),f=d[0],m=d[1];++u;for(var g=a[u]||"";(g.match(/["]/g)||[]).length&1&&u<a.length-1;)g+=`
`+a[++u];switch(g=g.trim(),+f){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(vo(m))?isNaN(Af(m).getDate())?h[l][c]=m:h[l][c]=On(m):h[l][c]=vo(m),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return ug(t(s,o),o)}function n(s,o){return Ic(r(s,o),o)}var i=function(){var s=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Yr(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var g=ut({r:f,c:m});if(h=d?(l[f]||[])[m]:l[g],!h){o(c,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,v,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=$s(h.z||ft[14],Ci(On(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var w=`\r
`,b=c.join(w);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),YYe=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var f=h.split(`
`),m=-1,g=-1,v=0,w=[];v!==f.length;++v){var b=f[v].trim().split(":");if(b[0]==="cell"){var x=yi(b[1]);if(w.length<=x.r)for(m=w.length;m<=x.r;++m)w[m]||(w[m]=[]);switch(m=x.r,g=x.c,b[2]){case"t":w[m][g]=t(b[3]);break;case"v":w[m][g]=+b[3];break;case"vtf":var C=b[b.length-1];case"vtc":switch(b[3]){case"nl":w[m][g]=!!+b[4];break;default:w[m][g]=+b[4];break}b[2]=="vtf"&&(w[m][g]=[w[m][g],C])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return ug(r(h,d),d)}function i(h,d){return Ic(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],f=[],m,g="",v=cg(h["!ref"]),w=Array.isArray(h),b=v.s.r;b<=v.e.r;++b)for(var x=v.s.c;x<=v.e.c;++x)if(g=ut({r:b,c:x}),m=w?(h[b]||[])[x]:h[g],!(!m||m.v==null||m.t==="z")){switch(f=["cell",g,"t"],m.t){case"s":case"str":f.push(e(m.v));break;case"n":m.f?(f[2]="vtf",f[3]="n",f[4]=m.v,f[5]=e(m.f)):(f[2]="v",f[3]=m.v);break;case"b":f[2]="vt"+(m.f?"f":"c"),f[3]="nl",f[4]=m.v?"1":"0",f[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var C=Ci(On(m.v));f[2]="vtc",f[3]="nd",f[4]=""+C,f[5]=m.w||$s(m.z||ft[14],C);break;case"e":continue}d.push(f.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),C0=function(){function t(u,h,d,f,m){m.raw?h[d][f]=u:u===""||(u==="TRUE"?h[d][f]=!0:u==="FALSE"?h[d][f]=!1:isNaN(vo(u))?isNaN(Af(u).getDate())?h[d][f]=u:h[d][f]=On(u):h[d][f]=vo(u))}function e(u,h){var d=h||{},f=[];if(!u||u.length===0)return f;for(var m=u.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var v=10,w=0,b=0;b<=g;++b)w=m[b].indexOf(" "),w==-1?w=m[b].length:w++,v=Math.max(v,w);for(b=0;b<=g;++b){f[b]=[];var x=0;for(t(m[b].slice(0,v).trim(),f,b,x,d),x=1;x<=(m[b].length-v)/10+1;++x)t(m[b].slice(v+(x-1)*10,v+x*10).trim(),f,b,x,d)}return d.sheetRows&&(f=f.slice(0,d.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,f=0,m=0;f<u.length;++f)(m=u.charCodeAt(f))==34?d=!d:!d&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.push([h[f],f]);if(!m.length){h=n;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.push([h[f],f])}return m.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[m.pop()[1]]||44}function s(u,h){var d=h||{},f="",m=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=i(u.slice(0,1024)):d&&d.FS?f=d.FS:f=i(u.slice(0,1024));var v=0,w=0,b=0,x=0,C=0,S=f.charCodeAt(0),E=!1,T=0,I=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=d.dateNF!=null?i9e(d.dateNF):null;function M(){var D=u.slice(x,C),L={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)L.t="z";else if(d.raw)L.t="s",L.v=D;else if(D.trim().length===0)L.t="s",L.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(L.t="s",L.v=D.slice(2,-1).replace(/""/g,'"')):MXe(D)?(L.t="n",L.f=D.slice(1)):(L.t="s",L.v=D);else if(D=="TRUE")L.t="b",L.v=!0;else if(D=="FALSE")L.t="b",L.v=!1;else if(!isNaN(b=vo(D)))L.t="n",d.cellText!==!1&&(L.w=D),L.v=b;else if(!isNaN(Af(D).getDate())||k&&D.match(k)){L.z=d.dateNF||ft[14];var U=0;k&&D.match(k)&&(D=s9e(D,d.dateNF,D.match(k)||[]),U=1),d.cellDates?(L.t="d",L.v=On(D,U)):(L.t="n",L.v=Ci(On(D,U))),d.cellText!==!1&&(L.w=$s(L.z,L.v instanceof Date?Ci(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=D;if(L.t=="z"||(d.dense?(m[v]||(m[v]=[]),m[v][w]=L):m[ut({c:w,r:v})]=L),x=C+1,I=u.charCodeAt(x),g.e.c<w&&(g.e.c=w),g.e.r<v&&(g.e.r=v),T==S)++w;else if(w=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;C<u.length;++C)switch(T=u.charCodeAt(C)){case 34:I===34&&(E=!E);break;case S:case 10:case 13:if(!E&&M())break e;break}return C-x>0&&M(),m["!ref"]=Nt(g),m}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):ug(e(u,h),h)}function a(u,h){var d="",f=h.type=="string"?[0,0,0,0]:SD(u,h);switch(h.type){case"base64":d=as(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):(h.codepage,d=kt&&Buffer.isBuffer(u)?u.toString("binary"):fh(u));break;case"array":d=Yu(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?d=dr(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=dr(d):h.type=="binary",d.slice(0,19)=="socialcalc:version:"?YYe.to_sheet(h.type=="string"?d:dr(d),h):o(d,h)}function l(u,h){return Ic(a(u,h),h)}function c(u){for(var h=[],d=Yr(u["!ref"]),f,m=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var v=[],w=d.s.c;w<=d.e.c;++w){var b=ut({r:g,c:w});if(f=m?(u[g]||[])[w]:u[b],!f||f.v==null){v.push("          ");continue}for(var x=(f.w||(sl(f),f.w)||"").slice(0,10);x.length<10;)x+=" ";v.push(x+(w===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function KYe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=zYe.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return C0.to_workbook(t,e)}}var Jm=function(){function t(A,O,N){if(A){Ln(A,A.l||0);for(var F=N.Enum||_;A.l<A.length;){var j=A.read_shift(2),z=F[j]||F[65535],Q=A.read_shift(2),W=A.l+Q,ae=z.f&&z.f(A,Q,N);if(A.l=W,O(ae,z,j))return}}}function e(A,O){switch(O.type){case"base64":return r(lo(as(A)),O);case"binary":return r(lo(A),O);case"buffer":case"array":return r(A,O)}throw"Unsupported type "+O.type}function r(A,O){if(!A)return A;var N=O||{},F=N.dense?[]:{},j="Sheet1",z="",Q=0,W={},ae=[],ye=[],H={s:{r:0,c:0},e:{r:0,c:0}},Re=N.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)N.Enum=_,t(A,function(be,Fe,He){switch(He){case 0:N.vers=be,be>=4096&&(N.qpro=!0);break;case 6:H=be;break;case 204:be&&(z=be);break;case 222:z=be;break;case 15:case 51:N.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:He==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=N.dateNF||ft[14],N.cellDates&&(be[1].t="d",be[1].v=RC(be[1].v))),N.qpro&&be[3]>Q&&(F["!ref"]=Nt(H),W[j]=F,ae.push(j),F=N.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Q=be[3],j=z||"Sheet"+(Q+1),z="");var V=N.dense?(F[be[0].r]||[])[be[0].c]:F[ut(be[0])];if(V){V.t=be[1].t,V.v=be[1].v,be[1].z!=null&&(V.z=be[1].z),be[1].f!=null&&(V.f=be[1].f);break}N.dense?(F[be[0].r]||(F[be[0].r]=[]),F[be[0].r][be[0].c]=be[1]):F[ut(be[0])]=be[1];break}},N);else if(A[2]==26||A[2]==14)N.Enum=R,A[2]==14&&(N.qpro=!0,A.l=0),t(A,function(be,Fe,He){switch(He){case 204:j=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>Q&&(F["!ref"]=Nt(H),W[j]=F,ae.push(j),F=N.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Q=be[3],j="Sheet"+(Q+1)),Re>0&&be[0].r>=Re)break;N.dense?(F[be[0].r]||(F[be[0].r]=[]),F[be[0].r][be[0].c]=be[1]):F[ut(be[0])]=be[1],H.e.c<be[0].c&&(H.e.c=be[0].c),H.e.r<be[0].r&&(H.e.r=be[0].r);break;case 27:be[14e3]&&(ye[be[14e3][0]]=be[14e3][1]);break;case 1537:ye[be[0]]=be[1],be[0]==Q&&(j=be[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(F["!ref"]=Nt(H),W[z||j]=F,ae.push(z||j),!ye.length)return{SheetNames:ae,Sheets:W};for(var ue={},Pe=[],ke=0;ke<ye.length;++ke)W[ae[ke]]?(Pe.push(ye[ke]||ae[ke]),ue[ye[ke]]=W[ye[ke]]||W[ae[ke]]):(Pe.push(ye[ke]),ue[ye[ke]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:ue}}function n(A,O){var N=O||{};if(+N.codepage>=0&&uo(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var F=vk(),j=Yr(A["!ref"]),z=Array.isArray(A),Q=[];Qs(F,0,s(1030)),Qs(F,6,l(j));for(var W=Math.min(j.e.r,8191),ae=j.s.r;ae<=W;++ae)for(var ye=Hn(ae),H=j.s.c;H<=j.e.c;++H){ae===j.s.r&&(Q[H]=vn(H));var Re=Q[H]+ye,ue=z?(A[ae]||[])[H]:A[Re];if(!(!ue||ue.t=="z"))if(ue.t=="n")(ue.v|0)==ue.v&&ue.v>=-32768&&ue.v<=32767?Qs(F,13,f(ae,H,ue.v)):Qs(F,14,g(ae,H,ue.v));else{var Pe=sl(ue);Qs(F,15,h(ae,H,Pe.slice(0,239)))}}return Qs(F,1),F.end()}function i(A,O){var N=O||{};if(+N.codepage>=0&&uo(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var F=vk();Qs(F,0,o(A));for(var j=0,z=0;j<A.SheetNames.length;++j)(A.Sheets[A.SheetNames[j]]||{})["!ref"]&&Qs(F,27,y(A.SheetNames[j],z++));var Q=0;for(j=0;j<A.SheetNames.length;++j){var W=A.Sheets[A.SheetNames[j]];if(!(!W||!W["!ref"])){for(var ae=Yr(W["!ref"]),ye=Array.isArray(W),H=[],Re=Math.min(ae.e.r,8191),ue=ae.s.r;ue<=Re;++ue)for(var Pe=Hn(ue),ke=ae.s.c;ke<=ae.e.c;++ke){ue===ae.s.r&&(H[ke]=vn(ke));var be=H[ke]+Pe,Fe=ye?(W[ue]||[])[ke]:W[be];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")Qs(F,23,M(ue,ke,Q,Fe.v));else{var He=sl(Fe);Qs(F,22,T(ue,ke,Q,He.slice(0,239)))}}++Q}}return Qs(F,1),F.end()}function s(A){var O=hn(2);return O.write_shift(2,A),O}function o(A){var O=hn(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var N=0,F=0,j=0,z=0;z<A.SheetNames.length;++z){var Q=A.SheetNames[z],W=A.Sheets[Q];if(!(!W||!W["!ref"])){++j;var ae=cg(W["!ref"]);N<ae.e.r&&(N=ae.e.r),F<ae.e.c&&(F=ae.e.c)}}return N>8191&&(N=8191),O.write_shift(2,N),O.write_shift(1,j),O.write_shift(1,F),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function a(A,O,N){var F={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&N.qpro?(F.s.c=A.read_shift(1),A.l++,F.s.r=A.read_shift(2),F.e.c=A.read_shift(1),A.l++,F.e.r=A.read_shift(2),F):(F.s.c=A.read_shift(2),F.s.r=A.read_shift(2),O==12&&N.qpro&&(A.l+=2),F.e.c=A.read_shift(2),F.e.r=A.read_shift(2),O==12&&N.qpro&&(A.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function l(A){var O=hn(8);return O.write_shift(2,A.s.c),O.write_shift(2,A.s.r),O.write_shift(2,A.e.c),O.write_shift(2,A.e.r),O}function c(A,O,N){var F=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(F[0].c=A.read_shift(1),F[3]=A.read_shift(1),F[0].r=A.read_shift(2),A.l+=2):(F[2]=A.read_shift(1),F[0].c=A.read_shift(2),F[0].r=A.read_shift(2)),F}function u(A,O,N){var F=A.l+O,j=c(A,O,N);if(j[1].t="s",N.vers==20768){A.l++;var z=A.read_shift(1);return j[1].v=A.read_shift(z,"utf8"),j}return N.qpro&&A.l++,j[1].v=A.read_shift(F-A.l,"cstr"),j}function h(A,O,N){var F=hn(7+N.length);F.write_shift(1,255),F.write_shift(2,O),F.write_shift(2,A),F.write_shift(1,39);for(var j=0;j<F.length;++j){var z=N.charCodeAt(j);F.write_shift(1,z>=128?95:z)}return F.write_shift(1,0),F}function d(A,O,N){var F=c(A,O,N);return F[1].v=A.read_shift(2,"i"),F}function f(A,O,N){var F=hn(7);return F.write_shift(1,255),F.write_shift(2,O),F.write_shift(2,A),F.write_shift(2,N,"i"),F}function m(A,O,N){var F=c(A,O,N);return F[1].v=A.read_shift(8,"f"),F}function g(A,O,N){var F=hn(13);return F.write_shift(1,255),F.write_shift(2,O),F.write_shift(2,A),F.write_shift(8,N,"f"),F}function v(A,O,N){var F=A.l+O,j=c(A,O,N);if(j[1].v=A.read_shift(8,"f"),N.qpro)A.l=F;else{var z=A.read_shift(2);C(A.slice(A.l,A.l+z),j),A.l+=z}return j}function w(A,O,N){var F=O&32768;return O&=-32769,O=(F?A:0)+(O>=8192?O-16384:O),(F?"":"$")+(N?vn(O):Hn(O))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(A,O){Ln(A,0);for(var N=[],F=0,j="",z="",Q="",W="";A.l<A.length;){var ae=A[A.l++];switch(ae){case 0:N.push(A.read_shift(8,"f"));break;case 1:z=w(O[0].c,A.read_shift(2),!0),j=w(O[0].r,A.read_shift(2),!1),N.push(z+j);break;case 2:{var ye=w(O[0].c,A.read_shift(2),!0),H=w(O[0].r,A.read_shift(2),!1);z=w(O[0].c,A.read_shift(2),!0),j=w(O[0].r,A.read_shift(2),!1),N.push(ye+H+":"+z+j)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(A.read_shift(2));break;case 6:{for(var Re="";ae=A[A.l++];)Re+=String.fromCharCode(ae);N.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:W=N.pop(),Q=N.pop(),N.push(["AND","OR"][ae-20]+"("+Q+","+W+")");break;default:if(ae<32&&x[ae])W=N.pop(),Q=N.pop(),N.push(Q+x[ae]+W);else if(b[ae]){if(F=b[ae][1],F==69&&(F=A[A.l++]),F>N.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+N.join("|")+"|");return}var ue=N.slice(-F);N.length-=F,N.push(b[ae][0]+"("+ue.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}N.length==1?O[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function S(A){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=A.read_shift(2),O[3]=A[A.l++],O[0].c=A[A.l++],O}function E(A,O){var N=S(A);return N[1].t="s",N[1].v=A.read_shift(O-4,"cstr"),N}function T(A,O,N,F){var j=hn(6+F.length);j.write_shift(2,A),j.write_shift(1,N),j.write_shift(1,O),j.write_shift(1,39);for(var z=0;z<F.length;++z){var Q=F.charCodeAt(z);j.write_shift(1,Q>=128?95:Q)}return j.write_shift(1,0),j}function I(A,O){var N=S(A);N[1].v=A.read_shift(2);var F=N[1].v>>1;if(N[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return N[1].v=F,N}function k(A,O){var N=S(A),F=A.read_shift(4),j=A.read_shift(4),z=A.read_shift(2);if(z==65535)return F===0&&j===3221225472?(N[1].t="e",N[1].v=15):F===0&&j===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var Q=z&32768;return z=(z&32767)-16446,N[1].v=(1-Q*2)*(j*Math.pow(2,z+32)+F*Math.pow(2,z)),N}function M(A,O,N,F){var j=hn(14);if(j.write_shift(2,A),j.write_shift(1,N),j.write_shift(1,O),F==0)return j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,65535),j;var z=0,Q=0,W=0,ae=0;return F<0&&(z=1,F=-F),Q=Math.log2(F)|0,F/=Math.pow(2,Q-31),ae=F>>>0,ae&2147483648||(F/=2,++Q,ae=F>>>0),F-=ae,ae|=2147483648,ae>>>=0,F*=Math.pow(2,32),W=F>>>0,j.write_shift(4,W),j.write_shift(4,ae),Q+=16383+(z?32768:0),j.write_shift(2,Q),j}function D(A,O){var N=k(A);return A.l+=O-14,N}function L(A,O){var N=S(A),F=A.read_shift(4);return N[1].v=F>>6,N}function U(A,O){var N=S(A),F=A.read_shift(8,"f");return N[1].v=F,N}function J(A,O){var N=U(A);return A.l+=O-10,N}function X(A,O){return A[A.l+O-1]==0?A.read_shift(O,"cstr"):""}function ie(A,O){var N=A[A.l++];N>O-1&&(N=O-1);for(var F="";F.length<N;)F+=String.fromCharCode(A[A.l++]);return F}function se(A,O,N){if(!(!N.qpro||O<21)){var F=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var j=A.read_shift(O-21,"cstr");return[F,j]}}function P(A,O){for(var N={},F=A.l+O;A.l<F;){var j=A.read_shift(2);if(j==14e3){for(N[j]=[0,""],N[j][0]=A.read_shift(2);A[A.l];)N[j][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return N}function y(A,O){var N=hn(5+A.length);N.write_shift(2,14e3),N.write_shift(2,O);for(var F=0;F<A.length;++F){var j=A.charCodeAt(F);N[N.l++]=j>127?95:j}return N[N.l++]=0,N}var _={0:{n:"BOF",f:sn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:P},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function XYe(t){var e={},r=t.match(li),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=st(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=ZP[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var qYe=function(){var t=b0("t"),e=b0("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var a={t:"s",v:Lt(o[1])},l=s.match(e);return l&&(a.s=XYe(l[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}}(),JYe=function(){var e=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),ZYe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,QYe=/<(?:\w+:)?r>/,eKe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function mD(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Lt(dr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=dr(t),r&&(n.h=sD(n.t))):t.match(QYe)&&(n.r=dr(t),n.t=Lt(dr((t.replace(eKe,"").match(ZYe)||[]).join("").replace(li,""))),r&&(n.h=JYe(qYe(n.r)))),n):{t:""}}var tKe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,rKe=/<(?:\w+:)?(?:si|sstItem)>/g,nKe=/<\/(?:\w+:)?(?:si|sstItem)>/;function iKe(t,e){var r=[],n="";if(!t)return r;var i=t.match(tKe);if(i){n=i[2].replace(rKe,"").split(nKe);for(var s=0;s!=n.length;++s){var o=mD(n[s].trim(),e);o!=null&&(r[r.length]=o)}i=st(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function sKe(t){return[t.read_shift(4),t.read_shift(4)]}function oKe(t,e){var r=[],n=!1;return ml(t,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function Vq(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ya(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function aKe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ya(t,4),e.U=Ya(t,4),e.W=Ya(t,4),e}function lKe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function cKe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(lKe(t));return e}function uKe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function hKe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ya(t,4),e.U=Ya(t,4),e.W=Ya(t,4),e}function dKe(t){var e=hKe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Uq(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Wq(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function fKe(t){var e=Ya(t);switch(e.Minor){case 2:return[e.Minor,gKe(t)];case 3:return[e.Minor,mKe()];case 4:return[e.Minor,pKe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function gKe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Uq(t,r),i=Wq(t,t.length-t.l);return{t:"Std",h:n,v:i}}function mKe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pKe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(li,function(s){var o=st(s);switch(ua(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function vKe(t,e){var r={},n=r.EncryptionVersionInfo=Ya(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=Uq(t,i),e-=i,r.EncryptionVerifier=Wq(t,e),r}function yKe(t){var e={},r=e.EncryptionVersionInfo=Ya(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function wKe(t){var e=0,r,n=Vq(t),i=n.length+1,s,o,a,l,c;for(r=pc(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=e&16384?1:0,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var zq=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=e[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],h=0;h!=7;++h)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=Vq(o),l=s(a),c=a.length,u=pc(16),h=0;h!=16;++h)u[h]=0;var d,f,m;for((c&1)===1&&(d=l>>8,u[c]=i(t[0],d),--c,d=l&255,f=a[a.length-1],u[c]=i(f,d));c>0;)--c,d=l>>8,u[c]=i(a[c],d),--c,d=l&255,u[c]=i(a[c],d);for(c=15,m=15-a.length;m>0;)d=l>>8,u[c]=i(t[m],d),--c,--m,d=l&255,u[c]=i(a[c],d),--c,--m;return u}}(),xKe=function(t,e,r,n,i){i||(i=e),n||(n=zq(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},bKe=function(t){var e=0,r=zq(t);return function(n){var i=xKe("",n,e,r);return e=i[1],i[0]}};function SKe(t,e,r,n){var i={key:sn(t),verificationBytes:sn(t)};return r.password&&(i.verifier=wKe(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=bKe(r.password)),i}function CKe(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=yKe(t):n.Data=vKe(t,e),n}function EKe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?CKe(t,e-2,n):SKe(t,r.biff>=8?e:e-2,r,n),n}var TKe=function(){function t(i,s){switch(s.type){case"base64":return e(as(i),s);case"binary":return e(i,s);case"buffer":return e(kt&&Buffer.isBuffer(i)?i.toString("binary"):fh(i),s);case"array":return e(Yu(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var d=/\\\w+\b/g,f=0,m,g=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var v=u.slice(f,d.lastIndex-m[0].length);if(v[0]==" "&&(v=v.slice(1)),++g,v.length){var w={v,t:"s"};Array.isArray(a)?a[h][g]=w:a[ut({r:h,c:g})]=w}break}f=d.lastIndex}g>c.e.c&&(c.e.c=g)}),a["!ref"]=Nt(c),a}function r(i,s){return Ic(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Yr(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=ut({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(sl(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function _Ke(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function E0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function RKe(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),o=i-s;if(o===0)return[0,0,e];var a=0,l=0,c=i+s;switch(l=o/(c>1?2-c:c),i){case e:a=((r-n)/o+6)%6;break;case r:a=(n-e)/o+2;break;case n:a=(e-r)/o+4;break}return[a/6,l,c/2]}function AKe(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*e,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function Z1(t,e){if(e===0)return t;var r=RKe(_Ke(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),E0(AKe(r))}var Gq=6,OKe=15,kKe=1,gi=Gq;function Q1(t){return Math.floor((t+Math.round(128/gi)/256)*gi)}function eb(t){return Math.floor((t-5)/gi*100+.5)/100}function bk(t){return Math.round((t*gi+5)/gi*256)/256}function L_(t){return bk(eb(Q1(t)))}function pD(t){var e=Math.abs(t-L_(t)),r=gi;if(e>.005)for(gi=kKe;gi<OKe;++gi)Math.abs(t-L_(t))<=e&&(e=Math.abs(t-L_(t)),r=gi);gi=r}function Of(t){t.width?(t.wpx=Q1(t.width),t.wch=eb(t.wpx),t.MDW=gi):t.wpx?(t.wch=eb(t.wpx),t.width=bk(t.wch),t.MDW=gi):typeof t.wch=="number"&&(t.width=bk(t.wch),t.wpx=Q1(t.width),t.MDW=gi),t.customWidth&&delete t.customWidth}var IKe=96,Yq=IKe;function Kq(t){return t*96/Yq}function T0(t){return t*Yq/96}var NKe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function MKe(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(li)||[]).forEach(function(o){var a=st(o);switch(ua(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=Rr(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=Rr(a.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function PKe(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(li)||[]).forEach(function(o){var a=st(o);switch(ua(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function DKe(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(li)||[]).forEach(function(o){var a=st(o);switch(ua(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=dr(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?Rr(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?Rr(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?Rr(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?Rr(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?Rr(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?Rr(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?Rr(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=ZP[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=Rr(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=Ou[i.color.index];i.color.index==81&&(l=Ou[1]),l||(l=Ou[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Z1(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function LKe(t,e,r){e.NumberFmt=[];for(var n=na(ft),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ft[n[i]];var s=t[0].match(li);if(s)for(i=0;i<s.length;++i){var o=st(s[i]);switch(ua(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Lt(dr(o.formatCode)),l=parseInt(o.numFmtId,10);if(e.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=a}Au(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var rw=["numFmtId","fillId","fontId","borderId","xfId"],nw=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function FKe(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(li)||[]).forEach(function(s){var o=st(s),a=0;switch(ua(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<rw.length;++a)n[rw[a]]&&(n[rw[a]]=parseInt(n[rw[a]],10));for(a=0;a<nw.length;++a)n[nw[a]]&&(n[nw[a]]=Rr(n[nw[a]]));if(e.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[a]){n.numFmtId=a;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Rr(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var $Ke=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=a.match(e))&&LKe(h,u,c),(h=a.match(i))&&DKe(h,u,l,c),(h=a.match(n))&&PKe(h,u,l,c),(h=a.match(s))&&MKe(h,u,l,c),(h=a.match(r))&&FKe(h,u,c),u}}();function HKe(t,e){var r=t.read_shift(2),n=ti(t);return[r,n]}function jKe(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=q9e(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=X9e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ti(t),n}var BKe=ni;function VKe(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var UKe=ni;function WKe(t,e,r){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return ml(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Au(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Z1(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var zKe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function GKe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(li)||[]).forEach(function(i){var s=st(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[zKe.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function YKe(){}function KKe(){}var XKe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qKe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,JKe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ZKe(t,e,r){e.themeElements={};var n;[["clrScheme",XKe,GKe],["fontScheme",qKe,YKe],["fmtScheme",JKe,KKe]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var QKe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Xq(t,e){(!t||t.length===0)&&(t=eXe());var r,n={};if(!(r=t.match(QKe)))throw new Error("themeElements not found in theme");return ZKe(r[0],n,e),n.raw=t,n}function eXe(t,e){var r=[oq];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function tXe(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=sq(s,{type:"array"})}catch{return}var a=es(o,"theme/theme/theme1.xml",!0);if(a)return Xq(a,r)}}function rXe(t){return t.read_shift(4)}function nXe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=iXe(t,4);break;case 2:e.xclrValue=Dq(t);break;case 3:e.xclrValue=rXe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function iXe(t,e){return ni(t,e)}function sXe(t,e){return ni(t,e)}function oXe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=nXe(t);break;case 6:n[1]=sXe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function aXe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(oXe(t,r-t.l));return{ixfe:n,ext:s}}function lXe(t,e){e.forEach(function(r){switch(r[0]){}})}function cXe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ti(t)}}function uXe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function hXe(t){return t.l+=4,t.read_shift(4)!=0}function dXe(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return ml(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){a==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):a==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!c.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function fXe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,o;return t.replace(li,function(a){var l=st(a);switch(ua(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(o=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function gXe(t){var e=[];if(!t)return e;var r=1;return(t.match(li)||[]).forEach(function(n){var i=st(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function mXe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ut(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function pXe(t,e,r){var n=[];return ml(t,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function vXe(t,e,r,n){if(!t)return t;var i=n||{},s=!1;ml(t,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function yXe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function f5(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(o){var a=yi(o.ref);if(i?(t[a.r]||(t[a.r]=[]),s=t[a.r][a.c]):s=t[o.ref],!s){s={t:"z"},i?t[a.r][a.c]=s:t[o.ref]=s;var l=Yr(t["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=Nt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function wXe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=st(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=yi(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&mD(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function xXe(t,e){var r=[],n=!1,i={},s=0;return t.replace(li,function(a,l){var c=st(a);switch(ua(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+a.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function bXe(t,e){var r=[],n=!1;return t.replace(li,function(s){var o=st(s);switch(ua(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function SXe(t){var e={};e.iauthor=t.read_shift(4);var r=mh(t);return e.rfx=r.s,e.ref=ut(r.s),t.l+=16,e}var CXe=ti;function EXe(t,e){var r=[],n=[],i={},s=!1;return ml(t,function(a,l,c){switch(c){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var TXe="application/vnd.ms-office.vbaProject";function _Xe(t){var e=It.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");It.utils.cfb_add(e,i,t.FileIndex[n].content)}}),It.write(e)}function RXe(){return{"!type":"dialog"}}function AXe(){return{"!type":"dialog"}}function OXe(){return{"!type":"macro"}}function kXe(){return{"!type":"macro"}}var Pd=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+vn(u)+(l?"":"$")+Hn(c)}return function(i,s){return e=s,i.replace(t,r)}}(),qq=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,IXe=function(){return function(e,r){return e.replace(qq,function(n,i,s,o,a,l){var c=cD(o)-(s?0:r.c),u=lD(l)-(a?0:r.r),h=u==0?"":a?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function Jq(t,e){return t.replace(qq,function(r,n,i,s,o,a){return n+(i=="$"?i+s:vn(cD(s)+e.c))+(o=="$"?o+a:Hn(lD(a)+e.r))})}function NXe(t,e,r){var n=cg(e),i=n.s,s=yi(r),o={r:s.r-i.r,c:s.c-i.c};return Jq(t,o)}function MXe(t){return t.length!=1}function g5(t){return t.replace(/_xlfn\./g,"")}function tn(t){t.l+=1}function vc(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Zq(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Qq(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=vc(t),a=vc(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Qq(t){var e=vc(t),r=vc(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function PXe(t,e,r){if(r.biff<8)return Qq(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=vc(t),o=vc(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function eJ(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return DXe(t);var n=t.read_shift(r&&r.biff==12?4:2),i=vc(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function DXe(t){var e=vc(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function LXe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function FXe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $Xe(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function $Xe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function HXe(t,e,r){var n=(t[t.l++]&96)>>5,i=Zq(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function jXe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Zq(t,s,r);return[n,i,o]}function BXe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function VXe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function UXe(t,e,r){var n=(t[t.l++]&96)>>5,i=PXe(t,e-1,r);return[n,i]}function WXe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function m5(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function zXe(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function GXe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function YXe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function KXe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function XXe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function tJ(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function qXe(t){return t.read_shift(2),tJ(t)}function JXe(t){return t.read_shift(2),tJ(t)}function ZXe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=eJ(t,0,r);return[n,i]}function QXe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=FXe(t,0,r);return[n,i]}function eqe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=eJ(t,0,r);return[n,i,s]}function tqe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[rJe[i],iJ[i],n]}function rqe(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:nqe(t);return[i,(s[0]===0?iJ:tJe)[s[1]]]}function nqe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function iqe(t,e,r){t.l+=r&&r.biff==2?3:4}function sqe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function oqe(t){return t.l++,ph[t.read_shift(1)]}function aqe(t){return t.l++,t.read_shift(2)}function lqe(t){return t.l++,t.read_shift(1)!==0}function cqe(t){return t.l++,Zn(t)}function uqe(t,e,r){return t.l++,vv(t,e-1,r)}function hqe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Xr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=ph[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Zn(t);break;case 2:r[1]=vh(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function dqe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?mh:AC)(t));return i}function fqe(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=hqe(t,r.biff);return o}function gqe(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function mqe(t,e,r){if(r.biff==5)return pqe(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function pqe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function vqe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function yqe(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function wqe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function xqe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var bqe=ni,Sqe=ni,Cqe=ni;function wv(t,e,r){return t.l+=2,[LXe(t)]}function vD(t){return t.l+=6,[]}var Eqe=wv,Tqe=vD,_qe=vD,Rqe=wv;function rJ(t){return t.l+=2,[sn(t),t.read_shift(2)&1]}var Aqe=wv,Oqe=rJ,kqe=vD,Iqe=wv,Nqe=wv,Mqe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Pqe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=Mqe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function Dqe(t){return t.l+=2,[t.read_shift(4)]}function Lqe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Fqe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $qe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Hqe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function jqe(t){return t.l+=4,[0,0]}var p5={1:{n:"PtgExp",f:sqe},2:{n:"PtgTbl",f:Cqe},3:{n:"PtgAdd",f:tn},4:{n:"PtgSub",f:tn},5:{n:"PtgMul",f:tn},6:{n:"PtgDiv",f:tn},7:{n:"PtgPower",f:tn},8:{n:"PtgConcat",f:tn},9:{n:"PtgLt",f:tn},10:{n:"PtgLe",f:tn},11:{n:"PtgEq",f:tn},12:{n:"PtgGe",f:tn},13:{n:"PtgGt",f:tn},14:{n:"PtgNe",f:tn},15:{n:"PtgIsect",f:tn},16:{n:"PtgUnion",f:tn},17:{n:"PtgRange",f:tn},18:{n:"PtgUplus",f:tn},19:{n:"PtgUminus",f:tn},20:{n:"PtgPercent",f:tn},21:{n:"PtgParen",f:tn},22:{n:"PtgMissArg",f:tn},23:{n:"PtgStr",f:uqe},26:{n:"PtgSheet",f:Lqe},27:{n:"PtgEndSheet",f:Fqe},28:{n:"PtgErr",f:oqe},29:{n:"PtgBool",f:lqe},30:{n:"PtgInt",f:aqe},31:{n:"PtgNum",f:cqe},32:{n:"PtgArray",f:WXe},33:{n:"PtgFunc",f:tqe},34:{n:"PtgFuncVar",f:rqe},35:{n:"PtgName",f:gqe},36:{n:"PtgRef",f:ZXe},37:{n:"PtgArea",f:HXe},38:{n:"PtgMemArea",f:vqe},39:{n:"PtgMemErr",f:bqe},40:{n:"PtgMemNoMem",f:Sqe},41:{n:"PtgMemFunc",f:yqe},42:{n:"PtgRefErr",f:wqe},43:{n:"PtgAreaErr",f:BXe},44:{n:"PtgRefN",f:QXe},45:{n:"PtgAreaN",f:UXe},46:{n:"PtgMemAreaN",f:$qe},47:{n:"PtgMemNoMemN",f:Hqe},57:{n:"PtgNameX",f:mqe},58:{n:"PtgRef3d",f:eqe},59:{n:"PtgArea3d",f:jXe},60:{n:"PtgRefErr3d",f:xqe},61:{n:"PtgAreaErr3d",f:VXe},255:{}},Bqe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Vqe={1:{n:"PtgElfLel",f:rJ},2:{n:"PtgElfRw",f:Iqe},3:{n:"PtgElfCol",f:Eqe},6:{n:"PtgElfRwV",f:Nqe},7:{n:"PtgElfColV",f:Rqe},10:{n:"PtgElfRadical",f:Aqe},11:{n:"PtgElfRadicalS",f:kqe},13:{n:"PtgElfColS",f:Tqe},15:{n:"PtgElfColSV",f:_qe},16:{n:"PtgElfRadicalLel",f:Oqe},25:{n:"PtgList",f:Pqe},29:{n:"PtgSxName",f:Dqe},255:{}},Uqe={0:{n:"PtgAttrNoop",f:jqe},1:{n:"PtgAttrSemi",f:XXe},2:{n:"PtgAttrIf",f:YXe},4:{n:"PtgAttrChoose",f:zXe},8:{n:"PtgAttrGoto",f:GXe},16:{n:"PtgAttrSum",f:iqe},32:{n:"PtgAttrBaxcel",f:m5},33:{n:"PtgAttrBaxcel",f:m5},64:{n:"PtgAttrSpace",f:qXe},65:{n:"PtgAttrSpaceSemi",f:JXe},128:{n:"PtgAttrIfError",f:KXe},255:{}};function xv(t,e,r,n){if(n.biff<8)return ni(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=fqe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=dqe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&s.push(ni(t,e)),s}function bv(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=p5[s]||p5[Bqe[s]],(s===24||s===25)&&(i=(s===24?Vqe:Uqe)[t[t.l+1]]),!i||!i.f?ni(t,e):o.push([i.n,i.f(t,e,r)]);return o}function Wqe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var zqe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Gqe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function nJ(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function v5(t,e,r){var n=nJ(t,e,r);return n=="#REF"?n:Gqe(n,r)}function Kn(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,h=0,d=0,f,m="";if(!t[0]||!t[0][0])return"";for(var g=-1,v="",w=0,b=t[0].length;w<b;++w){var x=t[0][w];switch(x[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),g>=0){switch(t[0][g][1][0]){case 0:v=Wr(" ",t[0][g][1][1]);break;case 1:v=Wr("\r",t[0][g][1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+v,g=-1}a.push(c+zqe[x[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ym(x[1][1],o,i),a.push(Km(u,s));break;case"PtgRefN":u=r?Ym(x[1][1],r,i):x[1][1],a.push(Km(u,s));break;case"PtgRef3d":h=x[1][1],u=Ym(x[1][2],o,i),m=v5(n,h,i),a.push(m+"!"+Km(u,s));break;case"PtgFunc":case"PtgFuncVar":var C=x[1][0],S=x[1][1];C||(C=0),C&=127;var E=C==0?[]:a.slice(-C);a.length-=C,S==="User"&&(S=E.shift()),a.push(S+"("+E.join(",")+")");break;case"PtgBool":a.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(x[1]);break;case"PtgNum":a.push(String(x[1]));break;case"PtgStr":a.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(x[1]);break;case"PtgAreaN":f=J6(x[1][1],r?{s:r}:o,i),a.push(P_(f,i));break;case"PtgArea":f=J6(x[1][1],o,i),a.push(P_(f,i));break;case"PtgArea3d":h=x[1][1],f=x[1][2],m=v5(n,h,i),a.push(m+"!"+P_(f,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2];var T=(n.names||[])[d-1]||(n[0]||[])[d],I=T?T.Name:"SH33TJSNAME"+String(d);I&&I.slice(0,6)=="_xlfn."&&!i.xlfn&&(I=I.slice(6)),a.push(I);break;case"PtgNameX":var k=x[1][1];d=x[1][2];var M;if(i.biff<=5)k<0&&(k=-k),n[k]&&(M=n[k][d]);else{var D="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][d]&&n[k][d].itab>0&&(D=n.SheetNames[n[k][d].itab-1]+"!"):D=n.SheetNames[d-1]+"!"),n[k]&&n[k][d])D+=n[k][d].Name;else if(n[0]&&n[0][d])D+=n[0][d].Name;else{var L=(nJ(n,k,i)||"").split(";;");L[d-1]?D=L[d-1]:D+="SH33TJSERRX"}a.push(D);break}M||(M={Name:"SH33TJSERRY"}),a.push(M.Name);break;case"PtgParen":var U="(",J=")";if(g>=0){switch(v="",t[0][g][1][0]){case 2:U=Wr(" ",t[0][g][1][1])+U;break;case 3:U=Wr("\r",t[0][g][1][1])+U;break;case 4:J=Wr(" ",t[0][g][1][1])+J;break;case 5:J=Wr("\r",t[0][g][1][1])+J;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}a.push(U+a.pop()+J);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:x[1][1],r:x[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[ut(u)]){var ie=n.sharedf[ut(u)];a.push(Kn(ie,o,X,n,i))}else{var se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(Kn(c[1],o,X,n,i)),se=!0;break}se||a.push(x[1])}break;case"PtgArray":a.push("{"+Wqe(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var P=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&P.indexOf(t[0][w][0])==-1){x=t[0][g];var y=!0;switch(x[1][0]){case 4:y=!1;case 0:v=Wr(" ",x[1][1]);break;case 5:y=!1;case 1:v=Wr("\r",x[1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}a.push((y?v:"")+a.pop()+(y?"":v)),g=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function Yqe(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],ni(t,e-2)];var a=bv(t,o,r);return e!==o+i&&(s=xv(t,e-o-i,a,r)),t.l=n,[a,s]}function Kqe(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],ni(t,e-2)];var a=bv(t,o,r);return e!==o+i&&(s=xv(t,e-o-i,a,r)),t.l=n,[a,s]}function Xqe(t,e,r,n){var i=t.l+e,s=bv(t,n,r),o;return i!==t.l&&(o=xv(t,i-t.l,s,r)),[s,o]}function qqe(t,e,r){var n=t.l+e,i,s=t.read_shift(2),o=bv(t,s,r);return s==65535?[[],ni(t,e-2)]:(e!==s+2&&(i=xv(t,n-s-2,o,r)),[o,i])}function Jqe(t){var e;if(Ha(t,t.l+6)!==65535)return[Zn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function F_(t,e,r){var n=t.l+e,i=ha(t);r.biff==2&&++t.l;var s=Jqe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var a=Kqe(t,n-t.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function OC(t,e,r){var n=t.read_shift(4),i=bv(t,n,r),s=t.read_shift(4),o=s>0?xv(t,s,i,r):null;return[i,o]}var Zqe=OC,kC=OC,Qqe=OC,eJe=OC,tJe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iJ={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},rJe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function y5(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function $_(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Zm={},Dd={};function Qm(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function sJ(t,e,r,n,i,s){try{n.cellNF&&(t.z=ft[e])}catch(a){if(n.WTF)throw a}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=On(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ft[e]==null&&Au(n9e[e]||"General",e),t.t==="e")t.w=t.w||ph[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=x0(t.v);else if(t.t==="d"){var o=Ci(t.v);(o|0)===o?t.w=o.toString(10):t.w=x0(o)}else{if(t.v===void 0)return"";t.w=Gu(t.v,Dd)}else t.t==="d"?t.w=$s(e,Ci(t.v),Dd):t.w=$s(e,t.v,Dd)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Z1(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Z1(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function nJe(t,e){var r=Yr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Nt(r))}var iJe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sJe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oJe=/<(?:\w:)?hyperlink [^>]*>/mg,aJe=/"(\w*:\w*)"/,lJe=/<(?:\w:)?col\b[^>]*[\/]?>/g,cJe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,uJe=/<(?:\w:)?pageMargins[^>]*\/>/g,oJ=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hJe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dJe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function fJe(t,e,r,n,i,s,o){if(!t)return t;n||(n={"!id":{}});var a=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(sJe);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var d=c.match(oJ);d?yD(d[0],a,i,r):(d=c.match(hJe))&&gJe(d[0],d[1]||"",a,i,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(aJe);m&&nJe(a,m[1])}var g=c.match(dJe);g&&g[1]&&xJe(g[1],i);var v=[];if(e.cellStyles){var w=c.match(lJe);w&&vJe(v,w)}h&&bJe(h[1],a,e,l,s,o);var b=u.match(cJe);b&&(a["!autofilter"]=yJe(b[0]));var x=[],C=u.match(iJe);if(C)for(f=0;f!=C.length;++f)x[f]=Yr(C[f].slice(C[f].indexOf('"')+1));var S=u.match(oJe);S&&mJe(a,S,n);var E=u.match(uJe);if(E&&(a["!margins"]=pJe(st(E[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=Nt(l)),e.sheetRows>0&&a["!ref"]){var T=Yr(a["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Nt(T))}return v.length>0&&(a["!cols"]=v),x.length>0&&(a["!merges"]=x),a}function yD(t,e,r,n){var i=st(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Lt(dr(i.codeName)))}function gJe(t,e,r,n,i){yD(t.slice(0,t.indexOf(">")),r,n,i)}function mJe(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=st(dr(e[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Lt(s.location))):(s.Target="#"+Lt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=Yr(s.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=ut({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=s)}}}function pJe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function vJe(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=st(e[n],!0);i.hidden&&(i.hidden=Rr(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,pD(i.width)),Of(i);s<=o;)t[s++]=$n(i)}}function yJe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var wJe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xJe(t,e){e.Views||(e.Views=[{}]),(t.match(wJe)||[]).forEach(function(r,n){var i=st(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Rr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var bJe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=b0("v"),o=b0("f");return function(l,c,u,h,d,f){for(var m=0,g="",v=[],w=[],b=0,x=0,C=0,S="",E,T,I=0,k=0,M,D,L=0,U=0,J=Array.isArray(f.CellXf),X,ie=[],se=[],P=Array.isArray(c),y=[],_={},R=!1,A=!!u.sheetStubs,O=l.split(e),N=0,F=O.length;N!=F;++N){g=O[N].trim();var j=g.length;if(j!==0){var z=0;e:for(m=0;m<j;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(T=st(g.slice(z,m),!0),I=T.r!=null?parseInt(T.r,10):I+1,k=-1,u.sheetRows&&u.sheetRows<I)continue;_={},R=!1,T.ht&&(R=!0,_.hpt=parseFloat(T.ht),_.hpx=T0(_.hpt)),T.hidden=="1"&&(R=!0,_.hidden=!0),T.outlineLevel!=null&&(R=!0,_.level=+T.outlineLevel),R&&(y[I-1]=_)}break;case"<":z=m;break}if(z>=m)break;if(T=st(g.slice(z,m),!0),I=T.r!=null?parseInt(T.r,10):I+1,k=-1,!(u.sheetRows&&u.sheetRows<I)){h.s.r>I-1&&(h.s.r=I-1),h.e.r<I-1&&(h.e.r=I-1),u&&u.cellStyles&&(_={},R=!1,T.ht&&(R=!0,_.hpt=parseFloat(T.ht),_.hpx=T0(_.hpt)),T.hidden=="1"&&(R=!0,_.hidden=!0),T.outlineLevel!=null&&(R=!0,_.level=+T.outlineLevel),R&&(y[I-1]=_)),v=g.slice(m).split(t);for(var Q=0;Q!=v.length&&v[Q].trim().charAt(0)=="<";++Q);for(v=v.slice(Q),m=0;m!=v.length;++m)if(g=v[m].trim(),g.length!==0){if(w=g.match(r),b=m,x=0,C=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(b=0,S=w[1],x=0;x!=S.length&&!((C=S.charCodeAt(x)-64)<1||C>26);++x)b=26*b+C;--b,k=b}else++k;for(x=0;x!=g.length&&g.charCodeAt(x)!==62;++x);if(++x,T=st(g.slice(0,x),!0),T.r||(T.r=ut({r:I-1,c:k})),S=g.slice(x),E={t:""},(w=S.match(s))!=null&&w[1]!==""&&(E.v=Lt(w[1])),u.cellFormula){if((w=S.match(o))!=null&&w[1]!==""){if(E.f=Lt(dr(w[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=g5(E.f)),w[0].indexOf('t="array"')>-1)E.F=(S.match(i)||[])[1],E.F.indexOf(":")>-1&&ie.push([Yr(E.F),E.F]);else if(w[0].indexOf('t="shared"')>-1){D=st(w[0]);var W=Lt(dr(w[1]));u.xlfn||(W=g5(W)),se[parseInt(D.si,10)]=[D,W,T.r]}}else(w=S.match(/<f[^>]*\/>/))&&(D=st(w[0]),se[D.si]&&(E.f=NXe(se[D.si][1],se[D.si][2],T.r)));var ae=yi(T.r);for(x=0;x<ie.length;++x)ae.r>=ie[x][0].s.r&&ae.r<=ie[x][0].e.r&&ae.c>=ie[x][0].s.c&&ae.c<=ie[x][0].e.c&&(E.F=ie[x][1])}if(T.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(A)E.t="z";else continue;else E.t=T.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),E.t){case"n":if(E.v==""||E.v==null){if(!A)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!A)continue;E.t="z"}else M=Zm[parseInt(E.v,10)],E.v=M.t,E.r=M.r,u.cellHTML&&(E.h=M.h);break;case"str":E.t="s",E.v=E.v!=null?dr(E.v):"",u.cellHTML&&(E.h=sD(E.v));break;case"inlineStr":w=S.match(n),E.t="s",w!=null&&(M=mD(w[1]))?(E.v=M.t,u.cellHTML&&(E.h=M.h)):E.v="";break;case"b":E.v=Rr(E.v);break;case"d":u.cellDates?E.v=On(E.v,1):(E.v=Ci(On(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=Rq[E.v];break}if(L=U=0,X=null,J&&T.s!==void 0&&(X=f.CellXf[T.s],X!=null&&(X.numFmtId!=null&&(L=X.numFmtId),u.cellStyles&&X.fillId!=null&&(U=X.fillId))),sJ(E,L,U,u,d,f),u.cellDates&&J&&E.t=="n"&&lg(ft[L])&&(E.t="d",E.v=RC(E.v)),T.cm&&u.xlmeta){var ye=(u.xlmeta.Cell||[])[+T.cm-1];ye&&ye.type=="XLDAPR"&&(E.D=!0)}if(P){var H=yi(T.r);c[H.r]||(c[H.r]=[]),c[H.r][H.c]=E}else c[T.r]=E}}}}y.length>0&&(c["!rows"]=y)}}();function SJe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var CJe=mh;function EJe(){}function TJe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Y9e(t),r}function _Je(t){var e=zs(t);return[e]}function RJe(t){var e=gh(t);return[e]}function AJe(t){var e=zs(t),r=t.read_shift(1);return[e,r,"b"]}function OJe(t){var e=gh(t),r=t.read_shift(1);return[e,r,"b"]}function kJe(t){var e=zs(t),r=t.read_shift(1);return[e,r,"e"]}function IJe(t){var e=gh(t),r=t.read_shift(1);return[e,r,"e"]}function NJe(t){var e=zs(t),r=t.read_shift(4);return[e,r,"s"]}function MJe(t){var e=gh(t),r=t.read_shift(4);return[e,r,"s"]}function PJe(t){var e=zs(t),r=Zn(t);return[e,r,"n"]}function aJ(t){var e=gh(t),r=Zn(t);return[e,r,"n"]}function DJe(t){var e=zs(t),r=dD(t);return[e,r,"n"]}function LJe(t){var e=gh(t),r=dD(t);return[e,r,"n"]}function FJe(t){var e=zs(t),r=uD(t);return[e,r,"is"]}function $Je(t){var e=zs(t),r=ti(t);return[e,r,"str"]}function HJe(t){var e=gh(t),r=ti(t);return[e,r,"str"]}function jJe(t,e,r){var n=t.l+e,i=zs(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=kC(t,n-t.l,r);o[3]=Kn(a,null,i,r.supbooks,r)}else t.l=n;return o}function BJe(t,e,r){var n=t.l+e,i=zs(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=kC(t,n-t.l,r);o[3]=Kn(a,null,i,r.supbooks,r)}else t.l=n;return o}function VJe(t,e,r){var n=t.l+e,i=zs(t);i.r=r["!row"];var s=Zn(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=kC(t,n-t.l,r);o[3]=Kn(a,null,i,r.supbooks,r)}else t.l=n;return o}function UJe(t,e,r){var n=t.l+e,i=zs(t);i.r=r["!row"];var s=ti(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=kC(t,n-t.l,r);o[3]=Kn(a,null,i,r.supbooks,r)}else t.l=n;return o}var WJe=mh;function zJe(t,e){var r=t.l+e,n=mh(t),i=hD(t),s=ti(t),o=ti(t),a=ti(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function GJe(){}function YJe(t,e,r){var n=t.l+e,i=Eq(t),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=Zqe(t,n-t.l,r);o[1]=a}else t.l=n;return o}function KJe(t,e,r){var n=t.l+e,i=mh(t),s=[i];if(r.cellFormula){var o=eJe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}var XJe=["left","right","top","bottom","header","footer"];function qJe(t){var e={};return XJe.forEach(function(r){e[r]=Zn(t)}),e}function JJe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function ZJe(){}function QJe(){}function eZe(t,e,r,n,i,s,o){if(!t)return t;var a=e||{};n||(n={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,f,m,g,v,w,b,x,C,S,E=[];a.biff=12,a["!row"]=0;var T=0,I=!1,k=[],M={},D=a.supbooks||i.supbooks||[[]];if(D.sharedf=M,D.arrayf=k,D.SheetNames=i.SheetNames||i.Sheets.map(function(P){return P.name}),!a.supbooks&&(a.supbooks=D,i.Names))for(var L=0;L<i.Names.length;++L)D[0][L+1]=i.Names[L];var U=[],J=[],X=!1;tb[16]={n:"BrtShortReal",f:aJ};var ie;if(ml(t,function(y,_,R){if(!d)switch(R){case 148:c=y;break;case 0:f=y,a.sheetRows&&a.sheetRows<=f.r&&(d=!0),C=Hn(v=f.r),a["!row"]=f.r,(y.hidden||y.hpt||y.level!=null)&&(y.hpt&&(y.hpx=T0(y.hpt)),J[y.r]=y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:y[2]},y[2]){case"n":m.v=y[1];break;case"s":x=Zm[y[1]],m.v=x.t,m.r=x.r;break;case"b":m.v=!!y[1];break;case"e":m.v=y[1],a.cellText!==!1&&(m.w=ph[m.v]);break;case"str":m.t="s",m.v=y[1];break;case"is":m.t="s",m.v=y[1].t;break}if((g=o.CellXf[y[0].iStyleRef])&&sJ(m,g.numFmtId,null,a,s,o),w=y[0].c==-1?w+1:y[0].c,a.dense?(l[v]||(l[v]=[]),l[v][w]=m):l[vn(w)+C]=m,a.cellFormula){for(I=!1,T=0;T<k.length;++T){var A=k[T];f.r>=A[0].s.r&&f.r<=A[0].e.r&&w>=A[0].s.c&&w<=A[0].e.c&&(m.F=Nt(A[0]),I=!0)}!I&&y.length>3&&(m.f=y[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>w&&(u.s.c=w),u.e.r<f.r&&(u.e.r=f.r),u.e.c<w&&(u.e.c=w),a.cellDates&&g&&m.t=="n"&&lg(ft[g.numFmtId])){var O=yu(m.v);O&&(m.t="d",m.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}ie&&(ie.type=="XLDAPR"&&(m.D=!0),ie=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;m={t:"z",v:void 0},w=y[0].c==-1?w+1:y[0].c,a.dense?(l[v]||(l[v]=[]),l[v][w]=m):l[vn(w)+C]=m,u.s.r>f.r&&(u.s.r=f.r),u.s.c>w&&(u.s.c=w),u.e.r<f.r&&(u.e.r=f.r),u.e.c<w&&(u.e.c=w),ie&&(ie.type=="XLDAPR"&&(m.D=!0),ie=void 0);break;case 176:E.push(y);break;case 49:ie=((a.xlmeta||{}).Cell||[])[y-1];break;case 494:var N=n["!id"][y.relId];for(N?(y.Target=N.Target,y.loc&&(y.Target+="#"+y.loc),y.Rel=N):y.relId==""&&(y.Target="#"+y.loc),v=y.rfx.s.r;v<=y.rfx.e.r;++v)for(w=y.rfx.s.c;w<=y.rfx.e.c;++w)a.dense?(l[v]||(l[v]=[]),l[v][w]||(l[v][w]={t:"z",v:void 0}),l[v][w].l=y):(b=ut({c:w,r:v}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=y);break;case 426:if(!a.cellFormula)break;k.push(y),S=a.dense?l[v][w]:l[vn(w)+C],S.f=Kn(y[1],u,{r:f.r,c:w},D,a),S.F=Nt(y[0]);break;case 427:if(!a.cellFormula)break;M[ut(y[0].s)]=y[1],S=a.dense?l[v][w]:l[vn(w)+C],S.f=Kn(y[1],u,{r:f.r,c:w},D,a);break;case 60:if(!a.cellStyles)break;for(;y.e>=y.s;)U[y.e--]={width:y.w/256,hidden:!!(y.flags&1),level:y.level},X||(X=!0,pD(y.w/256)),Of(U[y.e+1]);break;case 161:l["!autofilter"]={ref:Nt(y)};break;case 476:l["!margins"]=y;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),y.name&&(i.Sheets[r].CodeName=y.name),(y.above||y.left)&&(l["!outline"]={above:y.above,left:y.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),y.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!_.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Nt(c||u)),a.sheetRows&&l["!ref"]){var se=Yr(l["!ref"]);a.sheetRows<=+se.e.r&&(se.e.r=a.sheetRows-1,se.e.r>u.e.r&&(se.e.r=u.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>u.e.c&&(se.e.c=u.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Nt(se))}return E.length>0&&(l["!merges"]=E),U.length>0&&(l["!cols"]=U),J.length>0&&(l["!rows"]=J),l}function tZe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=Lt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function rZe(t,e,r,n,i,s){var o=s||{"!type":"chart"};if(!t)return s;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=tZe(h);u.s.r=u.s.c=0,u.e.c=a,c=vn(a),d[0].forEach(function(f,m){o[c+Hn(m)]={t:"n",v:f,z:d[1]},l=m}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=Nt(u)),o}function nZe(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=t.match(oJ);return a&&yD(a[0],s,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iZe(t,e){t.l+=10;var r=ti(t);return{name:r}}function sZe(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ml(t,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var lJ=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oZe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],aZe=[],lZe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w5(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Rr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function x5(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Rr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function cJ(t){x5(t.WBProps,lJ),x5(t.CalcPr,lZe),w5(t.WBView,oZe),w5(t.Sheets,aZe),Dd.date1904=Rr(t.WBProps.date1904)}var cZe="][*?/\\".split("");function uZe(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return cZe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var hZe=/<\w+:workbook/;function dZe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(t.replace(li,function(l,c){var u=st(l);switch(ua(u[0])){case"<?xml":break;case"<workbook":l.match(hZe)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lJ.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Rr(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=dr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Lt(dr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=dr(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Rr(u.hidden||"0")&&(s.Hidden=!0),o=c+l.length;break;case"</definedName>":s.Ref=Lt(dr(t.slice(o,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),k9e.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return cJ(r),r}function fZe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=yk(t),r.name=ti(t),r}function gZe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?ti(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function mZe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function pZe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=K9e(t),o=Qqe(t,0,r),a=hD(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function vZe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],tb[16]={n:"BrtFRTArchID$",f:mZe},ml(t,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Kn(l.Ptg,null,null,o,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),cJ(r),r.Names=s,r.supbooks=o,r}function yZe(t,e,r){return e.slice(-4)===".bin"?vZe(t,r):dZe(t,r)}function wZe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?eZe(t,n,r,i,s,o,a):fJe(t,n,r,i,s,o,a)}function xZe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?sZe(t,n,r,i,s):nZe(t,n,r,i,s)}function bZe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?OXe():kXe()}function SZe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?RXe():AXe()}function CZe(t,e,r,n){return e.slice(-4)===".bin"?WKe(t,r,n):$Ke(t,r,n)}function EZe(t,e,r){return Xq(t,r)}function TZe(t,e,r){return e.slice(-4)===".bin"?oKe(t,r):iKe(t,r)}function _Ze(t,e,r){return e.slice(-4)===".bin"?EXe(t,r):wXe(t,r)}function RZe(t,e,r){return e.slice(-4)===".bin"?pXe(t):gXe(t)}function AZe(t,e,r,n){return r.slice(-4)===".bin"?vXe(t,e,r,n):void 0}function OZe(t,e,r){return e.slice(-4)===".bin"?dXe(t,e,r):fXe(t,e,r)}var uJ=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hJ=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(uJ),s,o,a,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(hJ),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function kZe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(uJ),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(hJ),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var ep;function IZe(t,e){var r=ep[t]||Lt(t);return r==="General"?Gu(e):$s(r,e)}function NZe(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Rr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=On(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Lt(e)]=i}function MZe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||ph[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=x0(t.v):t.w=Gu(t.v):t.w=IZe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=ep[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&lg(n)){var i=yu(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function PZe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=NKe[n.Pattern]||n.Pattern)}t[e.ID]=e}function DZe(t,e,r,n,i,s,o,a,l,c){var u="General",h=n.StyleID,d={};c=c||{};var f=[],m=0;for(h===void 0&&a&&(h=a.StyleID),h===void 0&&o&&(h=o.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&f.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Rr(t);break;case"String":n.t="s",n.r=V6(Lt(t)),n.v=t.indexOf("<")>-1?Lt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(On(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Lt(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Rq[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=V6(e||t));break}if(MZe(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=Lt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Pd(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Pd("RC:RC",i):n.ArrayRange&&(n.F=Pd(n.ArrayRange,i),l.push([Yr(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(f.forEach(function(v){!d.patternType&&v.patternType&&(d.patternType=v.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function LZe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function H_(t,e){var r=e||{};QX();var n=dm(oD(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=dr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=$n(r);return o.type="string",C0.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Fe){i.indexOf("<"+Fe)>=0&&(s=!0)}),s)return zZe(n,r);ep={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},h=[],d=r.dense?[]:{},f="",m={},g={},v=Zs('<Data ss:Type="String">'),w=0,b=0,x=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},T="",I=0,k=[],M={},D={},L=0,U=[],J=[],X={},ie=[],se,P=!1,y=[],_=[],R={},A=0,O=0,N={Sheets:[],WBProps:{date1904:!1}},F={};S0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var j="";a=S0.exec(n);)switch(a[3]=(j=a[3]).toLowerCase()){case"data":if(j=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?DZe(n.slice(w,a.index),T,v,l[l.length-1][0]=="comment"?X:m,{c:b,r:x},S,ie[b],g,y,r):(T="",v=Zs(a[0]),w=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(J.length>0&&(m.c=J),(!r.sheetRows||r.sheetRows>x)&&m.v!==void 0&&(r.dense?(d[x]||(d[x]=[]),d[x][b]=m):d[vn(b)+Hn(x)]=m),m.HRef&&(m.l={Target:Lt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(A=b+(parseInt(m.MergeAcross,10)|0),O=x+(parseInt(m.MergeDown,10)|0),k.push({s:{c:b,r:x},e:{c:A,r:O}})),!r.sheetStubs)m.MergeAcross?b=A+1:++b;else if(m.MergeAcross||m.MergeDown){for(var z=b;z<=A;++z)for(var Q=x;Q<=O;++Q)(z>b||Q>x)&&(r.dense?(d[Q]||(d[Q]=[]),d[Q][z]={t:"z"}):d[vn(z)+Hn(Q)]={t:"z"});b=A+1}else++b;else m=kZe(a[0]),m.Index&&(b=+m.Index-1),b<C.s.c&&(C.s.c=b),b>C.e.c&&(C.e.c=b),a[0].slice(-2)==="/>"&&++b,J=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(x<C.s.r&&(C.s.r=x),x>C.e.r&&(C.e.r=x),a[0].slice(-2)==="/>"&&(g=Zs(a[0]),g.Index&&(x=+g.Index-1)),b=0,++x):(g=Zs(a[0]),g.Index&&(x=+g.Index-1),R={},(g.AutoFitHeight=="0"||g.Height)&&(R.hpx=parseInt(g.Height,10),R.hpt=Kq(R.hpx),_[x]=R),g.Hidden=="1"&&(R.hidden=!0,_[x]=R));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(f),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(d["!ref"]=Nt(C),r.sheetRows&&r.sheetRows<=C.e.r&&(d["!fullref"]=d["!ref"],C.e.r=r.sheetRows-1,d["!ref"]=Nt(C))),k.length&&(d["!merges"]=k),ie.length>0&&(d["!cols"]=ie),_.length>0&&(d["!rows"]=_),u[f]=d}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=b=0,l.push([a[3],!1]),c=Zs(a[0]),f=Lt(c.Name),d=r.dense?[]:{},k=[],y=[],_=[],F={name:f,Hidden:0},N.Sheets.push(F);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),ie=[],P=!1}break;case"style":a[1]==="/"?PZe(S,E,r):E=Zs(a[0]);break;case"numberformat":E.nf=Lt(Zs(a[0]).Format||"General"),ep[E.nf]&&(E.nf=ep[E.nf]);for(var W=0;W!=392&&ft[W]!=E.nf;++W);if(W==392){for(W=57;W!=392;++W)if(ft[W]==null){Au(E.nf,W);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(se=Zs(a[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!P&&se.wpx>10){P=!0,gi=Gq;for(var ae=0;ae<ie.length;++ae)ie[ae]&&Of(ie[ae])}P&&Of(se),ie[se.Index-1||ie.length]=se;for(var ye=0;ye<+se.Span;++ye)ie[ie.length]=$n(se);break;case"namedrange":if(a[1]==="/")break;N.Names||(N.Names=[]);var H=st(a[0]),Re={Name:H.Name,Ref:Pd(H.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(Re.Sheet=N.Sheets.length-1),N.Names.push(Re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?T+=n.slice(I,a.index):I=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Zs(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?wGe(M,j,n.slice(L,a.index)):L=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));LZe(X),J.push(X)}else l.push([a[3],!1]),c=Zs(a[0]),X={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var ue=Zs(a[0]);d["!autofilter"]={ref:Pd(ue.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return _5(n,r);var Pe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(a[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(L,a.index)){case"SheetHidden":F.Hidden=1;break;case"SheetVeryHidden":F.Hidden=2;break}else L=a.index+a[0].length;break;case"header":d["!margins"]||Qm(d["!margins"]={},"xlml"),isNaN(+st(a[0]).Margin)||(d["!margins"].header=+st(a[0]).Margin);break;case"footer":d["!margins"]||Qm(d["!margins"]={},"xlml"),isNaN(+st(a[0]).Margin)||(d["!margins"].footer=+st(a[0]).Margin);break;case"pagemargins":var ke=st(a[0]);d["!margins"]||Qm(d["!margins"]={},"xlml"),isNaN(+ke.Top)||(d["!margins"].top=+ke.Top),isNaN(+ke.Left)||(d["!margins"].left=+ke.Left),isNaN(+ke.Right)||(d["!margins"].right=+ke.Right),isNaN(+ke.Bottom)||(d["!margins"].bottom=+ke.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?NZe(D,j,U,n.slice(L,a.index)):(U=a,L=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=u),be.SheetNames=h,be.Workbook=N,be.SSF=$n(ft),be.Props=M,be.Custprops=D,be}function Sk(t,e){switch(bD(e=e||{}),e.type||"base64"){case"base64":return H_(as(t),e);case"binary":case"buffer":case"file":return H_(t,e);case"array":return H_(fh(t),e)}}function FZe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=J9e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=Z9e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var $Ze=[60,1084,2066,2165,2175];function HZe(t,e,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=Ha(r,r.l),c=Ck[l],u=0;c!=null&&$Ze.indexOf(l)>-1;)s=Ha(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+s),o.push(a),r.l+=4+s,c=Ck[l=Ha(r,r.l)];var h=jl(o);Ln(h,0);var d=0;h.lens=[];for(var f=0;f<o.length;++f)h.lens.push(d),d+=o[f].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Po(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ft[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||ph[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=x0(t.v):t.w=Gu(t.v):t.w=$s(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&lg(ft[n]||String(n))){var i=yu(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function iw(t,e,r){return{v:t,ixfe:e,t:r}}function jZe(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},o={},a=null,l=[],c="",u={},h,d="",f,m,g,v,w={},b=[],x,C,S=[],E=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},k=function(pe){return pe<8?Ou[pe]:pe<64&&E[pe-8]||Ou[pe]},M=function(pe,Ie,je){var Be=Ie.XF.data;if(!(!Be||!Be.patternType||!je||!je.cellStyles)){Ie.s={},Ie.s.patternType=Be.patternType;var Je;(Je=E0(k(Be.icvFore)))&&(Ie.s.fgColor={rgb:Je}),(Je=E0(k(Be.icvBack)))&&(Ie.s.bgColor={rgb:Je})}},D=function(pe,Ie,je){if(!(R>1)&&!(je.sheetRows&&pe.r>=je.sheetRows)){if(je.cellStyles&&Ie.XF&&Ie.XF.data&&M(pe,Ie,je),delete Ie.ixfe,delete Ie.XF,h=pe,d=ut(pe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),pe.r<o.s.r&&(o.s.r=pe.r),pe.c<o.s.c&&(o.s.c=pe.c),pe.r+1>o.e.r&&(o.e.r=pe.r+1),pe.c+1>o.e.c&&(o.e.c=pe.c+1),je.cellFormula&&Ie.f){for(var Be=0;Be<b.length;++Be)if(!(b[Be][0].s.c>pe.c||b[Be][0].s.r>pe.r)&&!(b[Be][0].e.c<pe.c||b[Be][0].e.r<pe.r)){Ie.F=Nt(b[Be][0]),(b[Be][0].s.c!=pe.c||b[Be][0].s.r!=pe.r)&&delete Ie.f,Ie.f&&(Ie.f=""+Kn(b[Be][1],o,pe,y,L));break}}je.dense?(i[pe.r]||(i[pe.r]=[]),i[pe.r][pe.c]=Ie):i[d]=Ie}},L={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(L.password=e.password);var U,J=[],X=[],ie=[],se=[],P=!1,y=[];y.SheetNames=L.snames,y.sharedf=L.sharedf,y.arrayf=L.arrayf,y.names=[],y.XTI=[];var _=0,R=0,A=0,O=[],N=[],F;L.codepage=1200,uo(1200);for(var j=!1;t.l<t.length-1;){var z=t.l,Q=t.read_shift(2);if(Q===0&&_===10)break;var W=t.l===t.length?0:t.read_shift(2),ae=Ck[Q];if(ae&&ae.f){if(e.bookSheets&&_===133&&Q!==133)break;if(_=Q,ae.r===2||ae.r==12){var ye=t.read_shift(2);if(W-=2,!L.enc&&ye!==Q&&((ye&255)<<8|ye>>8)!==Q)throw new Error("rt mismatch: "+ye+"!="+Q);ae.r==12&&(t.l+=10,W-=10)}var H={};if(Q===10?H=ae.f(t,W,L):H=HZe(Q,ae,t,W,L),R==0&&[9,521,1033,2057].indexOf(_)===-1)continue;switch(Q){case 34:r.opts.Date1904=T.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(t.l=0),L.enc=H,!e.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=H;break;case 66:var Re=Number(H);switch(Re){case 21010:Re=1200;break;case 32768:Re=1e4;break;case 32769:Re=1252;break}uo(L.codepage=Re),j=!0;break;case 317:L.rrtabid=H;break;case 25:L.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:L.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:S.push(H);break;case 430:y.push([H]),y[y.length-1].XTI=[];break;case 35:case 547:y[y.length-1].push(H);break;case 24:case 536:F={Name:H.Name,Ref:Kn(H.rgce,o,null,y,L)},H.itab>0&&(F.Sheet=H.itab-1),y.names.push(F),y[0]||(y[0]=[],y[0].XTI=[]),y[y.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(N[H.itab-1]={ref:Nt(H.rgce[0][0][1][2])});break;case 22:L.ExternCount=H;break;case 23:y.length==0&&(y[0]=[],y[0].XTI=[]),y[y.length-1].XTI=y[y.length-1].XTI.concat(H),y.XTI=y.XTI.concat(H);break;case 2196:if(L.biff<8)break;F!=null&&(F.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&L.WTF&&console.error("Password verifier: "+H);break;case 133:s[H.pos]=H,L.snames.push(H.name);break;case 10:{if(--R)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Nt(o),e.sheetRows&&e.sheetRows<=o.e.r){var ue=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Nt(o),o.e.r=ue}o.e.r++,o.e.c++}J.length>0&&(i["!merges"]=J),X.length>0&&(i["!objects"]=X),ie.length>0&&(i["!cols"]=ie),se.length>0&&(i["!rows"]=se),T.Sheets.push(I)}c===""?u=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[Q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),L.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(L.biff=5,j=!0,uo(L.codepage=28591)),L.biff==8&&H.BIFFVer==0&&H.dt==16&&(L.biff=2),R++)break;if(i=e.dense?[]:{},L.biff<8&&!j&&(j=!0,uo(L.codepage=e.codepage||1252)),L.biff<5||H.BIFFVer==0&&H.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:t.l-W,name:c};s[Pe.pos]=Pe,L.snames.push(c)}else c=(s[z]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),J=[],X=[],L.arrayf=b=[],ie=[],se=[],P=!1,I={Hidden:(s[z]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[H.r]||[])[H.c]:i[ut({c:H.c,r:H.r})])&&++H.c,x={ixfe:H.ixfe,XF:S[H.ixfe]||{},v:H.val,t:"n"},A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:H.c,r:H.r},x,e);break;case 5:case 517:x={ixfe:H.ixfe,XF:S[H.ixfe],v:H.val,t:H.t},A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:H.c,r:H.r},x,e);break;case 638:x={ixfe:H.ixfe,XF:S[H.ixfe],v:H.rknum,t:"n"},A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:H.c,r:H.r},x,e);break;case 189:for(var ke=H.c;ke<=H.C;++ke){var be=H.rkrec[ke-H.c][0];x={ixfe:be,XF:S[be],v:H.rkrec[ke-H.c][1],t:"n"},A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:ke,r:H.r},x,e)}break;case 6:case 518:case 1030:{if(H.val=="String"){a=H;break}if(x=iw(H.val,H.cell.ixfe,H.tt),x.XF=S[x.ixfe],e.cellFormula){var Fe=H.formula;if(Fe&&Fe[0]&&Fe[0][0]&&Fe[0][0][0]=="PtgExp"){var He=Fe[0][0][1][0],V=Fe[0][0][1][1],K=ut({r:He,c:V});w[K]?x.f=""+Kn(H.formula,o,H.cell,y,L):x.F=((e.dense?(i[He]||[])[V]:i[K])||{}).F}else x.f=""+Kn(H.formula,o,H.cell,y,L)}A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D(H.cell,x,e),a=H}break;case 7:case 519:if(a)a.val=H,x=iw(H,a.cell.ixfe,"s"),x.XF=S[x.ixfe],e.cellFormula&&(x.f=""+Kn(a.formula,o,a.cell,y,L)),A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D(a.cell,x,e),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(H);var te=ut(H[0].s);if(f=e.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[te],e.cellFormula&&f){if(!a||!te||!f)break;f.f=""+Kn(H[1],o,H[0],y,L),f.F=Nt(H[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!a)break;w[ut(a.cell)]=H[0],f=e.dense?(i[a.cell.r]||[])[a.cell.c]:i[ut(a.cell)],(f||{}).f=""+Kn(H[0],o,h,y,L)}}break;case 253:x=iw(l[H.isst].t,H.ixfe,"s"),l[H.isst].h&&(x.h=l[H.isst].h),x.XF=S[x.ixfe],A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:H.c,r:H.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:H.ixfe,XF:S[H.ixfe],t:"z"},A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:H.c,r:H.r},x,e));break;case 190:if(e.sheetStubs)for(var ve=H.c;ve<=H.C;++ve){var le=H.ixfe[ve-H.c];x={ixfe:le,XF:S[le],t:"z"},A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:ve,r:H.r},x,e)}break;case 214:case 516:case 4:x=iw(H.val,H.ixfe,"s"),x.XF=S[x.ixfe],A>0&&(x.z=O[x.ixfe>>8&63]),Po(x,e,r.opts.Date1904),D({c:H.c,r:H.r},x,e);break;case 0:case 512:R===1&&(o=H);break;case 252:l=H;break;case 1054:if(L.biff==4){O[A++]=H[1];for(var ce=0;ce<A+163&&ft[ce]!=H[1];++ce);ce>=163&&Au(H[1],A+163)}else Au(H[1],H[0]);break;case 30:{O[A++]=H;for(var me=0;me<A+163&&ft[me]!=H;++me);me>=163&&Au(H,A+163)}break;case 229:J=J.concat(H);break;case 93:X[H.cmo[0]]=L.lastobj=H;break;case 438:L.lastobj.TxO=H;break;case 127:L.lastobj.ImData=H;break;case 440:for(v=H[0].s.r;v<=H[0].e.r;++v)for(g=H[0].s.c;g<=H[0].e.c;++g)f=e.dense?(i[v]||[])[g]:i[ut({c:g,r:v})],f&&(f.l=H[1]);break;case 2048:for(v=H[0].s.r;v<=H[0].e.r;++v)for(g=H[0].s.c;g<=H[0].e.c;++g)f=e.dense?(i[v]||[])[g]:i[ut({c:g,r:v})],f&&f.l&&(f.l.Tooltip=H[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;f=e.dense?(i[H[0].r]||[])[H[0].c]:i[ut(H[0])];var de=X[H[2]];f||(e.dense?(i[H[0].r]||(i[H[0].r]=[]),f=i[H[0].r][H[0].c]={t:"z"}):f=i[ut(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),f.c||(f.c=[]),m={a:H[1],t:de.TxO.t},f.c.push(m)}break;case 2173:lXe(S[H.ixfe],H.ext);break;case 125:{if(!L.cellStyles)break;for(;H.e>=H.s;)ie[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},P||(P=!0,pD(H.w/256)),Of(ie[H.e+1])}break;case 520:{var fe={};H.level!=null&&(se[H.r]=fe,fe.level=H.level),H.hidden&&(se[H.r]=fe,fe.hidden=!0),H.hpt&&(se[H.r]=fe,fe.hpt=H.hpt,fe.hpx=T0(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Qm(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Q]]=H;break;case 161:i["!margins"]||Qm(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(T.Views[0].RTL=!0);break;case 146:E=H;break;case 2198:U=H;break;case 140:C=H;break;case 442:c?I.CodeName=H||I.name:T.WBProps.CodeName=H||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+Q.toString(16)),t.l+=W}return r.SheetNames=na(s).sort(function(ge,pe){return Number(ge)-Number(pe)}).map(function(ge){return s[ge].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&N.forEach(function(ge,pe){r.Sheets[r.SheetNames[pe]]["!autofilter"]=ge}),r.Strings=l,r.SSF=$n(ft),L.enc&&(r.Encryption=L.enc),U&&(r.Themes=U),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),y.names.length>0&&(T.Names=y.names),r.Workbook=T,r}var b5={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function BZe(t,e,r){var n=It.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=i5(n,iGe,b5.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var o=It.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var a=i5(o,sGe,b5.SI);for(var l in a)e[l]==null&&(e[l]=a[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(Oq(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function dJ(t,e){e||(e={}),bD(e),BX(),e.codepage&&QP(e.codepage);var r,n;if(t.FullPaths){if(It.find(t,"/encryption"))throw new Error("File is password-protected");r=It.find(t,"!CompObj"),n=It.find(t,"/Workbook")||It.find(t,"/Book")}else{switch(e.type){case"base64":t=lo(as(t));break;case"binary":t=lo(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ln(t,0),n={content:t}}var i,s;if(r&&FZe(r),e.bookProps&&!e.bookSheets)i={};else{var o=kt?"buffer":"array";if(n&&n.content)i=jZe(n.content,e);else if((s=It.find(t,"PerfectOffice_MAIN"))&&s.content)i=Jm.to_workbook(s.content,(e.type=o,e));else if((s=It.find(t,"NativeContent_MAIN"))&&s.content)i=Jm.to_workbook(s.content,(e.type=o,e));else throw(s=It.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&It.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=_Xe(t))}var a={};return t.FullPaths&&BZe(t,a,e),i.Props=i.Custprops=a,e.bookFiles&&(i.cfb=t),i}var tb={0:{f:SJe},1:{f:_Je},2:{f:DJe},3:{f:kJe},4:{f:AJe},5:{f:PJe},6:{f:$Je},7:{f:NJe},8:{f:UJe},9:{f:VJe},10:{f:jJe},11:{f:BJe},12:{f:RJe},13:{f:LJe},14:{f:IJe},15:{f:OJe},16:{f:aJ},17:{f:HJe},18:{f:MJe},19:{f:uD},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pZe},40:{},42:{},43:{f:jKe},44:{f:HKe},45:{f:BKe},46:{f:UKe},47:{f:VKe},48:{},49:{f:W9e},50:{},51:{f:uXe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Bq},62:{f:FJe},63:{f:mXe},64:{f:ZJe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ni,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JJe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:TJe},148:{f:CJe,p:16},151:{f:GJe},152:{},153:{f:gZe},154:{},155:{},156:{f:fZe},157:{},158:{},159:{T:1,f:sKe},160:{T:-1},161:{T:1,f:mh},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:WJe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:cXe},336:{T:-1},337:{f:hXe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yk},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jq},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YJe},427:{f:KJe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qJe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:EJe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:zJe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yk},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:CXe},633:{T:1},634:{T:-1},635:{T:1,f:SXe},636:{T:-1},637:{f:G9e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iZe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:QJe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ck={6:{f:F_},10:{f:kl},12:{f:sn},13:{f:sn},14:{f:Xr},15:{f:Xr},16:{f:Zn},17:{f:Xr},18:{f:Xr},19:{f:sn},20:{f:l5},21:{f:l5},23:{f:jq},24:{f:u5},25:{f:Xr},26:{},27:{},28:{f:xYe},29:{},34:{f:Xr},35:{f:c5},38:{f:Zn},39:{f:Zn},40:{f:Zn},41:{f:Zn},42:{f:Xr},43:{f:Xr},47:{f:EKe},49:{f:tYe},51:{f:sn},60:{},61:{f:ZGe},64:{f:Xr},65:{f:eYe},66:{f:sn},77:{},80:{},81:{},82:{},85:{f:sn},89:{},90:{},91:{},92:{f:WGe},93:{f:SYe},94:{},95:{f:Xr},96:{},97:{},99:{f:Xr},125:{f:Bq},128:{f:hYe},129:{f:zGe},130:{f:sn},131:{f:Xr},132:{f:Xr},133:{f:GGe},134:{},140:{f:AYe},141:{f:sn},144:{},146:{f:kYe},151:{},152:{},153:{},154:{},155:{},156:{f:sn},157:{},158:{},160:{f:DYe},161:{f:NYe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:aYe},190:{f:lYe},193:{f:kl},197:{},198:{},199:{},200:{},201:{},202:{f:Xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:sn},220:{},221:{f:Xr},222:{},224:{f:uYe},225:{f:UGe},226:{f:kl},227:{},229:{f:bYe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:YGe},253:{f:rYe},255:{f:KGe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Pq},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Xr},353:{f:kl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:fYe},431:{f:Xr},432:{},433:{},434:{},437:{},438:{f:TYe},439:{f:Xr},440:{f:_Ye},441:{},442:{f:yv},443:{},444:{f:sn},445:{},446:{},448:{f:kl},449:{f:JGe,r:2},450:{f:kl},512:{f:o5},513:{f:PYe},515:{f:dYe},516:{f:nYe},517:{f:a5},519:{f:LYe},520:{f:XGe},523:{},545:{f:h5},549:{f:s5},566:{},574:{f:QGe},638:{f:oYe},659:{},1048:{},1054:{f:iYe},1084:{},1212:{f:vYe},2048:{f:RYe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:kl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:IYe,r:12},2173:{f:aXe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:pYe,r:12},2197:{},2198:{f:tXe,r:12},2199:{},2200:{},2201:{},2202:{f:yYe,r:12},2203:{f:kl},2204:{},2205:{},2206:{},2207:{},2211:{f:qGe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:sn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:MYe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OYe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:o5},1:{},2:{f:jYe},3:{f:HYe},4:{f:$Ye},5:{f:a5},7:{f:BYe},8:{},9:{f:tw},11:{},22:{f:sn},30:{f:sYe},31:{},32:{},33:{f:h5},36:{},37:{f:s5},50:{f:VYe},62:{},52:{},67:{},68:{f:sn},69:{},86:{},126:{},127:{f:FYe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:UYe},223:{},234:{},354:{},421:{},518:{f:F_},521:{f:tw},536:{f:u5},547:{f:c5},561:{},579:{},1030:{f:F_},1033:{f:tw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qs(t,e,r,n){var i=e;if(!isNaN(i)){var s=(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&bq(r)&&t.push(r)}}function S5(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=i.index,a=s&&s.index||t.length,l=d9e(t.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<l.length;++o){var g=l[o].trim(),v=g.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var w=g.split(/<\/t[dh]>/i);for(a=0;a<w.length;++a){var b=w[a].trim();if(b.match(/<t[dh]/i)){for(var x=b,C=0;x.charAt(0)=="<"&&(C=x.indexOf(">"))>-1;)x=x.slice(C+1);for(var S=0;S<m.length;++S){var E=m[S];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,S=-1)}var T=st(b.slice(0,b.indexOf(">")));d=T.colspan?+T.colspan:1,((h=+T.rowspan)>1||d>1)&&m.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var I=T.t||T["data-t"]||"";if(!x.length){u+=d;continue}if(x=lq(x),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!x.length){u+=d;continue}var k={t:"s",v:x};r.raw||!x.trim().length||I=="s"||(x==="TRUE"?k={t:"b",v:!0}:x==="FALSE"?k={t:"b",v:!1}:isNaN(vo(x))?isNaN(Af(x).getDate())||(k={t:"d",v:On(x)},r.cellDates||(k={t:"n",v:Ci(k.v)}),k.z=r.dateNF||ft[14]):k={t:"n",v:vo(x)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=k):n[ut({r:c,c:u})]=k,u+=d}}}}return n["!ref"]=Nt(f),m.length&&(n["!merges"]=m),n}function VZe(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=ut({r,c:o}),h=n.dense?(t[r]||[])[o]:t[u],d=h&&h.v!=null&&(h.h||sD(h.w||(sl(h),h.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+u,s.push(A9e("td",d,f))}}var m="<tr>";return m+s.join("")+"</tr>"}var UZe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',WZe="</body></html>";function zZe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ic(S5(r[0],e),e);var n=CD();return r.forEach(function(i,s){ED(n,S5(i,e),"Sheet"+(s+1))}),n}function GZe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function YZe(t,e){var r=e||{},n=r.header!=null?r.header:UZe,i=r.footer!=null?r.footer:WZe,s=[n],o=cg(t["!ref"]);r.dense=Array.isArray(t),s.push(GZe(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(VZe(t,o,a,r));return s.push("</table>"+i),s.join("")}function fJ(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?yi(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=cg(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],d=0,f=t["!rows"]||(t["!rows"]=[]),m=0,g=0,v=0,w=0,b=0,x=0;for(t["!cols"]||(t["!cols"]=[]);m<a.length&&g<l;++m){var C=a[m];if(C5(C)){if(n.display)continue;f[g]={hidden:!0}}var S=C.children;for(v=w=0;v<S.length;++v){var E=S[v];if(!(n.display&&C5(E))){var T=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):lq(E.innerHTML),I=E.getAttribute("data-z")||E.getAttribute("z");for(d=0;d<h.length;++d){var k=h[d];k.s.c==w+s&&k.s.r<g+i&&g+i<=k.e.r&&(w=k.e.c+1-s,d=-1)}x=+E.getAttribute("colspan")||1,((b=+E.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:g+i,c:w+s},e:{r:g+i+(b||1)-1,c:w+s+(x||1)-1}});var M={t:"s",v:T},D=E.getAttribute("data-t")||E.getAttribute("t")||"";T!=null&&(T.length==0?M.t=D||"z":n.raw||T.trim().length==0||D=="s"||(T==="TRUE"?M={t:"b",v:!0}:T==="FALSE"?M={t:"b",v:!1}:isNaN(vo(T))?isNaN(Af(T).getDate())||(M={t:"d",v:On(T)},n.cellDates||(M={t:"n",v:Ci(M.v)}),M.z=n.dateNF||ft[14]):M={t:"n",v:vo(T)})),M.z===void 0&&I!=null&&(M.z=I);var L="",U=E.getElementsByTagName("A");if(U&&U.length)for(var J=0;J<U.length&&!(U[J].hasAttribute("href")&&(L=U[J].getAttribute("href"),L.charAt(0)!="#"));++J);L&&L.charAt(0)!="#"&&(M.l={Target:L}),n.dense?(t[g+i]||(t[g+i]=[]),t[g+i][w+s]=M):t[ut({c:w+s,r:g+i})]=M,c.e.c<w+s&&(c.e.c=w+s),w+=x}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+i),t["!ref"]=Nt(c),g>=l&&(t["!fullref"]=Nt((c.e.r=a.length-m+g-1+i,c))),t}function gJ(t,e){var r=e||{},n=r.dense?[]:{};return fJ(n,t,e)}function KZe(t,e){return Ic(gJ(t,e),e)}function C5(t){var e="",r=XZe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function XZe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qZe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Lt(e.replace(/<[^>]*>/g,""));return[r]}var E5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mJ(t,e){var r=e||{},n=oD(t),i=[],s,o,a={name:""},l="",c=0,u,h,d={},f=[],m=r.dense?[]:{},g,v,w={value:""},b="",x=0,C=[],S=-1,E=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,k={},M=[],D={},L=0,U=0,J=[],X=1,ie=1,se=[],P={Names:[]},y={},_=["",""],R=[],A={},O="",N=0,F=!1,j=!1,z=0;for(S0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=S0.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?m["!ref"]=Nt(T):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(m["!fullref"]=m["!ref"],T.e.r=r.sheetRows-1,m["!ref"]=Nt(T)),M.length&&(m["!merges"]=M),J.length&&(m["!rows"]=J),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),d[u.name]=m,j=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=st(g[0],!1),S=E=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,m=r.dense?[]:{},M=[],J=[],j=!0);break;case"table-row-group":g[1]==="/"?--I:++I;break;case"table-row":case"":if(g[1]==="/"){S+=X,X=1;break}if(h=st(g[0],!1),h.?S=h.-1:S==-1&&(S=0),X=+h["number-rows-repeated"]||1,X<10)for(z=0;z<X;++z)I>0&&(J[S+z]={level:I});E=-1;break;case"covered-table-cell":g[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(m[S]||(m[S]=[]),m[S][E]={t:"z"}):m[ut({r:S,c:E})]={t:"z"}),b="",C=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++E,w=st(g[0],!1),ie=parseInt(w["number-columns-repeated"]||"1",10),v={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(v.f=y5(Lt(w.formula))),(w.||w["value-type"])=="string"&&(v.t="s",v.v=Lt(w["string-value"]||""),r.dense?(m[S]||(m[S]=[]),m[S][E]=v):m[ut({r:S,c:E})]=v),E+=ie-1;else if(g[1]!=="/"){++E,b="",x=0,C=[],ie=1;var Q=X?S+X-1:S;if(E>T.e.c&&(T.e.c=E),E<T.s.c&&(T.s.c=E),S<T.s.r&&(T.s.r=S),Q>T.e.r&&(T.e.r=Q),w=st(g[0],!1),R=[],A={},v={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=Lt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(L=parseInt(w["number-matrix-rows-spanned"],10)||0,U=parseInt(w["number-matrix-columns-spanned"],10)||0,D={s:{r:S,c:E},e:{r:S+L-1,c:E+U-1}},v.F=Nt(D),se.push([D,v.F])),w.formula)v.f=y5(w.formula);else for(z=0;z<se.length;++z)S>=se[z][0].s.r&&S<=se[z][0].e.r&&E>=se[z][0].s.c&&E<=se[z][0].e.c&&(v.F=se[z][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(L=parseInt(w["number-rows-spanned"],10)||0,U=parseInt(w["number-columns-spanned"],10)||0,D={s:{r:S,c:E},e:{r:S+L-1,c:E+U-1}},M.push(D)),w["number-columns-repeated"]&&(ie=parseInt(w["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Rr(w["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(w.value);break;case"percentage":v.t="n",v.v=parseFloat(w.value);break;case"currency":v.t="n",v.v=parseFloat(w.value);break;case"date":v.t="d",v.v=On(w["date-value"]),r.cellDates||(v.t="n",v.v=Ci(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=c9e(w["time-value"])/86400,r.cellDates&&(v.t="d",v.v=RC(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(w.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",w["string-value"]!=null&&(b=Lt(w["string-value"]),C=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(F=!1,v.t==="s"&&(v.v=b||"",C.length&&(v.R=C),F=x==0),y.Target&&(v.l=y),R.length>0&&(v.c=R,R=[]),b&&r.cellText!==!1&&(v.w=b),F&&(v.t="z",delete v.v),(!F||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var W=0;W<X;++W){if(ie=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(m[S+W]||(m[S+W]=[]),m[S+W][E]=W==0?v:$n(v);--ie>0;)m[S+W][E+ie]=$n(v);else for(m[ut({r:S+W,c:E})]=v;--ie>0;)m[ut({r:S+W,c:E+ie})]=$n(v);T.e.c<=E&&(T.e.c=E)}ie=parseInt(w["number-columns-repeated"]||"1",10),E+=ie-1,ie=0,v={},b="",C=[]}y={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;A.t=b,C.length&&(A.R=C),A.a=O,R.push(A)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);O="",N=0,b="",x=0,C=[];break;case"creator":g[1]==="/"?O=n.slice(N,g.index):N=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);b="",x=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(k[a.name]=l,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(l="",a=st(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=st(g[0],!1),l+=E5[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=st(g[0],!1),l+=E5[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":o=st(g[0],!1),_=$_(o["cell-range-address"]);var ae={Name:o.name,Ref:_[0]+"!"+_[1]};j&&(ae.Sheet=f.length),P.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var ye=qZe(n.slice(x,g.index));b=(b.length>0?b+`
`:"")+ye[0]}else st(g[0],!1),x=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{_=$_(st(g[0])["target-range-address"]),d[_[0]]["!autofilter"]={ref:_[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(y=st(g[0],!1),!y.href)break;y.Target=Lt(y.href),delete y.href,y.Target.charAt(0)=="#"&&y.Target.indexOf(".")>-1?(_=$_(y.Target.slice(1)),y.Target="#"+_[0]+"!"+_[1]):y.Target.match(/^\.\.[\\\/]/)&&(y.Target=y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var H={Sheets:d,SheetNames:f,Workbook:P};return r.bookSheets&&delete H.Sheets,H}function T5(t,e){e=e||{},bs(t,"META-INF/manifest.xml")&&dGe(nn(t,"META-INF/manifest.xml"),e);var r=es(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=mJ(dr(r),e);return bs(t,"meta.xml")&&(n.Props=Aq(nn(t,"meta.xml"))),n}function _5(t,e){return mJ(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function wD(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ek(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):dr(fh(t))}function Tk(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function R5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function JZe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function _0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function wn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Qn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=_0(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=_0(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function xD(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ZZe(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=_0(t,n),s=Qn(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:wn(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Qn(a.data),c=wn(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=wn(s[3][0].data)>>>0>0),r.push(o)}return r}function QZe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=_0(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Tk(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Tk(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function eQe(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(QZe(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Tk(e)}function tQe(t,e,r,n){var i=wD(t),s=i.getUint32(4,!0),o=(n>1?12:8)+R5(s&(n>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=R5(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(o,!0),o+=4),s&32&&(c=i.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function rQe(t,e,r){var n=wD(t),i=n.getUint32(8,!0),s=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=JZe(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[a]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function nQe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return tQe(t,e,r,t[0]);case 5:return rQe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function dc(t){var e=Qn(t);return _0(e[1][0].data)}function A5(t,e){var r=Qn(e.data),n=wn(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=Qn(o.data),l=wn(a[1][0].data)>>>0;switch(n){case 1:s[l]=Ek(a[3][0].data);break;case 8:{var c=t[dc(a[9][0].data)][0],u=Qn(c.data),h=t[dc(u[1][0].data)][0],d=wn(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var f=Qn(h.data);s[l]=f[3].map(function(m){return Ek(m.data)}).join("")}break}}),s}function iQe(t,e){var r,n,i,s,o,a,l,c,u,h,d,f,m,g,v=Qn(t),w=wn(v[1][0].data)>>>0,b=wn(v[2][0].data)>>>0,x=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&wn(v[8][0].data)>0||!1,C,S;if((s=(i=v[7])==null?void 0:i[0])!=null&&s.data&&e!=0)C=(a=(o=v[7])==null?void 0:o[0])==null?void 0:a.data,S=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=v[4])==null?void 0:u[0])!=null&&h.data&&e!=1)C=(f=(d=v[4])==null?void 0:d[0])==null?void 0:f.data,S=(g=(m=v[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var E=x?4:1,T=wD(C),I=[],k=0;k<C.length/2;++k){var M=T.getUint16(k*2,!0);M<65535&&I.push([k,M])}if(I.length!=b)throw"Expected ".concat(b," cells, found ").concat(I.length);var D=[];for(k=0;k<I.length-1;++k)D[I[k][0]]=S.subarray(I[k][1]*E,I[k+1][1]*E);return I.length>=1&&(D[I[I.length-1][0]]=S.subarray(I[I.length-1][1]*E)),{R:w,cells:D}}function sQe(t,e){var r,n=Qn(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?wn(n[7][0].data)>>>0>0?1:0:-1,s=xD(n[5],function(o){return iQe(o,i)});return{nrows:wn(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function oQe(t,e,r){var n,i=Qn(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(wn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(wn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Nt(s);var o=Qn(i[4][0].data),a=A5(t,t[dc(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?A5(t,t[dc(o[17][0].data)][0]):[],c=Qn(o[3][0].data),u=0;c[1].forEach(function(h){var d=Qn(h.data),f=t[dc(d[2][0].data)][0],m=wn(f.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=sQe(t,f);g.data.forEach(function(v,w){v.forEach(function(b,x){var C=ut({r:u+w,c:x}),S=nQe(b,a,l);S&&(r[C]=S)})}),u+=g.nrows})}function aQe(t,e){var r=Qn(e.data),n={"!ref":"A1"},i=t[dc(r[2][0].data)],s=wn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return oQe(t,i[0],n),n}function lQe(t,e){var r,n=Qn(e.data),i={name:(r=n[1])!=null&&r[0]?Ek(n[1][0].data):"",sheets:[]},s=xD(n[2],dc);return s.forEach(function(o){t[o].forEach(function(a){var l=wn(a.meta[1][0].data);l==6e3&&i.sheets.push(aQe(t,a))})}),i}function cQe(t,e){var r=CD(),n=Qn(e.data),i=xD(n[1],dc);if(i.forEach(function(s){t[s].forEach(function(o){var a=wn(o.meta[1][0].data);if(a==2){var l=lQe(t,o);l.sheets.forEach(function(c,u){ED(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function j_(t){var e,r,n,i,s={},o=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=eQe(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=ZZe(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&wn(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(l){s[l].forEach(function(c){var u=wn(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return cQe(s,a)}function uQe(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function bD(t){uQe([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function hQe(t){return pd.WS.indexOf(t)>-1?"sheet":t==pd.CS?"chart":t==pd.DS?"dialog":t==pd.MS?"macro":t&&t.length?t:"sheet"}function dQe(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,hQe(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function fQe(t,e,r,n,i,s,o,a,l,c,u,h){try{s[n]=Xm(es(t,r,!0),e);var d=nn(t,e),f;switch(a){case"sheet":f=wZe(d,e,i,l,s[n],c,u,h);break;case"chart":if(f=xZe(d,e,i,l,s[n],c,u,h),!f||!f["!drawel"])break;var m=gm(f["!drawel"].Target,e),g=wk(m),v=yXe(es(t,m,!0),Xm(es(t,g,!0),m)),w=gm(v,m),b=wk(w);f=rZe(es(t,w,!0),w,l,Xm(es(t,b,!0),w),c,f);break;case"macro":f=bZe(d,e,i,l,s[n],c,u,h);break;case"dialog":f=SZe(d,e,i,l,s[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=f;var x=[];s&&s[n]&&na(s[n]).forEach(function(C){var S="";if(s[n][C].Type==pd.CMNT){S=gm(s[n][C].Target,e);var E=_Ze(nn(t,S,!0),S,l);if(!E||!E.length)return;f5(f,E,!1)}s[n][C].Type==pd.TCMNT&&(S=gm(s[n][C].Target,e),x=x.concat(xXe(nn(t,S,!0),l)))}),x&&x.length&&f5(f,x,!0,l.people||[])}catch(C){if(l.WTF)throw C}}function ys(t){return t.charAt(0)=="/"?t.slice(1):t}function gQe(t,e){if(QX(),e=e||{},bD(e),bs(t,"META-INF/manifest.xml")||bs(t,"objectdata.xml"))return T5(t,e);if(bs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof j_<"u"){if(t.FileIndex)return j_(t);var r=It.utils.cfb_new();return j6(t).forEach(function(J){m9e(r,J,g9e(t,J))}),j_(r)}throw new Error("Unsupported NUMBERS file")}if(!bs(t,"[Content_Types].xml"))throw bs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=j6(t),i=uGe(es(t,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",nn(t,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!nn(t,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Zm=[],i.sst)try{Zm=TZe(nn(t,ys(i.sst)),i.sst,e)}catch(J){if(e.WTF)throw J}e.cellStyles&&i.themes.length&&(l=EZe(es(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=CZe(nn(t,ys(i.style)),i.style,l,e))}i.links.map(function(J){try{var X=Xm(es(t,wk(ys(J))),J);return AZe(nn(t,ys(J)),X,J,e)}catch{}});var u=yZe(nn(t,ys(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=nn(t,ys(i.coreprops[0]),!0),d&&(h=Aq(d)),i.extprops.length!==0&&(d=nn(t,ys(i.extprops[0]),!0),d&&mGe(d,h,e)));var f={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=es(t,ys(i.custprops[0]),!0),d&&(f=vGe(d,e)));var m={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(X){return X.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),e.bookProps&&(m.Props=h,m.Custprops=f),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var g={};e.bookDeps&&i.calcchain&&(g=RZe(nn(t,ys(i.calcchain)),i.calcchain));var v=0,w={},b,x;{var C=u.Sheets;h.Worksheets=C.length,h.SheetNames=[];for(var S=0;S!=C.length;++S)h.SheetNames[S]=C[S].name}var E=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),I=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");bs(t,I)||(I="xl/_rels/workbook."+E+".rels");var k=Xm(es(t,I,!0),I.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=OZe(nn(t,ys(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=bXe(nn(t,ys(i.people[0])),e)),k&&(k=dQe(k,u.Sheets));var M=nn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=h.Worksheets;++v){var D="sheet";if(k&&k[v]?(b="xl/"+k[v][1].replace(/[\/]?xl\//,""),bs(t,b)||(b=k[v][1]),bs(t,b)||(b=I.replace(/_rels\/.*$/,"")+k[v][1]),D=k[v][2]):(b="xl/worksheets/sheet"+(v+1-M)+"."+E,b=b.replace(/sheet0\./,"sheet.")),x=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(v!=e.sheets)continue e;break;case"string":if(h.SheetNames[v].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var L=!1,U=0;U!=e.sheets.length;++U)typeof e.sheets[U]=="number"&&e.sheets[U]==v&&(L=1),typeof e.sheets[U]=="string"&&e.sheets[U].toLowerCase()==h.SheetNames[v].toLowerCase()&&(L=1);if(!L)continue e}}fQe(t,b,x,h.SheetNames[v],v,w,o,D,e,u,l,c)}return m={Directory:i,Workbook:u,Props:h,Custprops:f,Deps:g,Sheets:o,SheetNames:h.SheetNames,Strings:Zm,Styles:c,Themes:l,SSF:$n(ft)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(J,X){J=J.replace(/^Root Entry[\/]/,""),m.keys.push(J),m.files[J]=t.FileIndex[X]}))),e&&e.bookVBA&&(i.vba.length>0?m.vbaraw=nn(t,ys(i.vba[0]),!0):i.defaults&&i.defaults.bin===TXe&&(m.vbaraw=nn(t,"xl/vbaProject.bin",!0))),m}function mQe(t,e){var r=e||{},n="Workbook",i=It.find(t,n);try{if(n="/!DataSpaces/Version",i=It.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(aKe(i.content),n="/!DataSpaces/DataSpaceMap",i=It.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=cKe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=It.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=uKe(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=It.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);dKe(i.content)}catch{}if(n="/EncryptionInfo",i=It.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=fKe(i.content);if(n="/EncryptedPackage",i=It.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function SD(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=as(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function pQe(t,e){return It.find(t,"EncryptedPackage")?mQe(t,e):dJ(t,e)}function vQe(t,e){var r,n=t,i=e||{};return i.type||(i.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),r=sq(n,i),gQe(r,i)}function pJ(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sk(t.slice(r),e);default:break e}return C0.to_workbook(t,e)}function yQe(t,e){var r="",n=SD(t,e);switch(e.type){case"base64":r=as(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Yu(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=dr(r)),e.type="binary",pJ(r,e)}function wQe(t,e){var r=t;return e.type=="base64"&&(r=as(r)),r=pk.utils.decode(1200,r.slice(2),"str"),e.type="binary",pJ(r,e)}function xQe(t){return t.match(/[^\x00-\x7F]/)?mm(t):t}function B_(t,e,r,n){return n?(r.type="string",C0.to_workbook(t,r)):C0.to_workbook(e,r)}function _k(t,e){BX();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return _k(new Uint8Array(t),(r=$n(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Dd={},r.dateNF&&(Dd.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=a9e(t),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=xQe(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=$n(r),r.type="array",_k(eD(n),r)}switch((i=SD(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return pQe(It.read(n,r),r);break;case 9:if(i[1]<=8)return dJ(n,r);break;case 60:return Sk(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return KYe(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return GYe.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?vQe(n,r):B_(t,n,r,s);case 239:return i[3]===60?Sk(n,r):B_(t,n,r,s);case 255:if(i[1]===254)return wQe(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Jm.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Jm.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return d5.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return TKe.to_workbook(n,r);break;case 10:case 13:case 32:return yQe(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return WYe.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?d5.to_workbook(n,r):B_(t,n,r,s)}function bQe(t,e,r,n,i,s,o,a){var l=Hn(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!o||t[r])for(var f=e.s.c;f<=e.e.c;++f){var m=o?t[r][f]:t[n[f]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[f]!=null&&(d[s[f]]=c);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[f]!=null){if(g==null)if(m.t=="e"&&g===null)d[s[f]]=null;else if(c!==void 0)d[s[f]]=c;else if(u&&g===null)d[s[f]]=null;else continue;else d[s[f]]=u&&(m.t!=="n"||m.t==="n"&&a.rawNumbers!==!1)?g:sl(m,g,a);g!=null&&(h=!1)}}return{row:d,isempty:h}}function Rk(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Yr(u);break;case"number":l=Yr(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Hn(l.s.r),d=[],f=[],m=0,g=0,v=Array.isArray(t),w=l.s.r,b=0,x={};v&&!t[w]&&(t[w]=[]);var C=c.skipHidden&&t["!cols"]||[],S=c.skipHidden&&t["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(C[b]||{}).hidden)switch(d[b]=vn(b),r=v?t[w][b]:t[d[b]+h],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=sl(r,null,c),g=x[o]||0,!g)x[o]=1;else{do a=o+"_"+g++;while(x[a]);x[o]=g,x[a]=1}s[b]=a}for(w=l.s.r+i;w<=l.e.r;++w)if(!(S[w]||{}).hidden){var E=bQe(t,l,w,d,n,s,v,c);(E.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(f[m++]=E.row)}return f.length=m,f}var O5=/"/g;function SQe(t,e,r,n,i,s,o,a){for(var l=!0,c=[],u="",h=Hn(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var f=a.dense?(t[r]||[])[d]:t[n[d]+h];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(a.rawNumbers&&f.t=="n"?f.v:sl(f,null,a));for(var m=0,g=0;m!==u.length;++m)if((g=u.charCodeAt(m))===i||g===s||g===34||a.forceQuotes){u='"'+u.replace(O5,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(O5,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function vJ(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Yr(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],f=n.skipHidden&&t["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(d[m]||{}).hidden||(h[m]=vn(m));for(var g=0,v=i.s.r;v<=i.e.r;++v)(f[v]||{}).hidden||(u=SQe(t,i,v,h,o,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?a:"")+u)));return delete n.dense,r.join("")}function CQe(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=vJ(t,e);return r}function EQe(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Yr(t["!ref"]),s="",o=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=vn(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Hn(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=c?(t[u]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function yJ(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?yi(n.origin):n.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=Yr(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var d=n.header||[],f=0;e.forEach(function(g,v){na(g).forEach(function(w){(f=d.indexOf(w))==-1&&(d[f=d.length]=w);var b=g[w],x="z",C="",S=ut({c:a+f,r:o+v+i});c=R0(s,S),b&&typeof b=="object"&&!(b instanceof Date)?s[S]=b:(typeof b=="number"?x="n":typeof b=="boolean"?x="b":typeof b=="string"?x="s":b instanceof Date?(x="d",n.cellDates||(x="n",b=Ci(b)),C=n.dateNF||ft[14]):b===null&&n.nullError&&(x="e",b=0),c?(c.t=x,c.v=b,delete c.w,delete c.R,C&&(c.z=C)):s[S]=c={t:x,v:b},C&&(c.z=C))})}),u.e.c=Math.max(u.e.c,a+d.length-1);var m=Hn(o);if(i)for(f=0;f<d.length;++f)s[vn(f+a)+m]={t:"s",v:d[f]};return s["!ref"]=Nt(u),s}function TQe(t,e){return yJ(null,t,e)}function R0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=yi(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?R0(t,ut(e)):R0(t,ut({r:e,c:r||0}))}function _Qe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function CD(){return{SheetNames:[],Sheets:{}}}function ED(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(uZe(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function RQe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=_Qe(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function AQe(t,e){return t.z=e,t}function wJ(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function OQe(t,e,r){return wJ(t,"#"+e,r)}function kQe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function IQe(t,e,r,n){for(var i=typeof e!="string"?e:Yr(e),s=typeof e=="string"?e:Nt(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=R0(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var NQe={encode_col:vn,encode_row:Hn,encode_cell:ut,encode_range:Nt,decode_col:cD,decode_row:lD,split_cell:U9e,decode_cell:yi,decode_range:cg,format_cell:sl,sheet_add_aoa:Cq,sheet_add_json:yJ,sheet_add_dom:fJ,aoa_to_sheet:ug,json_to_sheet:TQe,table_to_sheet:gJ,table_to_book:KZe,sheet_to_csv:vJ,sheet_to_txt:CQe,sheet_to_json:Rk,sheet_to_html:YZe,sheet_to_formulae:EQe,sheet_to_row_object_array:Rk,sheet_get_cell:R0,book_new:CD,book_append_sheet:ED,book_set_sheet_visibility:RQe,cell_set_number_format:AQe,cell_set_hyperlink:wJ,cell_set_internal_link:OQe,cell_add_comment:kQe,sheet_set_array_formula:IQe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function xJ({isOpen:t,onClose:e,onSelect:r}){const[n,i]=G.useState([]),[s,o]=G.useState(!0),[a,l]=G.useState(""),[c,u]=G.useState("");G.useEffect(()=>{t&&h()},[t]);const h=async()=>{o(!0),l("");try{const f=await NAe();i(f),f.length>0&&u(f[0].gid)}catch(f){l(f.message)}finally{o(!1)}},d=()=>{c&&(r(c),e())};return t?p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",style:{zIndex:1e3},children:p.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full mx-4 shadow-xl",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Za,{className:"w-5 h-5 text-blue-600"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Select Sheet"})]}),p.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:p.jsx(D0,{className:"w-5 h-5 text-gray-500"})})]}),s?p.jsx("div",{className:"flex items-center justify-center py-8",children:p.jsx(Qa,{className:"w-6 h-6 text-blue-600 animate-spin"})}):a?p.jsx("div",{className:"bg-red-50 p-4 rounded-lg text-red-600 text-sm",children:a}):p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:"space-y-2",children:n.map(f=>p.jsxs("label",{className:`flex items-center p-3 rounded-lg cursor-pointer transition-colors ${c===f.gid?"bg-blue-50 text-blue-700":"hover:bg-gray-50"}`,children:[p.jsx("input",{type:"radio",name:"sheet",value:f.gid,checked:c===f.gid,onChange:()=>u(f.gid),className:"mr-3"}),f.title]},f.gid))}),p.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t",children:[p.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),p.jsx("button",{onClick:d,disabled:!c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:"Import Selected Sheet"})]})]})]})}):null}function MQe({isOpen:t,onClose:e,onImport:r,data:n,loading:i}){const[s,o]=G.useState([]),[a,l]=G.useState(!1),[c,u]=G.useState(1),[h]=G.useState(25),[d,f]=G.useState(()=>{const k=localStorage.getItem("date_range_settings");return k?JSON.parse(k):{startDate:"",endDate:"",filterType:"all"}});if(!t)return null;const m=n[0]||[],g=n.slice(1).filter(k=>{var J;if(d.filterType==="all")return!0;if(!((J=k[0])!=null&&J.trim()))return!1;const M=k[0];let D=null;try{if(typeof M=="string")if(M.includes("/")){const[X]=M.split(" "),[ie,se,P]=X.split("/").map(Number);!isNaN(ie)&&!isNaN(se)&&!isNaN(P)&&(D=new Date(P,se-1,ie))}else M.includes("-")&&(D=new Date(M))}catch{return console.warn("Failed to parse date:",M),!1}if(!D||isNaN(D.getTime()))return!1;const L=d.startDate?new Date(d.startDate):null,U=d.endDate?new Date(d.endDate):null;if(L&&U){const X=new Date(L.getFullYear(),L.getMonth(),L.getDate()),ie=new Date(U.getFullYear(),U.getMonth(),U.getDate()),se=new Date(D.getFullYear(),D.getMonth(),D.getDate());return se>=X&&se<=ie}return!0}),v=Math.ceil(g.length/h),w=(c-1)*h,b=w+h,x=g.slice(w,b),C=k=>{u(k)},S=()=>{l(!a),o(a?[]:g.map((k,M)=>M))},E=k=>{o(M=>M.includes(k)?M.filter(D=>D!==k):[...M,k])},T=()=>{r(s),e()},I=(k,M)=>{const D={...d,filterType:"custom",[k==="start"?"startDate":"endDate"]:M};f(L=>({...L,filterType:"custom",[k==="start"?"startDate":"endDate"]:M})),o([]),l(!1),u(1),localStorage.setItem("date_range_settings",JSON.stringify(D)),window.dispatchEvent(new Event("dateRangeUpdated"))};return p.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",style:{zIndex:1e3},children:p.jsxs("div",{className:"bg-white rounded-xl w-full max-w-6xl mx-4 shadow-xl max-h-[90vh] flex flex-col",children:[p.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Za,{className:"w-5 h-5 text-blue-600"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Preview Import Data"})]}),p.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:p.jsx(D0,{className:"w-5 h-5 text-gray-500"})})]}),i?p.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:p.jsx(Qa,{className:"w-8 h-8 text-blue-600 animate-spin"})}):p.jsxs("div",{className:"flex-1 flex flex-col",children:[p.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[p.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(lx,{className:"w-5 h-5 text-blue-600"}),p.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter by Date:"})]}),p.jsxs("div",{className:"flex flex-wrap gap-4",children:[p.jsx("input",{type:"date",value:d.startDate,onChange:k=>{const M=k.target.value;I("start",M)},className:"px-3 py-2 border rounded-lg text-sm min-w-[150px] focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),p.jsx("span",{className:"text-gray-500",children:"to"}),p.jsx("input",{type:"date",value:d.endDate,onChange:k=>{const M=k.target.value;I("end",M)},className:"px-3 py-2 border rounded-lg text-sm min-w-[150px] focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:d.startDate})]}),p.jsx("button",{onClick:()=>{f({filterType:"all",startDate:"",endDate:""}),o([]),l(!1)},className:"px-3 py-1.5 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:"Clear Filter"})]}),p.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Showing ",g.length," records in selected date range",g.length>h&&p.jsxs("span",{className:"ml-2",children:["(Page ",c," of ",v,")"]})]})]}),p.jsx("div",{className:"flex-1 overflow-auto relative",style:{maxHeight:"calc(90vh - 300px)"},children:p.jsxs("table",{className:"w-full",children:[p.jsx("thead",{className:"bg-gray-50 sticky top-0",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-3 py-2 border-b",children:p.jsxs("label",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"checkbox",checked:a,onChange:S,className:"rounded"}),"Select All"]})}),m.map((k,M)=>p.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-gray-600 border-b whitespace-nowrap",children:k},M))]})}),p.jsx("tbody",{className:"divide-y relative",children:x.map((k,M)=>{const D=w+M;return p.jsxs("tr",{className:s.includes(D)?"bg-blue-10":"hover:bg-gray-50",children:[p.jsx("td",{className:"px-3 py-1.5",children:p.jsx("input",{type:"checkbox",checked:s.includes(D),onChange:()=>E(D),className:"rounded"})}),k.map((L,U)=>p.jsx("td",{className:"px-3 py-1.5 text-sm truncate max-w-xs",children:L},U))]},D)})})]})}),p.jsxs("div",{className:"p-4 border-t bg-gray-50 flex items-center justify-between sticky bottom-0",children:[p.jsxs("div",{className:"text-sm text-gray-600",children:[p.jsxs("span",{className:"mr-4",children:[s.length," rows selected"]}),v>1&&p.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[p.jsx("button",{onClick:()=>C(c-1),disabled:c===1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-50",children:p.jsx(ote,{className:"w-5 h-5"})}),p.jsxs("span",{className:"text-sm",children:["Page ",c," of ",v]}),p.jsx("button",{onClick:()=>C(c+1),disabled:c===v,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-50",children:p.jsx(lU,{className:"w-5 h-5"})})]})]}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),p.jsxs("button",{onClick:T,disabled:s.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[p.jsx(Fl,{className:"w-4 h-4"}),"Import Selected (",s.length,")"]})]})]})]})]})})}const PQe=[{data:"0",title:"[0] Timestamp",type:"date"},{data:"1",title:"[1] Email address",type:"text",validator:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},{data:"2",title:"[2] Name",type:"text",required:!0},{data:"3",title:"[3] ID Proof",type:"dropdown",source:["GSTIN","PAN Card","Aadhar Card"]},{data:"4",title:"[4] ID Proof Details",type:"text"},{data:"5",title:"[5] State",type:"dropdown",source:Object.keys(vS)},{data:"6",title:"[6] State Pin Code",type:"text",validator:/^\d{6}$/},{data:"7",title:"[7] Phone Number",type:"text",validator:/^\d{10}$/,required:!0},{data:"8",title:"[8] Total Amount Paid",type:"numeric",required:!0},{data:"9",title:"[9] Paid Via Card",type:"checkbox"},{data:"10",title:"[10] Other",type:"text"},{data:"11",title:"[11] Payment Paid On",type:"date"},{data:"12",title:"[12] BILL SENT",type:"checkbox"},{data:"13",title:"[13] Pattern",type:"text"},{data:"14",title:"[14] Invoice link",type:"text",readOnly:!0},{data:"15",title:"[15] Invoice Number",type:"text",width:150},{data:"16",title:"[16] Invoice ID",type:"text"},{data:"17",title:"[17] Is paid",type:"checkbox"},{data:"18",title:"[18] Is gst removed",type:"checkbox"},{data:"19",title:"[19] Payment Screenshot",type:"text"},{data:"20",title:"[20] EWAY BILL",type:"checkbox"}],DQe=[{data:"21",title:"[21] Split Status"},{data:"22",title:"[22] Customer ID"},{data:"23",title:"[23] Notes"}],ws=[...PQe,...DQe];kze();const k5=async(t,e,r)=>{var n,i;if(!t){console.error("[GSTIN Verification] Hot table instance not available");return}if(!r||r.trim()===""){console.log("[GSTIN Verification] Empty GSTIN, skipping verification");return}try{const s=t.getDataAtCell(e,2);console.log(`[GSTIN Verification] Starting verification for GSTIN: ${r}, original name: ${s}`),t.setCellMeta(e,2,"className","gstin-verifying"),t.setCellMeta(e,4,"className","gstin-verifying"),t.render(),t.setDataAtCell(e,2,"Verifying GSTIN..."),t.render();const o={billedTo:{gstin:r,name:s!=="Verifying GSTIN..."?s:"",pincode:"",gstState:"",country:"",phone:"",phoneShowInInvoice:!1,customFields:[]}};console.log("[GSTIN Verification] Calling verifyBillGSTIN...");const a=await Rd(o);if(console.log("[GSTIN Verification] Result:",JSON.stringify(a,null,2)),t.setCellMeta(e,2,"className",""),t.setCellMeta(e,4,"className",""),a.status==="success"&&((n=a.billedTo)!=null&&n.name)){console.log("[GSTIN Verification] Successful verification"),t.setDataAtCell(e,2,a.billedTo.name),t.setCellMeta(e,2,"className","gstin-verified-name"),t.setCellMeta(e,4,"className","gstin-verified"),t.render(),setTimeout(()=>{var h,d;t.getDataAtCell(e,2)!==((h=a.billedTo)==null?void 0:h.name)&&(console.log("[GSTIN Verification] Name update failed, trying again..."),t.setDataAtCell(e,2,(d=a.billedTo)==null?void 0:d.name),t.render())},100);const c=(((i=a.billedTo)==null?void 0:i.customFields)||[]).find(u=>u.label==="Address"||u.label==="principal_place_of_business");if(c&&c.value){const u=String(c.value),h=u.match(/(\d{6})/);if(h&&!t.getDataAtCell(e,6)&&t.setDataAtCell(e,6,h[1]),!t.getDataAtCell(e,5)){for(const d of Object.keys(vS))if(u.includes(d)){t.setDataAtCell(e,5,d);break}}}}else console.warn("[GSTIN Verification] Verification failed:",a.message),t.setCellMeta(e,4,"className","gstin-error"),s&&s!=="Verifying GSTIN..."?t.setDataAtCell(e,2,s):t.setDataAtCell(e,2,""),t.render()}catch(s){console.error("[GSTIN Verification] Error during verification:",s),t.setCellMeta(e,2,"className",""),t.setCellMeta(e,4,"className","gstin-error"),t.render()}};function LQe({onDataUpdate:t,onRowSelect:e}){G.useRef(null);const r=G.useRef(null),[n,i]=G.useState(()=>{try{const y=localStorage.getItem("bill_generator_grid_data");return y?JSON.parse(y):[Array(ws.length).fill("")]}catch{return[Array(ws.length).fill("")]}}),[s,o]=G.useState([]),a=G.useRef(null),[l,c]=G.useState(""),[u,h]=G.useState(!1),[d,f]=G.useState(!1),[m,g]=G.useState(!1),[v,w]=G.useState([]),[b,x]=G.useState(null),[C,S]=G.useState(()=>{const y=localStorage.getItem("date_range_settings");return y?JSON.parse(y):{startDate:"",endDate:"",filterType:"all"}});G.useEffect(()=>{const y=_=>{var A;S(_.detail);const R=(A=r.current)==null?void 0:A.hotInstance;R&&(R.getPlugin("filters").clearConditions(0),R.getPlugin("filters").removeConditions(0),_.detail.filterType!=="all"&&(R.getPlugin("filters").addCondition(0,"between",[_.detail.startDate,_.detail.endDate]),R.getPlugin("filters").filter()))};return window.addEventListener("dateRangeUpdated",y),()=>{window.removeEventListener("dateRangeUpdated",y)}},[]);const E=()=>{if(!qf()){c("Google Sheets credentials not configured. Please set them up in Settings.");return}f(!0)},T=async y=>{h(!0),c("");try{const _=await d9(y);w(_),g(!0)}catch(_){c(_.message)}finally{h(!1),f(!1)}},I=y=>{const _=y.map(R=>v[R+1]);i(R=>{const O=[...R.filter(N=>N[14]&&N[14].trim()!==""),..._];return O.some(N=>N.every(F=>F===""))||O.push(Array(ws.length).fill("")),Dc(O),O}),c(`Successfully imported ${y.length} records from Google Sheets!`)},k=()=>{c("");try{Dc(n),c("Data saved successfully!")}catch(y){c(y.message)}},M=()=>{c("");try{const y=[Array(ws.length).fill("")];i(y),Dc(y),t([]),o([]),c("All data cleared successfully!")}catch(y){c(y.message)}},D=y=>{i(_=>{const R=[..._];return R[y]&&(R[y][17]="true"),R}),Dc(n)};G.useEffect(()=>{const y=setTimeout(()=>{localStorage.setItem("bill_generator_grid_data",JSON.stringify(n))},500);return()=>clearTimeout(y)},[n]);const L=async y=>!y||!Array.isArray(y)?[]:y.some(_=>_!=="")?c9(y):[],U=async y=>{o(y),e(y);const _=y.filter(R=>n[R]&&n[R].some(A=>A!==""));try{const R=_.map(N=>L(n[N])),O=(await Promise.all(R)).flat();t(O)}catch(R){console.error("Error processing bills:",R),t([])}},J=y=>{var A;const _=(A=y.target.files)==null?void 0:A[0];if(!_)return;c("");const R=new FileReader;R.onload=O=>{var N;try{const F=_k((N=O.target)==null?void 0:N.result),j=F.Sheets[F.SheetNames[0]],Q=NQe.sheet_to_json(j,{header:1}).slice(1).filter(ye=>Array.isArray(ye)&&ye.some(H=>H!==""));if(Q.length===0){c("No data found in imported file");return}const W=Q.map(ye=>{const H=ye.map(Re=>Re==null?"":String(Re));return H.concat(Array(ws.length-H.length).fill(""))});i(W),localStorage.setItem("bill_generator_grid_data",JSON.stringify(W));const ae=W.flatMap(ye=>L(ye));t(ae),c("Data imported successfully!")}catch(F){console.error("Error processing Excel file:",F),c(`Error processing Excel file: ${F.message}`)}},R.onerror=()=>{c("Error reading the file")},R.readAsArrayBuffer(_)};G.useEffect(()=>{if(!n.length||!n.some(A=>(A[13]||"").includes("/")))return;const _=n.map(A=>{const O=A[13]||"",N=A[16]||"",F=O.match(/(\d+)\/(\d+)/);if(F&&N){const j=`split_bill_${N}`,z=localStorage.getItem(j);if(z)try{const{remainingSplits:Q}=JSON.parse(z),W=[...A];return W[2]=`Split ${F[2]-Q}/${F[2]}`,W}catch{return A}}return A});JSON.stringify(_)!==JSON.stringify(n)&&i(_)},[n]),G.useEffect(()=>{const y=_=>{var A;const R=(A=r.current)==null?void 0:A.hotInstance;if(R){if(_.key==="Delete"){_.preventDefault();const O=R.getSelected();if(!O)return;O.forEach(([N,F,j,z])=>{for(let Q=N;Q<=j;Q++)for(let W=F;W<=z;W++)R.setDataAtCell(Q,W,"")})}_.ctrlKey&&_.key==="d"&&_.preventDefault()}};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[]),G.useEffect(()=>{var _;const y=(_=r.current)==null?void 0:_.hotInstance;if(!(!y||!C)&&y.getPlugin){const R=y.getPlugin("filters");R&&(R.clearConditions(0),R.removeConditions(0),C.filterType!=="all"&&C.startDate&&C.endDate&&(R.addCondition(0,"between",[C.startDate,C.endDate]),R.filter()))}},[C]);const X=oe.useCallback((y,_)=>{var A,O,N,F,j;if(!y||_==="loadData")return;for(const[z,Q,W,ae]of y){const ye=parseInt(Q,10);if(ye===4&&typeof ae=="string"&&ae.trim()!==""&&((A=r.current)==null?void 0:A.hotInstance.getDataAtCell(z,3))==="GSTIN"&&k5((O=r.current)==null?void 0:O.hotInstance,z,ae),ye===3&&ae==="GSTIN"){const H=(N=r.current)==null?void 0:N.hotInstance.getDataAtCell(z,4);H&&typeof H=="string"&&H.trim()!==""&&k5((F=r.current)==null?void 0:F.hotInstance,z,H)}}const R=((j=r.current)==null?void 0:j.hotInstance.getData())||[];Dc(R),i(R),L(R).then(z=>{t(z)}).catch(z=>{console.error("Error processing row data:",z),t([])})},[n,t]),ie=async(y=0,_=0)=>{var R;try{const O=(await navigator.clipboard.readText()).split(`
`).map(z=>z.split("	"));if(!O.length||!O[0].length){console.warn("No data found in clipboard"),c("No data found in clipboard. Please try copying from your spreadsheet again.");return}console.log(`Found ${O.length} rows and ${O[0].length} columns in clipboard`);const N=(R=r.current)==null?void 0:R.hotInstance;if(!N){c("Table not initialized. Please refresh the page and try again.");return}const F=[...n];for(let z=0;z<O.length;z++){const Q=y+z;F[Q]||(F[Q]=Array(ws.length).fill(""));for(let W=0;W<O[z].length;W++){const ae=_+W;if(ae<ws.length){let ye=O[z][W];ye!=null?ye=String(ye).trim():ye="",F[Q][ae]=ye}}}F.some(z=>z.every(Q=>Q===""))||F.push(Array(ws.length).fill("")),i(F),N.loadData(F),Dc(F);const j=F.filter(z=>z&&z.some(Q=>Q!=="")).map(z=>L(z));t(j),c(`Successfully pasted ${O.length} rows from clipboard`)}catch(A){console.error("Paste error:",A),c(`Error pasting from clipboard: ${A.message}`)}},se=async()=>{var y;try{c("");const _=(y=r.current)==null?void 0:y.hotInstance;let R=0,A=0;if(_){const O=_.getSelected();O&&O.length>0&&(R=O[0][0],A=O[0][1])}await ie(R,A)}catch(_){console.error("Error handling clipboard paste:",_),c(`Clipboard paste error: ${_.message}`)}},P={minRows:1,minCols:ws.length,minSpareRows:2,rowHeaders:!0,colHeaders:!0,width:"100%",height:500,licenseKey:"non-commercial-and-evaluation",autoWrapRow:!0,autoWrapCol:!0,wordWrap:!0,manualRowMove:!0,manualColumnMove:!0,copyPaste:{copyable:!0,pasteMode:"shift_down",pasteLimit:1e4,rowsLimit:1e4,columnsLimit:50},beforePaste:(y,_)=>(console.log("Before paste data:",y),console.log("Paste coordinates:",_),y.length>0&&y[0].length>0,y),afterPaste:(y,_)=>(console.log("After paste data:",y),!y.length||!y[0].length?(setTimeout(()=>{const R=_[0][0],A=_[0][1];ie(R,A)},10),y):(setTimeout(()=>{var R;try{const A=(R=r.current)==null?void 0:R.hotInstance;if(A){const O=A.getData();i(O),Dc(O);const N=O.filter(F=>F&&F.some(j=>j!=="")).map(F=>L(F));t(N),O.some(F=>F.every(j=>j===""))||A.alter("insert_row_below",O.length-1,1),c("Data pasted successfully!")}}catch(A){console.error("Error processing pasted data:",A),c(`Error processing pasted data: ${A.message}`)}},50),y)),fillHandle:{autoInsertRow:!0,direction:"vertical",copyPaste:!0,fillMode:"sequence"},autoColumnSize:{samplingRatio:.1,useHeaders:!0},fixedColumnsLeft:3,fixedRowsTop:0,outsideClickDeselects:!1,enterMoves:{row:0,col:1},enterBeginsEditing:!0,dropdownMenu:{items:{filter_by_condition:{name:"Filter by condition"},filter_by_value:{name:"Filter by value"},filter_action_bar:{name:"Filter options"},clear_filter:{name:"Clear filter"}}},filters:!0,columnSorting:{sortEmptyCells:!0,multiColumnSorting:!0,indicator:!0},search:!0,comments:!0,customBorders:!0,mergeCells:!0,contextMenu:{enabled:!0,allowMouseDownOutsideMenu:!0,disableSelection:!1,cssAsClass:!0,className:"htContextMenu htDropdownMenu",items:{row_above:{},row_below:{},separator1:"---------",remove_row:{},clear_row:{},separator2:"---------",copy:{},cut:{},separator3:"---------",alignment:{},separator4:"---------",mark_paid:{name:"Mark as Paid",callback(y,_){const R=_[0].start.row;D(R)},disabled(){const y=this.getSelected();if(!y)return!0;const _=y[0][0];return!this.getDataAtCell(_,16)}},separator5:"---------",make_read_only:{},make_read_write:{},separator6:"---------",freeze_column:{name:"Freeze column",callback(y,_){const R=_[0].start.col;this.updateSettings({fixedColumnsLeft:R+1})}},unfreeze_column:{name:"Unfreeze columns",callback(){this.updateSettings({fixedColumnsLeft:0})}}}},cells(y,_){const R={},A=ws[_];if(R.contextMenu=!0,R.className="htMiddle",A&&(A.type==="numeric"||_===8)&&(R.type="numeric",R.numericFormat={pattern:"0,0.00",culture:"en-IN"}),A&&(A.type==="date"||_===0)&&(R.type="text",R.validator=(O,N)=>{if(!O){N(!0);return}const F=/^(\d{2}\/\d{2}\/\d{4}|\d{4}-\d{2}-\d{2})$/.test(O);N(F)}),A){if(R.type=A.type||"text",A.source&&(R.source=A.source),A.readOnly){R.readOnly=!0;const O=R.className||"";R.className=`${O} htReadOnly`}if(A.validator&&(R.validator=(O,N)=>{if(!O&&!A.required){N(!0);return}typeof A.validator=="function"?N(A.validator(O)):N(A.validator.test(String(O)))},R.allowInvalid=!1),A.required){const O=R.className||"";R.className=`${O} htRequired`}}return R},trimRows:!0,trimColumns:!0,manualColumnResize:{minWidth:100,maxWidth:300},manualRowResize:{minHeight:25,maxHeight:100},beforeKeyDown:y=>{var _;if(y.ctrlKey&&y.key==="d"){y.preventDefault();const R=(_=r.current)==null?void 0:_.hotInstance;if(!R)return;const A=R.getSelected();if(!A)return;A.forEach(([O,N,F,j])=>{const z=[];for(let Q=O;Q<=F;Q++)z.push(R.getDataAtRow(Q));R.alter("insert_row_below",F,z.length),z.forEach((Q,W)=>{R.populateFromArray(F+1+W,0,[Q])})})}},colWidths:y=>{switch(y){case 0:return 150;case 1:return 200;case 2:return 150;case 7:return 120;case 8:return 100;default:return 130}},stretchH:"all",data:n,columns:ws,afterChange:X,beforeRemoveRow:(y,_)=>n.length-_>=1,afterRemoveRow:(y,_)=>{i(R=>{const A=[...R];return A.every(O=>O.some(N=>N!==""))&&A.push(Array(ws.length).fill("")),A})},afterSelection:function(y,_,R,A,O,N){const F=[];for(let j=Math.min(y,R);j<=Math.max(y,R);j++)n[j]&&n[j].some(z=>z!=="")&&F.push(j);o(F),U(F)}};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[p.jsx(mU,{className:"w-5 h-5 text-blue-600"}),p.jsx("h2",{className:"text-lg font-semibold",children:"Bulk Customer Import"})]}),p.jsxs("div",{className:"flex-1 flex justify-end",children:[p.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors disabled:opacity-50 mr-2",children:[p.jsx(P0,{className:"w-4 h-4"}),"Save Data"]}),p.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors mr-2",children:[p.jsx(zd,{className:"w-4 h-4"}),"Clear All"]}),p.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-4 py-2 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 transition-colors mr-2",children:[p.jsx(Za,{className:"w-4 h-4"}),"Paste from Clipboard"]}),p.jsx("button",{onClick:E,disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 mr-2",children:u?p.jsxs(p.Fragment,{children:[p.jsx(Qa,{className:"w-4 h-4 animate-spin"}),"Importing..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Za,{className:"w-4 h-4"}),"Import from Sheets"]})}),p.jsxs("button",{onClick:()=>{var y;return(y=a.current)==null?void 0:y.click()},className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[p.jsx(pU,{className:"w-4 h-4"}),"Import Excel"]}),p.jsx("input",{ref:a,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:J})]})]}),p.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg mb-4",children:[p.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Column Information:"}),p.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc pl-4",children:[p.jsx("li",{children:"Required Fields: Name, Phone Number, Total Amount"}),p.jsx("li",{children:"Pattern (Column 13): Leave empty to auto-generate based on Total Amount"}),p.jsx("li",{children:'Is GST Removed (Column 18): Set to "yes" if amount excludes GST'}),p.jsx("li",{children:'Paid Via Card (Column 9): Set to "yes" if paid by card (5.06% fee)'}),p.jsx("li",{children:'EWAY BILL (Column 20): Set to "yes" if e-way bill is required'}),p.jsx("li",{children:"Invoice Number and ID are read-only (generated after bill creation)"})]})]}),p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[p.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Quick Guide:"}),p.jsxs("ul",{className:"text-sm text-blue-600 space-y-1 list-disc pl-4",children:[p.jsxs("li",{children:["Date Range:",C.filterType!=="all"&&p.jsxs("span",{className:"ml-2",children:["Showing data from ",C.startDate," to ",C.endDate]})]}),p.jsxs("li",{children:["Keyboard Shortcuts:",p.jsxs("ul",{className:"ml-4 mt-1",children:[p.jsxs("li",{children:[p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"Delete"})," - Clear selected cells"]}),p.jsxs("li",{children:[p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"Ctrl"})," + ",p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"C"})," - Copy"]}),p.jsxs("li",{children:[p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"Ctrl"})," + ",p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"V"})," - Paste"]}),p.jsxs("li",{children:[p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"Ctrl"})," + ",p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"D"})," - Duplicate rows"]}),p.jsxs("li",{children:[p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"Tab"})," - Move to next cell"]}),p.jsxs("li",{children:[p.jsx("kbd",{className:"px-2 py-0.5 bg-gray-100 rounded",children:"Enter"})," - Move to next column"]})]})]}),p.jsx("li",{children:"Main columns follow the standard format"}),p.jsx("li",{children:"Additional columns are available at the end"}),p.jsx("li",{children:"Upload an Excel file (.xlsx or .xls)"}),p.jsx("li",{children:"Data will be automatically mapped to the grid"}),p.jsx("li",{children:"You can also manually edit or paste data directly into the grid"}),p.jsx("li",{children:"Each row represents a different customer"}),p.jsx("li",{children:'Click "Save Data" to store your changes locally'})]})]}),l&&p.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-4",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsx(zd,{className:"w-5 h-5 text-red-600"}),p.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Data Status"})]}),p.jsx("div",{className:"text-sm text-red-600 whitespace-pre-line",children:l})]}),p.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white shadow-sm",children:p.jsx(bK,{ref:r,height:400,licenseKey:"non-commercial-and-evaluation",currentRowClassName:"current-row",currentColClassName:"current-col",rowHeaders:!0,settings:P,className:"w-full"})}),p.jsx("div",{className:"mt-2",children:p.jsxs("p",{className:"text-sm text-gray-500",children:["Selected Rows: ",s.map(y=>y+1).join(", ")]})}),p.jsx(xJ,{isOpen:d,onClose:()=>f(!1),onSelect:T}),p.jsx(MQe,{isOpen:m,onClose:()=>g(!1),onImport:I,data:v,loading:u}),p.jsx("style",{children:`
        .verifying-gstin {
          background-color: #fffde7 !important;
          color: #b28704 !important;
        }
        .gstin-verified {
          background-color: #e8f5e9 !important;
          position: relative;
        }
        .gstin-verified::after {
          content: "";
          color: #2e7d32;
          position: absolute;
          right: 8px;
          top: 50%;
          transform: translateY(-50%);
          font-weight: bold;
        }
        .gstin-verified-name {
          background-color: #e8f5e9 !important;
          font-weight: bold !important;
          color: #2e7d32 !important;
        }
        .gstin-error {
          background-color: #ffebee !important;
          position: relative;
        }
        .gstin-error::after {
          content: "";
          position: absolute;
          right: 8px;
          top: 50%;
          transform: translateY(-50%);
        }
        `})]})}function FQe(){const[t,e]=G.useState([]),[r,n]=G.useState([]),[i,s]=G.useState("grid"),[o,a]=G.useState(!1),[l,c]=G.useState(null),u=async w=>{try{if(a(!0),c(null),!w){e([]);return}const b=Array.isArray(w)?w:[w],x=await Promise.all(b.map(async C=>{var S;if((S=C==null?void 0:C.billedTo)!=null&&S.gstin)try{return await Rd(C)}catch(E){return console.error("Error verifying GSTIN:",E),C}return C}));e(x.filter(Boolean))}catch(b){console.error("Error processing bills:",b),c("Failed to process bills")}finally{a(!1)}},h=w=>{n(w)},d=Array.isArray(t)?t.length:0,f=Array.isArray(r)?r.length:0,m=Array.isArray(t)?t.filter(w=>w&&!w.invoiceId).length:0,g=Array.isArray(t)?t.filter(w=>w&&w.invoiceId).length:0,v=Array.isArray(t)?t.reduce((w,b)=>{var x,C;return w+(((C=(x=b==null?void 0:b.items)==null?void 0:x[0])==null?void 0:C.total)||0)},0):0;return p.jsxs("div",{className:"space-y-6",children:[l&&p.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",children:l}),o&&p.jsx("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded relative",children:"Processing bills..."}),p.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 sm:gap-0",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bulk Customer Import"}),p.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Import and manage customer data in bulk"})]}),p.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[p.jsxs(yO,{variant:"outline",size:"sm",children:[p.jsx(HR,{className:"w-4 h-4 mr-2"}),"Filters"]}),p.jsxs(yO,{variant:"outline",size:"sm",children:[p.jsx(uU,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[p.jsxs(im,{children:[p.jsxs(sm,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[p.jsx(om,{className:"text-sm font-medium",children:"Total Records"}),p.jsx(Za,{className:"h-4 w-4 text-gray-500"})]}),p.jsxs(am,{children:[p.jsx("div",{className:"text-2xl font-bold",children:d}),p.jsxs("p",{className:"text-xs text-gray-500",children:[f," selected"]})]})]}),p.jsxs(im,{children:[p.jsxs(sm,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[p.jsx(om,{className:"text-sm font-medium",children:"Pending Bills"}),p.jsx(zd,{className:"h-4 h-4 text-yellow-500"})]}),p.jsxs(am,{children:[p.jsx("div",{className:"text-2xl font-bold",children:m}),p.jsx("p",{className:"text-xs text-gray-500",children:"Ready to generate"})]})]}),p.jsxs(im,{children:[p.jsxs(sm,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[p.jsx(om,{className:"text-sm font-medium",children:"Generated Bills"}),p.jsx(mU,{className:"h-4 w-4 text-green-500"})]}),p.jsxs(am,{children:[p.jsx("div",{className:"text-2xl font-bold",children:g}),p.jsx("p",{className:"text-xs text-gray-500",children:"Successfully processed"})]})]}),p.jsxs(im,{children:[p.jsxs(sm,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[p.jsx(om,{className:"text-sm font-medium",children:"Total Amount"}),p.jsx(P0,{className:"h-4 w-4 text-blue-500"})]}),p.jsxs(am,{children:[p.jsxs("div",{className:"text-2xl font-bold",children:["",v.toLocaleString()]}),p.jsx("p",{className:"text-xs text-gray-500",children:"Including GST"})]})]})]}),p.jsx("div",{className:"border-b border-gray-200",children:p.jsxs("nav",{className:"-mb-px flex space-x-8",children:[p.jsx("button",{onClick:()=>s("grid"),className:`
              border-b-2 py-4 px-1 text-sm font-medium
              ${i==="grid"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}
            `,children:"Data Grid"}),p.jsx("button",{onClick:()=>s("preview"),className:`
              border-b-2 py-4 px-1 text-sm font-medium
              ${i==="preview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}
            `,children:"Bill Preview"})]})}),p.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:i==="grid"?p.jsx(LQe,{onDataUpdate:u,onRowSelect:h}):p.jsx("div",{className:"p-6",children:p.jsx("div",{className:"text-center text-gray-500",children:"Select rows in the grid to preview bills"})})})]})}async function $Qe(t,e){try{const r={alg:"ES256",typ:"JWT"},n={iss:t,sub:t,aud:"serana",auth:{entity:"app",strategy:"app-iss-app-token"},iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+23*60*60+58*60},i=btoa(JSON.stringify(r)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),s=btoa(JSON.stringify(n)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),o=i+"."+s,a=e.replace(/-----BEGIN PRIVATE KEY-----/,"").replace(/-----END PRIVATE KEY-----/,"").replace(/\s+/g,""),l=Uint8Array.from(atob(a),v=>v.charCodeAt(0)),c={name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}},u=await window.crypto.subtle.importKey("pkcs8",l.buffer,c,!1,["sign"]),d=new TextEncoder().encode(o),f=await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},u,d),m=new Uint8Array(f),g=btoa(Array.from(m,v=>String.fromCharCode(v)).join("")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return o+"."+g}catch(r){throw console.error("JWT Generation Error:",r),new Error("Failed to generate JWT: "+r.message)}}async function HQe(t){const e=await fetch("https://api.refrens.com/authentication",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({strategy:"app-iss-app-token"})});if(!e.ok){const n=await e.text();throw new Error(`Authentication failed (${e.status}): ${n}`)}return(await e.json()).accessToken}const jQe="vm-jewellers-QNxLg",BQe=`-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgegjBaeYlIwMiZcrU
VTlRqvrkk3sHRT5eUHzZmMp3Yg+hRANCAASBzuRh/4Xdh1XLWH62DIXa4RdOeW7H
QFOIINuZUozLBpRuzTsFK/bGskuXI1mmHZZvxs2uw14ExyF25wH4iX6C
-----END PRIVATE KEY-----`;function VQe({onAuthChange:t}){const[e,r]=G.useState(()=>{const h=Cu();return h?Ad(h):""}),[n,i]=G.useState(!1),[s,o]=G.useState(!1),[a,l]=G.useState("");G.useEffect(()=>{const h=$I(e),d=Eu(h);i(d),t(d)},[e,t]);const c=h=>{const d=h.target.value,f=Ad(d);r(f),f&&nj(f)},u=G.useCallback(async()=>{o(!0),l("");try{const h=await $Qe(jQe,BQe),d=await HQe(h);d&&(r(Ad(d)),nj(d),i(!0),t(!0))}catch(h){l(h.message)}finally{o(!1)}},[t]);return p.jsxs("div",{className:"space-y-4 mb-6",children:[p.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[p.jsx(_2,{className:"w-5 h-5 text-blue-600"}),p.jsx("h2",{className:"text-lg font-semibold",children:"API Authentication"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bearer Token"}),p.jsx("input",{type:"text",className:`w-full p-3 border rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all ${e&&!n?"border-red-300":""}`,placeholder:"Enter token without Bearer prefix",value:e,onChange:c,disabled:s}),p.jsx("div",{className:"flex items-center gap-4",children:p.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[p.jsx(Gd,{className:`w-4 h-4 ${s?"animate-spin":""}`}),s?"Generating...":"Generate Authentication Token"]})}),a&&p.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["Error: ",a]})]})]})}function UQe({onCredentialsUpdate:t}){const[e,r]=G.useState(""),[n,i]=G.useState(""),[s,o]=G.useState(""),[a,l]=G.useState(""),[c,u]=G.useState([]),[h,d]=G.useState(""),[f,m]=G.useState(!1),[g,v]=G.useState(!1),[w,b]=G.useState("checking"),x=async()=>{try{await jI(),b("connected"),v(!0),d("")}catch(T){b("disconnected"),d(T.message),console.warn("Failed to initialize Google Sheets:",T)}};G.useEffect(()=>{const T=qf();T?(r(T.apiKey),i(T.clientId),o(T.spreadsheetId),l(T.selectedGid||""),x()):b("disconnected")},[]);const C=async()=>{try{const T=await getAvailableSheets();u(T),T.length>0&&!a&&l(T[0].gid)}catch(T){console.error("Error fetching sheets:",T)}},S=async()=>{if(!e||!n||!s){d("All fields are required");return}m(!0),d("");try{kAe({apiKey:e,clientId:n,spreadsheetId:s,selectedGid:a});try{await x(),await C(),t()}catch(T){throw T}}catch(T){d(T.message),b("disconnected")}finally{m(!1)}},E=()=>{IAe(),r(""),i(""),o(""),v(!1),b("disconnected"),t()};return p.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Za,{className:"w-6 h-6 text-blue-600"}),p.jsx("h2",{className:"text-lg font-semibold",children:"Google Sheets Integration"})]}),w!=="checking"&&p.jsx("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-sm ${w==="connected"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:w==="connected"?p.jsxs(p.Fragment,{children:[p.jsx(C2,{className:"w-4 h-4"}),"Connected"]}):p.jsxs(p.Fragment,{children:[p.jsx(R2,{className:"w-4 h-4"}),"Disconnected"]})})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"API Key"}),p.jsx("input",{type:"text",value:e,onChange:T=>r(T.target.value),placeholder:"Enter your Google API Key",className:"w-full p-2 border rounded-lg"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID"}),p.jsx("input",{type:"text",value:n,onChange:T=>i(T.target.value),placeholder:"Enter your Google OAuth Client ID",className:"w-full p-2 border rounded-lg"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Spreadsheet ID"}),p.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"Enter your Google Sheets ID",className:"w-full p-2 border rounded-lg"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sheet"}),p.jsx("select",{value:a,onChange:T=>l(T.target.value),className:"w-full p-2 border rounded-lg",disabled:c.length===0,children:c.length===0?p.jsx("option",{value:"",children:"Save credentials first to load sheets"}):c.map(T=>p.jsx("option",{value:T.gid,children:T.title},T.gid))})]}),h&&p.jsx("div",{className:"text-red-600 text-sm",children:h}),p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[p.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Setup Instructions:"}),p.jsxs("ol",{className:"text-sm text-blue-600 space-y-1 list-decimal pl-4",children:[p.jsxs("li",{children:["Go to ",p.jsx("a",{href:"https://console.cloud.google.com",target:"_blank",rel:"noopener",className:"underline",children:"Google Cloud Console"})," and create a project"]}),p.jsx("li",{children:"Enable the Google Sheets API in your project"}),p.jsxs("li",{children:["Create credentials:",p.jsxs("ul",{className:"ml-4 mt-1 space-y-1 list-disc",children:[p.jsx("li",{children:"Create an API Key (restrict to Sheets API only)"}),p.jsxs("li",{children:["Create an OAuth 2.0 Client ID:",p.jsxs("ul",{className:"ml-4 mt-1 space-y-1",children:[p.jsx("li",{children:"Application type: Web application"}),p.jsx("li",{children:"Add your domain to Authorized JavaScript origins"}),p.jsx("li",{children:"Add your domain to Authorized redirect URIs"})]})]})]})]}),p.jsx("li",{children:"Copy your Spreadsheet ID from the sheet's URL (the long string between /d/ and /edit)"})]}),p.jsxs("div",{className:"mt-4 text-sm text-blue-700",children:[p.jsx("strong",{children:"Note:"})," Make sure to configure the OAuth consent screen and add test users if in testing mode."]})]}),p.jsxs("div",{className:"flex gap-4",children:[p.jsxs("button",{onClick:S,disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[p.jsx(_2,{className:"w-4 h-4"}),f?"Setting up...":"Save Credentials"]}),p.jsx("button",{onClick:E,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Reset"})]})]})]})}const WQe=[{value:"all",label:"All Time"},{value:"custom",label:"Custom Range"},{value:"last30",label:"Last 30 Days"},{value:"last90",label:"Last 90 Days"},{value:"thisMonth",label:"This Month"},{value:"lastMonth",label:"Last Month"}];function zQe({onSave:t}){const[e,r]=oe.useState(()=>{const s=localStorage.getItem("date_range_settings");return s?JSON.parse(s):{startDate:"",endDate:"",filterType:"all"}}),n=s=>{const o=new Date;let a="",l="";switch(s){case"last30":a=new Date(o.setDate(o.getDate()-30)).toISOString().split("T")[0],l=new Date().toISOString().split("T")[0];break;case"last90":a=new Date(o.setDate(o.getDate()-90)).toISOString().split("T")[0],l=new Date().toISOString().split("T")[0];break;case"thisMonth":a=new Date(o.getFullYear(),o.getMonth(),1).toISOString().split("T")[0],l=new Date().toISOString().split("T")[0];break;case"lastMonth":a=new Date(o.getFullYear(),o.getMonth()-1,1).toISOString().split("T")[0],l=new Date(o.getFullYear(),o.getMonth(),0).toISOString().split("T")[0];break}r(c=>({...c,filterType:s,startDate:s==="all"?"":a,endDate:s==="all"?"":l}))},i=()=>{localStorage.setItem("date_range_settings",JSON.stringify(e)),t(e)};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[p.jsx(lx,{className:"w-5 h-5 text-blue-600"}),p.jsx("h2",{className:"text-lg font-semibold",children:"Date Range Settings"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter Type"}),p.jsx("select",{value:e.filterType,onChange:s=>n(s.target.value),className:"w-full p-2 border rounded-lg",children:WQe.map(s=>p.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.filterType==="custom"&&p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),p.jsx("input",{type:"date",value:e.startDate,onChange:s=>r(o=>({...o,startDate:s.target.value})),className:"w-full p-2 border rounded-lg"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),p.jsx("input",{type:"date",value:e.endDate,onChange:s=>r(o=>({...o,endDate:s.target.value})),className:"w-full p-2 border rounded-lg",min:e.startDate})]})]}),p.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[p.jsx(P0,{className:"w-4 h-4"}),"Save Date Range"]})]})]})}function GQe({onSave:t}){const[e,r]=G.useState(()=>localStorage.getItem("gstin_verification_enabled")!=="false");G.useEffect(()=>{localStorage.setItem("gstin_verification_enabled",JSON.stringify(e))},[e]);const n=()=>{const i=!e;r(i),t(i)};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(wte,{className:"h-5 w-5 text-blue-500"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"GSTIN Verification"})]}),p.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[p.jsx("p",{children:"Control whether GSTIN numbers should be automatically verified against the GST database."}),p.jsxs("div",{className:"mt-1 flex items-start gap-1",children:[p.jsx(T2,{className:"h-4 w-4 text-gray-400 mt-0.5"}),p.jsx("p",{className:"text-xs text-gray-500",children:"When enabled, GSTIN numbers will be verified and business names will be automatically filled with the legal name from the GST database. Disabling this feature will skip verification checks and allow manual entry without validation."})]}),p.jsxs("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-md flex items-start gap-2",children:[p.jsx(ax,{className:"h-4 w-4 text-amber-500 mt-0.5 flex-shrink-0"}),p.jsxs("p",{className:"text-xs text-amber-800",children:[p.jsx("strong",{children:"Important:"})," GSTIN verification requires direct network access to cleartax.in. Due to CORS restrictions, verification may fail in some environments. If verification fails, you will need to use our manual lookup tool or configure a CORS proxy. No simulated data is used for financial verification."]})]})]}),p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"font-medium text-gray-900",children:e?"Verification Enabled":"Verification Disabled"}),p.jsx("button",{type:"button",className:`${e?"bg-blue-600":"bg-gray-200"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2`,role:"switch","aria-checked":e,onClick:n,children:p.jsx("span",{"aria-hidden":"true",className:`${e?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})})]})]})}function YQe({onSave:t}){const[e,r]=G.useState(()=>localStorage.getItem("gstin_api_url")||""||"https://cleartax.in/f/compliance-report/"),[n,i]=G.useState(()=>localStorage.getItem("ngrok_tunnel_url")||""),[s,o]=G.useState("idle"),[a,l]=G.useState("");G.useEffect(()=>{if(s==="success"){const u=setTimeout(()=>{o("idle")},3e3);return()=>clearTimeout(u)}},[s]);const c=()=>{try{o("saving"),l("");let u=e.trim();u&&!u.startsWith("http")&&(u=`https://${u}`);let h=n.trim();h&&!h.startsWith("http")&&(h=`https://${h}`),localStorage.setItem("gstin_api_url",u),localStorage.setItem("ngrok_tunnel_url",h),r(u),i(h),t&&t({apiUrl:u,ngrokTunnel:h}),o("success"),window.dispatchEvent(new CustomEvent("gstin_api_settings_updated",{detail:{apiUrl:u,ngrokTunnel:h}}))}catch(u){console.error("Error saving GSTIN API settings:",u),o("error"),l(u.message||"Failed to save settings")}};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(vte,{className:"h-5 w-5 text-indigo-500"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"GSTIN API Configuration"})]}),p.jsxs("div",{className:"mt-4 space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"api-url",className:"block text-sm font-medium text-gray-700 mb-1",children:"GSTIN API Endpoint"}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(ute,{className:"h-4 w-4 text-gray-400 mr-2"}),p.jsx("input",{id:"api-url",type:"url",value:e,onChange:u=>r(u.target.value),placeholder:"https://cleartax.in/f/compliance-report/",className:"flex-1 px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"})]}),p.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the URL of your GSTIN verification API endpoint. E.g. https://cleartax.in/f/compliance-report/"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"ngrok-url",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngrok Tunnel URL (Optional)"}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(_2,{className:"h-4 w-4 text-gray-400 mr-2"}),p.jsx("input",{id:"ngrok-url",type:"url",value:n,onChange:u=>i(u.target.value),placeholder:"https://xxx-xxx-xxx.ngrok.io",className:"flex-1 px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"})]}),p.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"If you're using an ngrok tunnel for the API, enter the public URL here."})]}),p.jsx("div",{className:"flex justify-end",children:p.jsx("button",{onClick:c,disabled:s==="saving",className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50",children:s==="saving"?p.jsx(p.Fragment,{children:"Loading..."}):s==="success"?p.jsxs(p.Fragment,{children:[p.jsx(Fl,{className:"h-4 w-4"}),"Saved"]}):p.jsxs(p.Fragment,{children:[p.jsx(P0,{className:"h-4 w-4"}),"Save Settings"]})})}),s==="error"&&p.jsx("div",{className:"p-3 bg-red-50 text-red-700 rounded-md text-sm",children:a||"An error occurred while saving settings."}),p.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"About GSTIN API Configuration"}),p.jsx("p",{className:"text-xs text-gray-600",children:"Setting up a GSTIN API endpoint helps bypass CORS restrictions when verifying GSTIN numbers. The recommended endpoint is ClearTax: https://cleartax.in/f/compliance-report/"})]})]})]})}function KQe(){const[t,e]=G.useState([]),[r,n]=G.useState(!0),[i,s]=G.useState(""),[o,a]=G.useState({}),[l,c]=G.useState({}),[u,h]=G.useState(0),[d,f]=G.useState(!1),[m,g]=G.useState(!1),v=()=>{n(!0);try{const E=localStorage.getItem("gstin_verification_cache")||"{}",T=JSON.parse(E);a(T),c(T);const I=Object.values(T).some(L=>L.gstinStatus==="Simulated");g(I);const k=new Blob([E]).size;h(k);const M=Date.now(),D=[];Object.keys(T).forEach(L=>{const U=T[L],J=M-U.timestamp;let X="";J<60*60*1e3?X=`${Math.round(J/6e4)} min`:J<24*60*60*1e3?X=`${Math.round(J/36e5)} hours`:X=`${Math.round(J/864e5)} days`,D.push({gstin:L,legalName:U.legalName,tradeName:U.tradeName,address:U.address,gstinStatus:U.gstinStatus,timestamp:U.timestamp,age:X})}),D.sort((L,U)=>U.timestamp-L.timestamp),e(D),s(D.length===0?"No cached GSTIN data found.":"")}catch(E){console.error("Error loading GSTIN cache:",E),s("Error loading GSTIN cache")}finally{n(!1)}};G.useEffect(()=>{v();const E=()=>{console.log("[GSTIN Cache] Cache updated, reloading..."),v()};return window.addEventListener("gstin_cache_updated",E),window.addEventListener("gstin_verification_completed",E),()=>{window.removeEventListener("gstin_cache_updated",E),window.removeEventListener("gstin_verification_completed",E)}},[]);const w=()=>{if(confirm("Are you sure you want to clear all cached GSTIN data? This cannot be undone.")){f(!0);try{localStorage.removeItem("gstin_verification_cache"),a({}),c({}),h(0),g(!1),e([]),s("Cache cleared successfully"),window.dispatchEvent(new CustomEvent("gstin_cache_cleared"))}catch(E){console.error("Error clearing cache:",E),s("Error clearing cache")}finally{f(!1)}}},b=()=>{if(confirm("Are you sure you want to clear all simulated GSTIN data? This will remove all mock results from the cache.")){f(!0);try{const E=localStorage.getItem("gstin_verification_cache")||"{}",T=JSON.parse(E),I={};let k=!1;if(Object.entries(T).forEach(([M,D])=>{D.gstinStatus!=="Simulated"?I[M]=D:k=!0}),k){localStorage.setItem("gstin_verification_cache",JSON.stringify(I)),a(I),c(I);const M=JSON.stringify(I),D=new Blob([M]).size;h(D),g(!1),e(Object.values(I)),s("Simulated data cleared successfully"),window.dispatchEvent(new CustomEvent("gstin_cache_updated"))}}catch(E){console.error("Error clearing simulated data:",E),s("Error clearing simulated data")}finally{f(!1)}}},x=()=>{const E={};Object.entries(o).forEach(([T,I])=>{I.gstinStatus==="Simulated"&&(E[T]=I)}),c(E)},C=()=>{c(o)},S=E=>{try{const T=localStorage.getItem("gstin_verification_cache")||"{}",I=JSON.parse(T);I[E]&&(delete I[E],localStorage.setItem("gstin_verification_cache",JSON.stringify(I)),e(k=>k.filter(M=>M.gstin!==E)),s(`Removed GSTIN: ${E}`),window.dispatchEvent(new CustomEvent("gstin_cache_updated")))}catch(T){console.error("Error removing GSTIN from cache:",T),s("Error removing GSTIN from cache")}};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(UL,{className:"h-5 w-5 text-orange-500"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"GSTIN Verification Cache"})]}),p.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[p.jsx("p",{children:"GSTIN verification results are cached to reduce API calls and improve performance. Cache will persist until explicitly cleared."}),p.jsxs("div",{className:"mt-1 flex items-start gap-1",children:[p.jsx(T2,{className:"h-4 w-4 text-gray-400 mt-0.5"}),p.jsx("p",{className:"text-xs text-gray-500",children:"The cached data includes legal business names and addresses for each verified GSTIN. With the ClearTax API endpoint configured, verification will work correctly and the results will be cached here."})]})]}),p.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md flex items-start gap-2",children:[p.jsx(cU,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),p.jsxs("div",{className:"text-xs text-blue-800",children:[p.jsx("p",{className:"font-medium",children:"Verification Cache"}),p.jsx("p",{children:"GSTIN data remains cached for all bill generation tasks until explicitly cleared. This improves performance and reduces API calls to external services."})]})]}),p.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[p.jsxs("p",{children:["Current cache size: ",(u/1024).toFixed(2)," KB"]}),p.jsxs("p",{children:["Number of cached GST numbers: ",Object.keys(o).length]})]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsxs("button",{onClick:w,disabled:d||Object.keys(o).length===0,className:"flex items-center gap-2 px-3 py-1.5 border border-red-600 text-red-600 rounded-md shadow-sm text-sm bg-white hover:bg-red-50 disabled:opacity-50",children:[p.jsx(vw,{className:"w-4 h-4"}),"Clear All Cache"]}),m&&p.jsxs("button",{onClick:b,disabled:d,className:"flex items-center gap-2 px-3 py-1.5 border border-orange-600 text-orange-600 rounded-md shadow-sm text-sm bg-white hover:bg-orange-50 disabled:opacity-50",children:[p.jsx(vw,{className:"w-4 h-4"}),"Clear Simulated Data"]}),p.jsxs("button",{onClick:v,disabled:d,className:"flex items-center gap-2 px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm bg-white hover:bg-gray-50 disabled:opacity-50",children:[p.jsx(Gd,{className:"w-4 h-4"}),"Refresh"]}),m&&p.jsxs("div",{className:"flex gap-2 ml-auto",children:[p.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm bg-white hover:bg-gray-50",children:[p.jsx(HR,{className:"w-4 h-4"}),"Show All"]}),p.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-3 py-1.5 border border-orange-300 text-orange-700 rounded-md shadow-sm text-sm bg-orange-50 hover:bg-orange-100",children:[p.jsx(HR,{className:"w-4 h-4"}),"Show Only Simulated"]})]})]}),i&&p.jsx("div",{className:"mb-4 p-2 text-sm bg-blue-50 text-blue-700 rounded",children:i}),r?p.jsxs("div",{className:"text-center py-4",children:[p.jsx(Gd,{className:"w-5 h-5 animate-spin mx-auto text-gray-400 mb-2"}),p.jsx("p",{className:"text-sm text-gray-500",children:"Loading cache..."})]}):t.length>0?p.jsx("div",{className:"overflow-x-auto shadow-sm border border-gray-200 rounded-lg",children:p.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[p.jsx("thead",{className:"bg-gray-50",children:p.jsxs("tr",{children:[p.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"GSTIN"}),p.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Business Name"}),p.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),p.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age"}),p.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),p.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(E=>p.jsxs("tr",{className:"hover:bg-gray-50",children:[p.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-mono",children:E.gstin}),p.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:E.tradeName?E.tradeName!==E.legalName?`${E.tradeName} (${E.legalName})`:E.tradeName:E.legalName}),p.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:p.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E.gstinStatus==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:E.gstinStatus||"Unknown"})}),p.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:E.age}),p.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-sm font-medium",children:p.jsx("button",{onClick:()=>S(E.gstin),className:"text-red-600 hover:text-red-900",children:p.jsx(vw,{className:"w-4 h-4"})})})]},E.gstin))})]})}):p.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:[p.jsx(UL,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),p.jsx("p",{className:"text-gray-500",children:"No cached GSTIN data found"}),p.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Verify some GSTINs to build the cache"})]})]})}function XQe({onComplete:t}){const[e,r]=G.useState([]),[n,i]=G.useState([]),[s,o]=G.useState(!1),[a,l]=G.useState(0),[c,u]=G.useState(""),[h,d]=G.useState(null),[f,m]=G.useState(!1),[g,v]=G.useState(!1),w=G.useRef(null),b=M=>{u(M.target.value)},x=()=>{const M=c.split(/[\n,;]+/).map(J=>J.trim()).filter(J=>J.length>0),D=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i,L=M.filter(J=>D.test(J));if(L.length===0)return d("No valid GSTINs found in input"),[];const U=[...new Set(L)];return r(U),d(null),U},C=async()=>{const M=x();if(M.length===0)return;o(!0),l(0),i(M.map(L=>({gstin:L,status:"pending",legalName:null,tradeName:null,address:null,gstinStatus:null,message:"Waiting for processing",timestamp:Date.now()}))),w.current=new AbortController;const D=w.current.signal;try{for(let L=0;L<M.length&&!D.aborted;L++){const U=M[L];l(Math.round(L/M.length*100)),i(J=>J.map(X=>X.gstin===U?{...X,status:"pending",message:"Processing..."}:X));try{const J=await mO(U);i(X=>X.map(ie=>ie.gstin===U?{...ie,...J,status:J.status,timestamp:Date.now()}:ie))}catch(J){i(X=>X.map(ie=>ie.gstin===U?{...ie,status:"error",message:J.message||"Verification failed",timestamp:Date.now()}:ie))}l(Math.round((L+1)/M.length*100)),L<M.length-1&&!D.aborted&&await new Promise(J=>setTimeout(J,5e3))}D.aborted||(l(100),t&&t(n))}catch(L){d(L.message||"Failed to process batch")}finally{o(!1),w.current=null}},S=()=>{w.current&&(w.current.abort(),o(!1),d("Processing cancelled by user"))},E=()=>{const M=`GSTIN,Trade Name,State Code,PIN Code,Status,Message,Timestamp
`,D=n.map(ie=>{let se="",P="";if(ie.address){const y=ie.address.split(",").map(_=>_.trim());y.length>=2&&(se=y[0],P=y[1])}return[ie.gstin,ie.tradeName||"",se,P,ie.status,ie.message.replace(/,/g," "),new Date(ie.timestamp).toISOString()].join(",")}).join(`
`),L=M+D,U=new Blob([L],{type:"text/csv;charset=utf-8;"}),J=URL.createObjectURL(U),X=document.createElement("a");X.href=J,X.setAttribute("download",`gstin_verification_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(X),X.click(),document.body.removeChild(X)},T=()=>{const M=qf();return!!M&&!!M.spreadsheetId},I=async()=>{if(!T()){d("Google Sheets not connected. Please configure Google Sheets in Settings first.");return}try{v(!0),m(!0)}catch(M){d(M.message||"Failed to connect to Google Sheets")}finally{v(!1)}},k=async M=>{m(!1);try{o(!0),v(!0),d(null);const D=await d9(M);if(!D||D.length<=1){d("No data found in the selected sheet or all entries already have invoices");return}const U=D[0].findIndex(se=>se.includes("ID Proof Details")||se.includes("GSTIN"));if(U===-1){d('No "ID Proof Details" or "GSTIN" column found in the sheet');return}const J=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i,X=[];for(let se=1;se<D.length;se++){const P=D[se];if(P&&P[U]){const y=P[U].trim();J.test(y)&&X.push(y)}}if(X.length===0){d("No valid GSTIN numbers found in the sheet");return}const ie=[...new Set(X)];if(u(ie.join(`
`)),r(ie),i(ie.map(se=>({gstin:se,status:"pending",legalName:null,tradeName:null,address:null,gstinStatus:null,message:"Waiting for processing",timestamp:Date.now()}))),ie.length>0){const se=new AbortController;w.current=se;const P=se.signal;for(let y=0;y<ie.length&&!P.aborted;y++){const _=ie[y];l(Math.round(y/ie.length*100)),i(R=>R.map(A=>A.gstin===_?{...A,status:"pending",message:"Processing..."}:A));try{const R=await mO(_);i(A=>A.map(O=>O.gstin===_?{...O,...R,status:R.status,timestamp:Date.now()}:O))}catch(R){i(A=>A.map(O=>O.gstin===_?{...O,status:"error",message:R.message||"Verification failed",timestamp:Date.now()}:O))}l(Math.round((y+1)/ie.length*100)),y<ie.length-1&&!P.aborted&&await new Promise(R=>setTimeout(R,5e3))}P.aborted||(l(100),t&&t(n))}}catch(D){d(D.message||"Failed to process sheet data")}finally{o(!1),v(!1),w.current=null}};return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col md:flex-row items-start gap-4",children:[p.jsxs("div",{className:"w-full md:w-2/3",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter GSTINs (one per line, or comma/semicolon separated)"}),p.jsx("textarea",{className:"w-full h-60 p-2 border border-gray-300 rounded-md font-mono text-sm",placeholder:`29BXLPK1428B1ZM
07NDBPS0625E2ZJ
29BLOPP5558G1ZD`,value:c,onChange:b,disabled:s}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Each GSTIN will be verified with a 5-second delay between requests to avoid rate limiting."}),p.jsxs("div",{className:"flex gap-3 mt-4",children:[p.jsx("button",{onClick:C,disabled:s||c.trim()==="",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none disabled:opacity-50",children:s?p.jsxs(p.Fragment,{children:[p.jsx(zL,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):p.jsxs(p.Fragment,{children:[p.jsx(mte,{className:"w-4 h-4"}),"Verify GSTINs"]})}),p.jsx("button",{onClick:I,disabled:s||g,className:"flex items-center gap-2 px-4 py-2 border border-green-600 text-green-600 bg-white rounded-md hover:bg-green-50 focus:outline-none disabled:opacity-50",children:g?p.jsxs(p.Fragment,{children:[p.jsx(zL,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Za,{className:"w-4 h-4"}),"Import & Verify from Sheet"]})}),s&&p.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 border border-red-600 text-red-600 rounded-md hover:bg-red-50 focus:outline-none",children:[p.jsx(ax,{className:"w-4 h-4"}),"Cancel"]})]})]}),p.jsx("div",{className:"w-full md:w-1/3 space-y-4",children:p.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Batch Summary"}),p.jsxs("div",{className:"space-y-2 text-sm",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Total GSTINs:"}),p.jsx("span",{className:"font-medium",children:e.length})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Pending:"}),p.jsx("span",{className:"font-medium",children:n.filter(M=>M.status==="pending").length})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Successful:"}),p.jsx("span",{className:"font-medium text-green-600",children:n.filter(M=>M.status==="success").length})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Failed:"}),p.jsx("span",{className:"font-medium text-red-600",children:n.filter(M=>M.status==="error").length})]})]}),s&&p.jsxs("div",{className:"mt-4",children:[p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:p.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${a}%`}})}),p.jsxs("div",{className:"flex justify-between mt-1 text-xs text-gray-500",children:[p.jsxs("span",{children:["Progress: ",a,"%"]}),p.jsxs("span",{className:"flex items-center",children:[p.jsx(cU,{className:"w-3 h-3 mr-1"}),`${Math.ceil((e.length-n.filter(M=>M.status!=="pending").length)*5/60)} mins remaining`]})]})]}),n.length>0&&!s&&p.jsxs("button",{onClick:E,className:"mt-4 w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none",children:[p.jsx(uU,{className:"w-4 h-4"}),"Export Results as CSV"]})]})})]}),h&&p.jsxs("div",{className:"p-3 bg-red-50 text-red-700 rounded-md text-sm flex items-start gap-2",children:[p.jsx(ax,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),p.jsx("div",{children:h})]}),n.length>0&&p.jsxs("div",{className:"mt-6",children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Verification Results"}),p.jsx("div",{className:"overflow-x-auto mt-2",children:p.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border rounded-lg",children:[p.jsx("thead",{className:"bg-gray-50",children:p.jsxs("tr",{children:[p.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"GSTIN"}),p.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Legal Name"}),p.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Trade Name"}),p.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Address"}),p.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),p.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Message"})]})}),p.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(M=>p.jsxs("tr",{className:"hover:bg-gray-50",children:[p.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-800",children:M.gstin}),p.jsx("td",{className:"px-4 py-2 whitespace-normal break-words text-sm text-gray-600 max-w-[200px]",children:M.legalName||"-"}),p.jsx("td",{className:"px-4 py-2 whitespace-normal break-words text-sm text-gray-600 max-w-[200px]",children:M.tradeName||"-"}),p.jsx("td",{className:"px-4 py-2 whitespace-normal break-words text-sm text-gray-600 max-w-[200px]",children:M.address||"-"}),p.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:M.status==="pending"?p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Pending"}):M.status==="success"?p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:M.gstinStatus||"Success"}):p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Failed"})}),p.jsx("td",{className:"px-4 py-2 whitespace-normal break-words text-sm text-gray-600 max-w-[200px]",children:M.message})]},M.gstin))})]})})]}),f&&p.jsx(xJ,{isOpen:f,onClose:()=>m(!1),onSelect:k})]})}function qQe(){const[t,e]=G.useState([]),[r,n]=G.useState(()=>localStorage.getItem("debug_gstin_api")==="true"),[i,s]=G.useState(!1);G.useEffect(()=>{const c=window.fetch;return r?window.fetch=async function(u,h){let d;if(typeof u=="string")d=u;else if(u instanceof URL)d=u.href;else if(u instanceof Request)d=u.url;else return c(u,h);if(d.includes("gstin")||d.includes("cleartax")||d.includes("compliance-report")){const f=(h==null?void 0:h.method)||"GET",m=(h==null?void 0:h.headers)||{};let g=`curl -X ${f} "${d}"`;if(Object.entries(m).forEach(([w,b])=>{g+=` -H "${w}: ${b}"`}),h!=null&&h.body)try{const w=typeof h.body=="string"?h.body:JSON.stringify(h.body);g+=` -d '${w}'`}catch(w){console.error("Error stringifying request body:",w)}const v={timestamp:new Date().toISOString(),type:"request",url:d,method:f,headers:m,curlCommand:g};e(w=>[...w,v]),console.log("[GSTIN Debug] Request:",v);try{const w=await c(u,h),b=w.clone();let x;try{x=await b.json()}catch{x=await b.text()}const C={timestamp:new Date().toISOString(),type:"response",status:w.status,data:x};return e(S=>[...S,C]),console.log("[GSTIN Debug] Response:",C),w}catch(w){const b={timestamp:new Date().toISOString(),type:"error",data:w};throw e(x=>[...x,b]),console.error("[GSTIN Debug] Error:",w),w}}return c(u,h)}:window.fetch=c,()=>{window.fetch=c}},[r]);const o=()=>{const c=!r;n(c),localStorage.setItem("debug_gstin_api",c.toString())},a=()=>{e([])},l=c=>{navigator.clipboard.writeText(c)};return p.jsxs("div",{className:"border rounded-lg shadow-sm bg-white",children:[p.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(S2,{className:"h-5 w-5 text-orange-500"}),p.jsx("h3",{className:"font-medium text-gray-900",children:"GSTIN API Debugger"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:a,className:"p-1 text-gray-500 hover:text-gray-700",title:"Clear logs",children:p.jsx(Gd,{className:"h-4 w-4"})}),p.jsx("button",{onClick:o,className:`px-3 py-1 rounded-md text-sm ${r?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:r?"Disable Debug":"Enable Debug"}),p.jsx("button",{onClick:()=>s(!i),className:"p-1 text-gray-500 hover:text-gray-700",children:i?"":""})]})]}),i&&p.jsxs("div",{className:"p-4",children:[!r&&p.jsx("div",{className:"bg-gray-50 p-3 rounded-md text-sm text-gray-600 mb-4",children:"Debug mode is currently disabled. Enable it to see GSTIN API requests and responses."}),t.length===0?p.jsx("div",{className:"bg-gray-50 p-3 rounded-md text-sm text-gray-600",children:"No GSTIN API activity recorded yet. Try verifying a GSTIN number."}):p.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto font-mono text-sm",children:t.map((c,u)=>p.jsxs("div",{className:`p-3 rounded-md ${c.type==="request"?"bg-gray-50 border border-gray-200":c.type==="response"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[p.jsxs("div",{className:"flex justify-between items-start mb-2",children:[p.jsx("span",{className:"font-semibold",children:c.type==="request"?"Request":c.type==="response"?`Response (${c.status})`:"Error"}),p.jsx("span",{className:"text-xs text-gray-500",children:new Date(c.timestamp).toLocaleTimeString()})]}),c.url&&p.jsxs("div",{className:"mb-2 break-all",children:[p.jsx("span",{className:"text-gray-500 mr-2",children:"URL:"}),c.url]}),c.method&&p.jsxs("div",{className:"mb-2",children:[p.jsx("span",{className:"text-gray-500 mr-2",children:"Method:"}),c.method]}),c.curlCommand&&p.jsxs("div",{className:"mb-2 relative",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsx("span",{className:"text-gray-500",children:"cURL Command:"}),p.jsx("button",{onClick:()=>l(c.curlCommand),className:"text-blue-500 hover:text-blue-700",title:"Copy to clipboard",children:p.jsx(ate,{className:"h-4 w-4"})})]}),p.jsx("pre",{className:"bg-gray-800 text-gray-100 p-2 rounded-md text-xs overflow-x-auto",children:c.curlCommand})]}),c.data&&p.jsxs("div",{children:[p.jsx("div",{className:"text-gray-500 mb-1",children:"Data:"}),p.jsx("pre",{className:"bg-gray-800 text-gray-100 p-2 rounded-md text-xs overflow-x-auto",children:typeof c.data=="string"?c.data:JSON.stringify(c.data,null,2)})]})]},u))})]})]})}function JQe({onDataReceived:t}){const[e,r]=G.useState(""),[n,i]=G.useState(""),[s,o]=G.useState(!1),[a,l]=G.useState(""),c=()=>{if(!e){alert("Please enter a GSTIN number");return}if(!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i.test(e)){alert("Invalid GSTIN format. Please enter a valid GSTIN.");return}const d=`https://cleartax.in/f/compliance-report/${e}`;window.open(d,"_blank")},u=()=>{try{l("");const d=JSON.parse(n);l(""),t&&t(d)}catch{l("Invalid JSON format. Please copy the exact response from ClearTax.")}},h=()=>{if(!e){alert("Please enter a GSTIN number first");return}const d=`https://cleartax.in/f/compliance-report/${e}`;navigator.clipboard.writeText(d),o(!0),setTimeout(()=>o(!1),2e3)};return p.jsxs("div",{className:"border rounded-lg p-4 bg-white shadow-sm space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[p.jsx(fU,{className:"w-5 h-5 text-blue-600"}),"GSTIN Manual Lookup"]}),p.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Recommended for Financial Accuracy"})]}),p.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md flex items-start gap-2",children:[p.jsx(ax,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),p.jsxs("div",{className:"text-sm text-blue-800",children:[p.jsx("p",{className:"font-medium mb-1",children:"Financial Data Verification"}),p.jsx("p",{className:"text-xs",children:"To ensure financial data accuracy, direct verification with ClearTax is recommended. For precise and reliable GSTIN verification:"}),p.jsxs("ol",{className:"text-xs mt-2 list-decimal pl-4 space-y-1",children:[p.jsx("li",{children:"Enter the GSTIN number below"}),p.jsx("li",{children:'Click the "Open" button to access ClearTax directly'}),p.jsx("li",{children:"Copy the JSON data from the ClearTax page"}),p.jsx("li",{children:"Paste it below to save the official verification result"})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter GSTIN"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"text",value:e,onChange:d=>r(d.target.value.toUpperCase()),placeholder:"29AAACB2894G1ZJ",className:"flex-1 p-2 border border-gray-300 rounded-md",maxLength:15}),p.jsxs("button",{onClick:c,className:"flex items-center gap-1 px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[p.jsx(E2,{className:"w-4 h-4"}),"Open"]}),p.jsx("button",{onClick:h,className:"flex items-center gap-1 px-3 py-2 bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200",title:"Copy ClearTax URL to clipboard",children:s?p.jsx(Fl,{className:"w-4 h-4 text-green-600"}):p.jsx($R,{className:"w-4 h-4"})})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paste JSON Response from ClearTax"}),p.jsx("textarea",{value:n,onChange:d=>i(d.target.value),placeholder:'{"taxpayerInfo": {"lgnm": "COMPANY NAME", ...}}',className:"w-full p-2 border border-gray-300 rounded-md h-24 font-mono text-sm"}),a&&p.jsx("p",{className:"mt-1 text-sm text-red-600",children:a})]}),p.jsx("button",{onClick:u,disabled:!n,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Process Official GSTIN Data"})]})]})}function ZQe(){const t=()=>{},e=a=>{window.dispatchEvent(new CustomEvent("dateRangeUpdated",{detail:a}))},r=a=>{window.dispatchEvent(new CustomEvent("gstinVerificationUpdated",{detail:{enabled:a}})),console.log(`[Settings] GSTIN verification ${a?"enabled":"disabled"}`)},n=a=>{console.log("[Settings] GSTIN API configuration updated:",a)},i=a=>{console.log(`[Settings] Batch processing completed with ${a.length} results`)},s=a=>{console.log(`[Settings] Authentication status changed: ${a?"authenticated":"not authenticated"}`)},o=a=>{var l;if(console.log("[Settings] Manual GSTIN data received:",a),a&&a.taxpayerInfo)try{const c=a.taxpayerInfo.gstin;if(!c){alert("GSTIN not found in the provided data");return}const u={legalName:a.taxpayerInfo.lgnm||null,tradeName:a.taxpayerInfo.tradeNam||null,address:(l=a.taxpayerInfo.pradr)!=null&&l.addr?`${a.taxpayerInfo.pradr.addr.st||""}, ${a.taxpayerInfo.pradr.addr.loc||""}, ${a.taxpayerInfo.pradr.addr.stcd||""}, ${a.taxpayerInfo.pradr.addr.pncd||""}`.replace(/, ,/g,","):null,gstinStatus:a.taxpayerInfo.sts||"Unknown",timestamp:Date.now()},h=localStorage.getItem("gstin_verification_cache")||"{}",d=JSON.parse(h);d[c]=u,localStorage.setItem("gstin_verification_cache",JSON.stringify(d)),alert(`GSTIN data for ${c} saved to cache successfully!`),window.dispatchEvent(new CustomEvent("gstin_cache_updated"))}catch(c){console.error("Error saving GSTIN data to cache:",c),alert("Error saving data to cache")}else alert("Invalid data format. Expected ClearTax format with taxpayerInfo.")};return p.jsxs("div",{className:"container mx-auto py-8",children:[p.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Settings"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[p.jsxs("div",{className:"md:col-span-2 space-y-6",children:[p.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-md mb-4",children:[p.jsx("h2",{className:"text-lg font-semibold text-blue-800 mb-2",children:"GSTIN Verification Settings"}),p.jsx("p",{className:"text-sm text-blue-700 mb-4",children:"Financial data verification is critical. Direct verification with official sources is recommended."}),p.jsx(JQe,{onDataReceived:o})]}),p.jsx(YQe,{onSave:n}),p.jsx(GQe,{onSave:r}),p.jsx(qQe,{}),p.jsx(KQe,{}),p.jsx(XQe,{onComplete:i})]}),p.jsxs("div",{className:"space-y-6",children:[p.jsx(UQe,{onCredentialsUpdate:t}),p.jsx(zQe,{onSave:e}),p.jsx(VQe,{onAuthChange:s})]})]})]})}function QQe(){const[t,e]=G.useState([]),[r,n]=G.useState(""),[i,s]=G.useState([]),[o,a]=G.useState(!1),[l,c]=G.useState(""),[u,h]=G.useState(!1),[d,f]=G.useState(!1),[m,g]=G.useState(""),[v,w]=G.useState(!1),[b,x]=G.useState(null),[C,S]=G.useState(!1),[E,T]=G.useState(null);G.useEffect(()=>{I()},[]);const I=()=>{console.log("Loading invoices from local storage");const P=[],y=Cb(),_=new Set;y.length===0?console.log("No invoice keys found in localStorage"):console.log(`Found ${y.length} invoice keys:`,y);for(let R=0;R<localStorage.length;R++){const A=localStorage.key(R);if(A&&A.startsWith("invoices_"))try{const O=JSON.parse(localStorage.getItem(A)||"[]"),N=A.replace("invoices_","");let F="Unknown";N.startsWith("customer_")&&(F=N.replace("customer_","").split(/[_-]/)[0].replace(/([A-Z])/g," $1").trim()),console.log(`Found ${O.length} invoices for customer ${F}`),O.forEach(j=>{if(console.log("Processing invoice:",j),j.id&&j.link){const z=FE(j.link),Q=z||j.id||j.invoiceNumber;if(_.has(Q)){console.log(`Skipping duplicate invoice: ${Q}`);return}_.add(Q);const W=be=>{if(!be)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(be))return be;if(be.includes("/")){const[Fe,He,V]=be.split("/").map(Number);if(!isNaN(Fe)&&!isNaN(He)&&!isNaN(V))return`${V}-${String(He).padStart(2,"0")}-${String(Fe).padStart(2,"0")}`}try{const Fe=new Date(be);if(!isNaN(Fe.getTime()))return Fe.toISOString().split("T")[0]}catch(Fe){console.error("Error parsing date:",Fe)}return""},ae=j.paymentDate&&j.paymentDate!=="",ye=j.apiSynced===!0,Re=ye?"completed":"pending",ue=W(j.paymentDate||""),ke={id:`${Q}_${N}`,customerId:N,customerName:j.customerName||F,date:j.date||new Date().toISOString(),amount:j.amount||0,invoiceId:z||j.id,invoiceNumber:j.invoiceNumber||"Unknown",link:j.link,status:Re,paymentDate:ue,paymentMethod:j.paymentMethod,paymentAmount:j.paymentAmount,paymentRef:j.paymentRef,apiSynced:ye};P.push(ke),console.log("Added bill record:",ke)}else console.warn("Skipping invalid invoice (missing id or link):",j)})}catch(O){console.error(`Error parsing invoices for key ${A}:`,O)}}P.sort((R,A)=>new Date(A.date).getTime()-new Date(R.date).getTime()),console.log(`Total bills loaded: ${P.length}`),e(P)},k=t.filter(P=>P.customerName.toLowerCase().includes(r.toLowerCase())||P.invoiceNumber.toLowerCase().includes(r.toLowerCase())),M=oe.useMemo(()=>d?k.reduce((P,y)=>{const _=y.customerId||`unknown-${y.customerName}`;return P[_]||(P[_]={customerName:y.customerName,bills:[],totalAmount:0}),P[_].bills.push(y),P[_].totalAmount+=y.amount,P},{}):null,[k,d]),D=()=>{s(u?[]:k.filter(P=>P.status!=="completed").map(P=>P.id)),h(!u)},L=P=>{const y=t.find(_=>_.id===P);(y==null?void 0:y.status)!=="completed"&&(console.log("Selecting bill with ID:",P),s(_=>_.includes(P)?(console.log("Removing bill from selection"),_.filter(R=>R!==P)):(console.log("Adding bill to selection:",[..._,P]),[..._,P])))},U=P=>{console.log("Opening payment modal for bill:",P),console.log("Bill ID:",P.id),console.log("Invoice ID:",P.invoiceId),s([P.id]),x(P),w(!0)},J=async P=>{var F;console.log("Selected bills for payment:",i),T(i[0]),a(!0),c(""),g("");const y=Cu();if(!y||!Eu(y)){c("Please generate a valid authentication token in Settings"),a(!1);return}const _=i[0],R=t.find(j=>j.id===_);if(console.log("Bill found for payment:",R),!R||!R.invoiceId){console.error("Invoice ID not found. Bill:",R),c("Invoice ID not found"),a(!1);return}let A="";try{const j=wg(),z=j.findIndex(Q=>R.invoiceId&&Q[16]===R.invoiceId||R.invoiceNumber&&Q[15]===R.invoiceNumber);if(z!==-1&&j[z][11]){const Q=j[z][11];if(console.log(`Found original payment date in spreadsheet: ${Q}`),/^\d{2}\/\d{2}\/\d{4}$/.test(Q)){const[W,ae,ye]=Q.split("/");A=`${ye}-${ae}-${W}`}else A=Q}}catch(j){console.error("Error getting original payment date:",j)}let O=A||P.paymentDate;if(console.log(`Payment date priority: Original=${A}, User input=${P.paymentDate}, Final=${O}`),O&&O.includes("/")){const[j,z,Q]=O.split("/").map(Number);!isNaN(j)&&!isNaN(z)&&!isNaN(Q)&&(O=`${Q}-${String(z).padStart(2,"0")}-${String(j).padStart(2,"0")}`)}O||(O=R.date?R.date.split("T")[0]:new Date().toISOString().split("T")[0],console.log(`No payment date found, using invoice date: ${O}`));const N={...P,paymentDate:O};try{const j=`https://api.refrens.com/businesses/vm-jewellers/invoices/${R.invoiceId}/payments`;console.log(`Making payment API call for invoice ${R.invoiceId}:`,j),console.log("Payment data:",JSON.stringify(N));const z=await fetch(j,{method:"POST",headers:{Authorization:y,"Content-Type":"application/json"},body:JSON.stringify(N)});if(!z.ok){const W=await z.json();throw new Error(((F=W.error)==null?void 0:F.message)||`API Error (${z.status})`)}const Q=await z.json();console.log("Payment API success:",Q),e(W=>W.map(ae=>ae.invoiceId===R.invoiceId?{...ae,status:"completed",paymentDate:O,paymentMethod:P.paymentMethod,paymentAmount:P.amount,paymentRef:P.refId,apiSynced:!0}:ae));for(let W=0;W<localStorage.length;W++){const ae=localStorage.key(W);if(ae&&ae.startsWith("invoices_"))try{const H=JSON.parse(localStorage.getItem(ae)||"[]").map(Re=>Re.id===R.invoiceId||FE(Re.link)===R.invoiceId?{...Re,isPaid:!0,paymentDate:O,paymentMethod:P.paymentMethod,paymentAmount:P.amount,paymentRef:P.refId,apiSynced:!0}:Re);localStorage.setItem(ae,JSON.stringify(H))}catch(ye){console.error(`Error updating invoice in ${ae}:`,ye)}}try{let W=wg();if(W.length>0){const ae=W.findIndex(ye=>R.invoiceId&&ye[16]===R.invoiceId||R.invoiceNumber&&ye[15]===R.invoiceNumber);if(ae!==-1){const[ye,H,Re]=O.split("-").map(String),ue=`${Re}/${H}/${ye}`;W[ae][11]=ue,W[ae][17]="true",Cte(W),console.log(`Updated spreadsheet row ${ae}, column 11 with payment date: ${ue}`)}else console.warn(`Could not find spreadsheet row for invoice ID ${R.invoiceId} or number ${R.invoiceNumber}`)}}catch(W){console.error("Error updating spreadsheet data:",W)}w(!1),g(`Payment of ${P.amount.toLocaleString()} successfully recorded for invoice ${R.invoiceNumber} and synced with API`)}catch(j){console.error("Payment error:",j),c(j.message)}finally{a(!1),T(null)}},X=async()=>{var A;const P=Cu();if(!P||!Eu(P)){c("Please generate a valid authentication token in Settings");return}const y=i.filter(O=>{const N=t.find(F=>F.id===O);return N&&N.status!=="completed"});if(y.length===0){c("No pending invoices selected. Please select at least one unpaid invoice.");return}a(!0),c(""),g(""),S(!0);const _={tds:0,transactionCharge:0,paymentMethod:"UPI",notes:"Bulk payment",refId:`bulk-${new Date().getTime()}`};console.log("Starting bulk payment processing for",y.length,"invoices");const R=y.map(async O=>{var j;const N=t.find(z=>z.id===O);if(!N)return console.error("Bill not found:",O),null;const F=N.invoiceId;if(!F)return console.error("Invoice ID is missing, cannot process payment"),{billId:O,invoiceId:null,customerId:N.customerId,success:!1,error:"Invoice ID not found"};T(O);try{let z=N.paymentDate;try{const H=wg(),Re=H.findIndex(ue=>F&&ue[16]===F||N.invoiceNumber&&ue[15]===N.invoiceNumber);if(Re!==-1&&H[Re][11]){const ue=H[Re][11];if(/^\d{2}\/\d{2}\/\d{4}$/.test(ue)){const[Pe,ke,be]=ue.split("/");z=`${be}-${ke}-${Pe}`}else z=ue;console.log(`Using original payment date from spreadsheet for API call: ${z}`)}}catch(H){console.error("Error getting payment date from spreadsheet for API call:",H)}z||(N.date?(z=N.date.split("T")[0],console.log(`Using invoice date for payment: ${z}`)):(z=new Date().toISOString().split("T")[0],console.log(`No invoice date found, using today's date: ${z}`)));const Q={..._,amount:N.amount,paymentDate:z},W=`https://api.refrens.com/businesses/vm-jewellers/invoices/${F}/payments`;console.log(`Making bulk payment API call for invoice ${F}:`,W),console.log("Payment data:",JSON.stringify(Q));const ae=await fetch(W,{method:"POST",headers:{Authorization:P,"Content-Type":"application/json"},body:JSON.stringify(Q)});let ye;try{ye=await ae.json(),console.log(`Payment response for invoice ${F}:`,ye)}catch(H){throw console.error(`Error parsing response for invoice ${F}:`,H),new Error(`Could not parse API response for invoice ${F}`)}if(!ae.ok)throw(j=ye.error)!=null&&j.message?new Error(ye.error.message):new Error(`Failed to add payment for invoice ${F} (${ae.status}: ${ae.statusText})`);return{billId:O,invoiceId:F,customerId:N.customerId,amount:N.amount,success:!0,responseData:ye}}catch(z){return console.error(`Error adding payment for invoice ${F}:`,z),{billId:O,invoiceId:F,customerId:N.customerId,success:!1,error:z.message}}finally{T(null)}});try{const O=await Promise.all(R),N=O.filter(j=>j&&j.success),F=O.filter(j=>j&&!j.success);console.log("Bulk payment results:",{total:O.length,successful:N.length,failed:F.length});for(const j of N)if(j)for(let z=0;z<localStorage.length;z++){const Q=localStorage.key(z);if(Q&&Q.startsWith("invoices_"))try{const ae=JSON.parse(localStorage.getItem(Q)||"[]").map(ye=>{if(ye.id===j.invoiceId||FE(ye.link)===j.invoiceId){const H=t.find(ue=>ue.id===j.billId);let Re="";try{const ue=wg(),Pe=ue.findIndex(ke=>j.invoiceId&&ke[16]===j.invoiceId||(H==null?void 0:H.invoiceNumber)&&ke[15]===H.invoiceNumber);if(Pe!==-1&&ue[Pe][11]){const ke=ue[Pe][11];if(/^\d{2}\/\d{2}\/\d{4}$/.test(ke)){const[be,Fe,He]=ke.split("/");Re=`${He}-${Fe}-${be}`}else Re=ke;console.log(`Using original payment date from spreadsheet: ${Re}`)}}catch(ue){console.error("Error getting original payment date:",ue)}return Re||(H!=null&&H.paymentDate?(Re=H.paymentDate,console.log(`Using existing payment date: ${Re}`)):H!=null&&H.date?(Re=H.date.split("T")[0],console.log(`Using invoice date for payment display: ${Re}`)):(Re=new Date().toISOString().split("T")[0],console.log(`No dates found, using today's date for display: ${Re}`))),{...ye,isPaid:!0,paymentDate:Re,paymentMethod:"UPI",paymentAmount:j.amount,paymentRef:`bulk-${new Date().getTime()}`,apiSynced:!0}}return ye});localStorage.setItem(Q,JSON.stringify(ae))}catch(W){console.error(`Error updating invoice in ${Q}:`,W)}}if(e(j=>j.map(z=>{const Q=N.find(W=>(W==null?void 0:W.billId)===z.id);if(Q){let W="";try{const ae=wg(),ye=ae.findIndex(H=>Q.invoiceId&&H[16]===Q.invoiceId||z.invoiceNumber&&H[15]===z.invoiceNumber);if(ye!==-1&&ae[ye][11]){const H=ae[ye][11];if(/^\d{2}\/\d{2}\/\d{4}$/.test(H)){const[Re,ue,Pe]=H.split("/");W=`${Pe}-${ue}-${Re}`}else W=H;console.log(`Using original payment date from spreadsheet for UI: ${W}`)}}catch(ae){console.error("Error getting original payment date for UI update:",ae)}return W||(z.paymentDate?(W=z.paymentDate,console.log(`Using existing payment date: ${W}`)):z.date?(W=z.date.split("T")[0],console.log(`Using invoice date for payment display: ${W}`)):(W=new Date().toISOString().split("T")[0],console.log(`No dates found, using today's date for display: ${W}`))),{...z,status:"completed",paymentDate:W,paymentMethod:"UPI",paymentAmount:Q.amount,paymentRef:`bulk-${new Date().getTime()}`,apiSynced:!0}}return z})),s([]),h(!1),N.length>0&&g(`Successfully processed payment for ${N.length} invoice(s) and synced with API`),F.length>0){const j=F.length===1?`Failed to process 1 payment: ${(A=F[0])==null?void 0:A.error}`:`Failed to process ${F.length} payments. Check console for details.`;c(j)}window.dispatchEvent(new StorageEvent("storage",{key:"invoices_updated",newValue:new Date().toISOString()}))}catch(O){console.error("Bulk payment error:",O),c("Failed to process some payments. Please try again.")}finally{a(!1),S(!1)}},ie=()=>{window.confirm("This will clear all invoice data. Are you sure?")&&(Ste(),e([]),c(""),g("All invoice data cleared from localStorage"))},se=()=>{I(),g("Invoice data refreshed from localStorage")};return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bill History"}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[p.jsx(Gd,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),i.length>0&&p.jsxs("button",{onClick:X,disabled:o,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors disabled:opacity-50",children:[p.jsx(Cd,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Mark Selected as Paid"}),p.jsx("span",{className:"sm:hidden",children:"Pay Selected"})]}),p.jsxs("button",{onClick:ie,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",children:[p.jsx(vw,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Clear History"}),p.jsx("span",{className:"sm:hidden",children:"Clear"})]})]})]}),p.jsx("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm mb-6",children:p.jsxs("div",{className:"flex flex-col md:flex-row gap-3 sm:gap-4 mb-4",children:[p.jsxs("div",{className:"relative flex-1",children:[p.jsx(fU,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),p.jsx("input",{type:"text",placeholder:"Search by name, phone or invoice number",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full text-sm sm:text-base",value:r,onChange:P=>n(P.target.value)})]}),p.jsxs("div",{className:"flex gap-2 flex-wrap sm:flex-nowrap",children:[p.jsxs("select",{value:d?"byCustomer":"all",onChange:P=>f(P.target.value==="byCustomer"),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-auto",children:[p.jsx("option",{value:"all",children:"All Bills"}),p.jsx("option",{value:"byCustomer",children:"Group by Customer"})]}),p.jsxs("select",{value:i.length>0?"selected":"all",onChange:P=>{P.target.value==="selected"?s(k.filter(y=>y.status!=="completed").map(y=>y.id)):s([])},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm w-full sm:w-auto",children:[p.jsx("option",{value:"all",children:"All Status"}),p.jsx("option",{value:"selected",children:"Selected Only"})]})]})]})}),l&&p.jsx("div",{className:"bg-red-50 p-4 rounded-xl mb-6",children:p.jsxs("p",{className:"text-red-700 flex items-center",children:[p.jsx(R2,{className:"w-5 h-5 mr-2"}),l]})}),m&&p.jsx("div",{className:"bg-green-50 p-4 rounded-xl mb-6",children:p.jsxs("p",{className:"text-green-700 flex items-center",children:[p.jsx(C2,{className:"w-5 h-5 mr-2"}),m]})}),i.length>0&&p.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl mb-6",children:[p.jsxs("p",{className:"text-blue-700 flex items-center font-medium mb-2",children:["Selected Bills: ",i.length]}),p.jsx("div",{className:"text-xs text-blue-600 font-mono overflow-auto max-h-32",children:JSON.stringify(i,null,2)})]}),p.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full whitespace-nowrap",children:[p.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:u,onChange:D})}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice #"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice ID"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paid On"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mode"}),p.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),p.jsx("tbody",{className:"divide-y divide-gray-200",children:t.length===0?p.jsx("tr",{children:p.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-gray-500",children:"No bills found. Generate some bills first."})}):d?Object.entries(M||{}).map(([P,y])=>p.jsxs(oe.Fragment,{children:[p.jsx("tr",{className:"bg-gray-50",children:p.jsxs("td",{colSpan:8,className:"px-6 py-3 text-sm font-medium text-gray-700",children:[y.customerName||"Unknown Customer"," - ",y.bills.length," ",y.bills.length===1?"Invoice":"Invoices"]})}),y.bills.map(_=>p.jsx(I5,{bill:_,isSelected:i.includes(_.id),onSelect:L,onPaymentClick:()=>U(_)},_.id))]},P)):k.map(P=>p.jsx(I5,{bill:P,isSelected:i.includes(P.id),onSelect:L,onPaymentClick:()=>U(P)},P.id))})]})})}),b&&p.jsx(FI,{isOpen:v,onClose:()=>w(!1),onSubmit:J,invoiceAmount:(b==null?void 0:b.amount)||0,invoiceId:(b==null?void 0:b.invoiceId)||"",customerName:(b==null?void 0:b.customerName)||"",isSubmitting:o,paymentDate:(b==null?void 0:b.paymentDate)||""})]})}const I5=({bill:t,isSelected:e,onSelect:r,onPaymentClick:n})=>p.jsxs("tr",{className:"hover:bg-gray-50",children:[p.jsx("td",{className:"px-4 py-3",children:p.jsx("input",{type:"checkbox",checked:e,onChange:()=>r(t.id),className:"rounded border-gray-300",disabled:t.status==="completed"})}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx(bb,{className:"w-4 h-4 text-gray-400 mr-2"}),p.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.invoiceNumber})]})}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:t.invoiceId}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:t.customerName}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:new Date(t.date).toLocaleDateString()}),p.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:["",t.amount.toLocaleString()]}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:p.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.status==="completed"&&t.apiSynced===!0?"bg-green-100 text-green-800":e?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:t.status==="completed"&&t.apiSynced===!0?"Paid":"Pending"})}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:t.paymentDate||"-"}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:t.paymentMethod||"-"}),p.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:p.jsxs("div",{className:"flex space-x-2",children:[t.status!=="completed"&&p.jsx("button",{onClick:()=>{r(t.id),n()},className:"text-green-600 hover:text-green-800",title:"Mark as Paid",children:p.jsx(Cd,{className:"w-4 h-4"})}),p.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",title:"View Invoice",children:p.jsx(E2,{className:"w-4 h-4"})})]})})]});class eet extends G.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,r){console.error("ErrorBoundary caught an error:",e,r),this.setState({hasError:!0,error:e,errorInfo:r})}render(){return this.state.hasError?p.jsxs("div",{className:"error-boundary",style:{padding:"20px",margin:"20px",backgroundColor:"#ffebee",border:"1px solid #f44336",borderRadius:"4px",color:"#d32f2f"},children:[p.jsx("h2",{children:"Something went wrong"}),p.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[p.jsx("summary",{children:"Show error details"}),p.jsx("p",{children:this.state.error&&this.state.error.toString()}),p.jsx("p",{children:"Component Stack:"}),p.jsx("pre",{children:this.state.errorInfo&&this.state.errorInfo.componentStack})]})]}):this.props.children}}function tet(){return p.jsx(qee,{children:p.jsx(eet,{children:p.jsx(Vee,{children:p.jsxs(eu,{path:"/",element:p.jsx(Ete,{}),children:[p.jsx(eu,{index:!0,element:p.jsx(cAe,{})}),p.jsx(eu,{path:"generate",element:p.jsx(jAe,{})}),p.jsx(eu,{path:"bulk-import",element:p.jsx(FQe,{})}),p.jsx(eu,{path:"history",element:p.jsx(QQe,{})}),p.jsx(eu,{path:"settings",element:p.jsx(ZQe,{})})]})})})})}GV(document.getElementById("root")).render(p.jsx(G.StrictMode,{children:p.jsx(tet,{})}))});export default ret();
